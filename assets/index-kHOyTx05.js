var es=Object.defineProperty;var ns=(g,A,c)=>A in g?es(g,A,{enumerable:!0,configurable:!0,writable:!0,value:c}):g[A]=c;var Ki=(g,A,c)=>ns(g,typeof A!="symbol"?A+"":A,c);(function(){const A=document.createElement("link").relList;if(A&&A.supports&&A.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))x(v);new MutationObserver(v=>{for(const p of v)if(p.type==="childList")for(const f of p.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&x(f)}).observe(document,{childList:!0,subtree:!0});function c(v){const p={};return v.integrity&&(p.integrity=v.integrity),v.referrerPolicy&&(p.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?p.credentials="include":v.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function x(v){if(v.ep)return;v.ep=!0;const p=c(v);fetch(v.href,p)}})();const vt=(g,A={})=>{const c=document.createElement(g);return A.className&&(c.className=A.className),A.text!==void 0&&(c.textContent=A.text),c};var Ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function io(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var Co={exports:{}};(function(g,A){(function(c,x){g.exports=x()})(Ti,function(){var c=function(n,r){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[l]=a[l])})(n,r)},x=function(){return(x=Object.assign||function(n){for(var r,s=1,a=arguments.length;s<a;s++)for(var l in r=arguments[s])Object.prototype.hasOwnProperty.call(r,l)&&(n[l]=r[l]);return n}).apply(this,arguments)};function v(n,r,s){for(var a,l=0,d=r.length;l<d;l++)!a&&l in r||((a=a||Array.prototype.slice.call(r,0,l))[l]=r[l]);return n.concat(a||Array.prototype.slice.call(r))}var p=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ti,f=Object.keys,m=Array.isArray;function w(n,r){return typeof r!="object"||f(r).forEach(function(s){n[s]=r[s]}),n}typeof Promise>"u"||p.Promise||(p.Promise=Promise);var D=Object.getPrototypeOf,F={}.hasOwnProperty;function P(n,r){return F.call(n,r)}function z(n,r){typeof r=="function"&&(r=r(D(n))),(typeof Reflect>"u"?f:Reflect.ownKeys)(r).forEach(function(s){C(n,s,r[s])})}var k=Object.defineProperty;function C(n,r,s,a){k(n,r,w(s&&P(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},a))}function b(n){return{from:function(r){return n.prototype=Object.create(r.prototype),C(n.prototype,"constructor",n),{extend:z.bind(null,n.prototype)}}}}var O=Object.getOwnPropertyDescriptor,T=[].slice;function I(n,r,s){return T.call(n,r,s)}function j(n,r){return r(n)}function J(n){if(!n)throw new Error("Assertion Failed")}function X(n){p.setImmediate?setImmediate(n):setTimeout(n,0)}function lt(n,r){if(typeof r=="string"&&P(n,r))return n[r];if(!r)return n;if(typeof r!="string"){for(var s=[],a=0,l=r.length;a<l;++a){var d=lt(n,r[a]);s.push(d)}return s}var S=r.indexOf(".");if(S!==-1){var M=n[r.substr(0,S)];return M==null?void 0:lt(M,r.substr(S+1))}}function rt(n,r,s){if(n&&r!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof r!="string"&&"length"in r){J(typeof s!="string"&&"length"in s);for(var a=0,l=r.length;a<l;++a)rt(n,r[a],s[a])}else{var d,S,M=r.indexOf(".");M!==-1?(d=r.substr(0,M),(S=r.substr(M+1))===""?s===void 0?m(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=s:rt(M=!(M=n[d])||!P(n,d)?n[d]={}:M,S,s)):s===void 0?m(n)&&!isNaN(parseInt(r))?n.splice(r,1):delete n[r]:n[r]=s}}function wt(n){var r,s={};for(r in n)P(n,r)&&(s[r]=n[r]);return s}var at=[].concat;function xt(n){return at.apply([],n)}var Gt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(xt([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(r){return r+n+"Array"})}))).filter(function(n){return p[n]}),Zt=new Set(Gt.map(function(n){return p[n]})),N=null;function ct(n){return N=new WeakMap,n=function r(s){if(!s||typeof s!="object")return s;var a=N.get(s);if(a)return a;if(m(s)){a=[],N.set(s,a);for(var l=0,d=s.length;l<d;++l)a.push(r(s[l]))}else if(Zt.has(s.constructor))a=s;else{var S,M=D(s);for(S in a=M===Object.prototype?{}:Object.create(M),N.set(s,a),s)P(s,S)&&(a[S]=r(s[S]))}return a}(n),N=null,n}var _={}.toString;function mt(n){return _.call(n).slice(8,-1)}var Nt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",pt=typeof Nt=="symbol"?function(n){var r;return n!=null&&(r=n[Nt])&&r.apply(n)}:function(){return null};function Pt(n,r){return r=n.indexOf(r),0<=r&&n.splice(r,1),0<=r}var kt={};function gt(n){var r,s,a,l;if(arguments.length===1){if(m(n))return n.slice();if(this===kt&&typeof n=="string")return[n];if(l=pt(n)){for(s=[];!(a=l.next()).done;)s.push(a.value);return s}if(n==null)return[n];if(typeof(r=n.length)!="number")return[n];for(s=new Array(r);r--;)s[r]=n[r];return s}for(r=arguments.length,s=new Array(r);r--;)s[r]=arguments[r];return s}var Q=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ot=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ve=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ot),tt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ft(n,r){this.name=n,this.message=r}function Et(n,r){return n+". Errors: "+Object.keys(r).map(function(s){return r[s].toString()}).filter(function(s,a,l){return l.indexOf(s)===a}).join(`
`)}function ht(n,r,s,a){this.failures=r,this.failedKeys=a,this.successCount=s,this.message=Et(n,r)}function zt(n,r){this.name="BulkError",this.failures=Object.keys(r).map(function(s){return r[s]}),this.failuresByPos=r,this.message=Et(n,this.failures)}b(Ft).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(ht).from(Ft),b(zt).from(Ft);var ne=Ve.reduce(function(n,r){return n[r]=r+"Error",n},{}),Dt=Ft,St=Ve.reduce(function(n,r){var s=r+"Error";function a(l,d){this.name=s,l?typeof l=="string"?(this.message="".concat(l).concat(d?`
 `+d:""),this.inner=d||null):typeof l=="object"&&(this.message="".concat(l.name," ").concat(l.message),this.inner=l):(this.message=tt[r]||s,this.inner=null)}return b(a).from(Dt),n[r]=a,n},{});St.Syntax=SyntaxError,St.Type=TypeError,St.Range=RangeError;var oe=Ot.reduce(function(n,r){return n[r+"Error"]=St[r],n},{}),ce=Ve.reduce(function(n,r){return["Syntax","Type","Range"].indexOf(r)===-1&&(n[r+"Error"]=St[r]),n},{});function Xt(){}function he(n){return n}function h(n,r){return n==null||n===he?r:function(s){return r(n(s))}}function dt(n,r){return function(){n.apply(this,arguments),r.apply(this,arguments)}}function st(n,r){return n===Xt?r:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var a=this.onsuccess,l=this.onerror;this.onsuccess=null,this.onerror=null;var d=r.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?dt(a,this.onsuccess):a),l&&(this.onerror=this.onerror?dt(l,this.onerror):l),d!==void 0?d:s}}function B(n,r){return n===Xt?r:function(){n.apply(this,arguments);var s=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?dt(s,this.onsuccess):s),a&&(this.onerror=this.onerror?dt(a,this.onerror):a)}}function E(n,r){return n===Xt?r:function(s){var a=n.apply(this,arguments);w(s,a);var l=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=r.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?dt(l,this.onsuccess):l),d&&(this.onerror=this.onerror?dt(d,this.onerror):d),a===void 0?s===void 0?void 0:s:w(a,s)}}function q(n,r){return n===Xt?r:function(){return r.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function yt(n,r){return n===Xt?r:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var a=this,l=arguments.length,d=new Array(l);l--;)d[l]=arguments[l];return s.then(function(){return r.apply(a,d)})}return r.apply(this,arguments)}}ce.ModifyError=ht,ce.DexieError=Ft,ce.BulkError=zt;var _t=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function nt(n){_t=n}var Lt={},Ut=100,Gt=typeof Promise>"u"?[]:function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,D(n),n];var r=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[r,D(r),n]}(),Ot=Gt[0],Ve=Gt[1],Gt=Gt[2],Ve=Ve&&Ve.then,le=Ot&&Ot.constructor,ie=!!Gt,Se=function(n,r){qe.push([n,r]),Ae&&(queueMicrotask(Kr),Ae=!1)},rn=!0,Ae=!0,Ue=[],me=[],on=he,Ke={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Xt,pgp:!1,env:{},finalize:Xt},Kt=Ke,qe=[],mn=0,Gn=[];function jt(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var r=this._PSD=Kt;if(typeof n!="function"){if(n!==Lt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ln(this,this._value))}this._state=null,this._value=null,++r.ref,function s(a,l){try{l(function(d){if(a._state===null){if(d===a)throw new TypeError("A promise cannot be resolved with itself.");var S=a._lib&&Vn();d&&typeof d.then=="function"?s(a,function(M,U){d instanceof jt?d._then(M,U):d.then(M,U)}):(a._state=!0,a._value=d,mr(a)),S&&En()}},Ln.bind(null,a))}catch(d){Ln(a,d)}}(this,n)}var Zn={get:function(){var n=Kt,r=ci;function s(a,l){var d=this,S=!n.global&&(n!==Kt||r!==ci),M=S&&!vn(),U=new jt(function(K,Y){Yi(d,new _n(yr(a,n,S,M),yr(l,n,S,M),K,Y,n))});return this._consoleTask&&(U._consoleTask=this._consoleTask),U}return s.prototype=Lt,s},set:function(n){C(this,"then",n&&n.prototype===Lt?Zn:{get:function(){return n},set:Zn.set})}};function _n(n,r,s,a,l){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof r=="function"?r:null,this.resolve=s,this.reject=a,this.psd=l}function Ln(n,r){var s,a;me.push(r),n._state===null&&(s=n._lib&&Vn(),r=on(r),n._state=!1,n._value=r,a=n,Ue.some(function(l){return l._value===a._value})||Ue.push(a),mr(n),s&&En())}function mr(n){var r=n._listeners;n._listeners=[];for(var s=0,a=r.length;s<a;++s)Yi(n,r[s]);var l=n._PSD;--l.ref||l.finalize(),mn===0&&(++mn,Se(function(){--mn==0&&Xi()},[]))}function Yi(n,r){if(n._state!==null){var s=n._state?r.onFulfilled:r.onRejected;if(s===null)return(n._state?r.resolve:r.reject)(n._value);++r.psd.ref,++mn,Se(Ur,[s,n,r])}else n._listeners.push(r)}function Ur(n,r,s){try{var a,l=r._value;!r._state&&me.length&&(me=[]),a=_t&&r._consoleTask?r._consoleTask.run(function(){return n(l)}):n(l),r._state||me.indexOf(l)!==-1||function(d){for(var S=Ue.length;S;)if(Ue[--S]._value===d._value)return Ue.splice(S,1)}(r),s.resolve(a)}catch(d){s.reject(d)}finally{--mn==0&&Xi(),--s.psd.ref||s.psd.finalize()}}function Kr(){Fn(Ke,function(){Vn()&&En()})}function Vn(){var n=rn;return Ae=rn=!1,n}function En(){var n,r,s;do for(;0<qe.length;)for(n=qe,qe=[],s=n.length,r=0;r<s;++r){var a=n[r];a[0].apply(null,a[1])}while(0<qe.length);Ae=rn=!0}function Xi(){var n=Ue;Ue=[],n.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});for(var r=Gn.slice(0),s=r.length;s;)r[--s]()}function Li(n){return new jt(Lt,!1,n)}function ge(n,r){var s=Kt;return function(){var a=Vn(),l=Kt;try{return On(s,!0),n.apply(this,arguments)}catch(d){r&&r(d)}finally{On(l,!1),a&&En()}}}z(jt.prototype,{then:Zn,_then:function(n,r){Yi(this,new _n(null,null,n,r,Kt))},catch:function(n){if(arguments.length===1)return this.then(null,n);var r=n,s=arguments[1];return typeof r=="function"?this.then(null,function(a){return(a instanceof r?s:Li)(a)}):this.then(null,function(a){return(a&&a.name===r?s:Li)(a)})},finally:function(n){return this.then(function(r){return jt.resolve(n()).then(function(){return r})},function(r){return jt.resolve(n()).then(function(){return Li(r)})})},timeout:function(n,r){var s=this;return n<1/0?new jt(function(a,l){var d=setTimeout(function(){return l(new St.Timeout(r))},n);s.then(a,l).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&C(jt.prototype,Symbol.toStringTag,"Dexie.Promise"),Ke.env=vr(),z(jt,{all:function(){var n=gt.apply(null,arguments).map(yn);return new jt(function(r,s){n.length===0&&r([]);var a=n.length;n.forEach(function(l,d){return jt.resolve(l).then(function(S){n[d]=S,--a||r(n)},s)})})},resolve:function(n){return n instanceof jt?n:n&&typeof n.then=="function"?new jt(function(r,s){n.then(r,s)}):new jt(Lt,!0,n)},reject:Li,race:function(){var n=gt.apply(null,arguments).map(yn);return new jt(function(r,s){n.map(function(a){return jt.resolve(a).then(r,s)})})},PSD:{get:function(){return Kt},set:function(n){return Kt=n}},totalEchoes:{get:function(){return ci}},newPSD:gn,usePSD:Fn,scheduler:{get:function(){return Se},set:function(n){Se=n}},rejectionMapper:{get:function(){return on},set:function(n){on=n}},follow:function(n,r){return new jt(function(s,a){return gn(function(l,d){var S=Kt;S.unhandleds=[],S.onunhandled=d,S.finalize=dt(function(){var M,U=this;M=function(){U.unhandleds.length===0?l():d(U.unhandleds[0])},Gn.push(function K(){M(),Gn.splice(Gn.indexOf(K),1)}),++mn,Se(function(){--mn==0&&Xi()},[])},S.finalize),n()},r,s,a)})}}),le&&(le.allSettled&&C(jt,"allSettled",function(){var n=gt.apply(null,arguments).map(yn);return new jt(function(r){n.length===0&&r([]);var s=n.length,a=new Array(s);n.forEach(function(l,d){return jt.resolve(l).then(function(S){return a[d]={status:"fulfilled",value:S}},function(S){return a[d]={status:"rejected",reason:S}}).then(function(){return--s||r(a)})})})}),le.any&&typeof AggregateError<"u"&&C(jt,"any",function(){var n=gt.apply(null,arguments).map(yn);return new jt(function(r,s){n.length===0&&s(new AggregateError([]));var a=n.length,l=new Array(a);n.forEach(function(d,S){return jt.resolve(d).then(function(M){return r(M)},function(M){l[S]=M,--a||s(new AggregateError(l))})})})}),le.withResolvers&&(jt.withResolvers=le.withResolvers));var Te={awaits:0,echoes:0,id:0},sn=0,Vt=[],ui=0,ci=0,_r=0;function gn(n,r,s,a){var l=Kt,d=Object.create(l);return d.parent=l,d.ref=0,d.global=!1,d.id=++_r,Ke.env,d.env=ie?{Promise:jt,PromiseProp:{value:jt,configurable:!0,writable:!0},all:jt.all,race:jt.race,allSettled:jt.allSettled,any:jt.any,resolve:jt.resolve,reject:jt.reject}:{},r&&w(d,r),++l.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},a=Fn(d,n,s,a),d.ref===0&&d.finalize(),a}function Cn(){return Te.id||(Te.id=++sn),++Te.awaits,Te.echoes+=Ut,Te.id}function vn(){return!!Te.awaits&&(--Te.awaits==0&&(Te.id=0),Te.echoes=Te.awaits*Ut,!0)}function yn(n){return Te.echoes&&n&&n.constructor===le?(Cn(),n.then(function(r){return vn(),r},function(r){return vn(),we(r)})):n}function gr(){var n=Vt[Vt.length-1];Vt.pop(),On(n,!1)}function On(n,r){var s,a=Kt;(r?!Te.echoes||ui++&&n===Kt:!ui||--ui&&n===Kt)||queueMicrotask(r?(function(l){++ci,Te.echoes&&--Te.echoes!=0||(Te.echoes=Te.awaits=Te.id=0),Vt.push(Kt),On(l,!0)}).bind(null,n):gr),n!==Kt&&(Kt=n,a===Ke&&(Ke.env=vr()),ie&&(s=Ke.env.Promise,r=n.env,(a.global||n.global)&&(Object.defineProperty(p,"Promise",r.PromiseProp),s.all=r.all,s.race=r.race,s.resolve=r.resolve,s.reject=r.reject,r.allSettled&&(s.allSettled=r.allSettled),r.any&&(s.any=r.any))))}function vr(){var n=p.Promise;return ie?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(p,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Fn(n,r,s,a,l){var d=Kt;try{return On(n,!0),r(s,a,l)}finally{On(d,!1)}}function yr(n,r,s,a){return typeof n!="function"?n:function(){var l=Kt;s&&Cn(),On(r,!0);try{return n.apply(this,arguments)}finally{On(l,!1),a&&queueMicrotask(vn)}}}function Ei(n){Promise===le&&Te.echoes===0?ui===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+Ve).indexOf("[native code]")===-1&&(Cn=vn=Xt);var we=jt.reject,an="ï¿¿",bn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",br="String expected.",Yn=[],Ci="__dbnames",Ji="readonly",li="readwrite";function $e(n,r){return n?r?function(){return n.apply(this,arguments)&&r.apply(this,arguments)}:n:r}var $i={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function hi(n){return typeof n!="string"||/\./.test(n)?function(r){return r}:function(r){return r[n]===void 0&&n in r&&delete(r=ct(r))[n],r}}function Xn(){throw St.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ht(n,r){try{var s=ve(n),a=ve(r);if(s!==a)return s==="Array"?1:a==="Array"?-1:s==="binary"?1:a==="binary"?-1:s==="string"?1:a==="string"?-1:s==="Date"?1:a!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return r<n?1:n<r?-1:0;case"binary":return function(l,d){for(var S=l.length,M=d.length,U=S<M?S:M,K=0;K<U;++K)if(l[K]!==d[K])return l[K]<d[K]?-1:1;return S===M?0:S<M?-1:1}(fi(n),fi(r));case"Array":return function(l,d){for(var S=l.length,M=d.length,U=S<M?S:M,K=0;K<U;++K){var Y=Ht(l[K],d[K]);if(Y!==0)return Y}return S===M?0:S<M?-1:1}(n,r)}}catch{}return NaN}function ve(n){var r=typeof n;return r!="object"?r:ArrayBuffer.isView(n)?"binary":(n=mt(n),n==="ArrayBuffer"?"binary":n)}function fi(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function wn(n,r,s){var a=n.schema.yProps;return a?(r&&0<s.numFailures&&(r=r.filter(function(l,d){return!s.failures[d]})),Promise.all(a.map(function(l){return l=l.updatesTable,r?n.db.table(l).where("k").anyOf(r).delete():n.db.table(l).clear()})).then(function(){return s})):s}var un=(Oi.prototype.execute=function(n){var r=this["@@propmod"];if(r.add!==void 0){var s=r.add;if(m(s))return v(v([],m(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(r.remove!==void 0){var a=r.remove;if(m(a))return m(n)?n.filter(function(l){return!a.includes(l)}).sort():[];if(typeof a=="number")return Number(n)-a;if(typeof a=="bigint")try{return BigInt(n)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return s=(s=r.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?r.replacePrefix[1]+n.substring(s.length):n},Oi);function Oi(n){this["@@propmod"]=n}function ee(n,r){for(var s=f(r),a=s.length,l=!1,d=0;d<a;++d){var S=s[d],M=r[S],U=lt(n,S);M instanceof un?(rt(n,S,M.execute(U)),l=!0):U!==M&&(rt(n,S,M),l=!0)}return l}var be=(de.prototype._trans=function(n,r,s){var a=this._tx||Kt.trans,l=this.name,d=_t&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function S(K,Y,Z){if(!Z.schema[l])throw new St.NotFound("Table "+l+" not part of transaction");return r(Z.idbtrans,Z)}var M=Vn();try{var U=a&&a.db._novip===this.db._novip?a===Kt.trans?a._promise(n,S,s):gn(function(){return a._promise(n,S,s)},{trans:a,transless:Kt.transless||Kt}):function K(Y,Z,$,W){if(Y.idbdb&&(Y._state.openComplete||Kt.letThrough||Y._vip)){var H=Y._createTransaction(Z,$,Y._dbSchema);try{H.create(),Y._state.PR1398_maxLoop=3}catch(G){return G.name===ne.InvalidState&&Y.isOpen()&&0<--Y._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Y.close({disableAutoOpen:!1}),Y.open().then(function(){return K(Y,Z,$,W)})):we(G)}return H._promise(Z,function(G,V){return gn(function(){return Kt.trans=H,W(G,V,H)})}).then(function(G){if(Z==="readwrite")try{H.idbtrans.commit()}catch{}return Z==="readonly"?G:H._completion.then(function(){return G})})}if(Y._state.openComplete)return we(new St.DatabaseClosed(Y._state.dbOpenError));if(!Y._state.isBeingOpened){if(!Y._state.autoOpen)return we(new St.DatabaseClosed);Y.open().catch(Xt)}return Y._state.dbReadyPromise.then(function(){return K(Y,Z,$,W)})}(this.db,n,[this.name],S);return d&&(U._consoleTask=d,U=U.catch(function(K){return console.trace(K),we(K)})),U}finally{M&&En()}},de.prototype.get=function(n,r){var s=this;return n&&n.constructor===Object?this.where(n).first(r):n==null?we(new St.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return s.core.get({trans:a,key:n}).then(function(l){return s.hook.reading.fire(l)})}).then(r)},de.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(m(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var r=f(n);if(r.length===1)return this.where(r[0]).equals(n[r[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(M){if(M.compound&&r.every(function(K){return 0<=M.keyPath.indexOf(K)})){for(var U=0;U<r.length;++U)if(r.indexOf(M.keyPath[U])===-1)return!1;return!0}return!1}).sort(function(M,U){return M.keyPath.length-U.keyPath.length})[0];if(s&&this.db._maxKey!==an){var d=s.keyPath.slice(0,r.length);return this.where(d).equals(d.map(function(U){return n[U]}))}!s&&_t&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var a=this.schema.idxByName;function l(M,U){return Ht(M,U)===0}var S=r.reduce(function(Z,U){var K=Z[0],Y=Z[1],Z=a[U],$=n[U];return[K||Z,K||!Z?$e(Y,Z&&Z.multi?function(W){return W=lt(W,U),m(W)&&W.some(function(H){return l($,H)})}:function(W){return l($,lt(W,U))}):Y]},[null,null]),d=S[0],S=S[1];return d?this.where(d.name).equals(n[d.keyPath]).filter(S):s?this.filter(S):this.where(r).equals("")},de.prototype.filter=function(n){return this.toCollection().and(n)},de.prototype.count=function(n){return this.toCollection().count(n)},de.prototype.offset=function(n){return this.toCollection().offset(n)},de.prototype.limit=function(n){return this.toCollection().limit(n)},de.prototype.each=function(n){return this.toCollection().each(n)},de.prototype.toArray=function(n){return this.toCollection().toArray(n)},de.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},de.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,m(n)?"[".concat(n.join("+"),"]"):n))},de.prototype.reverse=function(){return this.toCollection().reverse()},de.prototype.mapToClass=function(n){var r,s=this.db,a=this.name;function l(){return r!==null&&r.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Xn&&(function(U,K){if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function Y(){this.constructor=U}c(U,K),U.prototype=K===null?Object.create(K):(Y.prototype=K.prototype,new Y)}(l,r=n),Object.defineProperty(l.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),l.prototype.table=function(){return a},n=l);for(var d=new Set,S=n.prototype;S;S=D(S))Object.getOwnPropertyNames(S).forEach(function(U){return d.add(U)});function M(U){if(!U)return U;var K,Y=Object.create(n.prototype);for(K in U)if(!d.has(K))try{Y[K]=U[K]}catch{}return Y}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=M,this.hook("reading",M),n},de.prototype.defineClass=function(){return this.mapToClass(function(n){w(this,n)})},de.prototype.add=function(n,r){var s=this,a=this.schema.primKey,l=a.auto,d=a.keyPath,S=n;return d&&l&&(S=hi(d)(n)),this._trans("readwrite",function(M){return s.core.mutate({trans:M,type:"add",keys:r!=null?[r]:null,values:[S]})}).then(function(M){return M.numFailures?jt.reject(M.failures[0]):M.lastResult}).then(function(M){if(d)try{rt(n,d,M)}catch{}return M})},de.prototype.upsert=function(n,r){var s=this,a=this.schema.primKey.keyPath;return this._trans("readwrite",function(l){return s.core.get({trans:l,key:n}).then(function(d){var S=d??{};return ee(S,r),a&&rt(S,a,n),s.core.mutate({trans:l,type:"put",values:[S],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[r]}}).then(function(M){return M.numFailures?jt.reject(M.failures[0]):!!d})})})},de.prototype.update=function(n,r){return typeof n!="object"||m(n)?this.where(":id").equals(n).modify(r):(n=lt(n,this.schema.primKey.keyPath),n===void 0?we(new St.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(r))},de.prototype.put=function(n,r){var s=this,a=this.schema.primKey,l=a.auto,d=a.keyPath,S=n;return d&&l&&(S=hi(d)(n)),this._trans("readwrite",function(M){return s.core.mutate({trans:M,type:"put",values:[S],keys:r!=null?[r]:null})}).then(function(M){return M.numFailures?jt.reject(M.failures[0]):M.lastResult}).then(function(M){if(d)try{rt(n,d,M)}catch{}return M})},de.prototype.delete=function(n){var r=this;return this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(a){return wn(r,[n],a)}).then(function(a){return a.numFailures?jt.reject(a.failures[0]):void 0})})},de.prototype.clear=function(){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"deleteRange",range:$i}).then(function(s){return wn(n,null,s)})}).then(function(r){return r.numFailures?jt.reject(r.failures[0]):void 0})},de.prototype.bulkGet=function(n){var r=this;return this._trans("readonly",function(s){return r.core.getMany({keys:n,trans:s}).then(function(a){return a.map(function(l){return r.hook.reading.fire(l)})})})},de.prototype.bulkAdd=function(n,r,s){var a=this,l=Array.isArray(r)?r:void 0,d=(s=s||(l?void 0:r))?s.allKeys:void 0;return this._trans("readwrite",function(S){var K=a.schema.primKey,M=K.auto,K=K.keyPath;if(K&&l)throw new St.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(l&&l.length!==n.length)throw new St.InvalidArgument("Arguments objects and keys must have the same length");var U=n.length,K=K&&M?n.map(hi(K)):n;return a.core.mutate({trans:S,type:"add",keys:l,values:K,wantResults:d}).then(function(H){var Z=H.numFailures,$=H.results,W=H.lastResult,H=H.failures;if(Z===0)return d?$:W;throw new zt("".concat(a.name,".bulkAdd(): ").concat(Z," of ").concat(U," operations failed"),H)})})},de.prototype.bulkPut=function(n,r,s){var a=this,l=Array.isArray(r)?r:void 0,d=(s=s||(l?void 0:r))?s.allKeys:void 0;return this._trans("readwrite",function(S){var K=a.schema.primKey,M=K.auto,K=K.keyPath;if(K&&l)throw new St.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(l&&l.length!==n.length)throw new St.InvalidArgument("Arguments objects and keys must have the same length");var U=n.length,K=K&&M?n.map(hi(K)):n;return a.core.mutate({trans:S,type:"put",keys:l,values:K,wantResults:d}).then(function(H){var Z=H.numFailures,$=H.results,W=H.lastResult,H=H.failures;if(Z===0)return d?$:W;throw new zt("".concat(a.name,".bulkPut(): ").concat(Z," of ").concat(U," operations failed"),H)})})},de.prototype.bulkUpdate=function(n){var r=this,s=this.core,a=n.map(function(S){return S.key}),l=n.map(function(S){return S.changes}),d=[];return this._trans("readwrite",function(S){return s.getMany({trans:S,keys:a,cache:"clone"}).then(function(M){var U=[],K=[];n.forEach(function(Z,$){var W=Z.key,H=Z.changes,G=M[$];if(G){for(var V=0,et=Object.keys(H);V<et.length;V++){var ot=et[V],ft=H[ot];if(ot===r.schema.primKey.keyPath){if(Ht(ft,W)!==0)throw new St.Constraint("Cannot update primary key in bulkUpdate()")}else rt(G,ot,ft)}d.push($),U.push(W),K.push(G)}});var Y=U.length;return s.mutate({trans:S,type:"put",keys:U,values:K,updates:{keys:a,changeSpecs:l}}).then(function(Z){var $=Z.numFailures,W=Z.failures;if($===0)return Y;for(var H=0,G=Object.keys(W);H<G.length;H++){var V,et=G[H],ot=d[Number(et)];ot!=null&&(V=W[et],delete W[et],W[ot]=V)}throw new zt("".concat(r.name,".bulkUpdate(): ").concat($," of ").concat(Y," operations failed"),W)})})})},de.prototype.bulkDelete=function(n){var r=this,s=n.length;return this._trans("readwrite",function(a){return r.core.mutate({trans:a,type:"delete",keys:n}).then(function(l){return wn(r,n,l)})}).then(function(S){var l=S.numFailures,d=S.lastResult,S=S.failures;if(l===0)return d;throw new zt("".concat(r.name,".bulkDelete(): ").concat(l," of ").concat(s," operations failed"),S)})},de);function de(){}function An(n){function r(S,M){if(M){for(var U=arguments.length,K=new Array(U-1);--U;)K[U-1]=arguments[U];return s[S].subscribe.apply(null,K),n}if(typeof S=="string")return s[S]}var s={};r.addEventType=d;for(var a=1,l=arguments.length;a<l;++a)d(arguments[a]);return r;function d(S,M,U){if(typeof S!="object"){var K;M=M||q;var Y={subscribers:[],fire:U=U||Xt,subscribe:function(Z){Y.subscribers.indexOf(Z)===-1&&(Y.subscribers.push(Z),Y.fire=M(Y.fire,Z))},unsubscribe:function(Z){Y.subscribers=Y.subscribers.filter(function($){return $!==Z}),Y.fire=Y.subscribers.reduce(M,U)}};return s[S]=r[S]=Y}f(K=S).forEach(function(Z){var $=K[Z];if(m($))d(Z,K[Z][0],K[Z][1]);else{if($!=="asap")throw new St.InvalidArgument("Invalid event config");var W=d(Z,he,function(){for(var H=arguments.length,G=new Array(H);H--;)G[H]=arguments[H];W.subscribers.forEach(function(V){X(function(){V.apply(null,G)})})})}})}}function ze(n,r){return b(r).from({prototype:n}),r}function Jn(n,r){return!(n.filter||n.algorithm||n.or)&&(r?n.justLimit:!n.replayFilter)}function $n(n,r){n.filter=$e(n.filter,r)}function xn(n,r,s){var a=n.replayFilter;n.replayFilter=a?function(){return $e(a(),r())}:r,n.justLimit=s&&!a}function ye(n,r){if(n.isPrimKey)return r.primaryKey;var s=r.getIndexByKeyPath(n.index);if(!s)throw new St.Schema("KeyPath "+n.index+" on object store "+r.name+" is not indexed");return s}function zn(n,r,s){var a=ye(n,r.schema);return r.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:a,range:n.range}})}function Bn(n,r,s,a){var l=n.replayFilter?$e(n.filter,n.replayFilter()):n.filter;if(n.or){var d={},S=function(M,U,K){var Y,Z;l&&!l(U,K,function($){return U.stop($)},function($){return U.fail($)})||((Z=""+(Y=U.primaryKey))=="[object ArrayBuffer]"&&(Z=""+new Uint8Array(Y)),P(d,Z)||(d[Z]=!0,r(M,U,K)))};return Promise.all([n.or._iterate(S,s),Qn(zn(n,a,s),n.algorithm,S,!n.keysOnly&&n.valueMapper)])}return Qn(zn(n,a,s),$e(n.algorithm,l),r,!n.keysOnly&&n.valueMapper)}function Qn(n,r,s,a){var l=ge(a?function(d,S,M){return s(a(d),S,M)}:s);return n.then(function(d){if(d)return d.start(function(){var S=function(){return d.continue()};r&&!r(d,function(M){return S=M},function(M){d.stop(M),S=Xt},function(M){d.fail(M),S=Xt})||l(d.value,d,function(M){return S=M}),S()})})}var Qi=(ae.prototype._read=function(n,r){var s=this._ctx;return s.error?s.table._trans(null,we.bind(null,s.error)):s.table._trans("readonly",n).then(r)},ae.prototype._write=function(n){var r=this._ctx;return r.error?r.table._trans(null,we.bind(null,r.error)):r.table._trans("readwrite",n,"locked")},ae.prototype._addAlgorithm=function(n){var r=this._ctx;r.algorithm=$e(r.algorithm,n)},ae.prototype._iterate=function(n,r){return Bn(this._ctx,n,r,this._ctx.table.core)},ae.prototype.clone=function(n){var r=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&w(s,n),r._ctx=s,r},ae.prototype.raw=function(){return this._ctx.valueMapper=null,this},ae.prototype.each=function(n){var r=this._ctx;return this._read(function(s){return Bn(r,n,s,r.table.core)})},ae.prototype.count=function(n){var r=this;return this._read(function(s){var a=r._ctx,l=a.table.core;if(Jn(a,!0))return l.count({trans:s,query:{index:ye(a,l.schema),range:a.range}}).then(function(S){return Math.min(S,a.limit)});var d=0;return Bn(a,function(){return++d,!1},s,l).then(function(){return d})}).then(n)},ae.prototype.sortBy=function(n,r){var s=n.split(".").reverse(),a=s[0],l=s.length-1;function d(U,K){return K?d(U[s[K]],K-1):U[a]}var S=this._ctx.dir==="next"?1:-1;function M(U,K){return Ht(d(U,l),d(K,l))*S}return this.toArray(function(U){return U.sort(M)}).then(r)},ae.prototype.toArray=function(n){var r=this;return this._read(function(s){var a=r._ctx;if(a.dir==="next"&&Jn(a,!0)&&0<a.limit){var l=a.valueMapper,d=ye(a,a.table.core.schema);return a.table.core.query({trans:s,limit:a.limit,values:!0,query:{index:d,range:a.range}}).then(function(M){return M=M.result,l?M.map(l):M})}var S=[];return Bn(a,function(M){return S.push(M)},s,a.table.core).then(function(){return S})},n)},ae.prototype.offset=function(n){var r=this._ctx;return n<=0||(r.offset+=n,Jn(r)?xn(r,function(){var s=n;return function(a,l){return s===0||(s===1?--s:l(function(){a.advance(s),s=0}),!1)}}):xn(r,function(){var s=n;return function(){return--s<0}})),this},ae.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),xn(this._ctx,function(){var r=n;return function(s,a,l){return--r<=0&&a(l),0<=r}},!0),this},ae.prototype.until=function(n,r){return $n(this._ctx,function(s,a,l){return!n(s.value)||(a(l),r)}),this},ae.prototype.first=function(n){return this.limit(1).toArray(function(r){return r[0]}).then(n)},ae.prototype.last=function(n){return this.reverse().first(n)},ae.prototype.filter=function(n){var r;return $n(this._ctx,function(s){return n(s.value)}),(r=this._ctx).isMatch=$e(r.isMatch,n),this},ae.prototype.and=function(n){return this.filter(n)},ae.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},ae.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ae.prototype.desc=function(){return this.reverse()},ae.prototype.eachKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(s,a){n(a.key,a)})},ae.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},ae.prototype.eachPrimaryKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(s,a){n(a.primaryKey,a)})},ae.prototype.keys=function(n){var r=this._ctx;r.keysOnly=!r.isMatch;var s=[];return this.each(function(a,l){s.push(l.key)}).then(function(){return s}).then(n)},ae.prototype.primaryKeys=function(n){var r=this._ctx;if(r.dir==="next"&&Jn(r,!0)&&0<r.limit)return this._read(function(a){var l=ye(r,r.table.core.schema);return r.table.core.query({trans:a,values:!1,limit:r.limit,query:{index:l,range:r.range}})}).then(function(a){return a.result}).then(n);r.keysOnly=!r.isMatch;var s=[];return this.each(function(a,l){s.push(l.primaryKey)}).then(function(){return s}).then(n)},ae.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},ae.prototype.firstKey=function(n){return this.limit(1).keys(function(r){return r[0]}).then(n)},ae.prototype.lastKey=function(n){return this.reverse().firstKey(n)},ae.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var r={};return $n(this._ctx,function(l){var a=l.primaryKey.toString(),l=P(r,a);return r[a]=!0,!l}),this},ae.prototype.modify=function(n){var r=this,s=this._ctx;return this._write(function(a){var l=typeof n=="function"?n:function(G){return ee(G,n)},d=s.table.core,K=d.schema.primaryKey,S=K.outbound,M=K.extractKey,U=200,K=r.db._options.modifyChunkSize;K&&(U=typeof K=="object"?K[d.name]||K["*"]||200:K);function Y(G,ot){var et=ot.failures,ot=ot.numFailures;$+=G-ot;for(var ft=0,bt=f(et);ft<bt.length;ft++){var At=bt[ft];Z.push(et[At])}}var Z=[],$=0,W=[],H=n===Ai;return r.clone().primaryKeys().then(function(G){function V(ot){var ft=Math.min(U,G.length-ot),bt=G.slice(ot,ot+ft);return(H?Promise.resolve([]):d.getMany({trans:a,keys:bt,cache:"immutable"})).then(function(At){var Rt=[],Ct=[],Bt=S?[]:null,It=H?bt:[];if(!H)for(var Mt=0;Mt<ft;++Mt){var Wt=At[Mt],te={value:ct(Wt),primKey:G[ot+Mt]};l.call(te,te.value,te)!==!1&&(te.value==null?It.push(G[ot+Mt]):S||Ht(M(Wt),M(te.value))===0?(Ct.push(te.value),S&&Bt.push(G[ot+Mt])):(It.push(G[ot+Mt]),Rt.push(te.value)))}return Promise.resolve(0<Rt.length&&d.mutate({trans:a,type:"add",values:Rt}).then(function(Jt){for(var re in Jt.failures)It.splice(parseInt(re),1);Y(Rt.length,Jt)})).then(function(){return(0<Ct.length||et&&typeof n=="object")&&d.mutate({trans:a,type:"put",keys:Bt,values:Ct,criteria:et,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<ot}).then(function(Jt){return Y(Ct.length,Jt)})}).then(function(){return(0<It.length||et&&H)&&d.mutate({trans:a,type:"delete",keys:It,criteria:et,isAdditionalChunk:0<ot}).then(function(Jt){return wn(s.table,It,Jt)}).then(function(Jt){return Y(It.length,Jt)})}).then(function(){return G.length>ot+ft&&V(ot+U)})})}var et=Jn(s)&&s.limit===1/0&&(typeof n!="function"||H)&&{index:s.index,range:s.range};return V(0).then(function(){if(0<Z.length)throw new ht("Error modifying one or more objects",Z,$,W);return G.length})})})},ae.prototype.delete=function(){var n=this._ctx,r=n.range;return!Jn(n)||n.table.schema.yProps||!n.isPrimKey&&r.type!==3?this.modify(Ai):this._write(function(s){var a=n.table.core.schema.primaryKey,l=r;return n.table.core.count({trans:s,query:{index:a,range:l}}).then(function(d){return n.table.core.mutate({trans:s,type:"deleteRange",range:l}).then(function(U){var M=U.failures,U=U.numFailures;if(U)throw new ht("Could not delete some values",Object.keys(M).map(function(K){return M[K]}),d-U);return d-U})})})},ae);function ae(){}var Ai=function(n,r){return r.value=null};function tr(n,r){return n<r?-1:n===r?0:1}function zi(n,r){return r<n?-1:n===r?0:1}function Re(n,r,s){return n=n instanceof wr?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(r),n}function In(n){return new n.Collection(n,function(){return Bi("")}).limit(0)}function jn(n,r,s,a){var l,d,S,M,U,K,Y,Z=s.length;if(!s.every(function(H){return typeof H=="string"}))return Re(n,br);function $(H){l=H==="next"?function(V){return V.toUpperCase()}:function(V){return V.toLowerCase()},d=H==="next"?function(V){return V.toLowerCase()}:function(V){return V.toUpperCase()},S=H==="next"?tr:zi;var G=s.map(function(V){return{lower:d(V),upper:l(V)}}).sort(function(V,et){return S(V.lower,et.lower)});M=G.map(function(V){return V.upper}),U=G.map(function(V){return V.lower}),Y=(K=H)==="next"?"":a}$("next"),n=new n.Collection(n,function(){return kn(M[0],U[Z-1]+a)}),n._ondirectionchange=function(H){$(H)};var W=0;return n._addAlgorithm(function(H,G,V){var et=H.key;if(typeof et!="string")return!1;var ot=d(et);if(r(ot,U,W))return!0;for(var ft=null,bt=W;bt<Z;++bt){var At=function(Rt,Ct,Bt,It,Mt,Wt){for(var te=Math.min(Rt.length,It.length),Jt=-1,re=0;re<te;++re){var Fe=Ct[re];if(Fe!==It[re])return Mt(Rt[re],Bt[re])<0?Rt.substr(0,re)+Bt[re]+Bt.substr(re+1):Mt(Rt[re],It[re])<0?Rt.substr(0,re)+It[re]+Bt.substr(re+1):0<=Jt?Rt.substr(0,Jt)+Ct[Jt]+Bt.substr(Jt+1):null;Mt(Rt[re],Fe)<0&&(Jt=re)}return te<It.length&&Wt==="next"?Rt+Bt.substr(Rt.length):te<Rt.length&&Wt==="prev"?Rt.substr(0,Bt.length):Jt<0?null:Rt.substr(0,Jt)+It[Jt]+Bt.substr(Jt+1)}(et,ot,M[bt],U[bt],S,K);At===null&&ft===null?W=bt+1:(ft===null||0<S(ft,At))&&(ft=At)}return G(ft!==null?function(){H.continue(ft+Y)}:V),!1}),n}function kn(n,r,s,a){return{type:2,lower:n,upper:r,lowerOpen:s,upperOpen:a}}function Bi(n){return{type:1,lower:n,upper:n}}var wr=(Object.defineProperty(Yt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Yt.prototype.between=function(n,r,s,a){s=s!==!1,a=a===!0;try{return 0<this._cmp(n,r)||this._cmp(n,r)===0&&(s||a)&&(!s||!a)?In(this):new this.Collection(this,function(){return kn(n,r,!s,!a)})}catch{return Re(this,bn)}},Yt.prototype.equals=function(n){return n==null?Re(this,bn):new this.Collection(this,function(){return Bi(n)})},Yt.prototype.above=function(n){return n==null?Re(this,bn):new this.Collection(this,function(){return kn(n,void 0,!0)})},Yt.prototype.aboveOrEqual=function(n){return n==null?Re(this,bn):new this.Collection(this,function(){return kn(n,void 0,!1)})},Yt.prototype.below=function(n){return n==null?Re(this,bn):new this.Collection(this,function(){return kn(void 0,n,!1,!0)})},Yt.prototype.belowOrEqual=function(n){return n==null?Re(this,bn):new this.Collection(this,function(){return kn(void 0,n)})},Yt.prototype.startsWith=function(n){return typeof n!="string"?Re(this,br):this.between(n,n+an,!0,!0)},Yt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):jn(this,function(r,s){return r.indexOf(s[0])===0},[n],an)},Yt.prototype.equalsIgnoreCase=function(n){return jn(this,function(r,s){return r===s[0]},[n],"")},Yt.prototype.anyOfIgnoreCase=function(){var n=gt.apply(kt,arguments);return n.length===0?In(this):jn(this,function(r,s){return s.indexOf(r)!==-1},n,"")},Yt.prototype.startsWithAnyOfIgnoreCase=function(){var n=gt.apply(kt,arguments);return n.length===0?In(this):jn(this,function(r,s){return s.some(function(a){return r.indexOf(a)===0})},n,an)},Yt.prototype.anyOf=function(){var n=this,r=gt.apply(kt,arguments),s=this._cmp;try{r.sort(s)}catch{return Re(this,bn)}if(r.length===0)return In(this);var a=new this.Collection(this,function(){return kn(r[0],r[r.length-1])});a._ondirectionchange=function(d){s=d==="next"?n._ascending:n._descending,r.sort(s)};var l=0;return a._addAlgorithm(function(d,S,M){for(var U=d.key;0<s(U,r[l]);)if(++l===r.length)return S(M),!1;return s(U,r[l])===0||(S(function(){d.continue(r[l])}),!1)}),a},Yt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Yt.prototype.noneOf=function(){var n=gt.apply(kt,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Re(this,bn)}var r=n.reduce(function(s,a){return s?s.concat([[s[s.length-1][1],a]]):[[-1/0,a]]},null);return r.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},Yt.prototype.inAnyRange=function(et,r){var s=this,a=this._cmp,l=this._ascending,d=this._descending,S=this._min,M=this._max;if(et.length===0)return In(this);if(!et.every(function(ot){return ot[0]!==void 0&&ot[1]!==void 0&&l(ot[0],ot[1])<=0}))return Re(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",St.InvalidArgument);var U=!r||r.includeLowers!==!1,K=r&&r.includeUppers===!0,Y,Z=l;function $(ot,ft){return Z(ot[0],ft[0])}try{(Y=et.reduce(function(ot,ft){for(var bt=0,At=ot.length;bt<At;++bt){var Rt=ot[bt];if(a(ft[0],Rt[1])<0&&0<a(ft[1],Rt[0])){Rt[0]=S(Rt[0],ft[0]),Rt[1]=M(Rt[1],ft[1]);break}}return bt===At&&ot.push(ft),ot},[])).sort($)}catch{return Re(this,bn)}var W=0,H=K?function(ot){return 0<l(ot,Y[W][1])}:function(ot){return 0<=l(ot,Y[W][1])},G=U?function(ot){return 0<d(ot,Y[W][0])}:function(ot){return 0<=d(ot,Y[W][0])},V=H,et=new this.Collection(this,function(){return kn(Y[0][0],Y[Y.length-1][1],!U,!K)});return et._ondirectionchange=function(ot){Z=ot==="next"?(V=H,l):(V=G,d),Y.sort($)},et._addAlgorithm(function(ot,ft,bt){for(var At,Rt=ot.key;V(Rt);)if(++W===Y.length)return ft(bt),!1;return!H(At=Rt)&&!G(At)||(s._cmp(Rt,Y[W][1])===0||s._cmp(Rt,Y[W][0])===0||ft(function(){Z===l?ot.continue(Y[W][0]):ot.continue(Y[W][1])}),!1)}),et},Yt.prototype.startsWithAnyOf=function(){var n=gt.apply(kt,arguments);return n.every(function(r){return typeof r=="string"})?n.length===0?In(this):this.inAnyRange(n.map(function(r){return[r,r+an]})):Re(this,"startsWithAnyOf() only works with strings")},Yt);function Yt(){}function xe(n){return ge(function(r){return fe(r),n(r.target.error),!1})}function fe(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var ti="storagemutated",di="x-storagemutated-1",cn=An(null,ti),er=(Be.prototype._lock=function(){return J(!Kt.global),++this._reculock,this._reculock!==1||Kt.global||(Kt.lockOwnerFor=this),this},Be.prototype._unlock=function(){if(J(!Kt.global),--this._reculock==0)for(Kt.global||(Kt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Fn(n[1],n[0])}catch{}}return this},Be.prototype._locked=function(){return this._reculock&&Kt.lockOwnerFor!==this},Be.prototype.create=function(n){var r=this;if(!this.mode)return this;var s=this.db.idbdb,a=this.db._state.dbOpenError;if(J(!this.idbtrans),!n&&!s)switch(a&&a.name){case"DatabaseClosedError":throw new St.DatabaseClosed(a);case"MissingAPIError":throw new St.MissingAPI(a.message,a);default:throw new St.OpenFailed(a)}if(!this.active)throw new St.TransactionInactive;return J(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ge(function(l){fe(l),r._reject(n.error)}),n.onabort=ge(function(l){fe(l),r.active&&r._reject(new St.Abort(n.error)),r.active=!1,r.on("abort").fire(l)}),n.oncomplete=ge(function(){r.active=!1,r._resolve(),"mutatedParts"in n&&cn.storagemutated.fire(n.mutatedParts)}),this},Be.prototype._promise=function(n,r,s){var a=this;if(n==="readwrite"&&this.mode!=="readwrite")return we(new St.ReadOnly("Transaction is readonly"));if(!this.active)return we(new St.TransactionInactive);if(this._locked())return new jt(function(d,S){a._blockedFuncs.push([function(){a._promise(n,r,s).then(d,S)},Kt])});if(s)return gn(function(){var d=new jt(function(S,M){a._lock();var U=r(S,M,a);U&&U.then&&U.then(S,M)});return d.finally(function(){return a._unlock()}),d._lib=!0,d});var l=new jt(function(d,S){var M=r(d,S,a);M&&M.then&&M.then(d,S)});return l._lib=!0,l},Be.prototype._root=function(){return this.parent?this.parent._root():this},Be.prototype.waitFor=function(n){var r,s=this._root(),a=jt.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return a}):(s._waitingFor=a,s._waitingQueue=[],r=s.idbtrans.objectStore(s.storeNames[0]),function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(r.get(-1/0).onsuccess=d)}());var l=s._waitingFor;return new jt(function(d,S){a.then(function(M){return s._waitingQueue.push(ge(d.bind(null,M)))},function(M){return s._waitingQueue.push(ge(S.bind(null,M)))}).finally(function(){s._waitingFor===l&&(s._waitingFor=null)})})},Be.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new St.Abort))},Be.prototype.table=function(n){var r=this._memoizedTables||(this._memoizedTables={});if(P(r,n))return r[n];var s=this.schema[n];if(!s)throw new St.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),r[n]=s},Be);function Be(){}function pi(n,r,s,a,l,d,S,M){return{name:n,keyPath:r,unique:s,multi:a,auto:l,compound:d,src:(s&&!S?"&":"")+(a?"*":"")+(l?"++":"")+ei(r),type:M}}function ei(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function ke(n,r,s){return{name:n,primKey:r,indexes:s,mappedClass:null,idxByName:(a=function(l){return[l.name,l]},s.reduce(function(l,d,S){return S=a(d,S),S&&(l[S[0]]=S[1]),l},{}))};var a}var Qe=function(n){try{return n.only([[]]),Qe=function(){return[[]]},[[]]}catch{return Qe=function(){return an},an}};function Ii(n){return n==null?function(){}:typeof n=="string"?(r=n).split(".").length===1?function(s){return s[r]}:function(s){return lt(s,r)}:function(s){return lt(s,n)};var r}function nr(n){return[].slice.call(n)}var Wr=0;function ni(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function ir(n,r,U){function a(V){if(V.type===3)return null;if(V.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var W=V.lower,H=V.upper,G=V.lowerOpen,V=V.upperOpen;return W===void 0?H===void 0?null:r.upperBound(H,!!V):H===void 0?r.lowerBound(W,!!G):r.bound(W,H,!!G,!!V)}function l($){var W,H=$.name;return{name:H,schema:$,mutate:function(G){var V=G.trans,et=G.type,ot=G.keys,ft=G.values,bt=G.range;return new Promise(function(At,Rt){At=ge(At);var Ct=V.objectStore(H),Bt=Ct.keyPath==null,It=et==="put"||et==="add";if(!It&&et!=="delete"&&et!=="deleteRange")throw new Error("Invalid operation type: "+et);var Mt,Wt=(ot||ft||{length:1}).length;if(ot&&ft&&ot.length!==ft.length)throw new Error("Given keys array must have same length as given values array.");if(Wt===0)return At({numFailures:0,failures:{},results:[],lastResult:void 0});function te(Ne){++Fe,fe(Ne)}var Jt=[],re=[],Fe=0;if(et==="deleteRange"){if(bt.type===4)return At({numFailures:Fe,failures:re,results:[],lastResult:void 0});bt.type===3?Jt.push(Mt=Ct.clear()):Jt.push(Mt=Ct.delete(a(bt)))}else{var Bt=It?Bt?[ft,ot]:[ft,null]:[ot,null],$t=Bt[0],Me=Bt[1];if(It)for(var Pe=0;Pe<Wt;++Pe)Jt.push(Mt=Me&&Me[Pe]!==void 0?Ct[et]($t[Pe],Me[Pe]):Ct[et]($t[Pe])),Mt.onerror=te;else for(Pe=0;Pe<Wt;++Pe)Jt.push(Mt=Ct[et]($t[Pe])),Mt.onerror=te}function Dn(Ne){Ne=Ne.target.result,Jt.forEach(function(Rn,fr){return Rn.error!=null&&(re[fr]=Rn.error)}),At({numFailures:Fe,failures:re,results:et==="delete"?ot:Jt.map(function(Rn){return Rn.result}),lastResult:Ne})}Mt.onerror=function(Ne){te(Ne),Dn(Ne)},Mt.onsuccess=Dn})},getMany:function(G){var V=G.trans,et=G.keys;return new Promise(function(ot,ft){ot=ge(ot);for(var bt,At=V.objectStore(H),Rt=et.length,Ct=new Array(Rt),Bt=0,It=0,Mt=function(Jt){Jt=Jt.target,Ct[Jt._pos]=Jt.result,++It===Bt&&ot(Ct)},Wt=xe(ft),te=0;te<Rt;++te)et[te]!=null&&((bt=At.get(et[te]))._pos=te,bt.onsuccess=Mt,bt.onerror=Wt,++Bt);Bt===0&&ot(Ct)})},get:function(G){var V=G.trans,et=G.key;return new Promise(function(ot,ft){ot=ge(ot);var bt=V.objectStore(H).get(et);bt.onsuccess=function(At){return ot(At.target.result)},bt.onerror=xe(ft)})},query:(W=K,function(G){return new Promise(function(V,et){V=ge(V);var ot,ft,bt,Bt=G.trans,At=G.values,Rt=G.limit,Mt=G.query,Ct=Rt===1/0?void 0:Rt,It=Mt.index,Mt=Mt.range,Bt=Bt.objectStore(H),It=It.isPrimaryKey?Bt:Bt.index(It.name),Mt=a(Mt);if(Rt===0)return V({result:[]});W?((Ct=At?It.getAll(Mt,Ct):It.getAllKeys(Mt,Ct)).onsuccess=function(Wt){return V({result:Wt.target.result})},Ct.onerror=xe(et)):(ot=0,ft=!At&&"openKeyCursor"in It?It.openKeyCursor(Mt):It.openCursor(Mt),bt=[],ft.onsuccess=function(Wt){var te=ft.result;return te?(bt.push(At?te.value:te.primaryKey),++ot===Rt?V({result:bt}):void te.continue()):V({result:bt})},ft.onerror=xe(et))})}),openCursor:function(G){var V=G.trans,et=G.values,ot=G.query,ft=G.reverse,bt=G.unique;return new Promise(function(At,Rt){At=ge(At);var It=ot.index,Ct=ot.range,Bt=V.objectStore(H),Bt=It.isPrimaryKey?Bt:Bt.index(It.name),It=ft?bt?"prevunique":"prev":bt?"nextunique":"next",Mt=!et&&"openKeyCursor"in Bt?Bt.openKeyCursor(a(Ct),It):Bt.openCursor(a(Ct),It);Mt.onerror=xe(Rt),Mt.onsuccess=ge(function(Wt){var te,Jt,re,Fe,$t=Mt.result;$t?($t.___id=++Wr,$t.done=!1,te=$t.continue.bind($t),Jt=(Jt=$t.continuePrimaryKey)&&Jt.bind($t),re=$t.advance.bind($t),Fe=function(){throw new Error("Cursor not stopped")},$t.trans=V,$t.stop=$t.continue=$t.continuePrimaryKey=$t.advance=function(){throw new Error("Cursor not started")},$t.fail=ge(Rt),$t.next=function(){var Me=this,Pe=1;return this.start(function(){return Pe--?Me.continue():Me.stop()}).then(function(){return Me})},$t.start=function(Me){function Pe(){if(Mt.result)try{Me()}catch(Ne){$t.fail(Ne)}else $t.done=!0,$t.start=function(){throw new Error("Cursor behind last entry")},$t.stop()}var Dn=new Promise(function(Ne,Rn){Ne=ge(Ne),Mt.onerror=xe(Rn),$t.fail=Rn,$t.stop=function(fr){$t.stop=$t.continue=$t.continuePrimaryKey=$t.advance=Fe,Ne(fr)}});return Mt.onsuccess=ge(function(Ne){Mt.onsuccess=Pe,Pe()}),$t.continue=te,$t.continuePrimaryKey=Jt,$t.advance=re,Pe(),Dn},At($t)):At(null)},Rt)})},count:function(G){var V=G.query,et=G.trans,ot=V.index,ft=V.range;return new Promise(function(bt,At){var Rt=et.objectStore(H),Ct=ot.isPrimaryKey?Rt:Rt.index(ot.name),Rt=a(ft),Ct=Rt?Ct.count(Rt):Ct.count();Ct.onsuccess=ge(function(Bt){return bt(Bt.target.result)}),Ct.onerror=xe(At)})}}}var d,S,M,Y=(S=U,M=nr((d=n).objectStoreNames),{schema:{name:d.name,tables:M.map(function($){return S.objectStore($)}).map(function($){var W=$.keyPath,V=$.autoIncrement,H=m(W),G={},V={name:$.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:W==null,compound:H,keyPath:W,autoIncrement:V,unique:!0,extractKey:Ii(W)},indexes:nr($.indexNames).map(function(et){return $.index(et)}).map(function(bt){var ot=bt.name,ft=bt.unique,At=bt.multiEntry,bt=bt.keyPath,At={name:ot,compound:m(bt),keyPath:bt,unique:ft,multiEntry:At,extractKey:Ii(bt)};return G[ni(bt)]=At}),getIndexByKeyPath:function(et){return G[ni(et)]}};return G[":id"]=V.primaryKey,W!=null&&(G[ni(W)]=V.primaryKey),V})},hasGetAll:0<M.length&&"getAll"in S.objectStore(M[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),U=Y.schema,K=Y.hasGetAll,Y=U.tables.map(l),Z={};return Y.forEach(function($){return Z[$.name]=$}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function($){if(!Z[$])throw new Error("Table '".concat($,"' not found"));return Z[$]},MIN_KEY:-1/0,MAX_KEY:Qe(r),schema:U}}function qr(n,r,s,a){var l=s.IDBKeyRange;return s.indexedDB,{dbcore:(a=ir(r,l,a),n.dbcore.reduce(function(d,S){return S=S.create,x(x({},d),S(d))},a))}}function mi(n,a){var s=a.db,a=qr(n._middlewares,s,n._deps,a);n.core=a.dbcore,n.tables.forEach(function(l){var d=l.name;n.core.schema.tables.some(function(S){return S.name===d})&&(l.core=n.core.table(d),n[d]instanceof n.Table&&(n[d].core=l.core))})}function se(n,r,s,a){s.forEach(function(l){var d=a[l];r.forEach(function(S){var M=function U(K,Y){return O(K,Y)||(K=D(K))&&U(K,Y)}(S,l);(!M||"value"in M&&M.value===void 0)&&(S===n.Transaction.prototype||S instanceof n.Transaction?C(S,l,{get:function(){return this.table(l)},set:function(U){k(this,l,{value:U,writable:!0,configurable:!0,enumerable:!0})}}):S[l]=new n.Table(l,d))})})}function rr(n,r){r.forEach(function(s){for(var a in s)s[a]instanceof n.Table&&delete s[a]})}function tn(n,r){return n._cfg.version-r._cfg.version}function _i(n,r,s,a){var l=n._dbSchema;s.objectStoreNames.contains("$meta")&&!l.$meta&&(l.$meta=ke("$meta",Di("")[0],[]),n._storeNames.push("$meta"));var d=n._createTransaction("readwrite",n._storeNames,l);d.create(s),d._completion.catch(a);var S=d._reject.bind(d),M=Kt.transless||Kt;gn(function(){return Kt.trans=d,Kt.transless=M,r!==0?(mi(n,s),K=r,((U=d).storeNames.includes("$meta")?U.table("$meta").get("version").then(function(Y){return Y??K}):jt.resolve(K)).then(function(Y){return $=Y,W=d,H=s,G=[],Y=(Z=n)._versions,V=Z._dbSchema=Mi(0,Z.idbdb,H),(Y=Y.filter(function(et){return et._cfg.version>=$})).length!==0?(Y.forEach(function(et){G.push(function(){var ot=V,ft=et._cfg.dbschema;Ni(Z,ot,H),Ni(Z,ft,H),V=Z._dbSchema=ft;var bt=or(ot,ft);bt.add.forEach(function(It){gi(H,It[0],It[1].primKey,It[1].indexes)}),bt.change.forEach(function(It){if(It.recreate)throw new St.Upgrade("Not yet support for changing primary key");var Mt=H.objectStore(It.name);It.add.forEach(function(Wt){return vi(Mt,Wt)}),It.change.forEach(function(Wt){Mt.deleteIndex(Wt.name),vi(Mt,Wt)}),It.del.forEach(function(Wt){return Mt.deleteIndex(Wt)})});var At=et._cfg.contentUpgrade;if(At&&et._cfg.version>$){mi(Z,H),W._memoizedTables={};var Rt=wt(ft);bt.del.forEach(function(It){Rt[It]=ot[It]}),rr(Z,[Z.Transaction.prototype]),se(Z,[Z.Transaction.prototype],f(Rt),Rt),W.schema=Rt;var Ct,Bt=Q(At);return Bt&&Cn(),bt=jt.follow(function(){var It;(Ct=At(W))&&Bt&&(It=vn.bind(null,null),Ct.then(It,It))}),Ct&&typeof Ct.then=="function"?jt.resolve(Ct):bt.then(function(){return Ct})}}),G.push(function(ot){var ft,bt,At=et._cfg.dbschema;ft=At,bt=ot,[].slice.call(bt.db.objectStoreNames).forEach(function(Rt){return ft[Rt]==null&&bt.db.deleteObjectStore(Rt)}),rr(Z,[Z.Transaction.prototype]),se(Z,[Z.Transaction.prototype],Z._storeNames,Z._dbSchema),W.schema=Z._dbSchema}),G.push(function(ot){Z.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Z.idbdb.version/10)===et._cfg.version?(Z.idbdb.deleteObjectStore("$meta"),delete Z._dbSchema.$meta,Z._storeNames=Z._storeNames.filter(function(ft){return ft!=="$meta"})):ot.objectStore("$meta").put(et._cfg.version,"version"))})}),function et(){return G.length?jt.resolve(G.shift()(W.idbtrans)).then(et):jt.resolve()}().then(function(){kr(V,H)})):jt.resolve();var Z,$,W,H,G,V}).catch(S)):(f(l).forEach(function(Y){gi(s,Y,l[Y].primKey,l[Y].indexes)}),mi(n,s),void jt.follow(function(){return n.on.populate.fire(d)}).catch(S));var U,K})}function xr(n,r){kr(n._dbSchema,r),r.db.version%10!=0||r.objectStoreNames.contains("$meta")||r.db.createObjectStore("$meta").add(Math.ceil(r.db.version/10-1),"version");var s=Mi(0,n.idbdb,r);Ni(n,n._dbSchema,r);for(var a=0,l=or(s,n._dbSchema).change;a<l.length;a++){var d=function(S){if(S.change.length||S.recreate)return console.warn("Unable to patch indexes of table ".concat(S.name," because it has changes on the type of index or primary key.")),{value:void 0};var M=r.objectStore(S.name);S.add.forEach(function(U){_t&&console.debug("Dexie upgrade patch: Creating missing index ".concat(S.name,".").concat(U.src)),vi(M,U)})}(l[a]);if(typeof d=="object")return d.value}}function or(n,r){var s,a={del:[],add:[],change:[]};for(s in n)r[s]||a.del.push(s);for(s in r){var l=n[s],d=r[s];if(l){var S={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(l.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||l.primKey.auto!==d.primKey.auto)S.recreate=!0,a.change.push(S);else{var M=l.idxByName,U=d.idxByName,K=void 0;for(K in M)U[K]||S.del.push(K);for(K in U){var Y=M[K],Z=U[K];Y?Y.src!==Z.src&&S.change.push(Z):S.add.push(Z)}(0<S.del.length||0<S.add.length||0<S.change.length)&&a.change.push(S)}}else a.add.push([s,d])}return a}function gi(n,r,s,a){var l=n.db.createObjectStore(r,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return a.forEach(function(d){return vi(l,d)}),l}function kr(n,r){f(n).forEach(function(s){r.db.objectStoreNames.contains(s)||(_t&&console.debug("Dexie: Creating missing table",s),gi(r,s,n[s].primKey,n[s].indexes))})}function vi(n,r){n.createIndex(r.name,r.keyPath,{unique:r.unique,multiEntry:r.multi})}function Mi(n,r,s){var a={};return I(r.objectStoreNames,0).forEach(function(l){for(var d=s.objectStore(l),S=pi(ei(K=d.keyPath),K||"",!0,!1,!!d.autoIncrement,K&&typeof K!="string",!0),M=[],U=0;U<d.indexNames.length;++U){var Y=d.index(d.indexNames[U]),K=Y.keyPath,Y=pi(Y.name,K,!!Y.unique,!!Y.multiEntry,!1,K&&typeof K!="string",!1);M.push(Y)}a[l]=ke(l,S,M)}),a}function Ni(n,r,s){for(var a=s.db.objectStoreNames,l=0;l<a.length;++l){var d=a[l],S=s.objectStore(d);n._hasGetAll="getAll"in S;for(var M=0;M<S.indexNames.length;++M){var U=S.indexNames[M],K=S.index(U).keyPath,Y=typeof K=="string"?K:"["+I(K).join("+")+"]";!r[d]||(K=r[d].idxByName[Y])&&(K.name=U,delete r[d].idxByName[Y],r[d].idxByName[U]=K)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&p.WorkerGlobalScope&&p instanceof p.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Di(n){return n.split(",").map(function(r,s){var d=r.split(":"),a=(l=d[1])===null||l===void 0?void 0:l.trim(),l=(r=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return pi(l,d||null,/\&/.test(r),/\*/.test(r),/\+\+/.test(r),m(d),s===0,a)})}var Hr=(Ze.prototype._createTableSchema=ke,Ze.prototype._parseIndexSyntax=Di,Ze.prototype._parseStoresSpec=function(n,r){var s=this;f(n).forEach(function(a){if(n[a]!==null){var l=s._parseIndexSyntax(n[a]),d=l.shift();if(!d)throw new St.Schema("Invalid schema for table "+a+": "+n[a]);if(d.unique=!0,d.multi)throw new St.Schema("Primary key cannot be multiEntry*");l.forEach(function(S){if(S.auto)throw new St.Schema("Only primary key can be marked as autoIncrement (++)");if(!S.keyPath)throw new St.Schema("Index must have a name and cannot be an empty string")}),l=s._createTableSchema(a,d,l),r[a]=l}})},Ze.prototype.stores=function(s){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?w(this._cfg.storesSource,s):s;var s=r._versions,a={},l={};return s.forEach(function(d){w(a,d._cfg.storesSource),l=d._cfg.dbschema={},d._parseStoresSpec(a,l)}),r._dbSchema=l,rr(r,[r._allTables,r,r.Transaction.prototype]),se(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],f(l),l),r._storeNames=f(l),this},Ze.prototype.upgrade=function(n){return this._cfg.contentUpgrade=yt(this._cfg.contentUpgrade||Xt,n),this},Ze);function Ze(){}function sr(n,r){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new Pn(Ci,{addons:[],indexedDB:n,IDBKeyRange:r})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Ri(n){return n&&typeof n.databases=="function"}function ln(n){return gn(function(){return Kt.letThrough=!0,n()})}function Zi(n){return!("from"in n)}var Ce=function(n,r){if(!this){var s=new Ce;return n&&"d"in n&&w(s,n),s}w(this,arguments.length?{d:1,from:n,to:1<arguments.length?r:n}:{d:0})};function Un(n,r,s){var a=Ht(r,s);if(!isNaN(a)){if(0<a)throw RangeError();if(Zi(n))return w(n,{from:r,to:s,d:1});var l=n.l,a=n.r;if(Ht(s,n.from)<0)return l?Un(l,r,s):n.l={from:r,to:s,d:1,l:null,r:null},Pr(n);if(0<Ht(r,n.to))return a?Un(a,r,s):n.r={from:r,to:s,d:1,l:null,r:null},Pr(n);Ht(r,n.from)<0&&(n.from=r,n.l=null,n.d=a?a.d+1:1),0<Ht(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,l&&!n.l&&yi(n,l),a&&s&&yi(n,a)}}function yi(n,r){Zi(r)||function s(a,U){var d=U.from,S=U.to,M=U.l,U=U.r;Un(a,d,S),M&&s(a,M),U&&s(a,U)}(n,r)}function ar(n,r){var s=bi(r),a=s.next();if(a.done)return!1;for(var l=a.value,d=bi(n),S=d.next(l.from),M=S.value;!a.done&&!S.done;){if(Ht(M.from,l.to)<=0&&0<=Ht(M.to,l.from))return!0;Ht(l.from,M.from)<0?l=(a=s.next(M.from)).value:M=(S=d.next(l.from)).value}return!1}function bi(n){var r=Zi(n)?null:{s:0,n};return{next:function(s){for(var a=0<arguments.length;r;)switch(r.s){case 0:if(r.s=1,a)for(;r.n.l&&Ht(s,r.n.from)<0;)r={up:r,n:r.n.l,s:1};else for(;r.n.l;)r={up:r,n:r.n.l,s:1};case 1:if(r.s=2,!a||Ht(s,r.n.to)<=0)return{value:r.n,done:!1};case 2:if(r.n.r){r.s=3,r={up:r,n:r.n.r,s:0};continue}case 3:r=r.up}return{done:!0}}}}function Pr(n){var r,s,a=(((r=n.r)===null||r===void 0?void 0:r.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),l=1<a?"r":a<-1?"l":"";l&&(r=l=="r"?"l":"r",s=x({},n),a=n[l],n.from=a.from,n.to=a.to,n[l]=a[l],s[l]=a[r],(n[r]=s).d=Sr(s)),n.d=Sr(n)}function Sr(s){var r=s.r,s=s.l;return(r?s?Math.max(r.d,s.d):r.d:s?s.d:0)+1}function ii(n,r){return f(r).forEach(function(s){n[s]?yi(n[s],r[s]):n[s]=function a(l){var d,S,M={};for(d in l)P(l,d)&&(S=l[d],M[d]=!S||typeof S!="object"||Zt.has(S.constructor)?S:a(S));return M}(r[s])}),n}function ur(n,r){return n.all||r.all||Object.keys(n).some(function(s){return r[s]&&ar(r[s],n[s])})}z(Ce.prototype,((Ve={add:function(n){return yi(this,n),this},addKey:function(n){return Un(this,n,n),this},addKeys:function(n){var r=this;return n.forEach(function(s){return Un(r,s,s)}),this},hasKey:function(n){var r=bi(this).next(n).value;return r&&Ht(r.from,n)<=0&&0<=Ht(r.to,n)}})[Nt]=function(){return bi(this)},Ve));var Mn={},Fi={},ri=!1;function hn(n){ii(Fi,n),ri||(ri=!0,setTimeout(function(){ri=!1,cr(Fi,!(Fi={}))},0))}function cr(n,r){r===void 0&&(r=!1);var s=new Set;if(n.all)for(var a=0,l=Object.values(Mn);a<l.length;a++)oi(S=l[a],n,s,r);else for(var d in n){var S,M=/^idb\:\/\/(.*)\/(.*)\//.exec(d);M&&(d=M[1],M=M[2],(S=Mn["idb://".concat(d,"/").concat(M)])&&oi(S,n,s,r))}s.forEach(function(U){return U()})}function oi(n,r,s,a){for(var l=[],d=0,S=Object.entries(n.queries.query);d<S.length;d++){for(var M=S[d],U=M[0],K=[],Y=0,Z=M[1];Y<Z.length;Y++){var $=Z[Y];ur(r,$.obsSet)?$.subscribers.forEach(function(V){return s.add(V)}):a&&K.push($)}a&&l.push([U,K])}if(a)for(var W=0,H=l;W<H.length;W++){var G=H[W],U=G[0],K=G[1];n.queries.query[U]=K}}function He(n){var r=n._state,s=n._deps.indexedDB;if(r.isBeingOpened||n.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?we(r.dbOpenError):n});r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var a=r.openCanceller,l=Math.round(10*n.verno),d=!1;function S(){if(r.openCanceller!==a)throw new St.DatabaseClosed("db.open() was cancelled")}function M(){return new jt(function($,W){if(S(),!s)throw new St.MissingAPI;var H=n.name,G=r.autoSchema||!l?s.open(H):s.open(H,l);if(!G)throw new St.MissingAPI;G.onerror=xe(W),G.onblocked=ge(n._fireOnBlocked),G.onupgradeneeded=ge(function(V){var et;Y=G.transaction,r.autoSchema&&!n._options.allowEmptyDB?(G.onerror=fe,Y.abort(),G.result.close(),(et=s.deleteDatabase(H)).onsuccess=et.onerror=ge(function(){W(new St.NoSuchDatabase("Database ".concat(H," doesnt exist")))})):(Y.onerror=xe(W),V=V.oldVersion>Math.pow(2,62)?0:V.oldVersion,Z=V<1,n.idbdb=G.result,d&&xr(n,Y),_i(n,V/10,Y,W))},W),G.onsuccess=ge(function(){Y=null;var V,et,ot,ft,bt,At=n.idbdb=G.result,Rt=I(At.objectStoreNames);if(0<Rt.length)try{var Ct=At.transaction((ft=Rt).length===1?ft[0]:ft,"readonly");if(r.autoSchema)et=At,ot=Ct,(V=n).verno=et.version/10,ot=V._dbSchema=Mi(0,et,ot),V._storeNames=I(et.objectStoreNames,0),se(V,[V._allTables],f(ot),ot);else if(Ni(n,n._dbSchema,Ct),((bt=or(Mi(0,(bt=n).idbdb,Ct),bt._dbSchema)).add.length||bt.change.some(function(Bt){return Bt.add.length||Bt.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),At.close(),l=At.version+1,d=!0,$(M());mi(n,Ct)}catch{}Yn.push(n),At.onversionchange=ge(function(Bt){r.vcFired=!0,n.on("versionchange").fire(Bt)}),At.onclose=ge(function(){n.close({disableAutoOpen:!1})}),Z&&(bt=n._deps,Ct=H,At=bt.indexedDB,bt=bt.IDBKeyRange,Ri(At)||Ct===Ci||sr(At,bt).put({name:Ct}).catch(Xt)),$()},W)}).catch(function($){switch($==null?void 0:$.name){case"UnknownError":if(0<r.PR1398_maxLoop)return r.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),M();break;case"VersionError":if(0<l)return l=0,M()}return jt.reject($)})}var U,K=r.dbReadyResolve,Y=null,Z=!1;return jt.race([a,(typeof navigator>"u"?jt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function($){function W(){return indexedDB.databases().finally($)}U=setInterval(W,100),W()}).finally(function(){return clearInterval(U)}):Promise.resolve()).then(M)]).then(function(){return S(),r.onReadyBeingFired=[],jt.resolve(ln(function(){return n.on.ready.fire(n.vip)})).then(function $(){if(0<r.onReadyBeingFired.length){var W=r.onReadyBeingFired.reduce(yt,Xt);return r.onReadyBeingFired=[],jt.resolve(ln(function(){return W(n.vip)})).then($)}})}).finally(function(){r.openCanceller===a&&(r.onReadyBeingFired=null,r.isBeingOpened=!1)}).catch(function($){r.dbOpenError=$;try{Y&&Y.abort()}catch{}return a===r.openCanceller&&n._close(),we($)}).finally(function(){r.openComplete=!0,K()}).then(function(){var $;return Z&&($={},n.tables.forEach(function(W){W.schema.indexes.forEach(function(H){H.name&&($["idb://".concat(n.name,"/").concat(W.name,"/").concat(H.name)]=new Ce(-1/0,[[[]]]))}),$["idb://".concat(n.name,"/").concat(W.name,"/")]=$["idb://".concat(n.name,"/").concat(W.name,"/:dels")]=new Ce(-1/0,[[[]]])}),cn(ti).fire($),cr($,!0)),n})}function ji(n){function r(d){return n.next(d)}var s=l(r),a=l(function(d){return n.throw(d)});function l(d){return function(U){var M=d(U),U=M.value;return M.done?U:U&&typeof U.then=="function"?U.then(s,a):m(U)?Promise.all(U).then(s,a):s(U)}}return l(r)()}function wi(n,r,s){for(var a=m(n)?n.slice():[n],l=0;l<s;++l)a.push(r);return a}var Gr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return x(x({},n),{table:function(r){var s=n.table(r),a=s.schema,l={},d=[];function S(Z,$,W){var H=ni(Z),G=l[H]=l[H]||[],V=Z==null?0:typeof Z=="string"?1:Z.length,et=0<$,et=x(x({},W),{name:et?"".concat(H,"(virtual-from:").concat(W.name,")"):W.name,lowLevelIndex:W,isVirtual:et,keyTail:$,keyLength:V,extractKey:Ii(Z),unique:!et&&W.unique});return G.push(et),et.isPrimaryKey||d.push(et),1<V&&S(V===2?Z[0]:Z.slice(0,V-1),$+1,W),G.sort(function(ot,ft){return ot.keyTail-ft.keyTail}),et}r=S(a.primaryKey.keyPath,0,a.primaryKey),l[":id"]=[r];for(var M=0,U=a.indexes;M<U.length;M++){var K=U[M];S(K.keyPath,0,K)}function Y(Z){var $,W=Z.query.index;return W.isVirtual?x(x({},Z),{query:{index:W.lowLevelIndex,range:($=Z.query.range,W=W.keyTail,{type:$.type===1?2:$.type,lower:wi($.lower,$.lowerOpen?n.MAX_KEY:n.MIN_KEY,W),lowerOpen:!0,upper:wi($.upper,$.upperOpen?n.MIN_KEY:n.MAX_KEY,W),upperOpen:!0})}}):Z}return x(x({},s),{schema:x(x({},a),{primaryKey:r,indexes:d,getIndexByKeyPath:function(Z){return(Z=l[ni(Z)])&&Z[0]}}),count:function(Z){return s.count(Y(Z))},query:function(Z){return s.query(Y(Z))},openCursor:function(Z){var $=Z.query.index,W=$.keyTail,H=$.isVirtual,G=$.keyLength;return H?s.openCursor(Y(Z)).then(function(et){return et&&V(et)}):s.openCursor(Z);function V(et){return Object.create(et,{continue:{value:function(ot){ot!=null?et.continue(wi(ot,Z.reverse?n.MAX_KEY:n.MIN_KEY,W)):Z.unique?et.continue(et.key.slice(0,G).concat(Z.reverse?n.MIN_KEY:n.MAX_KEY,W)):et.continue()}},continuePrimaryKey:{value:function(ot,ft){et.continuePrimaryKey(wi(ot,n.MAX_KEY,W),ft)}},primaryKey:{get:function(){return et.primaryKey}},key:{get:function(){var ot=et.key;return G===1?ot[0]:ot.slice(0,G)}},value:{get:function(){return et.value}}})}}})}})}};function xi(n,r,s,a){return s=s||{},a=a||"",f(n).forEach(function(l){var d,S,M;P(r,l)?(d=n[l],S=r[l],typeof d=="object"&&typeof S=="object"&&d&&S?(M=mt(d))!==mt(S)?s[a+l]=r[l]:M==="Object"?xi(d,S,s,a+l+"."):d!==S&&(s[a+l]=r[l]):d!==S&&(s[a+l]=r[l])):s[a+l]=void 0}),f(r).forEach(function(l){P(n,l)||(s[a+l]=r[l])}),s}function ki(n,r){return r.type==="delete"?r.keys:r.keys||r.values.map(n.extractKey)}var Vr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return x(x({},n),{table:function(r){var s=n.table(r),a=s.schema.primaryKey;return x(x({},s),{mutate:function(l){var d=Kt.trans,S=d.table(r).hook,M=S.deleting,U=S.creating,K=S.updating;switch(l.type){case"add":if(U.fire===Xt)break;return d._promise("readwrite",function(){return Y(l)},!0);case"put":if(U.fire===Xt&&K.fire===Xt)break;return d._promise("readwrite",function(){return Y(l)},!0);case"delete":if(M.fire===Xt)break;return d._promise("readwrite",function(){return Y(l)},!0);case"deleteRange":if(M.fire===Xt)break;return d._promise("readwrite",function(){return function Z($,W,H){return s.query({trans:$,values:!1,query:{index:a,range:W},limit:H}).then(function(G){var V=G.result;return Y({type:"delete",keys:V,trans:$}).then(function(et){return 0<et.numFailures?Promise.reject(et.failures[0]):V.length<H?{failures:[],numFailures:0,lastResult:void 0}:Z($,x(x({},W),{lower:V[V.length-1],lowerOpen:!0}),H)})})}(l.trans,l.range,1e4)},!0)}return s.mutate(l);function Y(Z){var $,W,H,G=Kt.trans,V=Z.keys||ki(a,Z);if(!V)throw new Error("Keys missing");return(Z=Z.type==="add"||Z.type==="put"?x(x({},Z),{keys:V}):x({},Z)).type!=="delete"&&(Z.values=v([],Z.values)),Z.keys&&(Z.keys=v([],Z.keys)),$=s,H=V,((W=Z).type==="add"?Promise.resolve([]):$.getMany({trans:W.trans,keys:H,cache:"immutable"})).then(function(et){var ot=V.map(function(ft,bt){var At,Rt,Ct,Bt=et[bt],It={onerror:null,onsuccess:null};return Z.type==="delete"?M.fire.call(It,ft,Bt,G):Z.type==="add"||Bt===void 0?(At=U.fire.call(It,ft,Z.values[bt],G),ft==null&&At!=null&&(Z.keys[bt]=ft=At,a.outbound||rt(Z.values[bt],a.keyPath,ft))):(At=xi(Bt,Z.values[bt]),(Rt=K.fire.call(It,At,ft,Bt,G))&&(Ct=Z.values[bt],Object.keys(Rt).forEach(function(Mt){P(Ct,Mt)?Ct[Mt]=Rt[Mt]:rt(Ct,Mt,Rt[Mt])}))),It});return s.mutate(Z).then(function(ft){for(var bt=ft.failures,At=ft.results,Rt=ft.numFailures,ft=ft.lastResult,Ct=0;Ct<V.length;++Ct){var Bt=(At||V)[Ct],It=ot[Ct];Bt==null?It.onerror&&It.onerror(bt[Ct]):It.onsuccess&&It.onsuccess(Z.type==="put"&&et[Ct]?Z.values[Ct]:Bt)}return{failures:bt,results:At,numFailures:Rt,lastResult:ft}}).catch(function(ft){return ot.forEach(function(bt){return bt.onerror&&bt.onerror(ft)}),Promise.reject(ft)})})}}})}})}};function Tr(n,r,s){try{if(!r||r.keys.length<n.length)return null;for(var a=[],l=0,d=0;l<r.keys.length&&d<n.length;++l)Ht(r.keys[l],n[d])===0&&(a.push(s?ct(r.values[l]):r.values[l]),++d);return a.length===n.length?a:null}catch{return null}}var Lr={stack:"dbcore",level:-1,create:function(n){return{table:function(r){var s=n.table(r);return x(x({},s),{getMany:function(a){if(!a.cache)return s.getMany(a);var l=Tr(a.keys,a.trans._cache,a.cache==="clone");return l?jt.resolve(l):s.getMany(a).then(function(d){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?ct(d):d},d})},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),s.mutate(a)}})}}}};function Er(n,r){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!r.schema.primaryKey.outbound}function Ge(n,r){switch(n){case"query":return r.values&&!r.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var si={stack:"dbcore",level:0,name:"Observability",create:function(n){var r=n.schema.name,s=new Ce(n.MIN_KEY,n.MAX_KEY);return x(x({},n),{transaction:function(a,l,d){if(Kt.subscr&&l!=="readonly")throw new St.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Kt.querier));return n.transaction(a,l,d)},table:function(a){var l=n.table(a),d=l.schema,S=d.primaryKey,Z=d.indexes,M=S.extractKey,U=S.outbound,K=S.autoIncrement&&Z.filter(function(W){return W.compound&&W.keyPath.includes(S.keyPath)}),Y=x(x({},l),{mutate:function(W){function H(Mt){return Mt="idb://".concat(r,"/").concat(a,"/").concat(Mt),ft[Mt]||(ft[Mt]=new Ce)}var G,V,et,ot=W.trans,ft=W.mutatedParts||(W.mutatedParts={}),bt=H(""),At=H(":dels"),Rt=W.type,It=W.type==="deleteRange"?[W.range]:W.type==="delete"?[W.keys]:W.values.length<50?[ki(S,W).filter(function(Mt){return Mt}),W.values]:[],Ct=It[0],Bt=It[1],It=W.trans._cache;return m(Ct)?(bt.addKeys(Ct),(It=Rt==="delete"||Ct.length===Bt.length?Tr(Ct,It):null)||At.addKeys(Ct),(It||Bt)&&(G=H,V=It,et=Bt,d.indexes.forEach(function(Mt){var Wt=G(Mt.name||"");function te(re){return re!=null?Mt.extractKey(re):null}function Jt(re){return Mt.multiEntry&&m(re)?re.forEach(function(Fe){return Wt.addKey(Fe)}):Wt.addKey(re)}(V||et).forEach(function(re,Me){var $t=V&&te(V[Me]),Me=et&&te(et[Me]);Ht($t,Me)!==0&&($t!=null&&Jt($t),Me!=null&&Jt(Me))})}))):Ct?(Bt={from:(Bt=Ct.lower)!==null&&Bt!==void 0?Bt:n.MIN_KEY,to:(Bt=Ct.upper)!==null&&Bt!==void 0?Bt:n.MAX_KEY},At.add(Bt),bt.add(Bt)):(bt.add(s),At.add(s),d.indexes.forEach(function(Mt){return H(Mt.name).add(s)})),l.mutate(W).then(function(Mt){return!Ct||W.type!=="add"&&W.type!=="put"||(bt.addKeys(Mt.results),K&&K.forEach(function(Wt){for(var te=W.values.map(function($t){return Wt.extractKey($t)}),Jt=Wt.keyPath.findIndex(function($t){return $t===S.keyPath}),re=0,Fe=Mt.results.length;re<Fe;++re)te[re][Jt]=Mt.results[re];H(Wt.name).addKeys(te)})),ot.mutatedParts=ii(ot.mutatedParts||{},ft),Mt})}}),Z=function(H){var G=H.query,H=G.index,G=G.range;return[H,new Ce((H=G.lower)!==null&&H!==void 0?H:n.MIN_KEY,(G=G.upper)!==null&&G!==void 0?G:n.MAX_KEY)]},$={get:function(W){return[S,new Ce(W.key)]},getMany:function(W){return[S,new Ce().addKeys(W.keys)]},count:Z,query:Z,openCursor:Z};return f($).forEach(function(W){Y[W]=function(H){var G=Kt.subscr,V=!!G,et=Er(Kt,l)&&Ge(W,H)?H.obsSet={}:G;if(V){var ot=function(Bt){return Bt="idb://".concat(r,"/").concat(a,"/").concat(Bt),et[Bt]||(et[Bt]=new Ce)},ft=ot(""),bt=ot(":dels"),G=$[W](H),V=G[0],G=G[1];if((W==="query"&&V.isPrimaryKey&&!H.values?bt:ot(V.name||"")).add(G),!V.isPrimaryKey){if(W!=="count"){var At=W==="query"&&U&&H.values&&l.query(x(x({},H),{values:!1}));return l[W].apply(this,arguments).then(function(Bt){if(W==="query"){if(U&&H.values)return At.then(function(te){return te=te.result,ft.addKeys(te),Bt});var It=H.values?Bt.result.map(M):Bt.result;(H.values?ft:bt).addKeys(It)}else if(W==="openCursor"){var Mt=Bt,Wt=H.values;return Mt&&Object.create(Mt,{key:{get:function(){return bt.addKey(Mt.primaryKey),Mt.key}},primaryKey:{get:function(){var te=Mt.primaryKey;return bt.addKey(te),te}},value:{get:function(){return Wt&&ft.addKey(Mt.primaryKey),Mt.value}}})}return Bt})}bt.add(s)}}return l[W].apply(this,arguments)}}),Y}})}};function Cr(n,r,s){if(s.numFailures===0)return r;if(r.type==="deleteRange")return null;var a=r.keys?r.keys.length:"values"in r&&r.values?r.values.length:1;return s.numFailures===a?null:(r=x({},r),m(r.keys)&&(r.keys=r.keys.filter(function(l,d){return!(d in s.failures)})),"values"in r&&m(r.values)&&(r.values=r.values.filter(function(l,d){return!(d in s.failures)})),r)}function en(n,r){return s=n,((a=r).lower===void 0||(a.lowerOpen?0<Ht(s,a.lower):0<=Ht(s,a.lower)))&&(n=n,(r=r).upper===void 0||(r.upperOpen?Ht(n,r.upper)<0:Ht(n,r.upper)<=0));var s,a}function Or(n,r,$,a,l,d){if(!$||$.length===0)return n;var S=r.query.index,M=S.multiEntry,U=r.query.range,K=a.schema.primaryKey.extractKey,Y=S.extractKey,Z=(S.lowLevelIndex||S).extractKey,$=$.reduce(function(W,H){var G=W,V=[];if(H.type==="add"||H.type==="put")for(var et=new Ce,ot=H.values.length-1;0<=ot;--ot){var ft,bt=H.values[ot],At=K(bt);et.hasKey(At)||(ft=Y(bt),(M&&m(ft)?ft.some(function(Mt){return en(Mt,U)}):en(ft,U))&&(et.addKey(At),V.push(bt)))}switch(H.type){case"add":var Rt=new Ce().addKeys(r.values?W.map(function(Wt){return K(Wt)}):W),G=W.concat(r.values?V.filter(function(Wt){return Wt=K(Wt),!Rt.hasKey(Wt)&&(Rt.addKey(Wt),!0)}):V.map(function(Wt){return K(Wt)}).filter(function(Wt){return!Rt.hasKey(Wt)&&(Rt.addKey(Wt),!0)}));break;case"put":var Ct=new Ce().addKeys(H.values.map(function(Wt){return K(Wt)}));G=W.filter(function(Wt){return!Ct.hasKey(r.values?K(Wt):Wt)}).concat(r.values?V:V.map(function(Wt){return K(Wt)}));break;case"delete":var Bt=new Ce().addKeys(H.keys);G=W.filter(function(Wt){return!Bt.hasKey(r.values?K(Wt):Wt)});break;case"deleteRange":var It=H.range;G=W.filter(function(Wt){return!en(K(Wt),It)})}return G},n);return $===n?n:($.sort(function(W,H){return Ht(Z(W),Z(H))||Ht(K(W),K(H))}),r.limit&&r.limit<1/0&&($.length>r.limit?$.length=r.limit:n.length===r.limit&&$.length<r.limit&&(l.dirty=!0)),d?Object.freeze($):$)}function Kn(n,r){return Ht(n.lower,r.lower)===0&&Ht(n.upper,r.upper)===0&&!!n.lowerOpen==!!r.lowerOpen&&!!n.upperOpen==!!r.upperOpen}function Yr(n,r){return function(s,a,l,d){if(s===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((a=Ht(s,a))===0){if(l&&d)return 0;if(l)return 1;if(d)return-1}return a}(n.lower,r.lower,n.lowerOpen,r.lowerOpen)<=0&&0<=function(s,a,l,d){if(s===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((a=Ht(s,a))===0){if(l&&d)return 0;if(l)return-1;if(d)return 1}return a}(n.upper,r.upper,n.upperOpen,r.upperOpen)}function Pi(n,r,s,a){n.subscribers.add(s),a.addEventListener("abort",function(){var l,d;n.subscribers.delete(s),n.subscribers.size===0&&(l=n,d=r,setTimeout(function(){l.subscribers.size===0&&Pt(d,l)},3e3))})}var Ar={stack:"dbcore",level:0,name:"Cache",create:function(n){var r=n.schema.name;return x(x({},n),{transaction:function(s,a,l){var d,S,M=n.transaction(s,a,l);return a==="readwrite"&&(S=(d=new AbortController).signal,l=function(U){return function(){if(d.abort(),a==="readwrite"){for(var K=new Set,Y=0,Z=s;Y<Z.length;Y++){var $=Z[Y],W=Mn["idb://".concat(r,"/").concat($)];if(W){var H=n.table($),G=W.optimisticOps.filter(function(Wt){return Wt.trans===M});if(M._explicit&&U&&M.mutatedParts)for(var V=0,et=Object.values(W.queries.query);V<et.length;V++)for(var ot=0,ft=(Rt=et[V]).slice();ot<ft.length;ot++)ur((Ct=ft[ot]).obsSet,M.mutatedParts)&&(Pt(Rt,Ct),Ct.subscribers.forEach(function(Wt){return K.add(Wt)}));else if(0<G.length){W.optimisticOps=W.optimisticOps.filter(function(Wt){return Wt.trans!==M});for(var bt=0,At=Object.values(W.queries.query);bt<At.length;bt++)for(var Rt,Ct,Bt,It=0,Mt=(Rt=At[bt]).slice();It<Mt.length;It++)(Ct=Mt[It]).res!=null&&M.mutatedParts&&(U&&!Ct.dirty?(Bt=Object.isFrozen(Ct.res),Bt=Or(Ct.res,Ct.req,G,H,Ct,Bt),Ct.dirty?(Pt(Rt,Ct),Ct.subscribers.forEach(function(Wt){return K.add(Wt)})):Bt!==Ct.res&&(Ct.res=Bt,Ct.promise=jt.resolve({result:Bt}))):(Ct.dirty&&Pt(Rt,Ct),Ct.subscribers.forEach(function(Wt){return K.add(Wt)})))}}}K.forEach(function(Wt){return Wt()})}}},M.addEventListener("abort",l(!1),{signal:S}),M.addEventListener("error",l(!1),{signal:S}),M.addEventListener("complete",l(!0),{signal:S})),M},table:function(s){var a=n.table(s),l=a.schema.primaryKey;return x(x({},a),{mutate:function(d){var S=Kt.trans;if(l.outbound||S.db._options.cache==="disabled"||S.explicit||S.idbtrans.mode!=="readwrite")return a.mutate(d);var M=Mn["idb://".concat(r,"/").concat(s)];return M?(S=a.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||ki(l,d).some(function(U){return U==null}))?(M.optimisticOps.push(d),d.mutatedParts&&hn(d.mutatedParts),S.then(function(U){0<U.numFailures&&(Pt(M.optimisticOps,d),(U=Cr(0,d,U))&&M.optimisticOps.push(U),d.mutatedParts&&hn(d.mutatedParts))}),S.catch(function(){Pt(M.optimisticOps,d),d.mutatedParts&&hn(d.mutatedParts)})):S.then(function(U){var K=Cr(0,x(x({},d),{values:d.values.map(function(Y,Z){var $;return U.failures[Z]?Y:(Y=($=l.keyPath)!==null&&$!==void 0&&$.includes(".")?ct(Y):x({},Y),rt(Y,l.keyPath,U.results[Z]),Y)})}),U);M.optimisticOps.push(K),queueMicrotask(function(){return d.mutatedParts&&hn(d.mutatedParts)})}),S):a.mutate(d)},query:function(d){if(!Er(Kt,a)||!Ge("query",d))return a.query(d);var S=((K=Kt.trans)===null||K===void 0?void 0:K.db._options.cache)==="immutable",Z=Kt,M=Z.requery,U=Z.signal,K=function(H,G,V,et){var ot=Mn["idb://".concat(H,"/").concat(G)];if(!ot)return[];if(!(G=ot.queries[V]))return[null,!1,ot,null];var ft=G[(et.query?et.query.index.name:null)||""];if(!ft)return[null,!1,ot,null];switch(V){case"query":var bt=ft.find(function(At){return At.req.limit===et.limit&&At.req.values===et.values&&Kn(At.req.query.range,et.query.range)});return bt?[bt,!0,ot,ft]:[ft.find(function(At){return("limit"in At.req?At.req.limit:1/0)>=et.limit&&(!et.values||At.req.values)&&Yr(At.req.query.range,et.query.range)}),!1,ot,ft];case"count":return bt=ft.find(function(At){return Kn(At.req.query.range,et.query.range)}),[bt,!!bt,ot,ft]}}(r,s,"query",d),Y=K[0],Z=K[1],$=K[2],W=K[3];return Y&&Z?Y.obsSet=d.obsSet:(Z=a.query(d).then(function(H){var G=H.result;if(Y&&(Y.res=G),S){for(var V=0,et=G.length;V<et;++V)Object.freeze(G[V]);Object.freeze(G)}else H.result=ct(G);return H}).catch(function(H){return W&&Y&&Pt(W,Y),Promise.reject(H)}),Y={obsSet:d.obsSet,promise:Z,subscribers:new Set,type:"query",req:d,dirty:!1},W?W.push(Y):(W=[Y],($=$||(Mn["idb://".concat(r,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=W)),Pi(Y,W,M,U),Y.promise.then(function(H){return{result:Or(H.result,d,$==null?void 0:$.optimisticOps,a,Y,S)}})}})}})}};function Wn(n,r){return new Proxy(n,{get:function(s,a,l){return a==="db"?r:Reflect.get(s,a,l)}})}var Pn=(pe.prototype.version=function(n){if(isNaN(n)||n<.1)throw new St.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new St.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var r=this._versions,s=r.filter(function(a){return a._cfg.version===n})[0];return s||(s=new this.Version(n),r.push(s),r.sort(tn),s.stores({}),this._state.autoSchema=!1,s)},pe.prototype._whenReady=function(n){var r=this;return this.idbdb&&(this._state.openComplete||Kt.letThrough||this._vip)?n():new jt(function(s,a){if(r._state.openComplete)return a(new St.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen)return void a(new St.DatabaseClosed);r.open().catch(Xt)}r._state.dbReadyPromise.then(s,a)}).then(n)},pe.prototype.use=function(n){var r=n.stack,s=n.create,a=n.level,l=n.name;return l&&this.unuse({stack:r,name:l}),n=this._middlewares[r]||(this._middlewares[r]=[]),n.push({stack:r,create:s,level:a??10,name:l}),n.sort(function(d,S){return d.level-S.level}),this},pe.prototype.unuse=function(n){var r=n.stack,s=n.name,a=n.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(l){return a?l.create!==a:!!s&&l.name!==s})),this},pe.prototype.open=function(){var n=this;return Fn(Ke,function(){return He(n)})},pe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,r=Yn.indexOf(this);if(0<=r&&Yn.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new jt(function(s){n.dbReadyResolve=s}),n.openCanceller=new jt(function(s,a){n.cancelOpen=a}))},pe.prototype.close=function(s){var r=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;r?(s.isBeingOpened&&s.cancelOpen(new St.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new St.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},pe.prototype.delete=function(n){var r=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",a=this._state;return new jt(function(l,d){function S(){r.close(n);var M=r._deps.indexedDB.deleteDatabase(r.name);M.onsuccess=ge(function(){var U,K,Y;U=r._deps,K=r.name,Y=U.indexedDB,U=U.IDBKeyRange,Ri(Y)||K===Ci||sr(Y,U).delete(K).catch(Xt),l()}),M.onerror=xe(d),M.onblocked=r._fireOnBlocked}if(s)throw new St.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(S):S()})},pe.prototype.backendDB=function(){return this.idbdb},pe.prototype.isOpen=function(){return this.idbdb!==null},pe.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},pe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},pe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(pe.prototype,"tables",{get:function(){var n=this;return f(this._allTables).map(function(r){return n._allTables[r]})},enumerable:!1,configurable:!0}),pe.prototype.transaction=function(){var n=(function(r,s,a){var l=arguments.length;if(l<2)throw new St.InvalidArgument("Too few arguments");for(var d=new Array(l-1);--l;)d[l-1]=arguments[l];return a=d.pop(),[r,xt(d),a]}).apply(this,arguments);return this._transaction.apply(this,n)},pe.prototype._transaction=function(n,r,s){var a=this,l=Kt.trans;l&&l.db===this&&n.indexOf("!")===-1||(l=null);var d,S,M=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(S=r.map(function(K){if(K=K instanceof a.Table?K.name:K,typeof K!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return K}),n=="r"||n===Ji)d=Ji;else{if(n!="rw"&&n!=li)throw new St.InvalidArgument("Invalid transaction mode: "+n);d=li}if(l){if(l.mode===Ji&&d===li){if(!M)throw new St.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");l=null}l&&S.forEach(function(K){if(l&&l.storeNames.indexOf(K)===-1){if(!M)throw new St.SubTransaction("Table "+K+" not included in parent transaction.");l=null}}),M&&l&&!l.active&&(l=null)}}catch(K){return l?l._promise(null,function(Y,Z){Z(K)}):we(K)}var U=(function K(Y,Z,$,W,H){return jt.resolve().then(function(){var G=Kt.transless||Kt,V=Y._createTransaction(Z,$,Y._dbSchema,W);if(V.explicit=!0,G={trans:V,transless:G},W)V.idbtrans=W.idbtrans;else try{V.create(),V.idbtrans._explicit=!0,Y._state.PR1398_maxLoop=3}catch(ft){return ft.name===ne.InvalidState&&Y.isOpen()&&0<--Y._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Y.close({disableAutoOpen:!1}),Y.open().then(function(){return K(Y,Z,$,null,H)})):we(ft)}var et,ot=Q(H);return ot&&Cn(),G=jt.follow(function(){var ft;(et=H.call(V,V))&&(ot?(ft=vn.bind(null,null),et.then(ft,ft)):typeof et.next=="function"&&typeof et.throw=="function"&&(et=ji(et)))},G),(et&&typeof et.then=="function"?jt.resolve(et).then(function(ft){return V.active?ft:we(new St.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):G.then(function(){return et})).then(function(ft){return W&&V._resolve(),V._completion.then(function(){return ft})}).catch(function(ft){return V._reject(ft),we(ft)})})}).bind(null,this,d,S,l,s);return l?l._promise(d,U,"lock"):Kt.trans?Fn(Kt.transless,function(){return a._whenReady(U)}):this._whenReady(U)},pe.prototype.table=function(n){if(!P(this._allTables,n))throw new St.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},pe);function pe(n,r){var s=this;this._middlewares={},this.verno=0;var a=pe.dependencies;this._options=r=x({addons:pe.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange},a=r.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var l,d,S,M,U,K={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Xt,dbReadyPromise:null,cancelOpen:Xt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};K.dbReadyPromise=new jt(function(Z){K.dbReadyResolve=Z}),K.openCanceller=new jt(function(Z,$){K.cancelOpen=$}),this._state=K,this.name=n,this.on=An(this,"populate","blocked","versionchange","close",{ready:[yt,Xt]}),this.once=function(Z,$){var W=function(){for(var H=[],G=0;G<arguments.length;G++)H[G]=arguments[G];s.on(Z).unsubscribe(W),$.apply(s,H)};return s.on(Z,W)},this.on.ready.subscribe=j(this.on.ready.subscribe,function(Z){return function($,W){pe.vip(function(){var H,G=s._state;G.openComplete?(G.dbOpenError||jt.resolve().then($),W&&Z($)):G.onReadyBeingFired?(G.onReadyBeingFired.push($),W&&Z($)):(Z($),H=s,W||Z(function V(){H.on.ready.unsubscribe($),H.on.ready.unsubscribe(V)}))})}}),this.Collection=(l=this,ze(Qi.prototype,function(et,V){this.db=l;var W=$i,H=null;if(V)try{W=V()}catch(ot){H=ot}var G=et._ctx,V=G.table,et=V.hook.reading.fire;this._ctx={table:V,index:G.index,isPrimKey:!G.index||V.schema.primKey.keyPath&&G.index===V.schema.primKey.name,range:W,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:H,or:G.or,valueMapper:et!==he?et:null}})),this.Table=(d=this,ze(be.prototype,function(Z,$,W){this.db=d,this._tx=W,this.name=Z,this.schema=$,this.hook=d._allTables[Z]?d._allTables[Z].hook:An(null,{creating:[st,Xt],reading:[h,he],updating:[E,Xt],deleting:[B,Xt]})})),this.Transaction=(S=this,ze(er.prototype,function(Z,$,W,H,G){var V=this;Z!=="readonly"&&$.forEach(function(et){et=(et=W[et])===null||et===void 0?void 0:et.yProps,et&&($=$.concat(et.map(function(ot){return ot.updatesTable})))}),this.db=S,this.mode=Z,this.storeNames=$,this.schema=W,this.chromeTransactionDurability=H,this.idbtrans=null,this.on=An(this,"complete","error","abort"),this.parent=G||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new jt(function(et,ot){V._resolve=et,V._reject=ot}),this._completion.then(function(){V.active=!1,V.on.complete.fire()},function(et){var ot=V.active;return V.active=!1,V.on.error.fire(et),V.parent?V.parent._reject(et):ot&&V.idbtrans&&V.idbtrans.abort(),we(et)})})),this.Version=(M=this,ze(Hr.prototype,function(Z){this.db=M,this._cfg={version:Z,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(U=this,ze(wr.prototype,function(Z,$,W){if(this.db=U,this._ctx={table:Z,index:$===":id"?null:$,or:W},this._cmp=this._ascending=Ht,this._descending=function(H,G){return Ht(G,H)},this._max=function(H,G){return 0<Ht(H,G)?H:G},this._min=function(H,G){return Ht(H,G)<0?H:G},this._IDBKeyRange=U._deps.IDBKeyRange,!this._IDBKeyRange)throw new St.MissingAPI})),this.on("versionchange",function(Z){0<Z.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(Z){!Z.newVersion||Z.newVersion<Z.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(Z.oldVersion/10))}),this._maxKey=Qe(r.IDBKeyRange),this._createTransaction=function(Z,$,W,H){return new s.Transaction(Z,$,W,s._options.chromeTransactionDurability,H)},this._fireOnBlocked=function(Z){s.on("blocked").fire(Z),Yn.filter(function($){return $.name===s.name&&$!==s&&!$._state.vcFired}).map(function($){return $.on("versionchange").fire(Z)})},this.use(Lr),this.use(Ar),this.use(si),this.use(Gr),this.use(Vr);var Y=new Proxy(this,{get:function(Z,$,W){if($==="_vip")return!0;if($==="table")return function(G){return Wn(s.table(G),Y)};var H=Reflect.get(Z,$,W);return H instanceof be?Wn(H,Y):$==="tables"?H.map(function(G){return Wn(G,Y)}):$==="_createTransaction"?function(){return Wn(H.apply(this,arguments),Y)}:H}});this.vip=Y,a.forEach(function(Z){return Z(s)})}var qn,Ve=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",lr=(hr.prototype.subscribe=function(n,r,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:r,complete:s})},hr.prototype[Ve]=function(){return this},hr);function hr(n){this._subscribe=n}try{qn={indexedDB:p.indexedDB||p.mozIndexedDB||p.webkitIndexedDB||p.msIndexedDB,IDBKeyRange:p.IDBKeyRange||p.webkitIDBKeyRange}}catch{qn={indexedDB:null,IDBKeyRange:null}}function fn(n){var r,s=!1,a=new lr(function(l){var d=Q(n),S,M=!1,U={},K={},Y={get closed(){return M},unsubscribe:function(){M||(M=!0,S&&S.abort(),Z&&cn.storagemutated.unsubscribe(W))}};l.start&&l.start(Y);var Z=!1,$=function(){return Ei(H)},W=function(G){ii(U,G),ur(K,U)&&$()},H=function(){var G,V,et;!M&&qn.indexedDB&&(U={},G={},S&&S.abort(),S=new AbortController,et=function(ot){var ft=Vn();try{d&&Cn();var bt=gn(n,ot);return bt=d?bt.finally(vn):bt}finally{ft&&En()}}(V={subscr:G,signal:S.signal,requery:$,querier:n,trans:null}),Promise.resolve(et).then(function(ot){s=!0,r=ot,M||V.signal.aborted||(U={},function(ft){for(var bt in ft)if(P(ft,bt))return;return 1}(K=G)||Z||(cn(ti,W),Z=!0),Ei(function(){return!M&&l.next&&l.next(ot)}))},function(ot){s=!1,["DatabaseClosedError","AbortError"].includes(ot==null?void 0:ot.name)||M||Ei(function(){M||l.error&&l.error(ot)})}))};return setTimeout($,0),Y});return a.hasValue=function(){return s},a.getValue=function(){return r},a}var Hn=Pn;function Nn(n){var r=Ie;try{Ie=!0,cn.storagemutated.fire(n),cr(n,!0)}finally{Ie=r}}z(Hn,x(x({},ce),{delete:function(n){return new Hn(n,{addons:[]}).delete()},exists:function(n){return new Hn(n,{addons:[]}).open().then(function(r){return r.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return r=Hn.dependencies,s=r.indexedDB,r=r.IDBKeyRange,(Ri(s)?Promise.resolve(s.databases()).then(function(a){return a.map(function(l){return l.name}).filter(function(l){return l!==Ci})}):sr(s,r).toCollection().primaryKeys()).then(n)}catch{return we(new St.MissingAPI)}var r,s},defineClass:function(){return function(n){w(this,n)}},ignoreTransaction:function(n){return Kt.trans?Fn(Kt.transless,n):n()},vip:ln,async:function(n){return function(){try{var r=ji(n.apply(this,arguments));return r&&typeof r.then=="function"?r:jt.resolve(r)}catch(s){return we(s)}}},spawn:function(n,r,s){try{var a=ji(n.apply(s,r||[]));return a&&typeof a.then=="function"?a:jt.resolve(a)}catch(l){return we(l)}},currentTransaction:{get:function(){return Kt.trans||null}},waitFor:function(n,r){return r=jt.resolve(typeof n=="function"?Hn.ignoreTransaction(n):n).timeout(r||6e4),Kt.trans?Kt.trans.waitFor(r):r},Promise:jt,debug:{get:function(){return _t},set:function(n){nt(n)}},derive:b,extend:w,props:z,override:j,Events:An,on:cn,liveQuery:fn,extendObservabilitySet:ii,getByKeyPath:lt,setByKeyPath:rt,delByKeyPath:function(n,r){typeof r=="string"?rt(n,r,void 0):"length"in r&&[].map.call(r,function(s){rt(n,s,void 0)})},shallowClone:wt,deepClone:ct,getObjectDiff:xi,cmp:Ht,asap:X,minKey:-1/0,addons:[],connections:Yn,errnames:ne,dependencies:qn,cache:Mn,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,r,s){return n+r/Math.pow(10,2*s)})})),Hn.maxKey=Qe(Hn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(cn(ti,function(n){Ie||(n=new CustomEvent(di,{detail:n}),Ie=!0,dispatchEvent(n),Ie=!1)}),addEventListener(di,function(n){n=n.detail,Ie||Nn(n)}));var ai,Ie=!1,Si=function(){};return typeof BroadcastChannel<"u"&&((Si=function(){(ai=new BroadcastChannel(di)).onmessage=function(n){return n.data&&Nn(n.data)}})(),typeof ai.unref=="function"&&ai.unref(),cn(ti,function(n){Ie||ai.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Pn.disableBfCache&&n.persisted){_t&&console.debug("Dexie: handling persisted pagehide"),ai!=null&&ai.close();for(var r=0,s=Yn;r<s.length;r++)s[r].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Pn.disableBfCache&&n.persisted&&(_t&&console.debug("Dexie: handling persisted pageshow"),Si(),Nn({all:new Ce(-1/0,[[]])}))})),jt.rejectionMapper=function(n,r){return!n||n instanceof Ft||n instanceof TypeError||n instanceof SyntaxError||!n.name||!oe[n.name]?n:(r=new oe[n.name](r||n.message,n),"stack"in n&&C(r,"stack",{get:function(){return this.inner.stack}}),r)},nt(_t),x(Pn,Object.freeze({__proto__:null,Dexie:Pn,liveQuery:fn,Entity:Xn,cmp:Ht,PropModification:un,replacePrefix:function(n,r){return new un({replacePrefix:[n,r]})},add:function(n){return new un({add:n})},remove:function(n){return new un({remove:n})},default:Pn,RangeSet:Ce,mergeRanges:yi,rangesOverlap:ar}),{default:Pn}),Pn})})(Co);var is=Co.exports;const Qr=io(is),xo=Symbol.for("Dexie"),Gi=globalThis[xo]||(globalThis[xo]=Qr);if(Qr.semVer!==Gi.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Qr.semVer} and ${Gi.semVer}`);const{liveQuery:Ma,mergeRanges:Na,rangesOverlap:Da,RangeSet:Ra,cmp:Za,Entity:Fa,PropModification:ja,replacePrefix:Ua,add:Ka,remove:Wa,DexieYProvider:qa}=Gi;class rs extends Gi{constructor(){super("tallies-db");Ki(this,"tallies");Ki(this,"tally_sessions");Ki(this,"bagups");Ki(this,"projects");Ki(this,"supervisors");this.version(1).stores({tallies:"client_id, date, created_at, sync_status"}),this.version(2).stores({tallies:"client_id, date, created_at, sync_status",tally_sessions:"session_id, created_at, sync_status",bagups:"bagup_id, session_id, created_at, sync_status, [session_id+created_at]"}),this.version(3).stores({tallies:"client_id, date, created_at, sync_status",tally_sessions:"session_id, created_at, sync_status",bagups:"bagup_id, session_id, created_at, sync_status, [session_id+created_at]",projects:"project_name"}),this.version(4).stores({tallies:"client_id, date, created_at, sync_status",tally_sessions:"session_id, created_at, sync_status",bagups:"bagup_id, session_id, created_at, sync_status, [session_id+created_at]",projects:"project_name",supervisors:"name"})}}const _e=new rs,Ee=async()=>{_e.isOpen()||await _e.open()},os=async g=>(await Ee(),_e.tallies.where("date").equals(g).reverse().sortBy("created_at")),ss=async g=>(await Ee(),_e.tallies.where("sync_status").anyOf(g).reverse().sortBy("created_at")),Jr=async g=>(await Ee(),_e.tallies.where("sync_status").equals(g).count()),Oo=async(g,A)=>{await Ee(),await _e.tallies.update(g,A)},as=async g=>{await Ee(),await _e.tally_sessions.add(g)},Rr=async(g,A)=>{await Ee(),await _e.tally_sessions.update(g,A)},Ao=async g=>(await Ee(),_e.tally_sessions.get(g)),pr=async g=>(await Ee(),_e.tally_sessions.where("sync_status").anyOf(g).reverse().sortBy("created_at")),us=async()=>(await Ee(),_e.tally_sessions.orderBy("created_at").reverse().toArray()),Wi=async g=>(await Ee(),_e.tally_sessions.where("sync_status").equals(g).count()),cs=async g=>{await Ee(),await _e.bagups.add(g)},Zr=async(g,A)=>{await Ee(),await _e.bagups.update(g,A)},ls=async g=>{await Ee(),await _e.bagups.delete(g)},zo=async g=>(await Ee(),_e.bagups.where("[session_id+created_at]").between([g,Gi.minKey],[g,Gi.maxKey]).reverse().toArray()),hs=async g=>(await Ee(),_e.bagups.where("sync_status").anyOf(g).reverse().sortBy("created_at")),$r=async g=>(await Ee(),_e.bagups.where("sync_status").equals(g).count()),fs=async g=>{await Ee(),await _e.transaction("rw",_e.projects,async()=>{await _e.projects.clear(),await _e.projects.bulkPut(g)})},ds=async()=>(await Ee(),_e.projects.toArray()),ps=async g=>{await Ee(),await _e.transaction("rw",_e.supervisors,async()=>{await _e.supervisors.clear(),await _e.supervisors.bulkPut(g.map(A=>({name:A})))})},ms=async()=>(await Ee(),(await _e.supervisors.toArray()).map(A=>A.name)),_s=async g=>os(g),gs=async(g=20)=>(await ss(["pending","error"])).slice(0,g),vs=async()=>{const[g,A,c]=await Promise.all([Jr("pending"),Jr("synced"),Jr("error")]);return{pending:g,synced:A,error:c}},ys=async g=>{await Promise.all(g.map(A=>Oo(A.client_id,{sync_status:"synced",sync_error:void 0})))},bs=async(g,A)=>{await Promise.all(g.map(c=>Oo(c.client_id,{sync_status:"error",sync_error:A})))},Bo=()=>"randomUUID"in crypto?crypto.randomUUID():`id-${Date.now()}-${Math.random().toString(16).slice(2)}`,ws=async g=>{var x,v,p;let A=Date.now();if(g.date){const[f,m,w]=g.date.split("-").map(Number),D=new Date(f,m-1,w),F=new Date;D.setHours(F.getHours(),F.getMinutes(),F.getSeconds(),F.getMilliseconds()),A=D.getTime()}const c={session_id:Bo(),created_at:A,block_name:g.block_name.trim(),project_name:(x=g.project_name)==null?void 0:x.trim(),supervisor:(v=g.supervisor)==null?void 0:v.trim(),target_density:g.target_density,notes:((p=g.notes)==null?void 0:p.trim())||void 0,species:g.species,sync_status:"draft"};return await as(c),c},xs=async g=>Ao(g),ks=async(g=20)=>(await pr(["finalized","error"])).slice(0,g),Ps=async()=>{const[g,A,c,x,v,p]=await Promise.all([Wi("pending"),Wi("draft"),Wi("synced"),Wi("error"),Wi("finalized"),Wi("archived")]);return{pending:g,draft:A,synced:c,error:x,finalized:v,archived:p}},Ss=async g=>{await Promise.all(g.map(A=>Rr(A.session_id,{sync_status:"synced",sync_error:void 0})))},Ts=async(g,A)=>{await Promise.all(g.map(c=>Rr(c.session_id,{sync_status:"error",sync_error:A})))},Ls=async(g,A,c)=>{const x={};A.forEach(p=>{x[p]=0});const v={bagup_id:Bo(),session_id:g,created_at:Date.now(),counts:x,sync_status:"pending"};return c&&(v.lat=c.lat,v.lng=c.lng),await cs(v),v},ko=async(g,A)=>{await Zr(g,{counts:A})},Po=async g=>{await ls(g)},Es=async g=>zo(g),Cs=async(g=20)=>(await hs(["finalized","error"])).slice(0,g),Os=async()=>{const[g,A,c]=await Promise.all([$r("pending"),$r("synced"),$r("error")]);return{pending:g,synced:A,error:c}},As=async g=>{await Promise.all(g.map(A=>Zr(A.bagup_id,{sync_status:"synced",sync_error:void 0})))},zs=async(g,A)=>{await Promise.all(g.map(c=>Zr(c.bagup_id,{sync_status:"error",sync_error:A})))},Bs=async g=>{if(!await Ao(g))return;await Rr(g,{sync_status:"finalized",sync_error:void 0});const c=await zo(g);await Promise.all(c.filter(x=>x.sync_status==="pending"||x.sync_status==="error").map(x=>Zr(x.bagup_id,{sync_status:"finalized",sync_error:void 0})))},Is=async g=>{await Rr(g,{sync_status:"archived"})},Ms=async g=>{switch(g){case"Synced Sessions":return pr(["synced"]);case"Finalized Sessions":return pr(["finalized"]);case"Archived Sessions":return pr(["archived"]);case"Error Sessions":return pr(["error"]);case"All Sessions":default:return us()}},So=(g,A)=>{const c={};return g.forEach(x=>{c[x.species_code]=0}),A.forEach(x=>{Object.entries(x.counts).forEach(([v,p])=>{c[v]=(c[v]??0)+p})}),c},dr=(g,A)=>{const c=g.reduce((v,p)=>v+(A[p.species_code]??0),0),x={};return g.forEach(v=>{x[v.species_code]=c===0?0:(A[v.species_code]??0)/c}),x},Ns=(g,A)=>{if(!A)return"First bagup";const c=Math.max(g-A,0);return Io(c)},Io=g=>{const A=Math.floor(g/1e3),c=Math.floor(A/60),x=A%60;return c===0?`${x}s`:`${c}m ${x}s`},Ds=g=>{const A=[...g].sort((x,v)=>x.created_at-v.created_at),c={};return A.forEach((x,v)=>{var f;const p=v===0||(f=A[v-1])==null?void 0:f.created_at;c[x.bagup_id]=Ns(x.created_at,p)}),c},Rs=g=>{var p,f,m,w;const A=vt("div",{className:"species-row"}),c=vt("input");c.placeholder="Code",c.readOnly=!0,c.value=((p=g.initial)==null?void 0:p.species_code)??"";const x=vt("input");x.placeholder="Display name",x.readOnly=!0,x.value=((f=g.initial)==null?void 0:f.display_name)??"";const v=vt("input");return v.type="number",v.step="0.01",v.min="0",v.placeholder="Required ratio",v.value=((w=(m=g.initial)==null?void 0:m.required_ratio)==null?void 0:w.toString())??"",A.append(c,x,v),{row:A,codeInput:c,nameInput:x,ratioInput:v}},Zs=g=>{const A=vt("div",{className:"species-summary"});A.dataset.speciesCode=g.species_code;const c=vt("div",{className:"species-title",text:g.display_name}),x=vt("div",{className:"species-meta",text:`Target: ${(g.required_ratio*100).toFixed(0)}%`}),v=vt("div",{className:"species-current",text:"Current: 0%"}),p=vt("div",{className:"species-total",text:"Total: 0"});return A.append(c,x,v,p),A},Mo="https://script.google.com/macros/s/AKfycbxDcDdxog0J713kdiMBHWbnelmDa0lGf8JwYMKEGKP1H5ok3t_wsdOyu9-KcLWgXZvZ/exec",Fs=async g=>{const A=await fetch(Mo,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(g)});if(!A.ok){const c=await A.text();throw new Error(c||`Request failed with status ${A.status}`)}},js=async()=>{const g=await fetch(Mo,{method:"GET"});if(!g.ok){const c=await g.text();throw new Error(c||`Request failed with status ${g.status}`)}return await g.json()},qi=20,Us=async()=>{if(!navigator.onLine)return{synced:0,failed:0,skipped:!0,errors:[]};let g=0,A=0;const c=new Set;for(;;){const[x,v,p]=await Promise.all([gs(qi),ks(qi),Cs(qi)]);if(x.length===0&&v.length===0&&p.length===0)break;try{await Fs({tallies:x,sessions:v,bagups:p}),await Promise.all([ys(x),Ss(v),As(p)]),g+=x.length+v.length+p.length}catch(f){const m=f instanceof Error?f.message:"Sync failed";c.add(m),await Promise.all([bs(x,m),Ts(v,m),zs(p,m)]),A+=x.length+v.length+p.length}if(x.length<qi&&v.length<qi&&p.length<qi)break}return{synced:g,failed:A,skipped:!1,errors:Array.from(c)}},Ks=async()=>{if(navigator.onLine)try{const g=await js();await fs(g.projects),await ps(g.supervisors)}catch(g){console.error("Failed to sync projects",g)}},No=[],Oe=(g,A)=>{const c={timestamp:new Date().toISOString(),action:g,details:A};No.push(c),console.log("[UserAction]",c)},Ws=()=>{const g=No.map(v=>`[${v.timestamp}] ${v.action}${v.details?" "+JSON.stringify(v.details):""}`).join(`
`),A=new Blob([g],{type:"text/plain"}),c=URL.createObjectURL(A),x=document.createElement("a");x.href=c,x.download=`user_logs_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(c)};var to={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(g,A){(function(c,x){x(A)})(Ti,function(c){var x="1.9.4";function v(t){var e,i,o,u;for(i=1,o=arguments.length;i<o;i++){u=arguments[i];for(e in u)t[e]=u[e]}return t}var p=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function f(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var o=i.call(arguments,2);return function(){return t.apply(e,o.length?o.concat(i.call(arguments)):arguments)}}var m=0;function w(t){return"_leaflet_id"in t||(t._leaflet_id=++m),t._leaflet_id}function D(t,e,i){var o,u,y,R;return R=function(){o=!1,u&&(y.apply(i,u),u=!1)},y=function(){o?u=arguments:(t.apply(i,arguments),setTimeout(R,e),o=!0)},y}function F(t,e,i){var o=e[1],u=e[0],y=o-u;return t===o&&i?t:((t-u)%y+y)%y+u}function P(){return!1}function z(t,e){if(e===!1)return t;var i=Math.pow(10,e===void 0?6:e);return Math.round(t*i)/i}function k(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function C(t){return k(t).split(/\s+/)}function b(t,e){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?p(t.options):{});for(var i in e)t.options[i]=e[i];return t.options}function O(t,e,i){var o=[];for(var u in t)o.push(encodeURIComponent(i?u.toUpperCase():u)+"="+encodeURIComponent(t[u]));return(!e||e.indexOf("?")===-1?"?":"&")+o.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function I(t,e){return t.replace(T,function(i,o){var u=e[o];if(u===void 0)throw new Error("No value provided for variable "+i);return typeof u=="function"&&(u=u(e)),u})}var j=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function J(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var X="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function lt(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var rt=0;function wt(t){var e=+new Date,i=Math.max(0,16-(e-rt));return rt=e+i,window.setTimeout(t,i)}var at=window.requestAnimationFrame||lt("RequestAnimationFrame")||wt,xt=window.cancelAnimationFrame||lt("CancelAnimationFrame")||lt("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function Zt(t,e,i){if(i&&at===wt)t.call(e);else return at.call(window,f(t,e))}function N(t){t&&xt.call(window,t)}var ct={__proto__:null,extend:v,create:p,bind:f,get lastId(){return m},stamp:w,throttle:D,wrapNum:F,falseFn:P,formatNum:z,trim:k,splitWords:C,setOptions:b,getParamString:O,template:I,isArray:j,indexOf:J,emptyImageUrl:X,requestFn:at,cancelFn:xt,requestAnimFrame:Zt,cancelAnimFrame:N};function _(){}_.extend=function(t){var e=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,o=p(i);o.constructor=e,e.prototype=o;for(var u in this)Object.prototype.hasOwnProperty.call(this,u)&&u!=="prototype"&&u!=="__super__"&&(e[u]=this[u]);return t.statics&&v(e,t.statics),t.includes&&(mt(t.includes),v.apply(null,[o].concat(t.includes))),v(o,t),delete o.statics,delete o.includes,o.options&&(o.options=i.options?p(i.options):{},v(o.options,t.options)),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var y=0,R=o._initHooks.length;y<R;y++)o._initHooks[y].call(this)}},e},_.include=function(t){var e=this.prototype.options;return v(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},_.mergeOptions=function(t){return v(this.prototype.options,t),this},_.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i=typeof t=="function"?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};function mt(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=j(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Nt={on:function(t,e,i){if(typeof t=="object")for(var o in t)this._on(o,t[o],e);else{t=C(t);for(var u=0,y=t.length;u<y;u++)this._on(t[u],e,i)}return this},off:function(t,e,i){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var o in t)this._off(o,t[o],e);else{t=C(t);for(var u=arguments.length===1,y=0,R=t.length;y<R;y++)u?this._off(t[y]):this._off(t[y],e,i)}return this},_on:function(t,e,i,o){if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}if(this._listens(t,e,i)===!1){i===this&&(i=void 0);var u={fn:e,ctx:i};o&&(u.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(u)}},_off:function(t,e,i){var o,u,y;if(this._events&&(o=this._events[t],!!o)){if(arguments.length===1){if(this._firingCount)for(u=0,y=o.length;u<y;u++)o[u].fn=P;delete this._events[t];return}if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}var R=this._listens(t,e,i);if(R!==!1){var it=o[R];this._firingCount&&(it.fn=P,this._events[t]=o=o.slice()),o.splice(R,1)}}},fire:function(t,e,i){if(!this.listens(t,i))return this;var o=v({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var u=this._events[t];if(u){this._firingCount=this._firingCount+1||1;for(var y=0,R=u.length;y<R;y++){var it=u[y],ut=it.fn;it.once&&this.off(t,ut,it.ctx),ut.call(it.ctx||this,o)}this._firingCount--}}return i&&this._propagateEvent(o),this},listens:function(t,e,i,o){typeof t!="string"&&console.warn('"string" type argument expected');var u=e;typeof e!="function"&&(o=!!e,u=void 0,i=void 0);var y=this._events&&this._events[t];if(y&&y.length&&this._listens(t,u,i)!==!1)return!0;if(o){for(var R in this._eventParents)if(this._eventParents[R].listens(t,e,i,o))return!0}return!1},_listens:function(t,e,i){if(!this._events)return!1;var o=this._events[t]||[];if(!e)return!!o.length;i===this&&(i=void 0);for(var u=0,y=o.length;u<y;u++)if(o[u].fn===e&&o[u].ctx===i)return u;return!1},once:function(t,e,i){if(typeof t=="object")for(var o in t)this._on(o,t[o],e,!0);else{t=C(t);for(var u=0,y=t.length;u<y;u++)this._on(t[u],e,i,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[w(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[w(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,v({layer:t.target,propagatedFrom:t.target},t),!0)}};Nt.addEventListener=Nt.on,Nt.removeEventListener=Nt.clearAllEventListeners=Nt.off,Nt.addOneTimeEventListener=Nt.once,Nt.fireEvent=Nt.fire,Nt.hasEventListeners=Nt.listens;var pt=_.extend(Nt);function Pt(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var kt=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};Pt.prototype={clone:function(){return new Pt(this.x,this.y)},add:function(t){return this.clone()._add(gt(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(gt(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new Pt(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new Pt(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=kt(this.x),this.y=kt(this.y),this},distanceTo:function(t){t=gt(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=gt(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=gt(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+z(this.x)+", "+z(this.y)+")"}};function gt(t,e,i){return t instanceof Pt?t:j(t)?new Pt(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new Pt(t.x,t.y):new Pt(t,e,i)}function Q(t,e){if(t)for(var i=e?[t,e]:t,o=0,u=i.length;o<u;o++)this.extend(i[o])}Q.prototype={extend:function(t){var e,i;if(!t)return this;if(t instanceof Pt||typeof t[0]=="number"||"x"in t)e=i=gt(t);else if(t=tt(t),e=t.min,i=t.max,!e||!i)return this;return!this.min&&!this.max?(this.min=e.clone(),this.max=i.clone()):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(i.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(i.y,this.max.y)),this},getCenter:function(t){return gt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return gt(this.min.x,this.max.y)},getTopRight:function(){return gt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return typeof t[0]=="number"||t instanceof Pt?t=gt(t):t=tt(t),t instanceof Q?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=tt(t);var e=this.min,i=this.max,o=t.min,u=t.max,y=u.x>=e.x&&o.x<=i.x,R=u.y>=e.y&&o.y<=i.y;return y&&R},overlaps:function(t){t=tt(t);var e=this.min,i=this.max,o=t.min,u=t.max,y=u.x>e.x&&o.x<i.x,R=u.y>e.y&&o.y<i.y;return y&&R},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var e=this.min,i=this.max,o=Math.abs(e.x-i.x)*t,u=Math.abs(e.y-i.y)*t;return tt(gt(e.x-o,e.y-u),gt(i.x+o,i.y+u))},equals:function(t){return t?(t=tt(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function tt(t,e){return!t||t instanceof Q?t:new Q(t,e)}function Ft(t,e){if(t)for(var i=e?[t,e]:t,o=0,u=i.length;o<u;o++)this.extend(i[o])}Ft.prototype={extend:function(t){var e=this._southWest,i=this._northEast,o,u;if(t instanceof ht)o=t,u=t;else if(t instanceof Ft){if(o=t._southWest,u=t._northEast,!o||!u)return this}else return t?this.extend(zt(t)||Et(t)):this;return!e&&!i?(this._southWest=new ht(o.lat,o.lng),this._northEast=new ht(u.lat,u.lng)):(e.lat=Math.min(o.lat,e.lat),e.lng=Math.min(o.lng,e.lng),i.lat=Math.max(u.lat,i.lat),i.lng=Math.max(u.lng,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,o=Math.abs(e.lat-i.lat)*t,u=Math.abs(e.lng-i.lng)*t;return new Ft(new ht(e.lat-o,e.lng-u),new ht(i.lat+o,i.lng+u))},getCenter:function(){return new ht((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ht(this.getNorth(),this.getWest())},getSouthEast:function(){return new ht(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof ht||"lat"in t?t=zt(t):t=Et(t);var e=this._southWest,i=this._northEast,o,u;return t instanceof Ft?(o=t.getSouthWest(),u=t.getNorthEast()):o=u=t,o.lat>=e.lat&&u.lat<=i.lat&&o.lng>=e.lng&&u.lng<=i.lng},intersects:function(t){t=Et(t);var e=this._southWest,i=this._northEast,o=t.getSouthWest(),u=t.getNorthEast(),y=u.lat>=e.lat&&o.lat<=i.lat,R=u.lng>=e.lng&&o.lng<=i.lng;return y&&R},overlaps:function(t){t=Et(t);var e=this._southWest,i=this._northEast,o=t.getSouthWest(),u=t.getNorthEast(),y=u.lat>e.lat&&o.lat<i.lat,R=u.lng>e.lng&&o.lng<i.lng;return y&&R},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return t?(t=Et(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Et(t,e){return t instanceof Ft?t:new Ft(t,e)}function ht(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,i!==void 0&&(this.alt=+i)}ht.prototype={equals:function(t,e){if(!t)return!1;t=zt(t);var i=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return i<=(e===void 0?1e-9:e)},toString:function(t){return"LatLng("+z(this.lat,t)+", "+z(this.lng,t)+")"},distanceTo:function(t){return Dt.distance(this,zt(t))},wrap:function(){return Dt.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return Et([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new ht(this.lat,this.lng,this.alt)}};function zt(t,e,i){return t instanceof ht?t:j(t)&&typeof t[0]!="object"?t.length===3?new ht(t[0],t[1],t[2]):t.length===2?new ht(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new ht(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===void 0?null:new ht(t,e,i)}var ne={latLngToPoint:function(t,e){var i=this.projection.project(t),o=this.scale(e);return this.transformation._transform(i,o)},pointToLatLng:function(t,e){var i=this.scale(e),o=this.transformation.untransform(t,i);return this.projection.unproject(o)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),o=this.transformation.transform(e.min,i),u=this.transformation.transform(e.max,i);return new Q(o,u)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?F(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?F(t.lat,this.wrapLat,!0):t.lat,o=t.alt;return new ht(i,e,o)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),o=e.lat-i.lat,u=e.lng-i.lng;if(o===0&&u===0)return t;var y=t.getSouthWest(),R=t.getNorthEast(),it=new ht(y.lat-o,y.lng-u),ut=new ht(R.lat-o,R.lng-u);return new Ft(it,ut)}},Dt=v({},ne,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,o=t.lat*i,u=e.lat*i,y=Math.sin((e.lat-t.lat)*i/2),R=Math.sin((e.lng-t.lng)*i/2),it=y*y+Math.cos(o)*Math.cos(u)*R*R,ut=2*Math.atan2(Math.sqrt(it),Math.sqrt(1-it));return this.R*ut}}),St=6378137,oe={R:St,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,o=Math.max(Math.min(i,t.lat),-i),u=Math.sin(o*e);return new Pt(this.R*t.lng*e,this.R*Math.log((1+u)/(1-u))/2)},unproject:function(t){var e=180/Math.PI;return new ht((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=St*Math.PI;return new Q([-t,-t],[t,t])}()};function ce(t,e,i,o){if(j(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=e,this._c=i,this._d=o}ce.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new Pt((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};function Xt(t,e,i,o){return new ce(t,e,i,o)}var he=v({},Dt,{code:"EPSG:3857",projection:oe,transformation:function(){var t=.5/(Math.PI*oe.R);return Xt(t,.5,-t,.5)}()}),h=v({},he,{code:"EPSG:900913"});function dt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function st(t,e){var i="",o,u,y,R,it,ut;for(o=0,y=t.length;o<y;o++){for(it=t[o],u=0,R=it.length;u<R;u++)ut=it[u],i+=(u?"L":"M")+ut.x+" "+ut.y;i+=e?Vt.svg?"z":"x":""}return i||"M0 0"}var B=document.documentElement.style,E="ActiveXObject"in window,q=E&&!document.addEventListener,yt="msLaunchUri"in navigator&&!("documentMode"in document),_t=sn("webkit"),nt=sn("android"),Lt=sn("android 2")||sn("android 3"),Ut=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ot=nt&&sn("Google")&&Ut<537&&!("AudioNode"in window),Gt=!!window.opera,le=!yt&&sn("chrome"),ie=sn("gecko")&&!_t&&!Gt&&!E,Se=!le&&sn("safari"),rn=sn("phantom"),Ae="OTransition"in B,Ue=navigator.platform.indexOf("Win")===0,me=E&&"transition"in B,on="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Lt,Ke="MozPerspective"in B,Kt=!window.L_DISABLE_3D&&(me||on||Ke)&&!Ae&&!rn,qe=typeof orientation<"u"||sn("mobile"),mn=qe&&_t,Gn=qe&&on,jt=!window.PointerEvent&&window.MSPointerEvent,Zn=!!(window.PointerEvent||jt),_n="ontouchstart"in window||!!window.TouchEvent,Ln=!window.L_NO_TOUCH&&(_n||Zn),mr=qe&&Gt,Yi=qe&&ie,Ur=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Kr=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",P,e),window.removeEventListener("testPassiveEventSupport",P,e)}catch{}return t}(),Vn=function(){return!!document.createElement("canvas").getContext}(),En=!!(document.createElementNS&&dt("svg").createSVGRect),Xi=!!En&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Li=!En&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&typeof e.adj=="object"}catch{return!1}}(),ge=navigator.platform.indexOf("Mac")===0,Te=navigator.platform.indexOf("Linux")===0;function sn(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Vt={ie:E,ielt9:q,edge:yt,webkit:_t,android:nt,android23:Lt,androidStock:Ot,opera:Gt,chrome:le,gecko:ie,safari:Se,phantom:rn,opera12:Ae,win:Ue,ie3d:me,webkit3d:on,gecko3d:Ke,any3d:Kt,mobile:qe,mobileWebkit:mn,mobileWebkit3d:Gn,msPointer:jt,pointer:Zn,touch:Ln,touchNative:_n,mobileOpera:mr,mobileGecko:Yi,retina:Ur,passiveEvents:Kr,canvas:Vn,svg:En,vml:Li,inlineSvg:Xi,mac:ge,linux:Te},ui=Vt.msPointer?"MSPointerDown":"pointerdown",ci=Vt.msPointer?"MSPointerMove":"pointermove",_r=Vt.msPointer?"MSPointerUp":"pointerup",gn=Vt.msPointer?"MSPointerCancel":"pointercancel",Cn={touchstart:ui,touchmove:ci,touchend:_r,touchcancel:gn},vn={touchstart:bn,touchmove:an,touchend:an,touchcancel:an},yn={},gr=!1;function On(t,e,i){return e==="touchstart"&&we(),vn[e]?(i=vn[e].bind(this,i),t.addEventListener(Cn[e],i,!1),i):(console.warn("wrong event specified:",e),P)}function vr(t,e,i){if(!Cn[e]){console.warn("wrong event specified:",e);return}t.removeEventListener(Cn[e],i,!1)}function Fn(t){yn[t.pointerId]=t}function yr(t){yn[t.pointerId]&&(yn[t.pointerId]=t)}function Ei(t){delete yn[t.pointerId]}function we(){gr||(document.addEventListener(ui,Fn,!0),document.addEventListener(ci,yr,!0),document.addEventListener(_r,Ei,!0),document.addEventListener(gn,Ei,!0),gr=!0)}function an(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){e.touches=[];for(var i in yn)e.touches.push(yn[i]);e.changedTouches=[e],t(e)}}function bn(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&ke(e),an(t,e)}function br(t){var e={},i,o;for(o in t)i=t[o],e[o]=i&&i.bind?i.bind(t):i;return t=e,e.type="dblclick",e.detail=2,e.isTrusted=!1,e._simulated=!0,e}var Yn=200;function Ci(t,e){t.addEventListener("dblclick",e);var i=0,o;function u(y){if(y.detail!==1){o=y.detail;return}if(!(y.pointerType==="mouse"||y.sourceCapabilities&&!y.sourceCapabilities.firesTouchEvents)){var R=Ii(y);if(!(R.some(function(ut){return ut instanceof HTMLLabelElement&&ut.attributes.for})&&!R.some(function(ut){return ut instanceof HTMLInputElement||ut instanceof HTMLSelectElement}))){var it=Date.now();it-i<=Yn?(o++,o===2&&e(br(y))):o=1,i=it}}}return t.addEventListener("click",u),{dblclick:e,simDblclick:u}}function Ji(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}var li=$n(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),$e=$n(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),$i=$e==="webkitTransition"||$e==="OTransition"?$e+"End":"transitionend";function hi(t){return typeof t=="string"?document.getElementById(t):t}function Xn(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||i==="auto")&&document.defaultView){var o=document.defaultView.getComputedStyle(t,null);i=o?o[e]:null}return i==="auto"?null:i}function Ht(t,e,i){var o=document.createElement(t);return o.className=e||"",i&&i.appendChild(o),o}function ve(t){var e=t.parentNode;e&&e.removeChild(t)}function fi(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function wn(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function un(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function Oi(t,e){if(t.classList!==void 0)return t.classList.contains(e);var i=An(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function ee(t,e){if(t.classList!==void 0)for(var i=C(e),o=0,u=i.length;o<u;o++)t.classList.add(i[o]);else if(!Oi(t,e)){var y=An(t);de(t,(y?y+" ":"")+e)}}function be(t,e){t.classList!==void 0?t.classList.remove(e):de(t,k((" "+An(t)+" ").replace(" "+e+" "," ")))}function de(t,e){t.className.baseVal===void 0?t.className=e:t.className.baseVal=e}function An(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function ze(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&Jn(t,e)}function Jn(t,e){var i=!1,o="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(o)}catch{if(e===1)return}e=Math.round(e*100),i?(i.Enabled=e!==100,i.Opacity=e):t.style.filter+=" progid:"+o+"(opacity="+e+")"}function $n(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function xn(t,e,i){var o=e||new Pt(0,0);t.style[li]=(Vt.ie3d?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(i?" scale("+i+")":"")}function ye(t,e){t._leaflet_pos=e,Vt.any3d?xn(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function zn(t){return t._leaflet_pos||new Pt(0,0)}var Bn,Qn,Qi;if("onselectstart"in document)Bn=function(){Yt(window,"selectstart",ke)},Qn=function(){fe(window,"selectstart",ke)};else{var ae=$n(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Bn=function(){if(ae){var t=document.documentElement.style;Qi=t[ae],t[ae]="none"}},Qn=function(){ae&&(document.documentElement.style[ae]=Qi,Qi=void 0)}}function Ai(){Yt(window,"dragstart",ke)}function tr(){fe(window,"dragstart",ke)}var zi,Re;function In(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(jn(),zi=t,Re=t.style.outlineStyle,t.style.outlineStyle="none",Yt(window,"keydown",jn))}function jn(){zi&&(zi.style.outlineStyle=Re,zi=void 0,Re=void 0,fe(window,"keydown",jn))}function kn(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function Bi(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var wr={__proto__:null,TRANSFORM:li,TRANSITION:$e,TRANSITION_END:$i,get:hi,getStyle:Xn,create:Ht,remove:ve,empty:fi,toFront:wn,toBack:un,hasClass:Oi,addClass:ee,removeClass:be,setClass:de,getClass:An,setOpacity:ze,testProp:$n,setTransform:xn,setPosition:ye,getPosition:zn,get disableTextSelection(){return Bn},get enableTextSelection(){return Qn},disableImageDrag:Ai,enableImageDrag:tr,preventOutline:In,restoreOutline:jn,getSizedParentNode:kn,getScale:Bi};function Yt(t,e,i,o){if(e&&typeof e=="object")for(var u in e)cn(t,u,e[u],i);else{e=C(e);for(var y=0,R=e.length;y<R;y++)cn(t,e[y],i,o)}return this}var xe="_leaflet_events";function fe(t,e,i,o){if(arguments.length===1)ti(t),delete t[xe];else if(e&&typeof e=="object")for(var u in e)er(t,u,e[u],i);else if(e=C(e),arguments.length===2)ti(t,function(it){return J(e,it)!==-1});else for(var y=0,R=e.length;y<R;y++)er(t,e[y],i,o);return this}function ti(t,e){for(var i in t[xe]){var o=i.split(/\d/)[0];(!e||e(o))&&er(t,o,null,null,i)}}var di={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function cn(t,e,i,o){var u=e+w(i)+(o?"_"+w(o):"");if(t[xe]&&t[xe][u])return this;var y=function(it){return i.call(o||t,it||window.event)},R=y;!Vt.touchNative&&Vt.pointer&&e.indexOf("touch")===0?y=On(t,e,y):Vt.touch&&e==="dblclick"?y=Ci(t,y):"addEventListener"in t?e==="touchstart"||e==="touchmove"||e==="wheel"||e==="mousewheel"?t.addEventListener(di[e]||e,y,Vt.passiveEvents?{passive:!1}:!1):e==="mouseenter"||e==="mouseleave"?(y=function(it){it=it||window.event,ir(t,it)&&R(it)},t.addEventListener(di[e],y,!1)):t.addEventListener(e,R,!1):t.attachEvent("on"+e,y),t[xe]=t[xe]||{},t[xe][u]=y}function er(t,e,i,o,u){u=u||e+w(i)+(o?"_"+w(o):"");var y=t[xe]&&t[xe][u];if(!y)return this;!Vt.touchNative&&Vt.pointer&&e.indexOf("touch")===0?vr(t,e,y):Vt.touch&&e==="dblclick"?Ji(t,y):"removeEventListener"in t?t.removeEventListener(di[e]||e,y,!1):t.detachEvent("on"+e,y),t[xe][u]=null}function Be(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function pi(t){return cn(t,"wheel",Be),this}function ei(t){return Yt(t,"mousedown touchstart dblclick contextmenu",Be),t._leaflet_disable_click=!0,this}function ke(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Qe(t){return ke(t),Be(t),this}function Ii(t){if(t.composedPath)return t.composedPath();for(var e=[],i=t.target;i;)e.push(i),i=i.parentNode;return e}function nr(t,e){if(!e)return new Pt(t.clientX,t.clientY);var i=Bi(e),o=i.boundingClientRect;return new Pt((t.clientX-o.left)/i.x-e.clientLeft,(t.clientY-o.top)/i.y-e.clientTop)}var Wr=Vt.linux&&Vt.chrome?window.devicePixelRatio:Vt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ni(t){return Vt.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/Wr:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function ir(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch{return!1}return i!==t}var qr={__proto__:null,on:Yt,off:fe,stopPropagation:Be,disableScrollPropagation:pi,disableClickPropagation:ei,preventDefault:ke,stop:Qe,getPropagationPath:Ii,getMousePosition:nr,getWheelDelta:ni,isExternalTarget:ir,addListener:Yt,removeListener:fe},mi=pt.extend({run:function(t,e,i,o){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(o||.5,.2),this._startPos=zn(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Zt(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=this._duration*1e3;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),ye(this._el,i),this.fire("step")},_complete:function(){N(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),se=pt.extend({options:{crs:he,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=b(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=f(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==void 0&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==void 0&&this.setView(zt(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=$e&&Vt.any3d&&!Vt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Yt(this._proxy,$i,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){if(e=e===void 0?this._zoom:this._limitZoom(e),t=this._limitCenter(zt(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==void 0&&(i.zoom=v({animate:i.animate},i.zoom),i.pan=v({animate:i.animate,duration:i.duration},i.pan));var o=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(o)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e,i.pan&&i.pan.noMoveStart),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Vt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Vt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var o=this.getZoomScale(e),u=this.getSize().divideBy(2),y=t instanceof Pt?t:this.latLngToContainerPoint(t),R=y.subtract(u).multiplyBy(1-1/o),it=this.containerPointToLatLng(u.add(R));return this.setView(it,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():Et(t);var i=gt(e.paddingTopLeft||e.padding||[0,0]),o=gt(e.paddingBottomRight||e.padding||[0,0]),u=this.getBoundsZoom(t,!1,i.add(o));if(u=typeof e.maxZoom=="number"?Math.min(e.maxZoom,u):u,u===1/0)return{center:t.getCenter(),zoom:u};var y=o.subtract(i).divideBy(2),R=this.project(t.getSouthWest(),u),it=this.project(t.getNorthEast(),u),ut=this.unproject(R.add(it).divideBy(2).add(y),u);return{center:ut,zoom:u}},fitBounds:function(t,e){if(t=Et(t),!t.isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=gt(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new mi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){ee(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(i=i||{},i.animate===!1||!Vt.any3d)return this.setView(t,e,i);this._stop();var o=this.project(this.getCenter()),u=this.project(t),y=this.getSize(),R=this._zoom;t=zt(t),e=e===void 0?R:e;var it=Math.max(y.x,y.y),ut=it*this.getZoomScale(R,e),Tt=u.distanceTo(o)||1,qt=1.42,Qt=qt*qt;function ue(Le){var zr=Le?-1:1,Jo=Le?ut:it,$o=ut*ut-it*it+zr*Qt*Qt*Tt*Tt,Qo=2*Jo*Qt*Tt,Xr=$o/Qo,wo=Math.sqrt(Xr*Xr+1)-Xr,ts=wo<1e-9?-18:Math.log(wo);return ts}function We(Le){return(Math.exp(Le)-Math.exp(-Le))/2}function De(Le){return(Math.exp(Le)+Math.exp(-Le))/2}function dn(Le){return We(Le)/De(Le)}var Ye=ue(0);function Ui(Le){return it*(De(Ye)/De(Ye+qt*Le))}function Go(Le){return it*(De(Ye)*dn(Ye+qt*Le)-We(Ye))/Qt}function Vo(Le){return 1-Math.pow(1-Le,1.5)}var Yo=Date.now(),yo=(ue(1)-Ye)/qt,Xo=i.duration?1e3*i.duration:1e3*yo*.8;function bo(){var Le=(Date.now()-Yo)/Xo,zr=Vo(Le)*yo;Le<=1?(this._flyToFrame=Zt(bo,this),this._move(this.unproject(o.add(u.subtract(o).multiplyBy(Go(zr)/Tt)),R),this.getScaleZoom(it/Ui(zr),R),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,i.noMoveStart),bo.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return t=Et(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),o=this._limitCenter(i,this._zoom,Et(t));return i.equals(o)||this.panTo(o,e),this._enforcingBounds=!1,this},panInside:function(t,e){e=e||{};var i=gt(e.paddingTopLeft||e.padding||[0,0]),o=gt(e.paddingBottomRight||e.padding||[0,0]),u=this.project(this.getCenter()),y=this.project(t),R=this.getPixelBounds(),it=tt([R.min.add(i),R.max.subtract(o)]),ut=it.getSize();if(!it.contains(y)){this._enforcingBounds=!0;var Tt=y.subtract(it.getCenter()),qt=it.extend(y).getSize().subtract(ut);u.x+=Tt.x<0?-qt.x:qt.x,u.y+=Tt.y<0?-qt.y:qt.y,this.panTo(this.unproject(u),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=v({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),o=e.divideBy(2).round(),u=i.divideBy(2).round(),y=o.subtract(u);return!y.x&&!y.y?this:(t.animate&&t.pan?this.panBy(y):(t.pan&&this._rawPanBy(y),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(f(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=v({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=f(this._handleGeolocationResponse,this),i=f(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,i=t.message||(e===1?"permission denied":e===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=t.coords.latitude,i=t.coords.longitude,o=new ht(e,i),u=o.toBounds(t.coords.accuracy*2),y=this._locateOptions;if(y.setView){var R=this.getBoundsZoom(u);this.setView(o,y.maxZoom?Math.min(R,y.maxZoom):R)}var it={latlng:o,bounds:u,timestamp:t.timestamp};for(var ut in t.coords)typeof t.coords[ut]=="number"&&(it[ut]=t.coords[ut]);this.fire("locationfound",it)}},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ve(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(N(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ve(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),o=Ht("div",i,e||this._mapPane);return t&&(this._panes[t]=o),o},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new Ft(e,i)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=Et(t),i=gt(i||[0,0]);var o=this.getZoom()||0,u=this.getMinZoom(),y=this.getMaxZoom(),R=t.getNorthWest(),it=t.getSouthEast(),ut=this.getSize().subtract(i),Tt=tt(this.project(it,o),this.project(R,o)).getSize(),qt=Vt.any3d?this.options.zoomSnap:1,Qt=ut.x/Tt.x,ue=ut.y/Tt.y,We=e?Math.max(Qt,ue):Math.min(Qt,ue);return o=this.getScaleZoom(We,o),qt&&(o=Math.round(o/(qt/100))*(qt/100),o=e?Math.ceil(o/qt)*qt:Math.floor(o/qt)*qt),Math.max(u,Math.min(y,o))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Pt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new Q(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=e===void 0?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=e===void 0?this._zoom:e;var o=i.zoom(t*i.scale(e));return isNaN(o)?1/0:o},project:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.latLngToPoint(zt(t),e)},unproject:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.pointToLatLng(gt(t),e)},layerPointToLatLng:function(t){var e=gt(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(zt(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(zt(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(Et(t))},distance:function(t,e){return this.options.crs.distance(zt(t),zt(e))},containerPointToLayerPoint:function(t){return gt(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return gt(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(gt(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(zt(t)))},mouseEventToContainerPoint:function(t){return nr(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=hi(t);if(e){if(e._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Yt(e,"scroll",this._onScroll,this),this._containerId=w(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Vt.any3d,ee(t,"leaflet-container"+(Vt.touch?" leaflet-touch":"")+(Vt.retina?" leaflet-retina":"")+(Vt.ielt9?" leaflet-oldie":"")+(Vt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=Xn(t,"position");e!=="absolute"&&e!=="relative"&&e!=="fixed"&&e!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ye(this._mapPane,new Pt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ee(t.markerPane,"leaflet-zoom-hide"),ee(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,i){ye(this._mapPane,new Pt(0,0));var o=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var u=this._zoom!==e;this._moveStart(u,i)._move(t,e)._moveEnd(u),this.fire("viewreset"),o&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i,o){e===void 0&&(e=this._zoom);var u=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),o?i&&i.pinch&&this.fire("zoom",i):((u||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return N(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ye(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[w(this._container)]=this;var e=t?fe:Yt;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Vt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){N(this._resizeRequest),this._resizeRequest=Zt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i=[],o,u=e==="mouseout"||e==="mouseover",y=t.target||t.srcElement,R=!1;y;){if(o=this._targets[w(y)],o&&(e==="click"||e==="preclick")&&this._draggableMoved(o)){R=!0;break}if(o&&o.listens(e,!0)&&(u&&!ir(y,t)||(i.push(o),u))||y===this._container)break;y=y.parentNode}return!i.length&&!R&&!u&&this.listens(e,!0)&&(i=[this]),i},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(e))){var i=t.type;i==="mousedown"&&In(e),this._fireDOMEvent(t,i)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,i){if(t.type==="click"){var o=v({},t);o.type="preclick",this._fireDOMEvent(o,o.type,i)}var u=this._findEventTargets(t,e);if(i){for(var y=[],R=0;R<i.length;R++)i[R].listens(e,!0)&&y.push(i[R]);u=y.concat(u)}if(u.length){e==="contextmenu"&&ke(t);var it=u[0],ut={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var Tt=it.getLatLng&&(!it._radius||it._radius<=10);ut.containerPoint=Tt?this.latLngToContainerPoint(it.getLatLng()):this.mouseEventToContainerPoint(t),ut.layerPoint=this.containerPointToLayerPoint(ut.containerPoint),ut.latlng=Tt?it.getLatLng():this.layerPointToLatLng(ut.layerPoint)}for(R=0;R<u.length;R++)if(u[R].fire(e,ut,!0),ut.originalEvent._stopped||u[R].options.bubblingMouseEvents===!1&&J(this._mouseEvents,e)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return zn(this._mapPane)||new Pt(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var i=t&&e!==void 0?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return i.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var o=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(o)},_latLngBoundsToNewLayerBounds:function(t,e,i){var o=this._getNewPixelOrigin(i,e);return tt([this.project(t.getSouthWest(),e)._subtract(o),this.project(t.getNorthWest(),e)._subtract(o),this.project(t.getSouthEast(),e)._subtract(o),this.project(t.getNorthEast(),e)._subtract(o)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var o=this.project(t,e),u=this.getSize().divideBy(2),y=new Q(o.subtract(u),o.add(u)),R=this._getBoundsOffset(y,i,e);return Math.abs(R.x)<=1&&Math.abs(R.y)<=1?t:this.unproject(o.add(R),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),o=new Q(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(o,e))},_getBoundsOffset:function(t,e,i){var o=tt(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),u=o.min.subtract(t.min),y=o.max.subtract(t.max),R=this._rebound(u.x,-y.x),it=this._rebound(u.y,-y.y);return new Pt(R,it)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),o=Vt.any3d?this.options.zoomSnap:1;return o&&(t=Math.round(t/o)*o),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){be(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return(e&&e.animate)!==!0&&!this.getSize().contains(i)?!1:(this.panBy(i,e),!0)},_createAnimProxy:function(){var t=this._proxy=Ht("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var i=li,o=this._proxy.style[i];xn(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),o===this._proxy.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ve(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();xn(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var o=this.getZoomScale(e),u=this._getCenterOffset(t)._divideBy(1-1/o);return i.animate!==!0&&!this.getSize().contains(u)?!1:(Zt(function(){this._moveStart(!0,i.noMoveStart||!1)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,i,o){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,ee(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:o}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(f(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&be(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function rr(t,e){return new se(t,e)}var tn=_.extend({options:{position:"topright"},initialize:function(t){b(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),o=t._controlCorners[i];return ee(e,"leaflet-control"),i.indexOf("bottom")!==-1?o.insertBefore(e,o.firstChild):o.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ve(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),_i=function(t){return new tn(t)};se.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=Ht("div",e+"control-container",this._container);function o(u,y){var R=e+u+" "+e+y;t[u+y]=Ht("div",R,i)}o("top","left"),o("top","right"),o("bottom","left"),o("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ve(this._controlCorners[t]);ve(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var xr=tn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,o){return i<o?-1:o<i?1:0}},initialize:function(t,e,i){b(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var o in t)this._addLayer(t[o],o);for(o in e)this._addLayer(e[o],o,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return tn.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(w(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){ee(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ee(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):be(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return be(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=Ht("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),ei(e),pi(e);var o=this._section=Ht("section",t+"-list");i&&(this._map.on("click",this.collapse,this),Yt(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var u=this._layersLink=Ht("a",t+"-toggle",e);u.href="#",u.title="Layers",u.setAttribute("role","button"),Yt(u,{keydown:function(y){y.keyCode===13&&this._expandSafely()},click:function(y){ke(y),this._expandSafely()}},this),i||this.expand(),this._baseLayersList=Ht("div",t+"-base",o),this._separator=Ht("div",t+"-separator",o),this._overlaysList=Ht("div",t+"-overlays",o),e.appendChild(o)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&w(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(f(function(o,u){return this.options.sortFunction(o.layer,u.layer,o.name,u.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;fi(this._baseLayersList),fi(this._overlaysList),this._layerControlInputs=[];var t,e,i,o,u=0;for(i=0;i<this._layers.length;i++)o=this._layers[i],this._addItem(o),e=e||o.overlay,t=t||!o.overlay,u+=o.overlay?0:1;return this.options.hideSingleBase&&(t=t&&u>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(w(t.target)),i=e.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",o=document.createElement("div");return o.innerHTML=i,o.firstChild},_addItem:function(t){var e=document.createElement("label"),i=this._map.hasLayer(t.layer),o;t.overlay?(o=document.createElement("input"),o.type="checkbox",o.className="leaflet-control-layers-selector",o.defaultChecked=i):o=this._createRadioElement("leaflet-base-layers_"+w(this),i),this._layerControlInputs.push(o),o.layerId=w(t.layer),Yt(o,"click",this._onInputClick,this);var u=document.createElement("span");u.innerHTML=" "+t.name;var y=document.createElement("span");e.appendChild(y),y.appendChild(o),y.appendChild(u);var R=t.overlay?this._overlaysList:this._baseLayersList;return R.appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,e,i,o=[],u=[];this._handlingClick=!0;for(var y=t.length-1;y>=0;y--)e=t[y],i=this._getLayer(e.layerId).layer,e.checked?o.push(i):e.checked||u.push(i);for(y=0;y<u.length;y++)this._map.hasLayer(u[y])&&this._map.removeLayer(u[y]);for(y=0;y<o.length;y++)this._map.hasLayer(o[y])||this._map.addLayer(o[y]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,e,i,o=this._map.getZoom(),u=t.length-1;u>=0;u--)e=t[u],i=this._getLayer(e.layerId).layer,e.disabled=i.options.minZoom!==void 0&&o<i.options.minZoom||i.options.maxZoom!==void 0&&o>i.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Yt(t,"click",ke),this.expand();var e=this;setTimeout(function(){fe(t,"click",ke),e._preventClick=!1})}}),or=function(t,e,i){return new xr(t,e,i)},gi=tn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=Ht("div",e+" leaflet-bar"),o=this.options;return this._zoomInButton=this._createButton(o.zoomInText,o.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(o.zoomOutText,o.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,o,u){var y=Ht("a",i,o);return y.innerHTML=t,y.href="#",y.title=e,y.setAttribute("role","button"),y.setAttribute("aria-label",e),ei(y),Yt(y,"click",Qe),Yt(y,"click",u,this),Yt(y,"click",this._refocusOnMap,this),y},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";be(this._zoomInButton,e),be(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(ee(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(ee(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});se.mergeOptions({zoomControl:!0}),se.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new gi,this.addControl(this.zoomControl))});var kr=function(t){return new gi(t)},vi=tn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=Ht("div",e),o=this.options;return this._addScales(o,e+"-line",i),t.on(o.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=Ht("div",e,i)),t.imperial&&(this._iScale=Ht("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e=t*3.2808399,i,o,u;e>5280?(i=e/5280,o=this._getRoundNum(i),this._updateScale(this._iScale,o+" mi",o/i)):(u=this._getRoundNum(e),this._updateScale(this._iScale,u+" ft",u/e))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),Mi=function(t){return new vi(t)},Ni='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Di=tn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Vt.inlineSvg?Ni+" ":"")+"Leaflet</a>"},initialize:function(t){b(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=Ht("div","leaflet-control-attribution"),ei(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(' <span aria-hidden="true">|</span> ')}}});se.mergeOptions({attributionControl:!0}),se.addInitHook(function(){this.options.attributionControl&&new Di().addTo(this)});var Hr=function(t){return new Di(t)};tn.Layers=xr,tn.Zoom=gi,tn.Scale=vi,tn.Attribution=Di,_i.layers=or,_i.zoom=kr,_i.scale=Mi,_i.attribution=Hr;var Ze=_.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ze.addTo=function(t,e){return t.addHandler(e,this),this};var sr={Events:Nt},Ri=Vt.touch?"touchstart mousedown":"mousedown",ln=pt.extend({options:{clickTolerance:3},initialize:function(t,e,i,o){b(this,o),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(Yt(this._dragStartTarget,Ri,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ln._dragging===this&&this.finishDrag(!0),fe(this._dragStartTarget,Ri,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!Oi(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){ln._dragging===this&&this.finishDrag();return}if(!(ln._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(ln._dragging=this,this._preventOutline&&In(this._element),Ai(),Bn(),!this._moving)){this.fire("down");var e=t.touches?t.touches[0]:t,i=kn(this._element);this._startPoint=new Pt(e.clientX,e.clientY),this._startPos=zn(this._element),this._parentScale=Bi(i);var o=t.type==="mousedown";Yt(document,o?"mousemove":"touchmove",this._onMove,this),Yt(document,o?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var e=t.touches&&t.touches.length===1?t.touches[0]:t,i=new Pt(e.clientX,e.clientY)._subtract(this._startPoint);!i.x&&!i.y||Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,ke(t),this._moved||(this.fire("dragstart"),this._moved=!0,ee(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ee(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ye(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){be(document.body,"leaflet-dragging"),this._lastTarget&&(be(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),fe(document,"mousemove touchmove",this._onMove,this),fe(document,"mouseup touchend touchcancel",this._onUp,this),tr(),Qn();var e=this._moved&&this._moving;this._moving=!1,ln._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Zi(t,e,i){var o,u=[1,4,2,8],y,R,it,ut,Tt,qt,Qt,ue;for(y=0,qt=t.length;y<qt;y++)t[y]._code=hn(t[y],e);for(it=0;it<4;it++){for(Qt=u[it],o=[],y=0,qt=t.length,R=qt-1;y<qt;R=y++)ut=t[y],Tt=t[R],ut._code&Qt?Tt._code&Qt||(ue=ri(Tt,ut,Qt,e,i),ue._code=hn(ue,e),o.push(ue)):(Tt._code&Qt&&(ue=ri(Tt,ut,Qt,e,i),ue._code=hn(ue,e),o.push(ue)),o.push(ut));t=o}return t}function Ce(t,e){var i,o,u,y,R,it,ut,Tt,qt;if(!t||t.length===0)throw new Error("latlngs not passed");He(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Qt=zt([0,0]),ue=Et(t),We=ue.getNorthWest().distanceTo(ue.getSouthWest())*ue.getNorthEast().distanceTo(ue.getNorthWest());We<1700&&(Qt=Un(t));var De=t.length,dn=[];for(i=0;i<De;i++){var Ye=zt(t[i]);dn.push(e.project(zt([Ye.lat-Qt.lat,Ye.lng-Qt.lng])))}for(it=ut=Tt=0,i=0,o=De-1;i<De;o=i++)u=dn[i],y=dn[o],R=u.y*y.x-y.y*u.x,ut+=(u.x+y.x)*R,Tt+=(u.y+y.y)*R,it+=R*3;it===0?qt=dn[0]:qt=[ut/it,Tt/it];var Ui=e.unproject(gt(qt));return zt([Ui.lat+Qt.lat,Ui.lng+Qt.lng])}function Un(t){for(var e=0,i=0,o=0,u=0;u<t.length;u++){var y=zt(t[u]);e+=y.lat,i+=y.lng,o++}return zt([e/o,i/o])}var yi={__proto__:null,clipPolygon:Zi,polygonCenter:Ce,centroid:Un};function ar(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=ur(t,i),t=Sr(t,i),t}function bi(t,e,i){return Math.sqrt(oi(t,e,i,!0))}function Pr(t,e,i){return oi(t,e,i)}function Sr(t,e){var i=t.length,o=typeof Uint8Array<"u"?Uint8Array:Array,u=new o(i);u[0]=u[i-1]=1,ii(t,u,e,0,i-1);var y,R=[];for(y=0;y<i;y++)u[y]&&R.push(t[y]);return R}function ii(t,e,i,o,u){var y=0,R,it,ut;for(it=o+1;it<=u-1;it++)ut=oi(t[it],t[o],t[u],!0),ut>y&&(R=it,y=ut);y>i&&(e[R]=1,ii(t,e,i,o,R),ii(t,e,i,R,u))}function ur(t,e){for(var i=[t[0]],o=1,u=0,y=t.length;o<y;o++)cr(t[o],t[u])>e&&(i.push(t[o]),u=o);return u<y-1&&i.push(t[y-1]),i}var Mn;function Fi(t,e,i,o,u){var y=o?Mn:hn(t,i),R=hn(e,i),it,ut,Tt;for(Mn=R;;){if(!(y|R))return[t,e];if(y&R)return!1;it=y||R,ut=ri(t,e,it,i,u),Tt=hn(ut,i),it===y?(t=ut,y=Tt):(e=ut,R=Tt)}}function ri(t,e,i,o,u){var y=e.x-t.x,R=e.y-t.y,it=o.min,ut=o.max,Tt,qt;return i&8?(Tt=t.x+y*(ut.y-t.y)/R,qt=ut.y):i&4?(Tt=t.x+y*(it.y-t.y)/R,qt=it.y):i&2?(Tt=ut.x,qt=t.y+R*(ut.x-t.x)/y):i&1&&(Tt=it.x,qt=t.y+R*(it.x-t.x)/y),new Pt(Tt,qt,u)}function hn(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function cr(t,e){var i=e.x-t.x,o=e.y-t.y;return i*i+o*o}function oi(t,e,i,o){var u=e.x,y=e.y,R=i.x-u,it=i.y-y,ut=R*R+it*it,Tt;return ut>0&&(Tt=((t.x-u)*R+(t.y-y)*it)/ut,Tt>1?(u=i.x,y=i.y):Tt>0&&(u+=R*Tt,y+=it*Tt)),R=t.x-u,it=t.y-y,o?R*R+it*it:new Pt(u,y)}function He(t){return!j(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function ji(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),He(t)}function wi(t,e){var i,o,u,y,R,it,ut,Tt;if(!t||t.length===0)throw new Error("latlngs not passed");He(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var qt=zt([0,0]),Qt=Et(t),ue=Qt.getNorthWest().distanceTo(Qt.getSouthWest())*Qt.getNorthEast().distanceTo(Qt.getNorthWest());ue<1700&&(qt=Un(t));var We=t.length,De=[];for(i=0;i<We;i++){var dn=zt(t[i]);De.push(e.project(zt([dn.lat-qt.lat,dn.lng-qt.lng])))}for(i=0,o=0;i<We-1;i++)o+=De[i].distanceTo(De[i+1])/2;if(o===0)Tt=De[0];else for(i=0,y=0;i<We-1;i++)if(R=De[i],it=De[i+1],u=R.distanceTo(it),y+=u,y>o){ut=(y-o)/u,Tt=[it.x-ut*(it.x-R.x),it.y-ut*(it.y-R.y)];break}var Ye=e.unproject(gt(Tt));return zt([Ye.lat+qt.lat,Ye.lng+qt.lng])}var Gr={__proto__:null,simplify:ar,pointToSegmentDistance:bi,closestPointOnSegment:Pr,clipSegment:Fi,_getEdgeIntersection:ri,_getBitCode:hn,_sqClosestPointOnSegment:oi,isFlat:He,_flat:ji,polylineCenter:wi},xi={project:function(t){return new Pt(t.lng,t.lat)},unproject:function(t){return new ht(t.y,t.x)},bounds:new Q([-180,-90],[180,90])},ki={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Q([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var e=Math.PI/180,i=this.R,o=t.lat*e,u=this.R_MINOR/i,y=Math.sqrt(1-u*u),R=y*Math.sin(o),it=Math.tan(Math.PI/4-o/2)/Math.pow((1-R)/(1+R),y/2);return o=-i*Math.log(Math.max(it,1e-10)),new Pt(t.lng*e*i,o)},unproject:function(t){for(var e=180/Math.PI,i=this.R,o=this.R_MINOR/i,u=Math.sqrt(1-o*o),y=Math.exp(-t.y/i),R=Math.PI/2-2*Math.atan(y),it=0,ut=.1,Tt;it<15&&Math.abs(ut)>1e-7;it++)Tt=u*Math.sin(R),Tt=Math.pow((1-Tt)/(1+Tt),u/2),ut=Math.PI/2-2*Math.atan(y*Tt)-R,R+=ut;return new ht(R*e,t.x*e/i)}},Vr={__proto__:null,LonLat:xi,Mercator:ki,SphericalMercator:oe},Tr=v({},Dt,{code:"EPSG:3395",projection:ki,transformation:function(){var t=.5/(Math.PI*ki.R);return Xt(t,.5,-t,.5)}()}),Lr=v({},Dt,{code:"EPSG:4326",projection:xi,transformation:Xt(1/180,1,-1/180,.5)}),Er=v({},ne,{projection:xi,transformation:Xt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,o=e.lat-t.lat;return Math.sqrt(i*i+o*o)},infinite:!0});ne.Earth=Dt,ne.EPSG3395=Tr,ne.EPSG3857=he,ne.EPSG900913=h,ne.EPSG4326=Lr,ne.Simple=Er;var Ge=pt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[w(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[w(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});se.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=w(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=w(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return w(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){t=t?j(t)?t:[t]:[];for(var e=0,i=t.length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[w(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=w(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var o in this._zoomBoundLayers){var u=this._zoomBoundLayers[o].options;t=u.minZoom===void 0?t:Math.min(t,u.minZoom),e=u.maxZoom===void 0?e:Math.max(e,u.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var si=Ge.extend({initialize:function(t,e){b(this,e),this._layers={};var i,o;if(t)for(i=0,o=t.length;i<o;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){var e=typeof t=="number"?t:this.getLayerId(t);return e in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e=Array.prototype.slice.call(arguments,1),i,o;for(i in this._layers)o=this._layers[i],o[t]&&o[t].apply(o,e);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return w(t)}}),Cr=function(t,e){return new si(t,e)},en=si.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),si.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),si.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new Ft;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),Or=function(t,e){return new en(t,e)},Kn=_.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){b(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var o=this._createImg(i,e&&e.tagName==="IMG"?e:null);return this._setIconStyles(o,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),o},_setIconStyles:function(t,e){var i=this.options,o=i[e+"Size"];typeof o=="number"&&(o=[o,o]);var u=gt(o),y=gt(e==="shadow"&&i.shadowAnchor||i.iconAnchor||u&&u.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),y&&(t.style.marginLeft=-y.x+"px",t.style.marginTop=-y.y+"px"),u&&(t.style.width=u.x+"px",t.style.height=u.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return Vt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Yr(t){return new Kn(t)}var Pi=Kn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof Pi.imagePath!="string"&&(Pi.imagePath=this._detectIconPath()),(this.options.imagePath||Pi.imagePath)+Kn.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(i,o,u){var y=o.exec(i);return y&&y[u]};return t=e(t,/^url\((['"])?(.+)\1\)$/,2),t&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=Ht("div","leaflet-default-icon-path",document.body),e=Xn(t,"background-image")||Xn(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e),e)return e;var i=document.querySelector('link[href$="leaflet.css"]');return i?i.href.substring(0,i.href.length-11-1):""}}),Ar=Ze.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new ln(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ee(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&be(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,o=this._marker.options.autoPanSpeed,u=this._marker.options.autoPanPadding,y=zn(e._icon),R=i.getPixelBounds(),it=i.getPixelOrigin(),ut=tt(R.min._subtract(it).add(u),R.max._subtract(it).subtract(u));if(!ut.contains(y)){var Tt=gt((Math.max(ut.max.x,y.x)-ut.max.x)/(R.max.x-ut.max.x)-(Math.min(ut.min.x,y.x)-ut.min.x)/(R.min.x-ut.min.x),(Math.max(ut.max.y,y.y)-ut.max.y)/(R.max.y-ut.max.y)-(Math.min(ut.min.y,y.y)-ut.min.y)/(R.min.y-ut.min.y)).multiplyBy(o);i.panBy(Tt,{animate:!1}),this._draggable._newPos._add(Tt),this._draggable._startPos._add(Tt),ye(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=Zt(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(N(this._panRequest),this._panRequest=Zt(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,o=zn(e._icon),u=e._map.layerPointToLatLng(o);i&&ye(i,o),e._latlng=u,t.latlng=u,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){N(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Wn=Ge.extend({options:{icon:new Pi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){b(this,e),this._latlng=zt(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=zt(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),o=!1;i!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(i.title=t.title),i.tagName==="IMG"&&(i.alt=t.alt||"")),ee(i,e),t.keyboard&&(i.tabIndex="0",i.setAttribute("role","button")),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Yt(i,"focus",this._panOnFocus,this);var u=t.icon.createShadow(this._shadow),y=!1;u!==this._shadow&&(this._removeShadow(),y=!0),u&&(ee(u,e),u.alt=""),this._shadow=u,t.opacity<1&&this._updateOpacity(),o&&this.getPane().appendChild(this._icon),this._initInteraction(),u&&y&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&fe(this._icon,"focus",this._panOnFocus,this),ve(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ve(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ye(this._icon,t),this._shadow&&ye(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(ee(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ar)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ar(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&ze(this._icon,t),this._shadow&&ze(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,i=e.iconSize?gt(e.iconSize):gt(0,0),o=e.iconAnchor?gt(e.iconAnchor):gt(0,0);t.panInside(this._latlng,{paddingTopLeft:o,paddingBottomRight:i.subtract(o)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Pn(t,e){return new Wn(t,e)}var pe=Ge.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return b(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),qn=pe.extend({options:{fill:!0,radius:10},initialize:function(t,e){b(this,e),this._latlng=zt(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=zt(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return pe.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),o=[t+i,e+i];this._pxBounds=new Q(this._point.subtract(o),this._point.add(o))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ve(t,e){return new qn(t,e)}var lr=qn.extend({initialize:function(t,e,i){if(typeof e=="number"&&(e=v({},i,{radius:e})),b(this,e),this._latlng=zt(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new Ft(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:pe.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,o=i.options.crs;if(o.distance===Dt.distance){var u=Math.PI/180,y=this._mRadius/Dt.R/u,R=i.project([e+y,t]),it=i.project([e-y,t]),ut=R.add(it).divideBy(2),Tt=i.unproject(ut).lat,qt=Math.acos((Math.cos(y*u)-Math.sin(e*u)*Math.sin(Tt*u))/(Math.cos(e*u)*Math.cos(Tt*u)))/u;(isNaN(qt)||qt===0)&&(qt=y/Math.cos(Math.PI/180*e)),this._point=ut.subtract(i.getPixelOrigin()),this._radius=isNaN(qt)?0:ut.x-i.project([Tt,t-qt]).x,this._radiusY=ut.y-R.y}else{var Qt=o.unproject(o.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(Qt).x}this._updateBounds()}});function hr(t,e,i){return new lr(t,e,i)}var fn=pe.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){b(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e=1/0,i=null,o=oi,u,y,R=0,it=this._parts.length;R<it;R++)for(var ut=this._parts[R],Tt=1,qt=ut.length;Tt<qt;Tt++){u=ut[Tt-1],y=ut[Tt];var Qt=o(t,u,y,!0);Qt<e&&(e=Qt,i=o(t,u,y))}return i&&(i.distance=Math.sqrt(e)),i},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return wi(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=zt(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new Ft,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return He(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=He(t),o=0,u=t.length;o<u;o++)i?(e[o]=zt(t[o]),this._bounds.extend(e[o])):e[o]=this._convertLatLngs(t[o]);return e},_project:function(){var t=new Q;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new Pt(t,t);this._rawPxBounds&&(this._pxBounds=new Q([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,i){var o=t[0]instanceof ht,u=t.length,y,R;if(o){for(R=[],y=0;y<u;y++)R[y]=this._map.latLngToLayerPoint(t[y]),i.extend(R[y]);e.push(R)}else for(y=0;y<u;y++)this._projectLatlngs(t[y],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var e=this._parts,i,o,u,y,R,it,ut;for(i=0,u=0,y=this._rings.length;i<y;i++)for(ut=this._rings[i],o=0,R=ut.length;o<R-1;o++)it=Fi(ut[o],ut[o+1],t,o,!0),it&&(e[u]=e[u]||[],e[u].push(it[0]),(it[1]!==ut[o+1]||o===R-2)&&(e[u].push(it[1]),u++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,o=t.length;i<o;i++)t[i]=ar(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,o,u,y,R,it,ut=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,y=this._parts.length;i<y;i++)for(it=this._parts[i],o=0,R=it.length,u=R-1;o<R;u=o++)if(!(!e&&o===0)&&bi(t,it[u],it[o])<=ut)return!0;return!1}});function Hn(t,e){return new fn(t,e)}fn._flat=ji;var Nn=fn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ce(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=fn.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof ht&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){fn.prototype._setLatLngs.call(this,t),He(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return He(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new Pt(e,e);if(t=new Q(t.min.subtract(i),t.max.add(i)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var o=0,u=this._rings.length,y;o<u;o++)y=Zi(this._rings[o],t,!0),y.length&&this._parts.push(y)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e=!1,i,o,u,y,R,it,ut,Tt;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(y=0,ut=this._parts.length;y<ut;y++)for(i=this._parts[y],R=0,Tt=i.length,it=Tt-1;R<Tt;it=R++)o=i[R],u=i[it],o.y>t.y!=u.y>t.y&&t.x<(u.x-o.x)*(t.y-o.y)/(u.y-o.y)+o.x&&(e=!e);return e||fn.prototype._containsPoint.call(this,t,!0)}});function ai(t,e){return new Nn(t,e)}var Ie=en.extend({initialize:function(t,e){b(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e=j(t)?t:t.features,i,o,u;if(e){for(i=0,o=e.length;i<o;i++)u=e[i],(u.geometries||u.geometry||u.features||u.coordinates)&&this.addData(u);return this}var y=this.options;if(y.filter&&!y.filter(t))return this;var R=Si(t,y);return R?(R.feature=S(t),R.defaultOptions=R.options,this.resetStyle(R),y.onEachFeature&&y.onEachFeature(t,R),this.addLayer(R)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=v({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){t.setStyle&&(typeof e=="function"&&(e=e(t.feature)),t.setStyle(e))}});function Si(t,e){var i=t.type==="Feature"?t.geometry:t,o=i?i.coordinates:null,u=[],y=e&&e.pointToLayer,R=e&&e.coordsToLatLng||r,it,ut,Tt,qt;if(!o&&!i)return null;switch(i.type){case"Point":return it=R(o),n(y,t,it,e);case"MultiPoint":for(Tt=0,qt=o.length;Tt<qt;Tt++)it=R(o[Tt]),u.push(n(y,t,it,e));return new en(u);case"LineString":case"MultiLineString":return ut=s(o,i.type==="LineString"?0:1,R),new fn(ut,e);case"Polygon":case"MultiPolygon":return ut=s(o,i.type==="Polygon"?1:2,R),new Nn(ut,e);case"GeometryCollection":for(Tt=0,qt=i.geometries.length;Tt<qt;Tt++){var Qt=Si({geometry:i.geometries[Tt],type:"Feature",properties:t.properties},e);Qt&&u.push(Qt)}return new en(u);case"FeatureCollection":for(Tt=0,qt=i.features.length;Tt<qt;Tt++){var ue=Si(i.features[Tt],e);ue&&u.push(ue)}return new en(u);default:throw new Error("Invalid GeoJSON object.")}}function n(t,e,i,o){return t?t(e,i):new Wn(i,o&&o.markersInheritOptions&&o)}function r(t){return new ht(t[1],t[0],t[2])}function s(t,e,i){for(var o=[],u=0,y=t.length,R;u<y;u++)R=e?s(t[u],e-1,i):(i||r)(t[u]),o.push(R);return o}function a(t,e){return t=zt(t),t.alt!==void 0?[z(t.lng,e),z(t.lat,e),z(t.alt,e)]:[z(t.lng,e),z(t.lat,e)]}function l(t,e,i,o){for(var u=[],y=0,R=t.length;y<R;y++)u.push(e?l(t[y],He(t[y])?0:e-1,i,o):a(t[y],o));return!e&&i&&u.length>0&&u.push(u[0].slice()),u}function d(t,e){return t.feature?v({},t.feature,{geometry:e}):S(e)}function S(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var M={toGeoJSON:function(t){return d(this,{type:"Point",coordinates:a(this.getLatLng(),t)})}};Wn.include(M),lr.include(M),qn.include(M),fn.include({toGeoJSON:function(t){var e=!He(this._latlngs),i=l(this._latlngs,e?1:0,!1,t);return d(this,{type:(e?"Multi":"")+"LineString",coordinates:i})}}),Nn.include({toGeoJSON:function(t){var e=!He(this._latlngs),i=e&&!He(this._latlngs[0]),o=l(this._latlngs,i?2:e?1:0,!0,t);return e||(o=[o]),d(this,{type:(i?"Multi":"")+"Polygon",coordinates:o})}}),si.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(i){e.push(i.toGeoJSON(t).geometry.coordinates)}),d(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(e==="MultiPoint")return this.toMultiPoint(t);var i=e==="GeometryCollection",o=[];return this.eachLayer(function(u){if(u.toGeoJSON){var y=u.toGeoJSON(t);if(i)o.push(y.geometry);else{var R=S(y);R.type==="FeatureCollection"?o.push.apply(o,R.features):o.push(R)}}}),i?d(this,{geometries:o,type:"GeometryCollection"}):{type:"FeatureCollection",features:o}}});function U(t,e){return new Ie(t,e)}var K=U,Y=Ge.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=Et(e),b(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ee(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ve(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&wn(this._image),this},bringToBack:function(){return this._map&&un(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=Et(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",e=this._image=t?this._url:Ht("img");if(ee(e,"leaflet-image-layer"),this._zoomAnimated&&ee(e,"leaflet-zoom-animated"),this.options.className&&ee(e,this.options.className),e.onselectstart=P,e.onmousemove=P,e.onload=f(this.fire,this,"load"),e.onerror=f(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(e.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=e.src;return}e.src=this._url,e.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;xn(this._image,i,e)},_reset:function(){var t=this._image,e=new Q(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();ye(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){ze(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Z=function(t,e,i){return new Y(t,e,i)},$=Y.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",e=this._image=t?this._url:Ht("video");if(ee(e,"leaflet-image-layer"),this._zoomAnimated&&ee(e,"leaflet-zoom-animated"),this.options.className&&ee(e,this.options.className),e.onselectstart=P,e.onmousemove=P,e.onloadeddata=f(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),o=[],u=0;u<i.length;u++)o.push(i[u].src);this._url=i.length>0?o:[e.src];return}j(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var y=0;y<this._url.length;y++){var R=Ht("source");R.src=this._url[y],e.appendChild(R)}}});function W(t,e,i){return new $(t,e,i)}var H=Y.extend({_initImage:function(){var t=this._image=this._url;ee(t,"leaflet-image-layer"),this._zoomAnimated&&ee(t,"leaflet-zoom-animated"),this.options.className&&ee(t,this.options.className),t.onselectstart=P,t.onmousemove=P}});function G(t,e,i){return new H(t,e,i)}var V=Ge.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof ht||j(t))?(this._latlng=zt(t),b(this,e)):(b(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&ze(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&ze(this._container,1),this.bringToFront(),this.options.interactive&&(ee(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(ze(this._container,0),this._removeTimeout=setTimeout(f(ve,void 0,this._container),200)):ve(this._container),this.options.interactive&&(be(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=zt(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&wn(this._container),this},bringToBack:function(){return this._map&&un(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof en){e=null;var i=this._source._layers;for(var o in i)if(i[o]._map){e=i[o];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else if(e.getBounds)t=e.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof e=="string")t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=gt(this.options.offset),i=this._getAnchor();this._zoomAnimated?ye(this._container,t.add(i)):e=e.add(t).add(i);var o=this._containerBottom=-e.y,u=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=o+"px",this._container.style.left=u+"px"}},_getAnchor:function(){return[0,0]}});se.include({_initOverlay:function(t,e,i,o){var u=e;return u instanceof t||(u=new t(o).setContent(e)),i&&u.setLatLng(i),u}}),Ge.include({_initOverlay:function(t,e,i,o){var u=i;return u instanceof t?(b(u,o),u._source=this):(u=e&&!o?e:new t(o,this),u.setContent(i)),u}});var et=V.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,V.prototype.openOn.call(this,t)},onAdd:function(t){V.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof pe||this._source.on("preclick",Be))},onRemove:function(t){V.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof pe||this._source.off("preclick",Be))},getEvents:function(){var t=V.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=Ht("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=Ht("div",t+"-content-wrapper",e);if(this._contentNode=Ht("div",t+"-content",i),ei(e),pi(this._contentNode),Yt(e,"contextmenu",Be),this._tipContainer=Ht("div",t+"-tip-container",e),this._tip=Ht("div",t+"-tip",this._tipContainer),this.options.closeButton){var o=this._closeButton=Ht("a",t+"-close-button",e);o.setAttribute("role","button"),o.setAttribute("aria-label","Close popup"),o.href="#close",o.innerHTML='<span aria-hidden="true">&#215;</span>',Yt(o,"click",function(u){ke(u),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var o=t.offsetHeight,u=this.options.maxHeight,y="leaflet-popup-scrolled";u&&o>u?(e.height=u+"px",ee(t,y)):be(t,y),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();ye(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,e=parseInt(Xn(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,o=this._containerWidth,u=new Pt(this._containerLeft,-i-this._containerBottom);u._add(zn(this._container));var y=t.layerPointToContainerPoint(u),R=gt(this.options.autoPanPadding),it=gt(this.options.autoPanPaddingTopLeft||R),ut=gt(this.options.autoPanPaddingBottomRight||R),Tt=t.getSize(),qt=0,Qt=0;y.x+o+ut.x>Tt.x&&(qt=y.x+o-Tt.x+ut.x),y.x-qt-it.x<0&&(qt=y.x-it.x),y.y+i+ut.y>Tt.y&&(Qt=y.y+i-Tt.y+ut.y),y.y-Qt-it.y<0&&(Qt=y.y-it.y),(qt||Qt)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([qt,Qt]))}},_getAnchor:function(){return gt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ot=function(t,e){return new et(t,e)};se.mergeOptions({closePopupOnClick:!0}),se.include({openPopup:function(t,e,i){return this._initOverlay(et,t,e,i).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),Ge.include({bindPopup:function(t,e){return this._popup=this._initOverlay(et,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof en||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){Qe(t);var e=t.layer||t.target;if(this._popup._source===e&&!(e instanceof pe)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=e,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var ft=V.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){V.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){V.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=V.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ht("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+w(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,i,o=this._map,u=this._container,y=o.latLngToContainerPoint(o.getCenter()),R=o.layerPointToContainerPoint(t),it=this.options.direction,ut=u.offsetWidth,Tt=u.offsetHeight,qt=gt(this.options.offset),Qt=this._getAnchor();it==="top"?(e=ut/2,i=Tt):it==="bottom"?(e=ut/2,i=0):it==="center"?(e=ut/2,i=Tt/2):it==="right"?(e=0,i=Tt/2):it==="left"?(e=ut,i=Tt/2):R.x<y.x?(it="right",e=0,i=Tt/2):(it="left",e=ut+(qt.x+Qt.x)*2,i=Tt/2),t=t.subtract(gt(e,i,!0)).add(qt).add(Qt),be(u,"leaflet-tooltip-right"),be(u,"leaflet-tooltip-left"),be(u,"leaflet-tooltip-top"),be(u,"leaflet-tooltip-bottom"),ee(u,"leaflet-tooltip-"+it),ye(u,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&ze(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return gt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),bt=function(t,e){return new ft(t,e)};se.include({openTooltip:function(t,e,i){return this._initOverlay(ft,t,e,i).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Ge.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ft,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,i.click=this._openTooltip,this._map?this._addFocusListeners():i.add=this._addFocusListeners),this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof en||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&(Yt(e,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),Yt(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",function(){e._openOnceFlag=!1,e._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var e=t.latlng,i,o;this._tooltip.options.sticky&&t.originalEvent&&(i=this._map.mouseEventToContainerPoint(t.originalEvent),o=this._map.containerPointToLayerPoint(i),e=this._map.layerPointToLatLng(o)),this._tooltip.setLatLng(e)}});var At=Kn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&t.tagName==="DIV"?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(fi(e),e.appendChild(i.html)):e.innerHTML=i.html!==!1?i.html:"",i.bgPos){var o=gt(i.bgPos);e.style.backgroundPosition=-o.x+"px "+-o.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function Rt(t){return new At(t)}Kn.Default=Pi;var Ct=Ge.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Vt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){b(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ve(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(wn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(un(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=D(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof Pt?t:new Pt(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e=this.getPane().children,i=-t(-1/0,1/0),o=0,u=e.length,y;o<u;o++)y=e[o].style.zIndex,e[o]!==this._container&&y&&(i=t(i,+y));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Vt.ielt9){ze(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var o in this._tiles){var u=this._tiles[o];if(!(!u.current||!u.loaded)){var y=Math.min(1,(t-u.loaded)/200);ze(u.el,y),y<1?e=!0:(u.active?i=!0:this._onOpaqueTile(u),u.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(N(this._fadeFrame),this._fadeFrame=Zt(this._updateOpacity,this))}},_onOpaqueTile:P,_initContainer:function(){this._container||(this._container=Ht("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t!==void 0){for(var i in this._levels)i=Number(i),this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(ve(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var o=this._levels[t],u=this._map;return o||(o=this._levels[t]={},o.el=Ht("div","leaflet-tile-container leaflet-zoom-animated",this._container),o.el.style.zIndex=e,o.origin=u.project(u.unproject(u.getPixelOrigin()),t).round(),o.zoom=t,this._setZoomTransform(o,u.getCenter(),u.getZoom()),P(o.el.offsetWidth),this._onCreateLevel(o)),this._level=o,o}},_onUpdateLevel:P,_onRemoveLevel:P,_onCreateLevel:P,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var o=e.coords;this._retainParent(o.x,o.y,o.z,o.z-5)||this._retainChildren(o.x,o.y,o.z,o.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ve(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,o){var u=Math.floor(t/2),y=Math.floor(e/2),R=i-1,it=new Pt(+u,+y);it.z=+R;var ut=this._tileCoordsToKey(it),Tt=this._tiles[ut];return Tt&&Tt.active?(Tt.retain=!0,!0):(Tt&&Tt.loaded&&(Tt.retain=!0),R>o?this._retainParent(u,y,R,o):!1)},_retainChildren:function(t,e,i,o){for(var u=2*t;u<2*t+2;u++)for(var y=2*e;y<2*e+2;y++){var R=new Pt(u,y);R.z=i+1;var it=this._tileCoordsToKey(R),ut=this._tiles[it];if(ut&&ut.active){ut.retain=!0;continue}else ut&&ut.loaded&&(ut.retain=!0);i+1<o&&this._retainChildren(u,y,i+1,o)}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return e.minNativeZoom!==void 0&&t<e.minNativeZoom?e.minNativeZoom:e.maxNativeZoom!==void 0&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,o){var u=Math.round(e);this.options.maxZoom!==void 0&&u>this.options.maxZoom||this.options.minZoom!==void 0&&u<this.options.minZoom?u=void 0:u=this._clampZoom(u);var y=this.options.updateWhenZooming&&u!==this._tileZoom;(!o||y)&&(this._tileZoom=u,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),u!==void 0&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var o=this._map.getZoomScale(i,t.zoom),u=t.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(e,i)).round();Vt.any3d?xn(t.el,u,o):ye(t.el,u)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),o=this._tileZoom,u=this._map.getPixelWorldBounds(this._tileZoom);u&&(this._globalTileRange=this._pxBoundsToTileRange(u)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],o).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],o).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],o).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],o).y/i.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),o=e.getZoomScale(i,this._tileZoom),u=e.project(t,this._tileZoom).floor(),y=e.getSize().divideBy(o*2);return new Q(u.subtract(y),u.add(y))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(t===void 0&&(t=e.getCenter()),this._tileZoom!==void 0){var o=this._getTiledPixelBounds(t),u=this._pxBoundsToTileRange(o),y=u.getCenter(),R=[],it=this.options.keepBuffer,ut=new Q(u.getBottomLeft().subtract([it,-it]),u.getTopRight().add([it,-it]));if(!(isFinite(u.min.x)&&isFinite(u.min.y)&&isFinite(u.max.x)&&isFinite(u.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Tt in this._tiles){var qt=this._tiles[Tt].coords;(qt.z!==this._tileZoom||!ut.contains(new Pt(qt.x,qt.y)))&&(this._tiles[Tt].current=!1)}if(Math.abs(i-this._tileZoom)>1){this._setView(t,i);return}for(var Qt=u.min.y;Qt<=u.max.y;Qt++)for(var ue=u.min.x;ue<=u.max.x;ue++){var We=new Pt(ue,Qt);if(We.z=this._tileZoom,!!this._isValidTile(We)){var De=this._tiles[this._tileCoordsToKey(We)];De?De.current=!0:R.push(We)}}if(R.sort(function(Ye,Ui){return Ye.distanceTo(y)-Ui.distanceTo(y)}),R.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var dn=document.createDocumentFragment();for(ue=0;ue<R.length;ue++)this._addTile(R[ue],dn);this._level.el.appendChild(dn)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var o=this._tileCoordsToBounds(t);return Et(this.options.bounds).overlaps(o)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),o=t.scaleBy(i),u=o.add(i),y=e.unproject(o,t.z),R=e.unproject(u,t.z);return[y,R]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new Ft(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new Pt(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(ve(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ee(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=P,t.onmousemove=P,Vt.ielt9&&this.options.opacity<1&&ze(t,this.options.opacity)},_addTile:function(t,e){var i=this._getTilePos(t),o=this._tileCoordsToKey(t),u=this.createTile(this._wrapCoords(t),f(this._tileReady,this,t));this._initTile(u),this.createTile.length<2&&Zt(f(this._tileReady,this,t,null,u)),ye(u,i),this._tiles[o]={el:u,coords:t,current:!0},e.appendChild(u),this.fire("tileloadstart",{tile:u,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var o=this._tileCoordsToKey(t);i=this._tiles[o],i&&(i.loaded=+new Date,this._map._fadeAnimated?(ze(i.el,0),N(this._fadeFrame),this._fadeFrame=Zt(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(ee(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Vt.ielt9||!this._map._fadeAnimated?Zt(this._pruneTiles,this):setTimeout(f(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new Pt(this._wrapX?F(t.x,this._wrapX):t.x,this._wrapY?F(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new Q(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Bt(t){return new Ct(t)}var It=Ct.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,e=b(this,e),e.detectRetina&&Vt.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),typeof e.subdomains=="string"&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&e===void 0&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return Yt(i,"load",f(this._tileOnLoad,this,e,i)),Yt(i,"error",f(this._tileOnError,this,e,i)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(i.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(i.referrerPolicy=this.options.referrerPolicy),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){var e={r:Vt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return I(this._url,v(e,this.options))},_tileOnLoad:function(t,e){Vt.ielt9?setTimeout(f(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var o=this.options.errorTileUrl;o&&e.getAttribute("src")!==o&&(e.src=o),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,i=this.options.zoomReverse,o=this.options.zoomOffset;return i&&(t=e-t),t+o},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=P,e.onerror=P,!e.complete)){e.src=X;var i=this._tiles[t].coords;ve(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:i})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",X),Ct.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(!(!this._map||i&&i.getAttribute("src")===X))return Ct.prototype._tileReady.call(this,t,e,i)}});function Mt(t,e){return new It(t,e)}var Wt=It.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=v({},this.defaultWmsParams);for(var o in e)o in this.options||(i[o]=e[o]);e=b(this,e);var u=e.detectRetina&&Vt.retina?2:1,y=this.getTileSize();i.width=y.x*u,i.height=y.y*u,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,It.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,o=tt(i.project(e[0]),i.project(e[1])),u=o.min,y=o.max,R=(this._wmsVersion>=1.3&&this._crs===Lr?[u.y,u.x,y.y,y.x]:[u.x,u.y,y.x,y.y]).join(","),it=It.prototype.getTileUrl.call(this,t);return it+O(this.wmsParams,it,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+R},setParams:function(t,e){return v(this.wmsParams,t),e||this.redraw(),this}});function te(t,e){return new Wt(t,e)}It.WMS=Wt,Mt.wms=te;var Jt=Ge.extend({options:{padding:.1},initialize:function(t){b(this,t),w(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ee(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),o=this._map.getSize().multiplyBy(.5+this.options.padding),u=this._map.project(this._center,e),y=o.multiplyBy(-i).add(u).subtract(this._map._getNewPixelOrigin(t,e));Vt.any3d?xn(this._container,y,i):ye(this._container,y)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new Q(i,i.add(e.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),re=Jt.extend({options:{tolerance:0},getEvents:function(){var t=Jt.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Jt.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Yt(t,"mousemove",this._onMouseMove,this),Yt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Yt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){N(this._redrawRequest),delete this._ctx,ve(this._container),fe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var e in this._layers)t=this._layers[e],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Jt.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),o=Vt.retina?2:1;ye(e,t.min),e.width=o*i.x,e.height=o*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Vt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Jt.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[w(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,o=e.prev;i?i.prev=o:this._drawLast=o,o?o.next=i:this._drawFirst=i,delete t._order,delete this._layers[w(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var e=t.options.dashArray.split(/[, ]+/),i=[],o,u;for(u=0;u<e.length;u++){if(o=Number(e[u]),isNaN(o))return;i.push(o)}t.options._dashArray=i}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||Zt(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Q,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var o=this._drawFirst;o;o=o.next)t=o.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,o,u,y,R=t._parts,it=R.length,ut=this._ctx;if(it){for(ut.beginPath(),i=0;i<it;i++){for(o=0,u=R[i].length;o<u;o++)y=R[i][o],ut[o?"lineTo":"moveTo"](y.x,y.y);e&&ut.closePath()}this._fillStroke(ut,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var e=t._point,i=this._ctx,o=Math.max(Math.round(t._radius),1),u=(Math.max(Math.round(t._radiusY),1)||o)/o;u!==1&&(i.save(),i.scale(1,u)),i.beginPath(),i.arc(e.x,e.y/u,o,0,Math.PI*2,!1),u!==1&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&i.weight!==0&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e=this._map.mouseEventToLayerPoint(t),i,o,u=this._drawFirst;u;u=u.next)i=u.layer,i.options.interactive&&i._containsPoint(e)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(i))&&(o=i);this._fireEvent(o?[o]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(be(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var i,o,u=this._drawFirst;u;u=u.next)i=u.layer,i.options.interactive&&i._containsPoint(e)&&(o=i);o!==this._hoveredLayer&&(this._handleMouseOut(t),o&&(ee(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseover"),this._hoveredLayer=o)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(f(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,o=e.prev;if(i)i.prev=o;else return;o?o.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t)}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,o=e.prev;if(o)o.next=i;else return;i?i.prev=o:o&&(this._drawLast=o),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t)}}});function Fe(t){return Vt.canvas?new re(t):null}var $t=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Me={_initContainer:function(){this._container=Ht("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Jt.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=$t("shape");ee(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=$t("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[w(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ve(e),t.removeInteractiveTarget(e),delete this._layers[w(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,o=t.options,u=t._container;u.stroked=!!o.stroke,u.filled=!!o.fill,o.stroke?(e||(e=t._stroke=$t("stroke")),u.appendChild(e),e.weight=o.weight+"px",e.color=o.color,e.opacity=o.opacity,o.dashArray?e.dashStyle=j(o.dashArray)?o.dashArray.join(" "):o.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=o.lineCap.replace("butt","flat"),e.joinstyle=o.lineJoin):e&&(u.removeChild(e),t._stroke=null),o.fill?(i||(i=t._fill=$t("fill")),u.appendChild(i),i.color=o.fillColor||o.color,i.opacity=o.fillOpacity):i&&(u.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),o=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+o+" 0,"+65535*360)},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){wn(t._container)},_bringToBack:function(t){un(t._container)}},Pe=Vt.vml?$t:dt,Dn=Jt.extend({_initContainer:function(){this._container=Pe("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Pe("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ve(this._container),fe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Jt.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;(!this._svgSize||!this._svgSize.equals(e))&&(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),ye(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=Pe("path");t.options.className&&ee(e,t.options.className),t.options.interactive&&ee(e,"leaflet-interactive"),this._updateStyle(t),this._layers[w(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ve(t._path),t.removeInteractiveTarget(t._path),delete this._layers[w(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,st(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),o=Math.max(Math.round(t._radiusY),1)||i,u="a"+i+","+o+" 0 1,0 ",y=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+u+i*2+",0 "+u+-i*2+",0 ";this._setPath(t,y)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){wn(t._path)},_bringToBack:function(t){un(t._path)}});Vt.vml&&Dn.include(Me);function Ne(t){return Vt.svg||Vt.vml?new Dn(t):null}se.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var e=this._paneRenderers[t];return e===void 0&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&Fe(t)||Ne(t)}});var Rn=Nn.extend({initialize:function(t,e){Nn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=Et(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function fr(t,e){return new Rn(t,e)}Dn.create=Pe,Dn.pointsToPath=st,Ie.geometryToLayer=Si,Ie.coordsToLatLng=r,Ie.coordsToLatLngs=s,Ie.latLngToCoords=a,Ie.latLngsToCoords=l,Ie.getFeature=d,Ie.asFeature=S,se.mergeOptions({boxZoom:!0});var ho=Ze.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Yt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){fe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ve(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Bn(),Ai(),this._startPoint=this._map.mouseEventToContainerPoint(t),Yt(document,{contextmenu:Qe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Ht("div","leaflet-zoom-box",this._container),ee(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new Q(this._point,this._startPoint),i=e.getSize();ye(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(ve(this._box),be(this._container,"leaflet-crosshair")),Qn(),tr(),fe(document,{contextmenu:Qe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(f(this._resetState,this),0);var e=new Ft(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});se.addInitHook("addHandler","boxZoom",ho),se.mergeOptions({doubleClickZoom:!0});var fo=Ze.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),o=e.options.zoomDelta,u=t.originalEvent.shiftKey?i-o:i+o;e.options.doubleClickZoom==="center"?e.setZoom(u):e.setZoomAround(t.containerPoint,u)}});se.addInitHook("addHandler","doubleClickZoom",fo),se.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var po=Ze.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new ln(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ee(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){be(this._map._container,"leaflet-grab"),be(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=Et(this._map.options.maxBounds);this._offsetLimit=tt(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,o=this._draggable._newPos.x,u=(o-e+i)%t+e-i,y=(o+e+i)%t-e-i,R=Math.abs(u+i)<Math.abs(y+i)?u:y;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=R},_onDragEnd:function(t){var e=this._map,i=e.options,o=!i.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),o)e.fire("moveend");else{this._prunePositions(+new Date);var u=this._lastPos.subtract(this._positions[0]),y=(this._lastTime-this._times[0])/1e3,R=i.easeLinearity,it=u.multiplyBy(R/y),ut=it.distanceTo([0,0]),Tt=Math.min(i.inertiaMaxSpeed,ut),qt=it.multiplyBy(Tt/ut),Qt=Tt/(i.inertiaDeceleration*R),ue=qt.multiplyBy(-Qt/2).round();!ue.x&&!ue.y?e.fire("moveend"):(ue=e._limitOffset(ue,e.options.maxBounds),Zt(function(){e.panBy(ue,{duration:Qt,easeLinearity:R,noMoveStart:!0,animate:!0})}))}}});se.addInitHook("addHandler","dragging",po),se.mergeOptions({keyboard:!0,keyboardPanDelta:80});var mo=Ze.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Yt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),fe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,o=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(o,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e=this._panKeys={},i=this.keyCodes,o,u;for(o=0,u=i.left.length;o<u;o++)e[i.left[o]]=[-1*t,0];for(o=0,u=i.right.length;o<u;o++)e[i.right[o]]=[t,0];for(o=0,u=i.down.length;o<u;o++)e[i.down[o]]=[0,t];for(o=0,u=i.up.length;o<u;o++)e[i.up[o]]=[0,-1*t]},_setZoomDelta:function(t){var e=this._zoomKeys={},i=this.keyCodes,o,u;for(o=0,u=i.zoomIn.length;o<u;o++)e[i.zoomIn[o]]=t;for(o=0,u=i.zoomOut.length;o<u;o++)e[i.zoomOut[o]]=-t},_addHooks:function(){Yt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){fe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=t.keyCode,i=this._map,o;if(e in this._panKeys){if(!i._panAnim||!i._panAnim._inProgress)if(o=this._panKeys[e],t.shiftKey&&(o=gt(o).multiplyBy(3)),i.options.maxBounds&&(o=i._limitOffset(gt(o),i.options.maxBounds)),i.options.worldCopyJump){var u=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(o)));i.panTo(u)}else i.panBy(o)}else if(e in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else if(e===27&&i._popup&&i._popup.options.closeOnEscapeKey)i.closePopup();else return;Qe(t)}}});se.addInitHook("addHandler","keyboard",mo),se.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _o=Ze.extend({addHooks:function(){Yt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){fe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=ni(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var o=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(f(this._performZoom,this),o),Qe(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var o=this._delta/(this._map.options.wheelPxPerZoomLevel*4),u=4*Math.log(2/(1+Math.exp(-Math.abs(o))))/Math.LN2,y=i?Math.ceil(u/i)*i:u,R=t._limitZoom(e+(this._delta>0?y:-y))-e;this._delta=0,this._startTime=null,R&&(t.options.scrollWheelZoom==="center"?t.setZoom(e+R):t.setZoomAround(this._lastMousePos,e+R))}});se.addInitHook("addHandler","scrollWheelZoom",_o);var qo=600;se.mergeOptions({tapHold:Vt.touchNative&&Vt.safari&&Vt.mobile,tapTolerance:15});var go=Ze.extend({addHooks:function(){Yt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){fe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var e=t.touches[0];this._startPos=this._newPos=new Pt(e.clientX,e.clientY),this._holdTimeout=setTimeout(f(function(){this._cancel(),this._isTapValid()&&(Yt(document,"touchend",ke),Yt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))},this),qo),Yt(document,"touchend touchcancel contextmenu",this._cancel,this),Yt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){fe(document,"touchend",ke),fe(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),fe(document,"touchend touchcancel contextmenu",this._cancel,this),fe(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new Pt(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var i=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});i._simulated=!0,e.target.dispatchEvent(i)}});se.addInitHook("addHandler","tapHold",go),se.mergeOptions({touchZoom:Vt.touch,bounceAtZoomLimits:!0});var vo=Ze.extend({addHooks:function(){ee(this._map._container,"leaflet-touch-zoom"),Yt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){be(this._map._container,"leaflet-touch-zoom"),fe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(!(!t.touches||t.touches.length!==2||e._animatingZoom||this._zooming)){var i=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),e.options.touchZoom!=="center"&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(o)._divideBy(2))),this._startDist=i.distanceTo(o),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Yt(document,"touchmove",this._onTouchMove,this),Yt(document,"touchend touchcancel",this._onTouchEnd,this),ke(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]),u=i.distanceTo(o)/this._startDist;if(this._zoom=e.getScaleZoom(u,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&u<1||this._zoom>e.getMaxZoom()&&u>1)&&(this._zoom=e._limitZoom(this._zoom)),e.options.touchZoom==="center"){if(this._center=this._startLatLng,u===1)return}else{var y=i._add(o)._divideBy(2)._subtract(this._centerPoint);if(u===1&&y.x===0&&y.y===0)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(y),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),N(this._animRequest);var R=f(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Zt(R,this,!0),ke(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,N(this._animRequest),fe(document,"touchmove",this._onTouchMove,this),fe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});se.addInitHook("addHandler","touchZoom",vo),se.BoxZoom=ho,se.DoubleClickZoom=fo,se.Drag=po,se.Keyboard=mo,se.ScrollWheelZoom=_o,se.TapHold=go,se.TouchZoom=vo,c.Bounds=Q,c.Browser=Vt,c.CRS=ne,c.Canvas=re,c.Circle=lr,c.CircleMarker=qn,c.Class=_,c.Control=tn,c.DivIcon=At,c.DivOverlay=V,c.DomEvent=qr,c.DomUtil=wr,c.Draggable=ln,c.Evented=pt,c.FeatureGroup=en,c.GeoJSON=Ie,c.GridLayer=Ct,c.Handler=Ze,c.Icon=Kn,c.ImageOverlay=Y,c.LatLng=ht,c.LatLngBounds=Ft,c.Layer=Ge,c.LayerGroup=si,c.LineUtil=Gr,c.Map=se,c.Marker=Wn,c.Mixin=sr,c.Path=pe,c.Point=Pt,c.PolyUtil=yi,c.Polygon=Nn,c.Polyline=fn,c.Popup=et,c.PosAnimation=mi,c.Projection=Vr,c.Rectangle=Rn,c.Renderer=Jt,c.SVG=Dn,c.SVGOverlay=H,c.TileLayer=It,c.Tooltip=ft,c.Transformation=ce,c.Util=ct,c.VideoOverlay=$,c.bind=f,c.bounds=tt,c.canvas=Fe,c.circle=hr,c.circleMarker=Ve,c.control=_i,c.divIcon=Rt,c.extend=v,c.featureGroup=Or,c.geoJSON=U,c.geoJson=K,c.gridLayer=Bt,c.icon=Yr,c.imageOverlay=Z,c.latLng=zt,c.latLngBounds=Et,c.layerGroup=Cr,c.map=rr,c.marker=Pn,c.point=gt,c.polygon=ai,c.polyline=Hn,c.popup=ot,c.rectangle=fr,c.setOptions=b,c.stamp=w,c.svg=Ne,c.svgOverlay=G,c.tileLayer=Mt,c.tooltip=bt,c.transformation=Xt,c.version=x,c.videoOverlay=W;var Ho=window.L;c.noConflict=function(){return window.L=Ho,this},window.L=c})})(to,to.exports);var qs=to.exports;const Xe=io(qs);function Br(g){throw new Error('Could not dynamically require "'+g+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Do={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(g,A){(function(c){g.exports=c()})(function(){return function c(x,v,p){function f(D,F){if(!v[D]){if(!x[D]){var P=typeof Br=="function"&&Br;if(!F&&P)return P(D,!0);if(m)return m(D,!0);var z=new Error("Cannot find module '"+D+"'");throw z.code="MODULE_NOT_FOUND",z}var k=v[D]={exports:{}};x[D][0].call(k.exports,function(C){var b=x[D][1][C];return f(b||C)},k,k.exports,c,x,v,p)}return v[D].exports}for(var m=typeof Br=="function"&&Br,w=0;w<p.length;w++)f(p[w]);return f}({1:[function(c,x,v){var p=c("./utils"),f=c("./support"),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";v.encode=function(w){for(var D,F,P,z,k,C,b,O=[],T=0,I=w.length,j=I,J=p.getTypeOf(w)!=="string";T<w.length;)j=I-T,P=J?(D=w[T++],F=T<I?w[T++]:0,T<I?w[T++]:0):(D=w.charCodeAt(T++),F=T<I?w.charCodeAt(T++):0,T<I?w.charCodeAt(T++):0),z=D>>2,k=(3&D)<<4|F>>4,C=1<j?(15&F)<<2|P>>6:64,b=2<j?63&P:64,O.push(m.charAt(z)+m.charAt(k)+m.charAt(C)+m.charAt(b));return O.join("")},v.decode=function(w){var D,F,P,z,k,C,b=0,O=0,T="data:";if(w.substr(0,T.length)===T)throw new Error("Invalid base64 input, it looks like a data url.");var I,j=3*(w=w.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(w.charAt(w.length-1)===m.charAt(64)&&j--,w.charAt(w.length-2)===m.charAt(64)&&j--,j%1!=0)throw new Error("Invalid base64 input, bad content length.");for(I=f.uint8array?new Uint8Array(0|j):new Array(0|j);b<w.length;)D=m.indexOf(w.charAt(b++))<<2|(z=m.indexOf(w.charAt(b++)))>>4,F=(15&z)<<4|(k=m.indexOf(w.charAt(b++)))>>2,P=(3&k)<<6|(C=m.indexOf(w.charAt(b++))),I[O++]=D,k!==64&&(I[O++]=F),C!==64&&(I[O++]=P);return I}},{"./support":30,"./utils":32}],2:[function(c,x,v){var p=c("./external"),f=c("./stream/DataWorker"),m=c("./stream/Crc32Probe"),w=c("./stream/DataLengthProbe");function D(F,P,z,k,C){this.compressedSize=F,this.uncompressedSize=P,this.crc32=z,this.compression=k,this.compressedContent=C}D.prototype={getContentWorker:function(){var F=new f(p.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new w("data_length")),P=this;return F.on("end",function(){if(this.streamInfo.data_length!==P.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),F},getCompressedWorker:function(){return new f(p.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},D.createWorkerFrom=function(F,P,z){return F.pipe(new m).pipe(new w("uncompressedSize")).pipe(P.compressWorker(z)).pipe(new w("compressedSize")).withStreamInfo("compression",P)},x.exports=D},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(c,x,v){var p=c("./stream/GenericWorker");v.STORE={magic:"\0\0",compressWorker:function(){return new p("STORE compression")},uncompressWorker:function(){return new p("STORE decompression")}},v.DEFLATE=c("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(c,x,v){var p=c("./utils"),f=function(){for(var m,w=[],D=0;D<256;D++){m=D;for(var F=0;F<8;F++)m=1&m?3988292384^m>>>1:m>>>1;w[D]=m}return w}();x.exports=function(m,w){return m!==void 0&&m.length?p.getTypeOf(m)!=="string"?function(D,F,P,z){var k=f,C=z+P;D^=-1;for(var b=z;b<C;b++)D=D>>>8^k[255&(D^F[b])];return-1^D}(0|w,m,m.length,0):function(D,F,P,z){var k=f,C=z+P;D^=-1;for(var b=z;b<C;b++)D=D>>>8^k[255&(D^F.charCodeAt(b))];return-1^D}(0|w,m,m.length,0):0}},{"./utils":32}],5:[function(c,x,v){v.base64=!1,v.binary=!1,v.dir=!1,v.createFolders=!0,v.date=null,v.compression=null,v.compressionOptions=null,v.comment=null,v.unixPermissions=null,v.dosPermissions=null},{}],6:[function(c,x,v){var p=null;p=typeof Promise<"u"?Promise:c("lie"),x.exports={Promise:p}},{lie:37}],7:[function(c,x,v){var p=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",f=c("pako"),m=c("./utils"),w=c("./stream/GenericWorker"),D=p?"uint8array":"array";function F(P,z){w.call(this,"FlateWorker/"+P),this._pako=null,this._pakoAction=P,this._pakoOptions=z,this.meta={}}v.magic="\b\0",m.inherits(F,w),F.prototype.processChunk=function(P){this.meta=P.meta,this._pako===null&&this._createPako(),this._pako.push(m.transformTo(D,P.data),!1)},F.prototype.flush=function(){w.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},F.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this._pako=null},F.prototype._createPako=function(){this._pako=new f[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var P=this;this._pako.onData=function(z){P.push({data:z,meta:P.meta})}},v.compressWorker=function(P){return new F("Deflate",P)},v.uncompressWorker=function(){return new F("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(c,x,v){function p(k,C){var b,O="";for(b=0;b<C;b++)O+=String.fromCharCode(255&k),k>>>=8;return O}function f(k,C,b,O,T,I){var j,J,X=k.file,lt=k.compression,rt=I!==D.utf8encode,wt=m.transformTo("string",I(X.name)),at=m.transformTo("string",D.utf8encode(X.name)),xt=X.comment,Zt=m.transformTo("string",I(xt)),N=m.transformTo("string",D.utf8encode(xt)),ct=at.length!==X.name.length,_=N.length!==xt.length,mt="",Nt="",pt="",Pt=X.dir,kt=X.date,gt={crc32:0,compressedSize:0,uncompressedSize:0};C&&!b||(gt.crc32=k.crc32,gt.compressedSize=k.compressedSize,gt.uncompressedSize=k.uncompressedSize);var Q=0;C&&(Q|=8),rt||!ct&&!_||(Q|=2048);var tt=0,Ft=0;Pt&&(tt|=16),T==="UNIX"?(Ft=798,tt|=function(ht,zt){var ne=ht;return ht||(ne=zt?16893:33204),(65535&ne)<<16}(X.unixPermissions,Pt)):(Ft=20,tt|=function(ht){return 63&(ht||0)}(X.dosPermissions)),j=kt.getUTCHours(),j<<=6,j|=kt.getUTCMinutes(),j<<=5,j|=kt.getUTCSeconds()/2,J=kt.getUTCFullYear()-1980,J<<=4,J|=kt.getUTCMonth()+1,J<<=5,J|=kt.getUTCDate(),ct&&(Nt=p(1,1)+p(F(wt),4)+at,mt+="up"+p(Nt.length,2)+Nt),_&&(pt=p(1,1)+p(F(Zt),4)+N,mt+="uc"+p(pt.length,2)+pt);var Et="";return Et+=`
\0`,Et+=p(Q,2),Et+=lt.magic,Et+=p(j,2),Et+=p(J,2),Et+=p(gt.crc32,4),Et+=p(gt.compressedSize,4),Et+=p(gt.uncompressedSize,4),Et+=p(wt.length,2),Et+=p(mt.length,2),{fileRecord:P.LOCAL_FILE_HEADER+Et+wt+mt,dirRecord:P.CENTRAL_FILE_HEADER+p(Ft,2)+Et+p(Zt.length,2)+"\0\0\0\0"+p(tt,4)+p(O,4)+wt+mt+Zt}}var m=c("../utils"),w=c("../stream/GenericWorker"),D=c("../utf8"),F=c("../crc32"),P=c("../signature");function z(k,C,b,O){w.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=C,this.zipPlatform=b,this.encodeFileName=O,this.streamFiles=k,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}m.inherits(z,w),z.prototype.push=function(k){var C=k.meta.percent||0,b=this.entriesCount,O=this._sources.length;this.accumulate?this.contentBuffer.push(k):(this.bytesWritten+=k.data.length,w.prototype.push.call(this,{data:k.data,meta:{currentFile:this.currentFile,percent:b?(C+100*(b-O-1))/b:100}}))},z.prototype.openedSource=function(k){this.currentSourceOffset=this.bytesWritten,this.currentFile=k.file.name;var C=this.streamFiles&&!k.file.dir;if(C){var b=f(k,C,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},z.prototype.closedSource=function(k){this.accumulate=!1;var C=this.streamFiles&&!k.file.dir,b=f(k,C,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),C)this.push({data:function(O){return P.DATA_DESCRIPTOR+p(O.crc32,4)+p(O.compressedSize,4)+p(O.uncompressedSize,4)}(k),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},z.prototype.flush=function(){for(var k=this.bytesWritten,C=0;C<this.dirRecords.length;C++)this.push({data:this.dirRecords[C],meta:{percent:100}});var b=this.bytesWritten-k,O=function(T,I,j,J,X){var lt=m.transformTo("string",X(J));return P.CENTRAL_DIRECTORY_END+"\0\0\0\0"+p(T,2)+p(T,2)+p(I,4)+p(j,4)+p(lt.length,2)+lt}(this.dirRecords.length,b,k,this.zipComment,this.encodeFileName);this.push({data:O,meta:{percent:100}})},z.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},z.prototype.registerPrevious=function(k){this._sources.push(k);var C=this;return k.on("data",function(b){C.processChunk(b)}),k.on("end",function(){C.closedSource(C.previous.streamInfo),C._sources.length?C.prepareNextSource():C.end()}),k.on("error",function(b){C.error(b)}),this},z.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},z.prototype.error=function(k){var C=this._sources;if(!w.prototype.error.call(this,k))return!1;for(var b=0;b<C.length;b++)try{C[b].error(k)}catch{}return!0},z.prototype.lock=function(){w.prototype.lock.call(this);for(var k=this._sources,C=0;C<k.length;C++)k[C].lock()},x.exports=z},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(c,x,v){var p=c("../compressions"),f=c("./ZipFileWorker");v.generateWorker=function(m,w,D){var F=new f(w.streamFiles,D,w.platform,w.encodeFileName),P=0;try{m.forEach(function(z,k){P++;var C=function(I,j){var J=I||j,X=p[J];if(!X)throw new Error(J+" is not a valid compression method !");return X}(k.options.compression,w.compression),b=k.options.compressionOptions||w.compressionOptions||{},O=k.dir,T=k.date;k._compressWorker(C,b).withStreamInfo("file",{name:z,dir:O,date:T,comment:k.comment||"",unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions}).pipe(F)}),F.entriesCount=P}catch(z){F.error(z)}return F}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(c,x,v){function p(){if(!(this instanceof p))return new p;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var f=new p;for(var m in this)typeof this[m]!="function"&&(f[m]=this[m]);return f}}(p.prototype=c("./object")).loadAsync=c("./load"),p.support=c("./support"),p.defaults=c("./defaults"),p.version="3.10.1",p.loadAsync=function(f,m){return new p().loadAsync(f,m)},p.external=c("./external"),x.exports=p},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(c,x,v){var p=c("./utils"),f=c("./external"),m=c("./utf8"),w=c("./zipEntries"),D=c("./stream/Crc32Probe"),F=c("./nodejsUtils");function P(z){return new f.Promise(function(k,C){var b=z.decompressed.getContentWorker().pipe(new D);b.on("error",function(O){C(O)}).on("end",function(){b.streamInfo.crc32!==z.decompressed.crc32?C(new Error("Corrupted zip : CRC32 mismatch")):k()}).resume()})}x.exports=function(z,k){var C=this;return k=p.extend(k||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:m.utf8decode}),F.isNode&&F.isStream(z)?f.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):p.prepareContent("the loaded zip file",z,!0,k.optimizedBinaryString,k.base64).then(function(b){var O=new w(k);return O.load(b),O}).then(function(b){var O=[f.Promise.resolve(b)],T=b.files;if(k.checkCRC32)for(var I=0;I<T.length;I++)O.push(P(T[I]));return f.Promise.all(O)}).then(function(b){for(var O=b.shift(),T=O.files,I=0;I<T.length;I++){var j=T[I],J=j.fileNameStr,X=p.resolve(j.fileNameStr);C.file(X,j.decompressed,{binary:!0,optimizedBinaryString:!0,date:j.date,dir:j.dir,comment:j.fileCommentStr.length?j.fileCommentStr:null,unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions,createFolders:k.createFolders}),j.dir||(C.file(X).unsafeOriginalName=J)}return O.zipComment.length&&(C.comment=O.zipComment),C})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(c,x,v){var p=c("../utils"),f=c("../stream/GenericWorker");function m(w,D){f.call(this,"Nodejs stream input adapter for "+w),this._upstreamEnded=!1,this._bindStream(D)}p.inherits(m,f),m.prototype._bindStream=function(w){var D=this;(this._stream=w).pause(),w.on("data",function(F){D.push({data:F,meta:{percent:0}})}).on("error",function(F){D.isPaused?this.generatedError=F:D.error(F)}).on("end",function(){D.isPaused?D._upstreamEnded=!0:D.end()})},m.prototype.pause=function(){return!!f.prototype.pause.call(this)&&(this._stream.pause(),!0)},m.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},x.exports=m},{"../stream/GenericWorker":28,"../utils":32}],13:[function(c,x,v){var p=c("readable-stream").Readable;function f(m,w,D){p.call(this,w),this._helper=m;var F=this;m.on("data",function(P,z){F.push(P)||F._helper.pause(),D&&D(z)}).on("error",function(P){F.emit("error",P)}).on("end",function(){F.push(null)})}c("../utils").inherits(f,p),f.prototype._read=function(){this._helper.resume()},x.exports=f},{"../utils":32,"readable-stream":16}],14:[function(c,x,v){x.exports={isNode:typeof Buffer<"u",newBufferFrom:function(p,f){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(p,f);if(typeof p=="number")throw new Error('The "data" argument must not be a number');return new Buffer(p,f)},allocBuffer:function(p){if(Buffer.alloc)return Buffer.alloc(p);var f=new Buffer(p);return f.fill(0),f},isBuffer:function(p){return Buffer.isBuffer(p)},isStream:function(p){return p&&typeof p.on=="function"&&typeof p.pause=="function"&&typeof p.resume=="function"}}},{}],15:[function(c,x,v){function p(X,lt,rt){var wt,at=m.getTypeOf(lt),xt=m.extend(rt||{},F);xt.date=xt.date||new Date,xt.compression!==null&&(xt.compression=xt.compression.toUpperCase()),typeof xt.unixPermissions=="string"&&(xt.unixPermissions=parseInt(xt.unixPermissions,8)),xt.unixPermissions&&16384&xt.unixPermissions&&(xt.dir=!0),xt.dosPermissions&&16&xt.dosPermissions&&(xt.dir=!0),xt.dir&&(X=T(X)),xt.createFolders&&(wt=O(X))&&I.call(this,wt,!0);var Zt=at==="string"&&xt.binary===!1&&xt.base64===!1;rt&&rt.binary!==void 0||(xt.binary=!Zt),(lt instanceof P&&lt.uncompressedSize===0||xt.dir||!lt||lt.length===0)&&(xt.base64=!1,xt.binary=!0,lt="",xt.compression="STORE",at="string");var N=null;N=lt instanceof P||lt instanceof w?lt:C.isNode&&C.isStream(lt)?new b(X,lt):m.prepareContent(X,lt,xt.binary,xt.optimizedBinaryString,xt.base64);var ct=new z(X,N,xt);this.files[X]=ct}var f=c("./utf8"),m=c("./utils"),w=c("./stream/GenericWorker"),D=c("./stream/StreamHelper"),F=c("./defaults"),P=c("./compressedObject"),z=c("./zipObject"),k=c("./generate"),C=c("./nodejsUtils"),b=c("./nodejs/NodejsStreamInputAdapter"),O=function(X){X.slice(-1)==="/"&&(X=X.substring(0,X.length-1));var lt=X.lastIndexOf("/");return 0<lt?X.substring(0,lt):""},T=function(X){return X.slice(-1)!=="/"&&(X+="/"),X},I=function(X,lt){return lt=lt!==void 0?lt:F.createFolders,X=T(X),this.files[X]||p.call(this,X,null,{dir:!0,createFolders:lt}),this.files[X]};function j(X){return Object.prototype.toString.call(X)==="[object RegExp]"}var J={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(X){var lt,rt,wt;for(lt in this.files)wt=this.files[lt],(rt=lt.slice(this.root.length,lt.length))&&lt.slice(0,this.root.length)===this.root&&X(rt,wt)},filter:function(X){var lt=[];return this.forEach(function(rt,wt){X(rt,wt)&&lt.push(wt)}),lt},file:function(X,lt,rt){if(arguments.length!==1)return X=this.root+X,p.call(this,X,lt,rt),this;if(j(X)){var wt=X;return this.filter(function(xt,Zt){return!Zt.dir&&wt.test(xt)})}var at=this.files[this.root+X];return at&&!at.dir?at:null},folder:function(X){if(!X)return this;if(j(X))return this.filter(function(at,xt){return xt.dir&&X.test(at)});var lt=this.root+X,rt=I.call(this,lt),wt=this.clone();return wt.root=rt.name,wt},remove:function(X){X=this.root+X;var lt=this.files[X];if(lt||(X.slice(-1)!=="/"&&(X+="/"),lt=this.files[X]),lt&&!lt.dir)delete this.files[X];else for(var rt=this.filter(function(at,xt){return xt.name.slice(0,X.length)===X}),wt=0;wt<rt.length;wt++)delete this.files[rt[wt].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(X){var lt,rt={};try{if((rt=m.extend(X||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:f.utf8encode})).type=rt.type.toLowerCase(),rt.compression=rt.compression.toUpperCase(),rt.type==="binarystring"&&(rt.type="string"),!rt.type)throw new Error("No output type specified.");m.checkSupport(rt.type),rt.platform!=="darwin"&&rt.platform!=="freebsd"&&rt.platform!=="linux"&&rt.platform!=="sunos"||(rt.platform="UNIX"),rt.platform==="win32"&&(rt.platform="DOS");var wt=rt.comment||this.comment||"";lt=k.generateWorker(this,rt,wt)}catch(at){(lt=new w("error")).error(at)}return new D(lt,rt.type||"string",rt.mimeType)},generateAsync:function(X,lt){return this.generateInternalStream(X).accumulate(lt)},generateNodeStream:function(X,lt){return(X=X||{}).type||(X.type="nodebuffer"),this.generateInternalStream(X).toNodejsStream(lt)}};x.exports=J},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(c,x,v){x.exports=c("stream")},{stream:void 0}],17:[function(c,x,v){var p=c("./DataReader");function f(m){p.call(this,m);for(var w=0;w<this.data.length;w++)m[w]=255&m[w]}c("../utils").inherits(f,p),f.prototype.byteAt=function(m){return this.data[this.zero+m]},f.prototype.lastIndexOfSignature=function(m){for(var w=m.charCodeAt(0),D=m.charCodeAt(1),F=m.charCodeAt(2),P=m.charCodeAt(3),z=this.length-4;0<=z;--z)if(this.data[z]===w&&this.data[z+1]===D&&this.data[z+2]===F&&this.data[z+3]===P)return z-this.zero;return-1},f.prototype.readAndCheckSignature=function(m){var w=m.charCodeAt(0),D=m.charCodeAt(1),F=m.charCodeAt(2),P=m.charCodeAt(3),z=this.readData(4);return w===z[0]&&D===z[1]&&F===z[2]&&P===z[3]},f.prototype.readData=function(m){if(this.checkOffset(m),m===0)return[];var w=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,w},x.exports=f},{"../utils":32,"./DataReader":18}],18:[function(c,x,v){var p=c("../utils");function f(m){this.data=m,this.length=m.length,this.index=0,this.zero=0}f.prototype={checkOffset:function(m){this.checkIndex(this.index+m)},checkIndex:function(m){if(this.length<this.zero+m||m<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+m+"). Corrupted zip ?")},setIndex:function(m){this.checkIndex(m),this.index=m},skip:function(m){this.setIndex(this.index+m)},byteAt:function(){},readInt:function(m){var w,D=0;for(this.checkOffset(m),w=this.index+m-1;w>=this.index;w--)D=(D<<8)+this.byteAt(w);return this.index+=m,D},readString:function(m){return p.transformTo("string",this.readData(m))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var m=this.readInt(4);return new Date(Date.UTC(1980+(m>>25&127),(m>>21&15)-1,m>>16&31,m>>11&31,m>>5&63,(31&m)<<1))}},x.exports=f},{"../utils":32}],19:[function(c,x,v){var p=c("./Uint8ArrayReader");function f(m){p.call(this,m)}c("../utils").inherits(f,p),f.prototype.readData=function(m){this.checkOffset(m);var w=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,w},x.exports=f},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(c,x,v){var p=c("./DataReader");function f(m){p.call(this,m)}c("../utils").inherits(f,p),f.prototype.byteAt=function(m){return this.data.charCodeAt(this.zero+m)},f.prototype.lastIndexOfSignature=function(m){return this.data.lastIndexOf(m)-this.zero},f.prototype.readAndCheckSignature=function(m){return m===this.readData(4)},f.prototype.readData=function(m){this.checkOffset(m);var w=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,w},x.exports=f},{"../utils":32,"./DataReader":18}],21:[function(c,x,v){var p=c("./ArrayReader");function f(m){p.call(this,m)}c("../utils").inherits(f,p),f.prototype.readData=function(m){if(this.checkOffset(m),m===0)return new Uint8Array(0);var w=this.data.subarray(this.zero+this.index,this.zero+this.index+m);return this.index+=m,w},x.exports=f},{"../utils":32,"./ArrayReader":17}],22:[function(c,x,v){var p=c("../utils"),f=c("../support"),m=c("./ArrayReader"),w=c("./StringReader"),D=c("./NodeBufferReader"),F=c("./Uint8ArrayReader");x.exports=function(P){var z=p.getTypeOf(P);return p.checkSupport(z),z!=="string"||f.uint8array?z==="nodebuffer"?new D(P):f.uint8array?new F(p.transformTo("uint8array",P)):new m(p.transformTo("array",P)):new w(P)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(c,x,v){v.LOCAL_FILE_HEADER="PK",v.CENTRAL_FILE_HEADER="PK",v.CENTRAL_DIRECTORY_END="PK",v.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",v.ZIP64_CENTRAL_DIRECTORY_END="PK",v.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(c,x,v){var p=c("./GenericWorker"),f=c("../utils");function m(w){p.call(this,"ConvertWorker to "+w),this.destType=w}f.inherits(m,p),m.prototype.processChunk=function(w){this.push({data:f.transformTo(this.destType,w.data),meta:w.meta})},x.exports=m},{"../utils":32,"./GenericWorker":28}],25:[function(c,x,v){var p=c("./GenericWorker"),f=c("../crc32");function m(){p.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}c("../utils").inherits(m,p),m.prototype.processChunk=function(w){this.streamInfo.crc32=f(w.data,this.streamInfo.crc32||0),this.push(w)},x.exports=m},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(c,x,v){var p=c("../utils"),f=c("./GenericWorker");function m(w){f.call(this,"DataLengthProbe for "+w),this.propName=w,this.withStreamInfo(w,0)}p.inherits(m,f),m.prototype.processChunk=function(w){if(w){var D=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=D+w.data.length}f.prototype.processChunk.call(this,w)},x.exports=m},{"../utils":32,"./GenericWorker":28}],27:[function(c,x,v){var p=c("../utils"),f=c("./GenericWorker");function m(w){f.call(this,"DataWorker");var D=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,w.then(function(F){D.dataIsReady=!0,D.data=F,D.max=F&&F.length||0,D.type=p.getTypeOf(F),D.isPaused||D._tickAndRepeat()},function(F){D.error(F)})}p.inherits(m,f),m.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this.data=null},m.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,p.delay(this._tickAndRepeat,[],this)),!0)},m.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(p.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},m.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var w=null,D=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":w=this.data.substring(this.index,D);break;case"uint8array":w=this.data.subarray(this.index,D);break;case"array":case"nodebuffer":w=this.data.slice(this.index,D)}return this.index=D,this.push({data:w,meta:{percent:this.max?this.index/this.max*100:0}})},x.exports=m},{"../utils":32,"./GenericWorker":28}],28:[function(c,x,v){function p(f){this.name=f||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}p.prototype={push:function(f){this.emit("data",f)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(f){this.emit("error",f)}return!0},error:function(f){return!this.isFinished&&(this.isPaused?this.generatedError=f:(this.isFinished=!0,this.emit("error",f),this.previous&&this.previous.error(f),this.cleanUp()),!0)},on:function(f,m){return this._listeners[f].push(m),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(f,m){if(this._listeners[f])for(var w=0;w<this._listeners[f].length;w++)this._listeners[f][w].call(this,m)},pipe:function(f){return f.registerPrevious(this)},registerPrevious:function(f){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=f.streamInfo,this.mergeStreamInfo(),this.previous=f;var m=this;return f.on("data",function(w){m.processChunk(w)}),f.on("end",function(){m.end()}),f.on("error",function(w){m.error(w)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var f=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),f=!0),this.previous&&this.previous.resume(),!f},flush:function(){},processChunk:function(f){this.push(f)},withStreamInfo:function(f,m){return this.extraStreamInfo[f]=m,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var f in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,f)&&(this.streamInfo[f]=this.extraStreamInfo[f])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var f="Worker "+this.name;return this.previous?this.previous+" -> "+f:f}},x.exports=p},{}],29:[function(c,x,v){var p=c("../utils"),f=c("./ConvertWorker"),m=c("./GenericWorker"),w=c("../base64"),D=c("../support"),F=c("../external"),P=null;if(D.nodestream)try{P=c("../nodejs/NodejsStreamOutputAdapter")}catch{}function z(C,b){return new F.Promise(function(O,T){var I=[],j=C._internalType,J=C._outputType,X=C._mimeType;C.on("data",function(lt,rt){I.push(lt),b&&b(rt)}).on("error",function(lt){I=[],T(lt)}).on("end",function(){try{var lt=function(rt,wt,at){switch(rt){case"blob":return p.newBlob(p.transformTo("arraybuffer",wt),at);case"base64":return w.encode(wt);default:return p.transformTo(rt,wt)}}(J,function(rt,wt){var at,xt=0,Zt=null,N=0;for(at=0;at<wt.length;at++)N+=wt[at].length;switch(rt){case"string":return wt.join("");case"array":return Array.prototype.concat.apply([],wt);case"uint8array":for(Zt=new Uint8Array(N),at=0;at<wt.length;at++)Zt.set(wt[at],xt),xt+=wt[at].length;return Zt;case"nodebuffer":return Buffer.concat(wt);default:throw new Error("concat : unsupported type '"+rt+"'")}}(j,I),X);O(lt)}catch(rt){T(rt)}I=[]}).resume()})}function k(C,b,O){var T=b;switch(b){case"blob":case"arraybuffer":T="uint8array";break;case"base64":T="string"}try{this._internalType=T,this._outputType=b,this._mimeType=O,p.checkSupport(T),this._worker=C.pipe(new f(T)),C.lock()}catch(I){this._worker=new m("error"),this._worker.error(I)}}k.prototype={accumulate:function(C){return z(this,C)},on:function(C,b){var O=this;return C==="data"?this._worker.on(C,function(T){b.call(O,T.data,T.meta)}):this._worker.on(C,function(){p.delay(b,arguments,O)}),this},resume:function(){return p.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(C){if(p.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new P(this,{objectMode:this._outputType!=="nodebuffer"},C)}},x.exports=k},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(c,x,v){if(v.base64=!0,v.array=!0,v.string=!0,v.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",v.nodebuffer=typeof Buffer<"u",v.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")v.blob=!1;else{var p=new ArrayBuffer(0);try{v.blob=new Blob([p],{type:"application/zip"}).size===0}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);f.append(p),v.blob=f.getBlob("application/zip").size===0}catch{v.blob=!1}}}try{v.nodestream=!!c("readable-stream").Readable}catch{v.nodestream=!1}},{"readable-stream":16}],31:[function(c,x,v){for(var p=c("./utils"),f=c("./support"),m=c("./nodejsUtils"),w=c("./stream/GenericWorker"),D=new Array(256),F=0;F<256;F++)D[F]=252<=F?6:248<=F?5:240<=F?4:224<=F?3:192<=F?2:1;D[254]=D[254]=1;function P(){w.call(this,"utf-8 decode"),this.leftOver=null}function z(){w.call(this,"utf-8 encode")}v.utf8encode=function(k){return f.nodebuffer?m.newBufferFrom(k,"utf-8"):function(C){var b,O,T,I,j,J=C.length,X=0;for(I=0;I<J;I++)(64512&(O=C.charCodeAt(I)))==55296&&I+1<J&&(64512&(T=C.charCodeAt(I+1)))==56320&&(O=65536+(O-55296<<10)+(T-56320),I++),X+=O<128?1:O<2048?2:O<65536?3:4;for(b=f.uint8array?new Uint8Array(X):new Array(X),I=j=0;j<X;I++)(64512&(O=C.charCodeAt(I)))==55296&&I+1<J&&(64512&(T=C.charCodeAt(I+1)))==56320&&(O=65536+(O-55296<<10)+(T-56320),I++),O<128?b[j++]=O:(O<2048?b[j++]=192|O>>>6:(O<65536?b[j++]=224|O>>>12:(b[j++]=240|O>>>18,b[j++]=128|O>>>12&63),b[j++]=128|O>>>6&63),b[j++]=128|63&O);return b}(k)},v.utf8decode=function(k){return f.nodebuffer?p.transformTo("nodebuffer",k).toString("utf-8"):function(C){var b,O,T,I,j=C.length,J=new Array(2*j);for(b=O=0;b<j;)if((T=C[b++])<128)J[O++]=T;else if(4<(I=D[T]))J[O++]=65533,b+=I-1;else{for(T&=I===2?31:I===3?15:7;1<I&&b<j;)T=T<<6|63&C[b++],I--;1<I?J[O++]=65533:T<65536?J[O++]=T:(T-=65536,J[O++]=55296|T>>10&1023,J[O++]=56320|1023&T)}return J.length!==O&&(J.subarray?J=J.subarray(0,O):J.length=O),p.applyFromCharCode(J)}(k=p.transformTo(f.uint8array?"uint8array":"array",k))},p.inherits(P,w),P.prototype.processChunk=function(k){var C=p.transformTo(f.uint8array?"uint8array":"array",k.data);if(this.leftOver&&this.leftOver.length){if(f.uint8array){var b=C;(C=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),C.set(b,this.leftOver.length)}else C=this.leftOver.concat(C);this.leftOver=null}var O=function(I,j){var J;for((j=j||I.length)>I.length&&(j=I.length),J=j-1;0<=J&&(192&I[J])==128;)J--;return J<0||J===0?j:J+D[I[J]]>j?J:j}(C),T=C;O!==C.length&&(f.uint8array?(T=C.subarray(0,O),this.leftOver=C.subarray(O,C.length)):(T=C.slice(0,O),this.leftOver=C.slice(O,C.length))),this.push({data:v.utf8decode(T),meta:k.meta})},P.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:v.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},v.Utf8DecodeWorker=P,p.inherits(z,w),z.prototype.processChunk=function(k){this.push({data:v.utf8encode(k.data),meta:k.meta})},v.Utf8EncodeWorker=z},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(c,x,v){var p=c("./support"),f=c("./base64"),m=c("./nodejsUtils"),w=c("./external");function D(b){return b}function F(b,O){for(var T=0;T<b.length;++T)O[T]=255&b.charCodeAt(T);return O}c("setimmediate"),v.newBlob=function(b,O){v.checkSupport("blob");try{return new Blob([b],{type:O})}catch{try{var T=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return T.append(b),T.getBlob(O)}catch{throw new Error("Bug : can't construct the Blob.")}}};var P={stringifyByChunk:function(b,O,T){var I=[],j=0,J=b.length;if(J<=T)return String.fromCharCode.apply(null,b);for(;j<J;)O==="array"||O==="nodebuffer"?I.push(String.fromCharCode.apply(null,b.slice(j,Math.min(j+T,J)))):I.push(String.fromCharCode.apply(null,b.subarray(j,Math.min(j+T,J)))),j+=T;return I.join("")},stringifyByChar:function(b){for(var O="",T=0;T<b.length;T++)O+=String.fromCharCode(b[T]);return O},applyCanBeUsed:{uint8array:function(){try{return p.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return p.nodebuffer&&String.fromCharCode.apply(null,m.allocBuffer(1)).length===1}catch{return!1}}()}};function z(b){var O=65536,T=v.getTypeOf(b),I=!0;if(T==="uint8array"?I=P.applyCanBeUsed.uint8array:T==="nodebuffer"&&(I=P.applyCanBeUsed.nodebuffer),I)for(;1<O;)try{return P.stringifyByChunk(b,T,O)}catch{O=Math.floor(O/2)}return P.stringifyByChar(b)}function k(b,O){for(var T=0;T<b.length;T++)O[T]=b[T];return O}v.applyFromCharCode=z;var C={};C.string={string:D,array:function(b){return F(b,new Array(b.length))},arraybuffer:function(b){return C.string.uint8array(b).buffer},uint8array:function(b){return F(b,new Uint8Array(b.length))},nodebuffer:function(b){return F(b,m.allocBuffer(b.length))}},C.array={string:z,array:D,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return m.newBufferFrom(b)}},C.arraybuffer={string:function(b){return z(new Uint8Array(b))},array:function(b){return k(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:D,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return m.newBufferFrom(new Uint8Array(b))}},C.uint8array={string:z,array:function(b){return k(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:D,nodebuffer:function(b){return m.newBufferFrom(b)}},C.nodebuffer={string:z,array:function(b){return k(b,new Array(b.length))},arraybuffer:function(b){return C.nodebuffer.uint8array(b).buffer},uint8array:function(b){return k(b,new Uint8Array(b.length))},nodebuffer:D},v.transformTo=function(b,O){if(O=O||"",!b)return O;v.checkSupport(b);var T=v.getTypeOf(O);return C[T][b](O)},v.resolve=function(b){for(var O=b.split("/"),T=[],I=0;I<O.length;I++){var j=O[I];j==="."||j===""&&I!==0&&I!==O.length-1||(j===".."?T.pop():T.push(j))}return T.join("/")},v.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":p.nodebuffer&&m.isBuffer(b)?"nodebuffer":p.uint8array&&b instanceof Uint8Array?"uint8array":p.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},v.checkSupport=function(b){if(!p[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},v.MAX_VALUE_16BITS=65535,v.MAX_VALUE_32BITS=-1,v.pretty=function(b){var O,T,I="";for(T=0;T<(b||"").length;T++)I+="\\x"+((O=b.charCodeAt(T))<16?"0":"")+O.toString(16).toUpperCase();return I},v.delay=function(b,O,T){setImmediate(function(){b.apply(T||null,O||[])})},v.inherits=function(b,O){function T(){}T.prototype=O.prototype,b.prototype=new T},v.extend=function(){var b,O,T={};for(b=0;b<arguments.length;b++)for(O in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],O)&&T[O]===void 0&&(T[O]=arguments[b][O]);return T},v.prepareContent=function(b,O,T,I,j){return w.Promise.resolve(O).then(function(J){return p.blob&&(J instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(J))!==-1)&&typeof FileReader<"u"?new w.Promise(function(X,lt){var rt=new FileReader;rt.onload=function(wt){X(wt.target.result)},rt.onerror=function(wt){lt(wt.target.error)},rt.readAsArrayBuffer(J)}):J}).then(function(J){var X=v.getTypeOf(J);return X?(X==="arraybuffer"?J=v.transformTo("uint8array",J):X==="string"&&(j?J=f.decode(J):T&&I!==!0&&(J=function(lt){return F(lt,p.uint8array?new Uint8Array(lt.length):new Array(lt.length))}(J))),J):w.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(c,x,v){var p=c("./reader/readerFor"),f=c("./utils"),m=c("./signature"),w=c("./zipEntry"),D=c("./support");function F(P){this.files=[],this.loadOptions=P}F.prototype={checkSignature:function(P){if(!this.reader.readAndCheckSignature(P)){this.reader.index-=4;var z=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+f.pretty(z)+", expected "+f.pretty(P)+")")}},isSignature:function(P,z){var k=this.reader.index;this.reader.setIndex(P);var C=this.reader.readString(4)===z;return this.reader.setIndex(k),C},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var P=this.reader.readData(this.zipCommentLength),z=D.uint8array?"uint8array":"array",k=f.transformTo(z,P);this.zipComment=this.loadOptions.decodeFileName(k)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var P,z,k,C=this.zip64EndOfCentralSize-44;0<C;)P=this.reader.readInt(2),z=this.reader.readInt(4),k=this.reader.readData(z),this.zip64ExtensibleData[P]={id:P,length:z,value:k}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var P,z;for(P=0;P<this.files.length;P++)z=this.files[P],this.reader.setIndex(z.localHeaderOffset),this.checkSignature(m.LOCAL_FILE_HEADER),z.readLocalPart(this.reader),z.handleUTF8(),z.processAttributes()},readCentralDir:function(){var P;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(m.CENTRAL_FILE_HEADER);)(P=new w({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(P);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var P=this.reader.lastIndexOfSignature(m.CENTRAL_DIRECTORY_END);if(P<0)throw this.isSignature(0,m.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(P);var z=P;if(this.checkSignature(m.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,(P=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(P),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,m.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var k=this.centralDirOffset+this.centralDirSize;this.zip64&&(k+=20,k+=12+this.zip64EndOfCentralSize);var C=z-k;if(0<C)this.isSignature(z,m.CENTRAL_FILE_HEADER)||(this.reader.zero=C);else if(C<0)throw new Error("Corrupted zip: missing "+Math.abs(C)+" bytes.")},prepareReader:function(P){this.reader=p(P)},load:function(P){this.prepareReader(P),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},x.exports=F},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(c,x,v){var p=c("./reader/readerFor"),f=c("./utils"),m=c("./compressedObject"),w=c("./crc32"),D=c("./utf8"),F=c("./compressions"),P=c("./support");function z(k,C){this.options=k,this.loadOptions=C}z.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(k){var C,b;if(k.skip(22),this.fileNameLength=k.readInt(2),b=k.readInt(2),this.fileName=k.readData(this.fileNameLength),k.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((C=function(O){for(var T in F)if(Object.prototype.hasOwnProperty.call(F,T)&&F[T].magic===O)return F[T];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+f.transformTo("string",this.fileName)+")");this.decompressed=new m(this.compressedSize,this.uncompressedSize,this.crc32,C,k.readData(this.compressedSize))},readCentralPart:function(k){this.versionMadeBy=k.readInt(2),k.skip(2),this.bitFlag=k.readInt(2),this.compressionMethod=k.readString(2),this.date=k.readDate(),this.crc32=k.readInt(4),this.compressedSize=k.readInt(4),this.uncompressedSize=k.readInt(4);var C=k.readInt(2);if(this.extraFieldsLength=k.readInt(2),this.fileCommentLength=k.readInt(2),this.diskNumberStart=k.readInt(2),this.internalFileAttributes=k.readInt(2),this.externalFileAttributes=k.readInt(4),this.localHeaderOffset=k.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");k.skip(C),this.readExtraFields(k),this.parseZIP64ExtraField(k),this.fileComment=k.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var k=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),k==0&&(this.dosPermissions=63&this.externalFileAttributes),k==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var k=p(this.extraFields[1].value);this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=k.readInt(8)),this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=k.readInt(8)),this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=k.readInt(8)),this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=k.readInt(4))}},readExtraFields:function(k){var C,b,O,T=k.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});k.index+4<T;)C=k.readInt(2),b=k.readInt(2),O=k.readData(b),this.extraFields[C]={id:C,length:b,value:O};k.setIndex(T)},handleUTF8:function(){var k=P.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=D.utf8decode(this.fileName),this.fileCommentStr=D.utf8decode(this.fileComment);else{var C=this.findExtraFieldUnicodePath();if(C!==null)this.fileNameStr=C;else{var b=f.transformTo(k,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var O=this.findExtraFieldUnicodeComment();if(O!==null)this.fileCommentStr=O;else{var T=f.transformTo(k,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(T)}}},findExtraFieldUnicodePath:function(){var k=this.extraFields[28789];if(k){var C=p(k.value);return C.readInt(1)!==1||w(this.fileName)!==C.readInt(4)?null:D.utf8decode(C.readData(k.length-5))}return null},findExtraFieldUnicodeComment:function(){var k=this.extraFields[25461];if(k){var C=p(k.value);return C.readInt(1)!==1||w(this.fileComment)!==C.readInt(4)?null:D.utf8decode(C.readData(k.length-5))}return null}},x.exports=z},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(c,x,v){function p(C,b,O){this.name=C,this.dir=O.dir,this.date=O.date,this.comment=O.comment,this.unixPermissions=O.unixPermissions,this.dosPermissions=O.dosPermissions,this._data=b,this._dataBinary=O.binary,this.options={compression:O.compression,compressionOptions:O.compressionOptions}}var f=c("./stream/StreamHelper"),m=c("./stream/DataWorker"),w=c("./utf8"),D=c("./compressedObject"),F=c("./stream/GenericWorker");p.prototype={internalStream:function(C){var b=null,O="string";try{if(!C)throw new Error("No output type specified.");var T=(O=C.toLowerCase())==="string"||O==="text";O!=="binarystring"&&O!=="text"||(O="string"),b=this._decompressWorker();var I=!this._dataBinary;I&&!T&&(b=b.pipe(new w.Utf8EncodeWorker)),!I&&T&&(b=b.pipe(new w.Utf8DecodeWorker))}catch(j){(b=new F("error")).error(j)}return new f(b,O,"")},async:function(C,b){return this.internalStream(C).accumulate(b)},nodeStream:function(C,b){return this.internalStream(C||"nodebuffer").toNodejsStream(b)},_compressWorker:function(C,b){if(this._data instanceof D&&this._data.compression.magic===C.magic)return this._data.getCompressedWorker();var O=this._decompressWorker();return this._dataBinary||(O=O.pipe(new w.Utf8EncodeWorker)),D.createWorkerFrom(O,C,b)},_decompressWorker:function(){return this._data instanceof D?this._data.getContentWorker():this._data instanceof F?this._data:new m(this._data)}};for(var P=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],z=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},k=0;k<P.length;k++)p.prototype[P[k]]=z;x.exports=p},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(c,x,v){(function(p){var f,m,w=p.MutationObserver||p.WebKitMutationObserver;if(w){var D=0,F=new w(C),P=p.document.createTextNode("");F.observe(P,{characterData:!0}),f=function(){P.data=D=++D%2}}else if(p.setImmediate||p.MessageChannel===void 0)f="document"in p&&"onreadystatechange"in p.document.createElement("script")?function(){var b=p.document.createElement("script");b.onreadystatechange=function(){C(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},p.document.documentElement.appendChild(b)}:function(){setTimeout(C,0)};else{var z=new p.MessageChannel;z.port1.onmessage=C,f=function(){z.port2.postMessage(0)}}var k=[];function C(){var b,O;m=!0;for(var T=k.length;T;){for(O=k,k=[],b=-1;++b<T;)O[b]();T=k.length}m=!1}x.exports=function(b){k.push(b)!==1||m||f()}}).call(this,typeof Ti<"u"?Ti:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(c,x,v){var p=c("immediate");function f(){}var m={},w=["REJECTED"],D=["FULFILLED"],F=["PENDING"];function P(T){if(typeof T!="function")throw new TypeError("resolver must be a function");this.state=F,this.queue=[],this.outcome=void 0,T!==f&&b(this,T)}function z(T,I,j){this.promise=T,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof j=="function"&&(this.onRejected=j,this.callRejected=this.otherCallRejected)}function k(T,I,j){p(function(){var J;try{J=I(j)}catch(X){return m.reject(T,X)}J===T?m.reject(T,new TypeError("Cannot resolve promise with itself")):m.resolve(T,J)})}function C(T){var I=T&&T.then;if(T&&(typeof T=="object"||typeof T=="function")&&typeof I=="function")return function(){I.apply(T,arguments)}}function b(T,I){var j=!1;function J(rt){j||(j=!0,m.reject(T,rt))}function X(rt){j||(j=!0,m.resolve(T,rt))}var lt=O(function(){I(X,J)});lt.status==="error"&&J(lt.value)}function O(T,I){var j={};try{j.value=T(I),j.status="success"}catch(J){j.status="error",j.value=J}return j}(x.exports=P).prototype.finally=function(T){if(typeof T!="function")return this;var I=this.constructor;return this.then(function(j){return I.resolve(T()).then(function(){return j})},function(j){return I.resolve(T()).then(function(){throw j})})},P.prototype.catch=function(T){return this.then(null,T)},P.prototype.then=function(T,I){if(typeof T!="function"&&this.state===D||typeof I!="function"&&this.state===w)return this;var j=new this.constructor(f);return this.state!==F?k(j,this.state===D?T:I,this.outcome):this.queue.push(new z(j,T,I)),j},z.prototype.callFulfilled=function(T){m.resolve(this.promise,T)},z.prototype.otherCallFulfilled=function(T){k(this.promise,this.onFulfilled,T)},z.prototype.callRejected=function(T){m.reject(this.promise,T)},z.prototype.otherCallRejected=function(T){k(this.promise,this.onRejected,T)},m.resolve=function(T,I){var j=O(C,I);if(j.status==="error")return m.reject(T,j.value);var J=j.value;if(J)b(T,J);else{T.state=D,T.outcome=I;for(var X=-1,lt=T.queue.length;++X<lt;)T.queue[X].callFulfilled(I)}return T},m.reject=function(T,I){T.state=w,T.outcome=I;for(var j=-1,J=T.queue.length;++j<J;)T.queue[j].callRejected(I);return T},P.resolve=function(T){return T instanceof this?T:m.resolve(new this(f),T)},P.reject=function(T){var I=new this(f);return m.reject(I,T)},P.all=function(T){var I=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=T.length,J=!1;if(!j)return this.resolve([]);for(var X=new Array(j),lt=0,rt=-1,wt=new this(f);++rt<j;)at(T[rt],rt);return wt;function at(xt,Zt){I.resolve(xt).then(function(N){X[Zt]=N,++lt!==j||J||(J=!0,m.resolve(wt,X))},function(N){J||(J=!0,m.reject(wt,N))})}},P.race=function(T){var I=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=T.length,J=!1;if(!j)return this.resolve([]);for(var X=-1,lt=new this(f);++X<j;)rt=T[X],I.resolve(rt).then(function(wt){J||(J=!0,m.resolve(lt,wt))},function(wt){J||(J=!0,m.reject(lt,wt))});var rt;return lt}},{immediate:36}],38:[function(c,x,v){var p={};(0,c("./lib/utils/common").assign)(p,c("./lib/deflate"),c("./lib/inflate"),c("./lib/zlib/constants")),x.exports=p},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(c,x,v){var p=c("./zlib/deflate"),f=c("./utils/common"),m=c("./utils/strings"),w=c("./zlib/messages"),D=c("./zlib/zstream"),F=Object.prototype.toString,P=0,z=-1,k=0,C=8;function b(T){if(!(this instanceof b))return new b(T);this.options=f.assign({level:z,method:C,chunkSize:16384,windowBits:15,memLevel:8,strategy:k,to:""},T||{});var I=this.options;I.raw&&0<I.windowBits?I.windowBits=-I.windowBits:I.gzip&&0<I.windowBits&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var j=p.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(j!==P)throw new Error(w[j]);if(I.header&&p.deflateSetHeader(this.strm,I.header),I.dictionary){var J;if(J=typeof I.dictionary=="string"?m.string2buf(I.dictionary):F.call(I.dictionary)==="[object ArrayBuffer]"?new Uint8Array(I.dictionary):I.dictionary,(j=p.deflateSetDictionary(this.strm,J))!==P)throw new Error(w[j]);this._dict_set=!0}}function O(T,I){var j=new b(I);if(j.push(T,!0),j.err)throw j.msg||w[j.err];return j.result}b.prototype.push=function(T,I){var j,J,X=this.strm,lt=this.options.chunkSize;if(this.ended)return!1;J=I===~~I?I:I===!0?4:0,typeof T=="string"?X.input=m.string2buf(T):F.call(T)==="[object ArrayBuffer]"?X.input=new Uint8Array(T):X.input=T,X.next_in=0,X.avail_in=X.input.length;do{if(X.avail_out===0&&(X.output=new f.Buf8(lt),X.next_out=0,X.avail_out=lt),(j=p.deflate(X,J))!==1&&j!==P)return this.onEnd(j),!(this.ended=!0);X.avail_out!==0&&(X.avail_in!==0||J!==4&&J!==2)||(this.options.to==="string"?this.onData(m.buf2binstring(f.shrinkBuf(X.output,X.next_out))):this.onData(f.shrinkBuf(X.output,X.next_out)))}while((0<X.avail_in||X.avail_out===0)&&j!==1);return J===4?(j=p.deflateEnd(this.strm),this.onEnd(j),this.ended=!0,j===P):J!==2||(this.onEnd(P),!(X.avail_out=0))},b.prototype.onData=function(T){this.chunks.push(T)},b.prototype.onEnd=function(T){T===P&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg},v.Deflate=b,v.deflate=O,v.deflateRaw=function(T,I){return(I=I||{}).raw=!0,O(T,I)},v.gzip=function(T,I){return(I=I||{}).gzip=!0,O(T,I)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(c,x,v){var p=c("./zlib/inflate"),f=c("./utils/common"),m=c("./utils/strings"),w=c("./zlib/constants"),D=c("./zlib/messages"),F=c("./zlib/zstream"),P=c("./zlib/gzheader"),z=Object.prototype.toString;function k(b){if(!(this instanceof k))return new k(b);this.options=f.assign({chunkSize:16384,windowBits:0,to:""},b||{});var O=this.options;O.raw&&0<=O.windowBits&&O.windowBits<16&&(O.windowBits=-O.windowBits,O.windowBits===0&&(O.windowBits=-15)),!(0<=O.windowBits&&O.windowBits<16)||b&&b.windowBits||(O.windowBits+=32),15<O.windowBits&&O.windowBits<48&&!(15&O.windowBits)&&(O.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new F,this.strm.avail_out=0;var T=p.inflateInit2(this.strm,O.windowBits);if(T!==w.Z_OK)throw new Error(D[T]);this.header=new P,p.inflateGetHeader(this.strm,this.header)}function C(b,O){var T=new k(O);if(T.push(b,!0),T.err)throw T.msg||D[T.err];return T.result}k.prototype.push=function(b,O){var T,I,j,J,X,lt,rt=this.strm,wt=this.options.chunkSize,at=this.options.dictionary,xt=!1;if(this.ended)return!1;I=O===~~O?O:O===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof b=="string"?rt.input=m.binstring2buf(b):z.call(b)==="[object ArrayBuffer]"?rt.input=new Uint8Array(b):rt.input=b,rt.next_in=0,rt.avail_in=rt.input.length;do{if(rt.avail_out===0&&(rt.output=new f.Buf8(wt),rt.next_out=0,rt.avail_out=wt),(T=p.inflate(rt,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&at&&(lt=typeof at=="string"?m.string2buf(at):z.call(at)==="[object ArrayBuffer]"?new Uint8Array(at):at,T=p.inflateSetDictionary(this.strm,lt)),T===w.Z_BUF_ERROR&&xt===!0&&(T=w.Z_OK,xt=!1),T!==w.Z_STREAM_END&&T!==w.Z_OK)return this.onEnd(T),!(this.ended=!0);rt.next_out&&(rt.avail_out!==0&&T!==w.Z_STREAM_END&&(rt.avail_in!==0||I!==w.Z_FINISH&&I!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(j=m.utf8border(rt.output,rt.next_out),J=rt.next_out-j,X=m.buf2string(rt.output,j),rt.next_out=J,rt.avail_out=wt-J,J&&f.arraySet(rt.output,rt.output,j,J,0),this.onData(X)):this.onData(f.shrinkBuf(rt.output,rt.next_out)))),rt.avail_in===0&&rt.avail_out===0&&(xt=!0)}while((0<rt.avail_in||rt.avail_out===0)&&T!==w.Z_STREAM_END);return T===w.Z_STREAM_END&&(I=w.Z_FINISH),I===w.Z_FINISH?(T=p.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===w.Z_OK):I!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),!(rt.avail_out=0))},k.prototype.onData=function(b){this.chunks.push(b)},k.prototype.onEnd=function(b){b===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},v.Inflate=k,v.inflate=C,v.inflateRaw=function(b,O){return(O=O||{}).raw=!0,C(b,O)},v.ungzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(c,x,v){var p=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";v.assign=function(w){for(var D=Array.prototype.slice.call(arguments,1);D.length;){var F=D.shift();if(F){if(typeof F!="object")throw new TypeError(F+"must be non-object");for(var P in F)F.hasOwnProperty(P)&&(w[P]=F[P])}}return w},v.shrinkBuf=function(w,D){return w.length===D?w:w.subarray?w.subarray(0,D):(w.length=D,w)};var f={arraySet:function(w,D,F,P,z){if(D.subarray&&w.subarray)w.set(D.subarray(F,F+P),z);else for(var k=0;k<P;k++)w[z+k]=D[F+k]},flattenChunks:function(w){var D,F,P,z,k,C;for(D=P=0,F=w.length;D<F;D++)P+=w[D].length;for(C=new Uint8Array(P),D=z=0,F=w.length;D<F;D++)k=w[D],C.set(k,z),z+=k.length;return C}},m={arraySet:function(w,D,F,P,z){for(var k=0;k<P;k++)w[z+k]=D[F+k]},flattenChunks:function(w){return[].concat.apply([],w)}};v.setTyped=function(w){w?(v.Buf8=Uint8Array,v.Buf16=Uint16Array,v.Buf32=Int32Array,v.assign(v,f)):(v.Buf8=Array,v.Buf16=Array,v.Buf32=Array,v.assign(v,m))},v.setTyped(p)},{}],42:[function(c,x,v){var p=c("./common"),f=!0,m=!0;try{String.fromCharCode.apply(null,[0])}catch{f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{m=!1}for(var w=new p.Buf8(256),D=0;D<256;D++)w[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;function F(P,z){if(z<65537&&(P.subarray&&m||!P.subarray&&f))return String.fromCharCode.apply(null,p.shrinkBuf(P,z));for(var k="",C=0;C<z;C++)k+=String.fromCharCode(P[C]);return k}w[254]=w[254]=1,v.string2buf=function(P){var z,k,C,b,O,T=P.length,I=0;for(b=0;b<T;b++)(64512&(k=P.charCodeAt(b)))==55296&&b+1<T&&(64512&(C=P.charCodeAt(b+1)))==56320&&(k=65536+(k-55296<<10)+(C-56320),b++),I+=k<128?1:k<2048?2:k<65536?3:4;for(z=new p.Buf8(I),b=O=0;O<I;b++)(64512&(k=P.charCodeAt(b)))==55296&&b+1<T&&(64512&(C=P.charCodeAt(b+1)))==56320&&(k=65536+(k-55296<<10)+(C-56320),b++),k<128?z[O++]=k:(k<2048?z[O++]=192|k>>>6:(k<65536?z[O++]=224|k>>>12:(z[O++]=240|k>>>18,z[O++]=128|k>>>12&63),z[O++]=128|k>>>6&63),z[O++]=128|63&k);return z},v.buf2binstring=function(P){return F(P,P.length)},v.binstring2buf=function(P){for(var z=new p.Buf8(P.length),k=0,C=z.length;k<C;k++)z[k]=P.charCodeAt(k);return z},v.buf2string=function(P,z){var k,C,b,O,T=z||P.length,I=new Array(2*T);for(k=C=0;k<T;)if((b=P[k++])<128)I[C++]=b;else if(4<(O=w[b]))I[C++]=65533,k+=O-1;else{for(b&=O===2?31:O===3?15:7;1<O&&k<T;)b=b<<6|63&P[k++],O--;1<O?I[C++]=65533:b<65536?I[C++]=b:(b-=65536,I[C++]=55296|b>>10&1023,I[C++]=56320|1023&b)}return F(I,C)},v.utf8border=function(P,z){var k;for((z=z||P.length)>P.length&&(z=P.length),k=z-1;0<=k&&(192&P[k])==128;)k--;return k<0||k===0?z:k+w[P[k]]>z?k:z}},{"./common":41}],43:[function(c,x,v){x.exports=function(p,f,m,w){for(var D=65535&p|0,F=p>>>16&65535|0,P=0;m!==0;){for(m-=P=2e3<m?2e3:m;F=F+(D=D+f[w++]|0)|0,--P;);D%=65521,F%=65521}return D|F<<16|0}},{}],44:[function(c,x,v){x.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(c,x,v){var p=function(){for(var f,m=[],w=0;w<256;w++){f=w;for(var D=0;D<8;D++)f=1&f?3988292384^f>>>1:f>>>1;m[w]=f}return m}();x.exports=function(f,m,w,D){var F=p,P=D+w;f^=-1;for(var z=D;z<P;z++)f=f>>>8^F[255&(f^m[z])];return-1^f}},{}],46:[function(c,x,v){var p,f=c("../utils/common"),m=c("./trees"),w=c("./adler32"),D=c("./crc32"),F=c("./messages"),P=0,z=4,k=0,C=-2,b=-1,O=4,T=2,I=8,j=9,J=286,X=30,lt=19,rt=2*J+1,wt=15,at=3,xt=258,Zt=xt+at+1,N=42,ct=113,_=1,mt=2,Nt=3,pt=4;function Pt(h,dt){return h.msg=F[dt],dt}function kt(h){return(h<<1)-(4<h?9:0)}function gt(h){for(var dt=h.length;0<=--dt;)h[dt]=0}function Q(h){var dt=h.state,st=dt.pending;st>h.avail_out&&(st=h.avail_out),st!==0&&(f.arraySet(h.output,dt.pending_buf,dt.pending_out,st,h.next_out),h.next_out+=st,dt.pending_out+=st,h.total_out+=st,h.avail_out-=st,dt.pending-=st,dt.pending===0&&(dt.pending_out=0))}function tt(h,dt){m._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,dt),h.block_start=h.strstart,Q(h.strm)}function Ft(h,dt){h.pending_buf[h.pending++]=dt}function Et(h,dt){h.pending_buf[h.pending++]=dt>>>8&255,h.pending_buf[h.pending++]=255&dt}function ht(h,dt){var st,B,E=h.max_chain_length,q=h.strstart,yt=h.prev_length,_t=h.nice_match,nt=h.strstart>h.w_size-Zt?h.strstart-(h.w_size-Zt):0,Lt=h.window,Ut=h.w_mask,Ot=h.prev,Gt=h.strstart+xt,le=Lt[q+yt-1],ie=Lt[q+yt];h.prev_length>=h.good_match&&(E>>=2),_t>h.lookahead&&(_t=h.lookahead);do if(Lt[(st=dt)+yt]===ie&&Lt[st+yt-1]===le&&Lt[st]===Lt[q]&&Lt[++st]===Lt[q+1]){q+=2,st++;do;while(Lt[++q]===Lt[++st]&&Lt[++q]===Lt[++st]&&Lt[++q]===Lt[++st]&&Lt[++q]===Lt[++st]&&Lt[++q]===Lt[++st]&&Lt[++q]===Lt[++st]&&Lt[++q]===Lt[++st]&&Lt[++q]===Lt[++st]&&q<Gt);if(B=xt-(Gt-q),q=Gt-xt,yt<B){if(h.match_start=dt,_t<=(yt=B))break;le=Lt[q+yt-1],ie=Lt[q+yt]}}while((dt=Ot[dt&Ut])>nt&&--E!=0);return yt<=h.lookahead?yt:h.lookahead}function zt(h){var dt,st,B,E,q,yt,_t,nt,Lt,Ut,Ot=h.w_size;do{if(E=h.window_size-h.lookahead-h.strstart,h.strstart>=Ot+(Ot-Zt)){for(f.arraySet(h.window,h.window,Ot,Ot,0),h.match_start-=Ot,h.strstart-=Ot,h.block_start-=Ot,dt=st=h.hash_size;B=h.head[--dt],h.head[dt]=Ot<=B?B-Ot:0,--st;);for(dt=st=Ot;B=h.prev[--dt],h.prev[dt]=Ot<=B?B-Ot:0,--st;);E+=Ot}if(h.strm.avail_in===0)break;if(yt=h.strm,_t=h.window,nt=h.strstart+h.lookahead,Lt=E,Ut=void 0,Ut=yt.avail_in,Lt<Ut&&(Ut=Lt),st=Ut===0?0:(yt.avail_in-=Ut,f.arraySet(_t,yt.input,yt.next_in,Ut,nt),yt.state.wrap===1?yt.adler=w(yt.adler,_t,Ut,nt):yt.state.wrap===2&&(yt.adler=D(yt.adler,_t,Ut,nt)),yt.next_in+=Ut,yt.total_in+=Ut,Ut),h.lookahead+=st,h.lookahead+h.insert>=at)for(q=h.strstart-h.insert,h.ins_h=h.window[q],h.ins_h=(h.ins_h<<h.hash_shift^h.window[q+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[q+at-1])&h.hash_mask,h.prev[q&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=q,q++,h.insert--,!(h.lookahead+h.insert<at)););}while(h.lookahead<Zt&&h.strm.avail_in!==0)}function ne(h,dt){for(var st,B;;){if(h.lookahead<Zt){if(zt(h),h.lookahead<Zt&&dt===P)return _;if(h.lookahead===0)break}if(st=0,h.lookahead>=at&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+at-1])&h.hash_mask,st=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),st!==0&&h.strstart-st<=h.w_size-Zt&&(h.match_length=ht(h,st)),h.match_length>=at)if(B=m._tr_tally(h,h.strstart-h.match_start,h.match_length-at),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=at){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+at-1])&h.hash_mask,st=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else B=m._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(B&&(tt(h,!1),h.strm.avail_out===0))return _}return h.insert=h.strstart<at-1?h.strstart:at-1,dt===z?(tt(h,!0),h.strm.avail_out===0?Nt:pt):h.last_lit&&(tt(h,!1),h.strm.avail_out===0)?_:mt}function Dt(h,dt){for(var st,B,E;;){if(h.lookahead<Zt){if(zt(h),h.lookahead<Zt&&dt===P)return _;if(h.lookahead===0)break}if(st=0,h.lookahead>=at&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+at-1])&h.hash_mask,st=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=at-1,st!==0&&h.prev_length<h.max_lazy_match&&h.strstart-st<=h.w_size-Zt&&(h.match_length=ht(h,st),h.match_length<=5&&(h.strategy===1||h.match_length===at&&4096<h.strstart-h.match_start)&&(h.match_length=at-1)),h.prev_length>=at&&h.match_length<=h.prev_length){for(E=h.strstart+h.lookahead-at,B=m._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-at),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=E&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+at-1])&h.hash_mask,st=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=at-1,h.strstart++,B&&(tt(h,!1),h.strm.avail_out===0))return _}else if(h.match_available){if((B=m._tr_tally(h,0,h.window[h.strstart-1]))&&tt(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return _}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(B=m._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<at-1?h.strstart:at-1,dt===z?(tt(h,!0),h.strm.avail_out===0?Nt:pt):h.last_lit&&(tt(h,!1),h.strm.avail_out===0)?_:mt}function St(h,dt,st,B,E){this.good_length=h,this.max_lazy=dt,this.nice_length=st,this.max_chain=B,this.func=E}function oe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new f.Buf16(2*rt),this.dyn_dtree=new f.Buf16(2*(2*X+1)),this.bl_tree=new f.Buf16(2*(2*lt+1)),gt(this.dyn_ltree),gt(this.dyn_dtree),gt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new f.Buf16(wt+1),this.heap=new f.Buf16(2*J+1),gt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new f.Buf16(2*J+1),gt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ce(h){var dt;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=T,(dt=h.state).pending=0,dt.pending_out=0,dt.wrap<0&&(dt.wrap=-dt.wrap),dt.status=dt.wrap?N:ct,h.adler=dt.wrap===2?0:1,dt.last_flush=P,m._tr_init(dt),k):Pt(h,C)}function Xt(h){var dt=ce(h);return dt===k&&function(st){st.window_size=2*st.w_size,gt(st.head),st.max_lazy_match=p[st.level].max_lazy,st.good_match=p[st.level].good_length,st.nice_match=p[st.level].nice_length,st.max_chain_length=p[st.level].max_chain,st.strstart=0,st.block_start=0,st.lookahead=0,st.insert=0,st.match_length=st.prev_length=at-1,st.match_available=0,st.ins_h=0}(h.state),dt}function he(h,dt,st,B,E,q){if(!h)return C;var yt=1;if(dt===b&&(dt=6),B<0?(yt=0,B=-B):15<B&&(yt=2,B-=16),E<1||j<E||st!==I||B<8||15<B||dt<0||9<dt||q<0||O<q)return Pt(h,C);B===8&&(B=9);var _t=new oe;return(h.state=_t).strm=h,_t.wrap=yt,_t.gzhead=null,_t.w_bits=B,_t.w_size=1<<_t.w_bits,_t.w_mask=_t.w_size-1,_t.hash_bits=E+7,_t.hash_size=1<<_t.hash_bits,_t.hash_mask=_t.hash_size-1,_t.hash_shift=~~((_t.hash_bits+at-1)/at),_t.window=new f.Buf8(2*_t.w_size),_t.head=new f.Buf16(_t.hash_size),_t.prev=new f.Buf16(_t.w_size),_t.lit_bufsize=1<<E+6,_t.pending_buf_size=4*_t.lit_bufsize,_t.pending_buf=new f.Buf8(_t.pending_buf_size),_t.d_buf=1*_t.lit_bufsize,_t.l_buf=3*_t.lit_bufsize,_t.level=dt,_t.strategy=q,_t.method=st,Xt(h)}p=[new St(0,0,0,0,function(h,dt){var st=65535;for(st>h.pending_buf_size-5&&(st=h.pending_buf_size-5);;){if(h.lookahead<=1){if(zt(h),h.lookahead===0&&dt===P)return _;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var B=h.block_start+st;if((h.strstart===0||h.strstart>=B)&&(h.lookahead=h.strstart-B,h.strstart=B,tt(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-Zt&&(tt(h,!1),h.strm.avail_out===0))return _}return h.insert=0,dt===z?(tt(h,!0),h.strm.avail_out===0?Nt:pt):(h.strstart>h.block_start&&(tt(h,!1),h.strm.avail_out),_)}),new St(4,4,8,4,ne),new St(4,5,16,8,ne),new St(4,6,32,32,ne),new St(4,4,16,16,Dt),new St(8,16,32,32,Dt),new St(8,16,128,128,Dt),new St(8,32,128,256,Dt),new St(32,128,258,1024,Dt),new St(32,258,258,4096,Dt)],v.deflateInit=function(h,dt){return he(h,dt,I,15,8,0)},v.deflateInit2=he,v.deflateReset=Xt,v.deflateResetKeep=ce,v.deflateSetHeader=function(h,dt){return h&&h.state?h.state.wrap!==2?C:(h.state.gzhead=dt,k):C},v.deflate=function(h,dt){var st,B,E,q;if(!h||!h.state||5<dt||dt<0)return h?Pt(h,C):C;if(B=h.state,!h.output||!h.input&&h.avail_in!==0||B.status===666&&dt!==z)return Pt(h,h.avail_out===0?-5:C);if(B.strm=h,st=B.last_flush,B.last_flush=dt,B.status===N)if(B.wrap===2)h.adler=0,Ft(B,31),Ft(B,139),Ft(B,8),B.gzhead?(Ft(B,(B.gzhead.text?1:0)+(B.gzhead.hcrc?2:0)+(B.gzhead.extra?4:0)+(B.gzhead.name?8:0)+(B.gzhead.comment?16:0)),Ft(B,255&B.gzhead.time),Ft(B,B.gzhead.time>>8&255),Ft(B,B.gzhead.time>>16&255),Ft(B,B.gzhead.time>>24&255),Ft(B,B.level===9?2:2<=B.strategy||B.level<2?4:0),Ft(B,255&B.gzhead.os),B.gzhead.extra&&B.gzhead.extra.length&&(Ft(B,255&B.gzhead.extra.length),Ft(B,B.gzhead.extra.length>>8&255)),B.gzhead.hcrc&&(h.adler=D(h.adler,B.pending_buf,B.pending,0)),B.gzindex=0,B.status=69):(Ft(B,0),Ft(B,0),Ft(B,0),Ft(B,0),Ft(B,0),Ft(B,B.level===9?2:2<=B.strategy||B.level<2?4:0),Ft(B,3),B.status=ct);else{var yt=I+(B.w_bits-8<<4)<<8;yt|=(2<=B.strategy||B.level<2?0:B.level<6?1:B.level===6?2:3)<<6,B.strstart!==0&&(yt|=32),yt+=31-yt%31,B.status=ct,Et(B,yt),B.strstart!==0&&(Et(B,h.adler>>>16),Et(B,65535&h.adler)),h.adler=1}if(B.status===69)if(B.gzhead.extra){for(E=B.pending;B.gzindex<(65535&B.gzhead.extra.length)&&(B.pending!==B.pending_buf_size||(B.gzhead.hcrc&&B.pending>E&&(h.adler=D(h.adler,B.pending_buf,B.pending-E,E)),Q(h),E=B.pending,B.pending!==B.pending_buf_size));)Ft(B,255&B.gzhead.extra[B.gzindex]),B.gzindex++;B.gzhead.hcrc&&B.pending>E&&(h.adler=D(h.adler,B.pending_buf,B.pending-E,E)),B.gzindex===B.gzhead.extra.length&&(B.gzindex=0,B.status=73)}else B.status=73;if(B.status===73)if(B.gzhead.name){E=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>E&&(h.adler=D(h.adler,B.pending_buf,B.pending-E,E)),Q(h),E=B.pending,B.pending===B.pending_buf_size)){q=1;break}q=B.gzindex<B.gzhead.name.length?255&B.gzhead.name.charCodeAt(B.gzindex++):0,Ft(B,q)}while(q!==0);B.gzhead.hcrc&&B.pending>E&&(h.adler=D(h.adler,B.pending_buf,B.pending-E,E)),q===0&&(B.gzindex=0,B.status=91)}else B.status=91;if(B.status===91)if(B.gzhead.comment){E=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>E&&(h.adler=D(h.adler,B.pending_buf,B.pending-E,E)),Q(h),E=B.pending,B.pending===B.pending_buf_size)){q=1;break}q=B.gzindex<B.gzhead.comment.length?255&B.gzhead.comment.charCodeAt(B.gzindex++):0,Ft(B,q)}while(q!==0);B.gzhead.hcrc&&B.pending>E&&(h.adler=D(h.adler,B.pending_buf,B.pending-E,E)),q===0&&(B.status=103)}else B.status=103;if(B.status===103&&(B.gzhead.hcrc?(B.pending+2>B.pending_buf_size&&Q(h),B.pending+2<=B.pending_buf_size&&(Ft(B,255&h.adler),Ft(B,h.adler>>8&255),h.adler=0,B.status=ct)):B.status=ct),B.pending!==0){if(Q(h),h.avail_out===0)return B.last_flush=-1,k}else if(h.avail_in===0&&kt(dt)<=kt(st)&&dt!==z)return Pt(h,-5);if(B.status===666&&h.avail_in!==0)return Pt(h,-5);if(h.avail_in!==0||B.lookahead!==0||dt!==P&&B.status!==666){var _t=B.strategy===2?function(nt,Lt){for(var Ut;;){if(nt.lookahead===0&&(zt(nt),nt.lookahead===0)){if(Lt===P)return _;break}if(nt.match_length=0,Ut=m._tr_tally(nt,0,nt.window[nt.strstart]),nt.lookahead--,nt.strstart++,Ut&&(tt(nt,!1),nt.strm.avail_out===0))return _}return nt.insert=0,Lt===z?(tt(nt,!0),nt.strm.avail_out===0?Nt:pt):nt.last_lit&&(tt(nt,!1),nt.strm.avail_out===0)?_:mt}(B,dt):B.strategy===3?function(nt,Lt){for(var Ut,Ot,Gt,le,ie=nt.window;;){if(nt.lookahead<=xt){if(zt(nt),nt.lookahead<=xt&&Lt===P)return _;if(nt.lookahead===0)break}if(nt.match_length=0,nt.lookahead>=at&&0<nt.strstart&&(Ot=ie[Gt=nt.strstart-1])===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]){le=nt.strstart+xt;do;while(Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Gt<le);nt.match_length=xt-(le-Gt),nt.match_length>nt.lookahead&&(nt.match_length=nt.lookahead)}if(nt.match_length>=at?(Ut=m._tr_tally(nt,1,nt.match_length-at),nt.lookahead-=nt.match_length,nt.strstart+=nt.match_length,nt.match_length=0):(Ut=m._tr_tally(nt,0,nt.window[nt.strstart]),nt.lookahead--,nt.strstart++),Ut&&(tt(nt,!1),nt.strm.avail_out===0))return _}return nt.insert=0,Lt===z?(tt(nt,!0),nt.strm.avail_out===0?Nt:pt):nt.last_lit&&(tt(nt,!1),nt.strm.avail_out===0)?_:mt}(B,dt):p[B.level].func(B,dt);if(_t!==Nt&&_t!==pt||(B.status=666),_t===_||_t===Nt)return h.avail_out===0&&(B.last_flush=-1),k;if(_t===mt&&(dt===1?m._tr_align(B):dt!==5&&(m._tr_stored_block(B,0,0,!1),dt===3&&(gt(B.head),B.lookahead===0&&(B.strstart=0,B.block_start=0,B.insert=0))),Q(h),h.avail_out===0))return B.last_flush=-1,k}return dt!==z?k:B.wrap<=0?1:(B.wrap===2?(Ft(B,255&h.adler),Ft(B,h.adler>>8&255),Ft(B,h.adler>>16&255),Ft(B,h.adler>>24&255),Ft(B,255&h.total_in),Ft(B,h.total_in>>8&255),Ft(B,h.total_in>>16&255),Ft(B,h.total_in>>24&255)):(Et(B,h.adler>>>16),Et(B,65535&h.adler)),Q(h),0<B.wrap&&(B.wrap=-B.wrap),B.pending!==0?k:1)},v.deflateEnd=function(h){var dt;return h&&h.state?(dt=h.state.status)!==N&&dt!==69&&dt!==73&&dt!==91&&dt!==103&&dt!==ct&&dt!==666?Pt(h,C):(h.state=null,dt===ct?Pt(h,-3):k):C},v.deflateSetDictionary=function(h,dt){var st,B,E,q,yt,_t,nt,Lt,Ut=dt.length;if(!h||!h.state||(q=(st=h.state).wrap)===2||q===1&&st.status!==N||st.lookahead)return C;for(q===1&&(h.adler=w(h.adler,dt,Ut,0)),st.wrap=0,Ut>=st.w_size&&(q===0&&(gt(st.head),st.strstart=0,st.block_start=0,st.insert=0),Lt=new f.Buf8(st.w_size),f.arraySet(Lt,dt,Ut-st.w_size,st.w_size,0),dt=Lt,Ut=st.w_size),yt=h.avail_in,_t=h.next_in,nt=h.input,h.avail_in=Ut,h.next_in=0,h.input=dt,zt(st);st.lookahead>=at;){for(B=st.strstart,E=st.lookahead-(at-1);st.ins_h=(st.ins_h<<st.hash_shift^st.window[B+at-1])&st.hash_mask,st.prev[B&st.w_mask]=st.head[st.ins_h],st.head[st.ins_h]=B,B++,--E;);st.strstart=B,st.lookahead=at-1,zt(st)}return st.strstart+=st.lookahead,st.block_start=st.strstart,st.insert=st.lookahead,st.lookahead=0,st.match_length=st.prev_length=at-1,st.match_available=0,h.next_in=_t,h.input=nt,h.avail_in=yt,st.wrap=q,k},v.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(c,x,v){x.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(c,x,v){x.exports=function(p,f){var m,w,D,F,P,z,k,C,b,O,T,I,j,J,X,lt,rt,wt,at,xt,Zt,N,ct,_,mt;m=p.state,w=p.next_in,_=p.input,D=w+(p.avail_in-5),F=p.next_out,mt=p.output,P=F-(f-p.avail_out),z=F+(p.avail_out-257),k=m.dmax,C=m.wsize,b=m.whave,O=m.wnext,T=m.window,I=m.hold,j=m.bits,J=m.lencode,X=m.distcode,lt=(1<<m.lenbits)-1,rt=(1<<m.distbits)-1;t:do{j<15&&(I+=_[w++]<<j,j+=8,I+=_[w++]<<j,j+=8),wt=J[I&lt];e:for(;;){if(I>>>=at=wt>>>24,j-=at,(at=wt>>>16&255)===0)mt[F++]=65535&wt;else{if(!(16&at)){if(!(64&at)){wt=J[(65535&wt)+(I&(1<<at)-1)];continue e}if(32&at){m.mode=12;break t}p.msg="invalid literal/length code",m.mode=30;break t}xt=65535&wt,(at&=15)&&(j<at&&(I+=_[w++]<<j,j+=8),xt+=I&(1<<at)-1,I>>>=at,j-=at),j<15&&(I+=_[w++]<<j,j+=8,I+=_[w++]<<j,j+=8),wt=X[I&rt];n:for(;;){if(I>>>=at=wt>>>24,j-=at,!(16&(at=wt>>>16&255))){if(!(64&at)){wt=X[(65535&wt)+(I&(1<<at)-1)];continue n}p.msg="invalid distance code",m.mode=30;break t}if(Zt=65535&wt,j<(at&=15)&&(I+=_[w++]<<j,(j+=8)<at&&(I+=_[w++]<<j,j+=8)),k<(Zt+=I&(1<<at)-1)){p.msg="invalid distance too far back",m.mode=30;break t}if(I>>>=at,j-=at,(at=F-P)<Zt){if(b<(at=Zt-at)&&m.sane){p.msg="invalid distance too far back",m.mode=30;break t}if(ct=T,(N=0)===O){if(N+=C-at,at<xt){for(xt-=at;mt[F++]=T[N++],--at;);N=F-Zt,ct=mt}}else if(O<at){if(N+=C+O-at,(at-=O)<xt){for(xt-=at;mt[F++]=T[N++],--at;);if(N=0,O<xt){for(xt-=at=O;mt[F++]=T[N++],--at;);N=F-Zt,ct=mt}}}else if(N+=O-at,at<xt){for(xt-=at;mt[F++]=T[N++],--at;);N=F-Zt,ct=mt}for(;2<xt;)mt[F++]=ct[N++],mt[F++]=ct[N++],mt[F++]=ct[N++],xt-=3;xt&&(mt[F++]=ct[N++],1<xt&&(mt[F++]=ct[N++]))}else{for(N=F-Zt;mt[F++]=mt[N++],mt[F++]=mt[N++],mt[F++]=mt[N++],2<(xt-=3););xt&&(mt[F++]=mt[N++],1<xt&&(mt[F++]=mt[N++]))}break}}break}}while(w<D&&F<z);w-=xt=j>>3,I&=(1<<(j-=xt<<3))-1,p.next_in=w,p.next_out=F,p.avail_in=w<D?D-w+5:5-(w-D),p.avail_out=F<z?z-F+257:257-(F-z),m.hold=I,m.bits=j}},{}],49:[function(c,x,v){var p=c("../utils/common"),f=c("./adler32"),m=c("./crc32"),w=c("./inffast"),D=c("./inftrees"),F=1,P=2,z=0,k=-2,C=1,b=852,O=592;function T(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function I(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new p.Buf16(320),this.work=new p.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(N){var ct;return N&&N.state?(ct=N.state,N.total_in=N.total_out=ct.total=0,N.msg="",ct.wrap&&(N.adler=1&ct.wrap),ct.mode=C,ct.last=0,ct.havedict=0,ct.dmax=32768,ct.head=null,ct.hold=0,ct.bits=0,ct.lencode=ct.lendyn=new p.Buf32(b),ct.distcode=ct.distdyn=new p.Buf32(O),ct.sane=1,ct.back=-1,z):k}function J(N){var ct;return N&&N.state?((ct=N.state).wsize=0,ct.whave=0,ct.wnext=0,j(N)):k}function X(N,ct){var _,mt;return N&&N.state?(mt=N.state,ct<0?(_=0,ct=-ct):(_=1+(ct>>4),ct<48&&(ct&=15)),ct&&(ct<8||15<ct)?k:(mt.window!==null&&mt.wbits!==ct&&(mt.window=null),mt.wrap=_,mt.wbits=ct,J(N))):k}function lt(N,ct){var _,mt;return N?(mt=new I,(N.state=mt).window=null,(_=X(N,ct))!==z&&(N.state=null),_):k}var rt,wt,at=!0;function xt(N){if(at){var ct;for(rt=new p.Buf32(512),wt=new p.Buf32(32),ct=0;ct<144;)N.lens[ct++]=8;for(;ct<256;)N.lens[ct++]=9;for(;ct<280;)N.lens[ct++]=7;for(;ct<288;)N.lens[ct++]=8;for(D(F,N.lens,0,288,rt,0,N.work,{bits:9}),ct=0;ct<32;)N.lens[ct++]=5;D(P,N.lens,0,32,wt,0,N.work,{bits:5}),at=!1}N.lencode=rt,N.lenbits=9,N.distcode=wt,N.distbits=5}function Zt(N,ct,_,mt){var Nt,pt=N.state;return pt.window===null&&(pt.wsize=1<<pt.wbits,pt.wnext=0,pt.whave=0,pt.window=new p.Buf8(pt.wsize)),mt>=pt.wsize?(p.arraySet(pt.window,ct,_-pt.wsize,pt.wsize,0),pt.wnext=0,pt.whave=pt.wsize):(mt<(Nt=pt.wsize-pt.wnext)&&(Nt=mt),p.arraySet(pt.window,ct,_-mt,Nt,pt.wnext),(mt-=Nt)?(p.arraySet(pt.window,ct,_-mt,mt,0),pt.wnext=mt,pt.whave=pt.wsize):(pt.wnext+=Nt,pt.wnext===pt.wsize&&(pt.wnext=0),pt.whave<pt.wsize&&(pt.whave+=Nt))),0}v.inflateReset=J,v.inflateReset2=X,v.inflateResetKeep=j,v.inflateInit=function(N){return lt(N,15)},v.inflateInit2=lt,v.inflate=function(N,ct){var _,mt,Nt,pt,Pt,kt,gt,Q,tt,Ft,Et,ht,zt,ne,Dt,St,oe,ce,Xt,he,h,dt,st,B,E=0,q=new p.Buf8(4),yt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return k;(_=N.state).mode===12&&(_.mode=13),Pt=N.next_out,Nt=N.output,gt=N.avail_out,pt=N.next_in,mt=N.input,kt=N.avail_in,Q=_.hold,tt=_.bits,Ft=kt,Et=gt,dt=z;t:for(;;)switch(_.mode){case C:if(_.wrap===0){_.mode=13;break}for(;tt<16;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(2&_.wrap&&Q===35615){q[_.check=0]=255&Q,q[1]=Q>>>8&255,_.check=m(_.check,q,2,0),tt=Q=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&Q)<<8)+(Q>>8))%31){N.msg="incorrect header check",_.mode=30;break}if((15&Q)!=8){N.msg="unknown compression method",_.mode=30;break}if(tt-=4,h=8+(15&(Q>>>=4)),_.wbits===0)_.wbits=h;else if(h>_.wbits){N.msg="invalid window size",_.mode=30;break}_.dmax=1<<h,N.adler=_.check=1,_.mode=512&Q?10:12,tt=Q=0;break;case 2:for(;tt<16;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(_.flags=Q,(255&_.flags)!=8){N.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){N.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=Q>>8&1),512&_.flags&&(q[0]=255&Q,q[1]=Q>>>8&255,_.check=m(_.check,q,2,0)),tt=Q=0,_.mode=3;case 3:for(;tt<32;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}_.head&&(_.head.time=Q),512&_.flags&&(q[0]=255&Q,q[1]=Q>>>8&255,q[2]=Q>>>16&255,q[3]=Q>>>24&255,_.check=m(_.check,q,4,0)),tt=Q=0,_.mode=4;case 4:for(;tt<16;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}_.head&&(_.head.xflags=255&Q,_.head.os=Q>>8),512&_.flags&&(q[0]=255&Q,q[1]=Q>>>8&255,_.check=m(_.check,q,2,0)),tt=Q=0,_.mode=5;case 5:if(1024&_.flags){for(;tt<16;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}_.length=Q,_.head&&(_.head.extra_len=Q),512&_.flags&&(q[0]=255&Q,q[1]=Q>>>8&255,_.check=m(_.check,q,2,0)),tt=Q=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(kt<(ht=_.length)&&(ht=kt),ht&&(_.head&&(h=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),p.arraySet(_.head.extra,mt,pt,ht,h)),512&_.flags&&(_.check=m(_.check,mt,ht,pt)),kt-=ht,pt+=ht,_.length-=ht),_.length))break t;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(kt===0)break t;for(ht=0;h=mt[pt+ht++],_.head&&h&&_.length<65536&&(_.head.name+=String.fromCharCode(h)),h&&ht<kt;);if(512&_.flags&&(_.check=m(_.check,mt,ht,pt)),kt-=ht,pt+=ht,h)break t}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(kt===0)break t;for(ht=0;h=mt[pt+ht++],_.head&&h&&_.length<65536&&(_.head.comment+=String.fromCharCode(h)),h&&ht<kt;);if(512&_.flags&&(_.check=m(_.check,mt,ht,pt)),kt-=ht,pt+=ht,h)break t}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;tt<16;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(Q!==(65535&_.check)){N.msg="header crc mismatch",_.mode=30;break}tt=Q=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),N.adler=_.check=0,_.mode=12;break;case 10:for(;tt<32;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}N.adler=_.check=T(Q),tt=Q=0,_.mode=11;case 11:if(_.havedict===0)return N.next_out=Pt,N.avail_out=gt,N.next_in=pt,N.avail_in=kt,_.hold=Q,_.bits=tt,2;N.adler=_.check=1,_.mode=12;case 12:if(ct===5||ct===6)break t;case 13:if(_.last){Q>>>=7&tt,tt-=7&tt,_.mode=27;break}for(;tt<3;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}switch(_.last=1&Q,tt-=1,3&(Q>>>=1)){case 0:_.mode=14;break;case 1:if(xt(_),_.mode=20,ct!==6)break;Q>>>=2,tt-=2;break t;case 2:_.mode=17;break;case 3:N.msg="invalid block type",_.mode=30}Q>>>=2,tt-=2;break;case 14:for(Q>>>=7&tt,tt-=7&tt;tt<32;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if((65535&Q)!=(Q>>>16^65535)){N.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&Q,tt=Q=0,_.mode=15,ct===6)break t;case 15:_.mode=16;case 16:if(ht=_.length){if(kt<ht&&(ht=kt),gt<ht&&(ht=gt),ht===0)break t;p.arraySet(Nt,mt,pt,ht,Pt),kt-=ht,pt+=ht,gt-=ht,Pt+=ht,_.length-=ht;break}_.mode=12;break;case 17:for(;tt<14;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(_.nlen=257+(31&Q),Q>>>=5,tt-=5,_.ndist=1+(31&Q),Q>>>=5,tt-=5,_.ncode=4+(15&Q),Q>>>=4,tt-=4,286<_.nlen||30<_.ndist){N.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;tt<3;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}_.lens[yt[_.have++]]=7&Q,Q>>>=3,tt-=3}for(;_.have<19;)_.lens[yt[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,st={bits:_.lenbits},dt=D(0,_.lens,0,19,_.lencode,0,_.work,st),_.lenbits=st.bits,dt){N.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;St=(E=_.lencode[Q&(1<<_.lenbits)-1])>>>16&255,oe=65535&E,!((Dt=E>>>24)<=tt);){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(oe<16)Q>>>=Dt,tt-=Dt,_.lens[_.have++]=oe;else{if(oe===16){for(B=Dt+2;tt<B;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(Q>>>=Dt,tt-=Dt,_.have===0){N.msg="invalid bit length repeat",_.mode=30;break}h=_.lens[_.have-1],ht=3+(3&Q),Q>>>=2,tt-=2}else if(oe===17){for(B=Dt+3;tt<B;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}tt-=Dt,h=0,ht=3+(7&(Q>>>=Dt)),Q>>>=3,tt-=3}else{for(B=Dt+7;tt<B;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}tt-=Dt,h=0,ht=11+(127&(Q>>>=Dt)),Q>>>=7,tt-=7}if(_.have+ht>_.nlen+_.ndist){N.msg="invalid bit length repeat",_.mode=30;break}for(;ht--;)_.lens[_.have++]=h}}if(_.mode===30)break;if(_.lens[256]===0){N.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,st={bits:_.lenbits},dt=D(F,_.lens,0,_.nlen,_.lencode,0,_.work,st),_.lenbits=st.bits,dt){N.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,st={bits:_.distbits},dt=D(P,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,st),_.distbits=st.bits,dt){N.msg="invalid distances set",_.mode=30;break}if(_.mode=20,ct===6)break t;case 20:_.mode=21;case 21:if(6<=kt&&258<=gt){N.next_out=Pt,N.avail_out=gt,N.next_in=pt,N.avail_in=kt,_.hold=Q,_.bits=tt,w(N,Et),Pt=N.next_out,Nt=N.output,gt=N.avail_out,pt=N.next_in,mt=N.input,kt=N.avail_in,Q=_.hold,tt=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;St=(E=_.lencode[Q&(1<<_.lenbits)-1])>>>16&255,oe=65535&E,!((Dt=E>>>24)<=tt);){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(St&&!(240&St)){for(ce=Dt,Xt=St,he=oe;St=(E=_.lencode[he+((Q&(1<<ce+Xt)-1)>>ce)])>>>16&255,oe=65535&E,!(ce+(Dt=E>>>24)<=tt);){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}Q>>>=ce,tt-=ce,_.back+=ce}if(Q>>>=Dt,tt-=Dt,_.back+=Dt,_.length=oe,St===0){_.mode=26;break}if(32&St){_.back=-1,_.mode=12;break}if(64&St){N.msg="invalid literal/length code",_.mode=30;break}_.extra=15&St,_.mode=22;case 22:if(_.extra){for(B=_.extra;tt<B;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}_.length+=Q&(1<<_.extra)-1,Q>>>=_.extra,tt-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;St=(E=_.distcode[Q&(1<<_.distbits)-1])>>>16&255,oe=65535&E,!((Dt=E>>>24)<=tt);){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(!(240&St)){for(ce=Dt,Xt=St,he=oe;St=(E=_.distcode[he+((Q&(1<<ce+Xt)-1)>>ce)])>>>16&255,oe=65535&E,!(ce+(Dt=E>>>24)<=tt);){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}Q>>>=ce,tt-=ce,_.back+=ce}if(Q>>>=Dt,tt-=Dt,_.back+=Dt,64&St){N.msg="invalid distance code",_.mode=30;break}_.offset=oe,_.extra=15&St,_.mode=24;case 24:if(_.extra){for(B=_.extra;tt<B;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}_.offset+=Q&(1<<_.extra)-1,Q>>>=_.extra,tt-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){N.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(gt===0)break t;if(ht=Et-gt,_.offset>ht){if((ht=_.offset-ht)>_.whave&&_.sane){N.msg="invalid distance too far back",_.mode=30;break}zt=ht>_.wnext?(ht-=_.wnext,_.wsize-ht):_.wnext-ht,ht>_.length&&(ht=_.length),ne=_.window}else ne=Nt,zt=Pt-_.offset,ht=_.length;for(gt<ht&&(ht=gt),gt-=ht,_.length-=ht;Nt[Pt++]=ne[zt++],--ht;);_.length===0&&(_.mode=21);break;case 26:if(gt===0)break t;Nt[Pt++]=_.length,gt--,_.mode=21;break;case 27:if(_.wrap){for(;tt<32;){if(kt===0)break t;kt--,Q|=mt[pt++]<<tt,tt+=8}if(Et-=gt,N.total_out+=Et,_.total+=Et,Et&&(N.adler=_.check=_.flags?m(_.check,Nt,Et,Pt-Et):f(_.check,Nt,Et,Pt-Et)),Et=gt,(_.flags?Q:T(Q))!==_.check){N.msg="incorrect data check",_.mode=30;break}tt=Q=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;tt<32;){if(kt===0)break t;kt--,Q+=mt[pt++]<<tt,tt+=8}if(Q!==(4294967295&_.total)){N.msg="incorrect length check",_.mode=30;break}tt=Q=0}_.mode=29;case 29:dt=1;break t;case 30:dt=-3;break t;case 31:return-4;case 32:default:return k}return N.next_out=Pt,N.avail_out=gt,N.next_in=pt,N.avail_in=kt,_.hold=Q,_.bits=tt,(_.wsize||Et!==N.avail_out&&_.mode<30&&(_.mode<27||ct!==4))&&Zt(N,N.output,N.next_out,Et-N.avail_out)?(_.mode=31,-4):(Ft-=N.avail_in,Et-=N.avail_out,N.total_in+=Ft,N.total_out+=Et,_.total+=Et,_.wrap&&Et&&(N.adler=_.check=_.flags?m(_.check,Nt,Et,N.next_out-Et):f(_.check,Nt,Et,N.next_out-Et)),N.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(Ft==0&&Et===0||ct===4)&&dt===z&&(dt=-5),dt)},v.inflateEnd=function(N){if(!N||!N.state)return k;var ct=N.state;return ct.window&&(ct.window=null),N.state=null,z},v.inflateGetHeader=function(N,ct){var _;return N&&N.state&&2&(_=N.state).wrap?((_.head=ct).done=!1,z):k},v.inflateSetDictionary=function(N,ct){var _,mt=ct.length;return N&&N.state?(_=N.state).wrap!==0&&_.mode!==11?k:_.mode===11&&f(1,ct,mt,0)!==_.check?-3:Zt(N,ct,mt,mt)?(_.mode=31,-4):(_.havedict=1,z):k},v.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(c,x,v){var p=c("../utils/common"),f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],D=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];x.exports=function(F,P,z,k,C,b,O,T){var I,j,J,X,lt,rt,wt,at,xt,Zt=T.bits,N=0,ct=0,_=0,mt=0,Nt=0,pt=0,Pt=0,kt=0,gt=0,Q=0,tt=null,Ft=0,Et=new p.Buf16(16),ht=new p.Buf16(16),zt=null,ne=0;for(N=0;N<=15;N++)Et[N]=0;for(ct=0;ct<k;ct++)Et[P[z+ct]]++;for(Nt=Zt,mt=15;1<=mt&&Et[mt]===0;mt--);if(mt<Nt&&(Nt=mt),mt===0)return C[b++]=20971520,C[b++]=20971520,T.bits=1,0;for(_=1;_<mt&&Et[_]===0;_++);for(Nt<_&&(Nt=_),N=kt=1;N<=15;N++)if(kt<<=1,(kt-=Et[N])<0)return-1;if(0<kt&&(F===0||mt!==1))return-1;for(ht[1]=0,N=1;N<15;N++)ht[N+1]=ht[N]+Et[N];for(ct=0;ct<k;ct++)P[z+ct]!==0&&(O[ht[P[z+ct]]++]=ct);if(rt=F===0?(tt=zt=O,19):F===1?(tt=f,Ft-=257,zt=m,ne-=257,256):(tt=w,zt=D,-1),N=_,lt=b,Pt=ct=Q=0,J=-1,X=(gt=1<<(pt=Nt))-1,F===1&&852<gt||F===2&&592<gt)return 1;for(;;){for(wt=N-Pt,xt=O[ct]<rt?(at=0,O[ct]):O[ct]>rt?(at=zt[ne+O[ct]],tt[Ft+O[ct]]):(at=96,0),I=1<<N-Pt,_=j=1<<pt;C[lt+(Q>>Pt)+(j-=I)]=wt<<24|at<<16|xt|0,j!==0;);for(I=1<<N-1;Q&I;)I>>=1;if(I!==0?(Q&=I-1,Q+=I):Q=0,ct++,--Et[N]==0){if(N===mt)break;N=P[z+O[ct]]}if(Nt<N&&(Q&X)!==J){for(Pt===0&&(Pt=Nt),lt+=_,kt=1<<(pt=N-Pt);pt+Pt<mt&&!((kt-=Et[pt+Pt])<=0);)pt++,kt<<=1;if(gt+=1<<pt,F===1&&852<gt||F===2&&592<gt)return 1;C[J=Q&X]=Nt<<24|pt<<16|lt-b|0}}return Q!==0&&(C[lt+Q]=N-Pt<<24|64<<16|0),T.bits=Nt,0}},{"../utils/common":41}],51:[function(c,x,v){x.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(c,x,v){var p=c("../utils/common"),f=0,m=1;function w(E){for(var q=E.length;0<=--q;)E[q]=0}var D=0,F=29,P=256,z=P+1+F,k=30,C=19,b=2*z+1,O=15,T=16,I=7,j=256,J=16,X=17,lt=18,rt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],wt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],xt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Zt=new Array(2*(z+2));w(Zt);var N=new Array(2*k);w(N);var ct=new Array(512);w(ct);var _=new Array(256);w(_);var mt=new Array(F);w(mt);var Nt,pt,Pt,kt=new Array(k);function gt(E,q,yt,_t,nt){this.static_tree=E,this.extra_bits=q,this.extra_base=yt,this.elems=_t,this.max_length=nt,this.has_stree=E&&E.length}function Q(E,q){this.dyn_tree=E,this.max_code=0,this.stat_desc=q}function tt(E){return E<256?ct[E]:ct[256+(E>>>7)]}function Ft(E,q){E.pending_buf[E.pending++]=255&q,E.pending_buf[E.pending++]=q>>>8&255}function Et(E,q,yt){E.bi_valid>T-yt?(E.bi_buf|=q<<E.bi_valid&65535,Ft(E,E.bi_buf),E.bi_buf=q>>T-E.bi_valid,E.bi_valid+=yt-T):(E.bi_buf|=q<<E.bi_valid&65535,E.bi_valid+=yt)}function ht(E,q,yt){Et(E,yt[2*q],yt[2*q+1])}function zt(E,q){for(var yt=0;yt|=1&E,E>>>=1,yt<<=1,0<--q;);return yt>>>1}function ne(E,q,yt){var _t,nt,Lt=new Array(O+1),Ut=0;for(_t=1;_t<=O;_t++)Lt[_t]=Ut=Ut+yt[_t-1]<<1;for(nt=0;nt<=q;nt++){var Ot=E[2*nt+1];Ot!==0&&(E[2*nt]=zt(Lt[Ot]++,Ot))}}function Dt(E){var q;for(q=0;q<z;q++)E.dyn_ltree[2*q]=0;for(q=0;q<k;q++)E.dyn_dtree[2*q]=0;for(q=0;q<C;q++)E.bl_tree[2*q]=0;E.dyn_ltree[2*j]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function St(E){8<E.bi_valid?Ft(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function oe(E,q,yt,_t){var nt=2*q,Lt=2*yt;return E[nt]<E[Lt]||E[nt]===E[Lt]&&_t[q]<=_t[yt]}function ce(E,q,yt){for(var _t=E.heap[yt],nt=yt<<1;nt<=E.heap_len&&(nt<E.heap_len&&oe(q,E.heap[nt+1],E.heap[nt],E.depth)&&nt++,!oe(q,_t,E.heap[nt],E.depth));)E.heap[yt]=E.heap[nt],yt=nt,nt<<=1;E.heap[yt]=_t}function Xt(E,q,yt){var _t,nt,Lt,Ut,Ot=0;if(E.last_lit!==0)for(;_t=E.pending_buf[E.d_buf+2*Ot]<<8|E.pending_buf[E.d_buf+2*Ot+1],nt=E.pending_buf[E.l_buf+Ot],Ot++,_t===0?ht(E,nt,q):(ht(E,(Lt=_[nt])+P+1,q),(Ut=rt[Lt])!==0&&Et(E,nt-=mt[Lt],Ut),ht(E,Lt=tt(--_t),yt),(Ut=wt[Lt])!==0&&Et(E,_t-=kt[Lt],Ut)),Ot<E.last_lit;);ht(E,j,q)}function he(E,q){var yt,_t,nt,Lt=q.dyn_tree,Ut=q.stat_desc.static_tree,Ot=q.stat_desc.has_stree,Gt=q.stat_desc.elems,le=-1;for(E.heap_len=0,E.heap_max=b,yt=0;yt<Gt;yt++)Lt[2*yt]!==0?(E.heap[++E.heap_len]=le=yt,E.depth[yt]=0):Lt[2*yt+1]=0;for(;E.heap_len<2;)Lt[2*(nt=E.heap[++E.heap_len]=le<2?++le:0)]=1,E.depth[nt]=0,E.opt_len--,Ot&&(E.static_len-=Ut[2*nt+1]);for(q.max_code=le,yt=E.heap_len>>1;1<=yt;yt--)ce(E,Lt,yt);for(nt=Gt;yt=E.heap[1],E.heap[1]=E.heap[E.heap_len--],ce(E,Lt,1),_t=E.heap[1],E.heap[--E.heap_max]=yt,E.heap[--E.heap_max]=_t,Lt[2*nt]=Lt[2*yt]+Lt[2*_t],E.depth[nt]=(E.depth[yt]>=E.depth[_t]?E.depth[yt]:E.depth[_t])+1,Lt[2*yt+1]=Lt[2*_t+1]=nt,E.heap[1]=nt++,ce(E,Lt,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(ie,Se){var rn,Ae,Ue,me,on,Ke,Kt=Se.dyn_tree,qe=Se.max_code,mn=Se.stat_desc.static_tree,Gn=Se.stat_desc.has_stree,jt=Se.stat_desc.extra_bits,Zn=Se.stat_desc.extra_base,_n=Se.stat_desc.max_length,Ln=0;for(me=0;me<=O;me++)ie.bl_count[me]=0;for(Kt[2*ie.heap[ie.heap_max]+1]=0,rn=ie.heap_max+1;rn<b;rn++)_n<(me=Kt[2*Kt[2*(Ae=ie.heap[rn])+1]+1]+1)&&(me=_n,Ln++),Kt[2*Ae+1]=me,qe<Ae||(ie.bl_count[me]++,on=0,Zn<=Ae&&(on=jt[Ae-Zn]),Ke=Kt[2*Ae],ie.opt_len+=Ke*(me+on),Gn&&(ie.static_len+=Ke*(mn[2*Ae+1]+on)));if(Ln!==0){do{for(me=_n-1;ie.bl_count[me]===0;)me--;ie.bl_count[me]--,ie.bl_count[me+1]+=2,ie.bl_count[_n]--,Ln-=2}while(0<Ln);for(me=_n;me!==0;me--)for(Ae=ie.bl_count[me];Ae!==0;)qe<(Ue=ie.heap[--rn])||(Kt[2*Ue+1]!==me&&(ie.opt_len+=(me-Kt[2*Ue+1])*Kt[2*Ue],Kt[2*Ue+1]=me),Ae--)}}(E,q),ne(Lt,le,E.bl_count)}function h(E,q,yt){var _t,nt,Lt=-1,Ut=q[1],Ot=0,Gt=7,le=4;for(Ut===0&&(Gt=138,le=3),q[2*(yt+1)+1]=65535,_t=0;_t<=yt;_t++)nt=Ut,Ut=q[2*(_t+1)+1],++Ot<Gt&&nt===Ut||(Ot<le?E.bl_tree[2*nt]+=Ot:nt!==0?(nt!==Lt&&E.bl_tree[2*nt]++,E.bl_tree[2*J]++):Ot<=10?E.bl_tree[2*X]++:E.bl_tree[2*lt]++,Lt=nt,le=(Ot=0)===Ut?(Gt=138,3):nt===Ut?(Gt=6,3):(Gt=7,4))}function dt(E,q,yt){var _t,nt,Lt=-1,Ut=q[1],Ot=0,Gt=7,le=4;for(Ut===0&&(Gt=138,le=3),_t=0;_t<=yt;_t++)if(nt=Ut,Ut=q[2*(_t+1)+1],!(++Ot<Gt&&nt===Ut)){if(Ot<le)for(;ht(E,nt,E.bl_tree),--Ot!=0;);else nt!==0?(nt!==Lt&&(ht(E,nt,E.bl_tree),Ot--),ht(E,J,E.bl_tree),Et(E,Ot-3,2)):Ot<=10?(ht(E,X,E.bl_tree),Et(E,Ot-3,3)):(ht(E,lt,E.bl_tree),Et(E,Ot-11,7));Lt=nt,le=(Ot=0)===Ut?(Gt=138,3):nt===Ut?(Gt=6,3):(Gt=7,4)}}w(kt);var st=!1;function B(E,q,yt,_t){Et(E,(D<<1)+(_t?1:0),3),function(nt,Lt,Ut,Ot){St(nt),Ft(nt,Ut),Ft(nt,~Ut),p.arraySet(nt.pending_buf,nt.window,Lt,Ut,nt.pending),nt.pending+=Ut}(E,q,yt)}v._tr_init=function(E){st||(function(){var q,yt,_t,nt,Lt,Ut=new Array(O+1);for(nt=_t=0;nt<F-1;nt++)for(mt[nt]=_t,q=0;q<1<<rt[nt];q++)_[_t++]=nt;for(_[_t-1]=nt,nt=Lt=0;nt<16;nt++)for(kt[nt]=Lt,q=0;q<1<<wt[nt];q++)ct[Lt++]=nt;for(Lt>>=7;nt<k;nt++)for(kt[nt]=Lt<<7,q=0;q<1<<wt[nt]-7;q++)ct[256+Lt++]=nt;for(yt=0;yt<=O;yt++)Ut[yt]=0;for(q=0;q<=143;)Zt[2*q+1]=8,q++,Ut[8]++;for(;q<=255;)Zt[2*q+1]=9,q++,Ut[9]++;for(;q<=279;)Zt[2*q+1]=7,q++,Ut[7]++;for(;q<=287;)Zt[2*q+1]=8,q++,Ut[8]++;for(ne(Zt,z+1,Ut),q=0;q<k;q++)N[2*q+1]=5,N[2*q]=zt(q,5);Nt=new gt(Zt,rt,P+1,z,O),pt=new gt(N,wt,0,k,O),Pt=new gt(new Array(0),at,0,C,I)}(),st=!0),E.l_desc=new Q(E.dyn_ltree,Nt),E.d_desc=new Q(E.dyn_dtree,pt),E.bl_desc=new Q(E.bl_tree,Pt),E.bi_buf=0,E.bi_valid=0,Dt(E)},v._tr_stored_block=B,v._tr_flush_block=function(E,q,yt,_t){var nt,Lt,Ut=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(Ot){var Gt,le=4093624447;for(Gt=0;Gt<=31;Gt++,le>>>=1)if(1&le&&Ot.dyn_ltree[2*Gt]!==0)return f;if(Ot.dyn_ltree[18]!==0||Ot.dyn_ltree[20]!==0||Ot.dyn_ltree[26]!==0)return m;for(Gt=32;Gt<P;Gt++)if(Ot.dyn_ltree[2*Gt]!==0)return m;return f}(E)),he(E,E.l_desc),he(E,E.d_desc),Ut=function(Ot){var Gt;for(h(Ot,Ot.dyn_ltree,Ot.l_desc.max_code),h(Ot,Ot.dyn_dtree,Ot.d_desc.max_code),he(Ot,Ot.bl_desc),Gt=C-1;3<=Gt&&Ot.bl_tree[2*xt[Gt]+1]===0;Gt--);return Ot.opt_len+=3*(Gt+1)+5+5+4,Gt}(E),nt=E.opt_len+3+7>>>3,(Lt=E.static_len+3+7>>>3)<=nt&&(nt=Lt)):nt=Lt=yt+5,yt+4<=nt&&q!==-1?B(E,q,yt,_t):E.strategy===4||Lt===nt?(Et(E,2+(_t?1:0),3),Xt(E,Zt,N)):(Et(E,4+(_t?1:0),3),function(Ot,Gt,le,ie){var Se;for(Et(Ot,Gt-257,5),Et(Ot,le-1,5),Et(Ot,ie-4,4),Se=0;Se<ie;Se++)Et(Ot,Ot.bl_tree[2*xt[Se]+1],3);dt(Ot,Ot.dyn_ltree,Gt-1),dt(Ot,Ot.dyn_dtree,le-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,Ut+1),Xt(E,E.dyn_ltree,E.dyn_dtree)),Dt(E),_t&&St(E)},v._tr_tally=function(E,q,yt){return E.pending_buf[E.d_buf+2*E.last_lit]=q>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&q,E.pending_buf[E.l_buf+E.last_lit]=255&yt,E.last_lit++,q===0?E.dyn_ltree[2*yt]++:(E.matches++,q--,E.dyn_ltree[2*(_[yt]+P+1)]++,E.dyn_dtree[2*tt(q)]++),E.last_lit===E.lit_bufsize-1},v._tr_align=function(E){Et(E,2,3),ht(E,j,Zt),function(q){q.bi_valid===16?(Ft(q,q.bi_buf),q.bi_buf=0,q.bi_valid=0):8<=q.bi_valid&&(q.pending_buf[q.pending++]=255&q.bi_buf,q.bi_buf>>=8,q.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(c,x,v){x.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(c,x,v){(function(p){(function(f,m){if(!f.setImmediate){var w,D,F,P,z=1,k={},C=!1,b=f.document,O=Object.getPrototypeOf&&Object.getPrototypeOf(f);O=O&&O.setTimeout?O:f,w={}.toString.call(f.process)==="[object process]"?function(J){process.nextTick(function(){I(J)})}:function(){if(f.postMessage&&!f.importScripts){var J=!0,X=f.onmessage;return f.onmessage=function(){J=!1},f.postMessage("","*"),f.onmessage=X,J}}()?(P="setImmediate$"+Math.random()+"$",f.addEventListener?f.addEventListener("message",j,!1):f.attachEvent("onmessage",j),function(J){f.postMessage(P+J,"*")}):f.MessageChannel?((F=new MessageChannel).port1.onmessage=function(J){I(J.data)},function(J){F.port2.postMessage(J)}):b&&"onreadystatechange"in b.createElement("script")?(D=b.documentElement,function(J){var X=b.createElement("script");X.onreadystatechange=function(){I(J),X.onreadystatechange=null,D.removeChild(X),X=null},D.appendChild(X)}):function(J){setTimeout(I,0,J)},O.setImmediate=function(J){typeof J!="function"&&(J=new Function(""+J));for(var X=new Array(arguments.length-1),lt=0;lt<X.length;lt++)X[lt]=arguments[lt+1];var rt={callback:J,args:X};return k[z]=rt,w(z),z++},O.clearImmediate=T}function T(J){delete k[J]}function I(J){if(C)setTimeout(I,0,J);else{var X=k[J];if(X){C=!0;try{(function(lt){var rt=lt.callback,wt=lt.args;switch(wt.length){case 0:rt();break;case 1:rt(wt[0]);break;case 2:rt(wt[0],wt[1]);break;case 3:rt(wt[0],wt[1],wt[2]);break;default:rt.apply(m,wt)}})(X)}finally{T(J),C=!1}}}}function j(J){J.source===f&&typeof J.data=="string"&&J.data.indexOf(P)===0&&I(+J.data.slice(P.length))}})(typeof self>"u"?p===void 0?this:p:self)}).call(this,typeof Ti<"u"?Ti:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Do);var Hs=Do.exports;const Gs=io(Hs);function Sn(g,A){return Array.from(g.getElementsByTagName(A))}function Nr(g){return g[0]==="#"?g:`#${g}`}function Vs(g,A,c){return Array.from(g.getElementsByTagNameNS(c,A))}function nn(g){return g==null||g.normalize(),(g==null?void 0:g.textContent)||""}function je(g,A,c){const x=g.getElementsByTagName(A);return x.length?x[0]:null}function Tn(g,A,c){const x={};if(!g)return x;const v=g.getElementsByTagName(A),p=v.length?v[0]:null;return p&&c?c(p,x):x}function Vi(g,A,c){const x=nn(je(g,A));return x&&c?c(x)||{}:{}}function Je(g,A,c){const x=Number.parseFloat(nn(je(g,A)));if(!Number.isNaN(x))return c&&c(x),x}function Fr(g,A){const c={};for(const x of A)Vi(g,x,v=>{c[x]=v});return c}function Ro(g){return(g==null?void 0:g.nodeType)===1}function Zo(g,A){const c={},x=A==="stroke"||A==="fill"?A:`${A}-color`;return g[0]==="#"&&(g=g.substring(1)),g.length===6||g.length===3?c[x]=`#${g}`:g.length===8&&(c[`${A}-opacity`]=Number.parseInt(g.substring(0,2),16)/255,c[x]=`#${g.substring(6,8)}${g.substring(4,6)}${g.substring(2,4)}`),c}function Dr(g,A,c){const x={};return Je(g,A,v=>{x[c]=v}),x}function ro(g,A){return Tn(g,"color",c=>Zo(nn(c),A))}function oo(g){return Tn(g,"Icon",(A,c)=>(Vi(A,"href",x=>{c.icon=x}),c))}function Ys(g){return Tn(g,"IconStyle",A=>Object.assign(ro(A,"icon"),Dr(A,"scale","icon-scale"),Dr(A,"heading","icon-heading"),Tn(A,"hotSpot",c=>{const x=Number.parseFloat(c.getAttribute("x")||""),v=Number.parseFloat(c.getAttribute("y")||""),p=c.getAttribute("xunits")||"",f=c.getAttribute("yunits")||"";return!Number.isNaN(x)&&!Number.isNaN(v)?{"icon-offset":[x,v],"icon-offset-units":[p,f]}:{}}),oo(A)))}function Xs(g){return Tn(g,"LabelStyle",A=>Object.assign(ro(A,"label"),Dr(A,"scale","label-scale")))}function Js(g){return Tn(g,"LineStyle",A=>Object.assign(ro(A,"stroke"),Dr(A,"width","stroke-width")))}function $s(g){return Tn(g,"PolyStyle",(A,c)=>Object.assign(c,Tn(A,"color",x=>Zo(nn(x),"fill")),Vi(A,"fill",x=>{if(x==="0")return{"fill-opacity":0}}),Vi(A,"outline",x=>{if(x==="0")return{"stroke-opacity":0}})))}function jr(g){return Object.assign({},$s(g),Js(g),Xs(g),Ys(g))}const Qs=/\s*/g,ta=/^\s*|\s*$/g,ea=/\s+/;function Fo(g){return g.replace(Qs,"").split(",").map(Number.parseFloat).filter(A=>!Number.isNaN(A)).slice(0,3)}function eo(g){return g.replace(ta,"").split(ea).map(Fo).filter(A=>A.length>=2)}function na(g){let A=Sn(g,"coord");A.length===0&&(A=Vs(g,"coord","*"));const c=A.map(x=>nn(x).split(" ").map(Number.parseFloat));return c.length===0?null:{geometry:c.length>2?{type:"LineString",coordinates:c}:{type:"Point",coordinates:c[0]},times:Sn(g,"when").map(x=>nn(x))}}function jo(g){if(g.length===0)return g;const A=g[0],c=g[g.length-1];let x=!0;for(let v=0;v<Math.max(A.length,c.length);v++)if(A[v]!==c[v]){x=!1;break}return x?g:g.concat([g[0]])}function Mr(g){return nn(je(g,"coordinates"))}function Uo(g){let A=[],c=[];for(let x=0;x<g.childNodes.length;x++){const v=g.childNodes.item(x);if(Ro(v))switch(v.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const p=Uo(v);A=A.concat(p.geometries),c=c.concat(p.coordTimes);break}case"Point":{const p=Fo(Mr(v));p.length>=2&&A.push({type:"Point",coordinates:p});break}case"LinearRing":case"LineString":{const p=eo(Mr(v));p.length>=2&&A.push({type:"LineString",coordinates:p});break}case"Polygon":{const p=[];for(const f of Sn(v,"LinearRing")){const m=jo(eo(Mr(f)));m.length>=4&&p.push(m)}p.length&&A.push({type:"Polygon",coordinates:p});break}case"Track":case"gx:Track":{const p=na(v);if(!p)break;const{times:f,geometry:m}=p;A.push(m),f.length&&c.push(f);break}}}return{geometries:A,coordTimes:c}}const Hi=g=>Number(g),no={string:g=>g,int:Hi,uint:Hi,short:Hi,ushort:Hi,float:Hi,double:Hi,bool:g=>!!g};function so(g,A){return Tn(g,"ExtendedData",(c,x)=>{for(const v of Sn(c,"Data"))x[v.getAttribute("name")||""]=nn(je(v,"value"));for(const v of Sn(c,"SimpleData")){const p=v.getAttribute("name")||"",f=A[p]||no.string;x[p]=f(nn(v))}return x})}function ao(g){const A=je(g,"description");for(const c of Array.from((A==null?void 0:A.childNodes)||[]))if(c.nodeType===4)return{description:{"@type":"html",value:nn(c)}};return{}}function uo(g){return Tn(g,"TimeSpan",A=>({timespan:{begin:nn(je(A,"begin")),end:nn(je(A,"end"))}}))}function co(g){return Tn(g,"TimeStamp",A=>({timestamp:nn(je(A,"when"))}))}function lo(g,A){return Vi(g,"styleUrl",c=>(c=Nr(c),A[c]?Object.assign({styleUrl:c},A[c]):{styleUrl:c}))}var pn;(function(g){g.ABSOLUTE="absolute",g.RELATIVE_TO_GROUND="relativeToGround",g.CLAMP_TO_GROUND="clampToGround",g.CLAMP_TO_SEAFLOOR="clampToSeaFloor",g.RELATIVE_TO_SEAFLOOR="relativeToSeaFloor"})(pn||(pn={}));function ia(g){switch(g==null?void 0:g.textContent){case pn.ABSOLUTE:return pn.ABSOLUTE;case pn.CLAMP_TO_GROUND:return pn.CLAMP_TO_GROUND;case pn.CLAMP_TO_SEAFLOOR:return pn.CLAMP_TO_SEAFLOOR;case pn.RELATIVE_TO_GROUND:return pn.RELATIVE_TO_GROUND;case pn.RELATIVE_TO_SEAFLOOR:return pn.RELATIVE_TO_SEAFLOOR}return null}function ra(g){return je(g,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[jo(eo(Mr(g)))]}}:aa(g)}const oa=Math.PI/180;function sa(g,A,c){const x=[(g[0]+g[2])/2,(g[1]+g[3])/2];return[A[0].map(v=>{const p=v[1]-x[1],f=v[0]-x[0],m=Math.sqrt(p**2+f**2),w=Math.atan2(p,f)+c*oa;return[x[0]+Math.cos(w)*m,x[1]+Math.sin(w)*m]})]}function aa(g){const A=je(g,"LatLonBox");if(A){const c=Je(A,"north"),x=Je(A,"west"),v=Je(A,"east"),p=Je(A,"south"),f=Je(A,"rotation");if(typeof c=="number"&&typeof p=="number"&&typeof x=="number"&&typeof v=="number"){const m=[x,p,v,c];let w=[[[x,c],[v,c],[v,p],[x,p],[x,c]]];return typeof f=="number"&&(w=sa(m,w,f)),{bbox:m,geometry:{type:"Polygon",coordinates:w}}}}return null}function ua(g,A,c,x){var w;const v=ra(g),p=(v==null?void 0:v.geometry)||null;if(!p&&x.skipNullGeometry)return null;const f={type:"Feature",geometry:p,properties:Object.assign({"@geometry-type":"groundoverlay"},Fr(g,["name","address","visibility","open","phoneNumber","description"]),ao(g),lo(g,A),jr(g),oo(g),so(g,c),uo(g),co(g))};v!=null&&v.bbox&&(f.bbox=v.bbox),((w=f.properties)==null?void 0:w.visibility)!==void 0&&(f.properties.visibility=f.properties.visibility!=="0");const m=g.getAttribute("id");return m!==null&&m!==""&&(f.id=m),f}function ca(g){const A=je(g,"Region");return A?{coordinateBox:ha(A),lod:la(g)}:null}function la(g){const A=je(g,"Lod");return A?[Je(A,"minLodPixels")??-1,Je(A,"maxLodPixels")??-1,Je(A,"minFadeExtent")??null,Je(A,"maxFadeExtent")??null]:null}function ha(g){const A=je(g,"LatLonAltBox");if(A){const c=Je(A,"north"),x=Je(A,"west"),v=Je(A,"east"),p=Je(A,"south");if(ia(je(A,"altitudeMode")||je(A,"gx:altitudeMode"))&&console.debug("Encountered an unsupported feature of KML for togeojson: please contact developers for support of altitude mode."),typeof c=="number"&&typeof p=="number"&&typeof x=="number"&&typeof v=="number")return{bbox:[x,p,v,c],geometry:{type:"Polygon",coordinates:[[[x,c],[v,c],[v,p],[x,p],[x,c]]]}}}return null}function fa(g){const A=je(g,"Link");return A?Fr(A,["href","refreshMode","refreshInterval","viewRefreshMode","viewRefreshTime","viewBoundScale","viewFormat","httpQuery"]):{}}function da(g,A,c,x){var w,D,F;const v=ca(g),p=((w=v==null?void 0:v.coordinateBox)==null?void 0:w.geometry)||null;if(!p&&x.skipNullGeometry)return null;const f={type:"Feature",geometry:p,properties:Object.assign({"@geometry-type":"networklink"},Fr(g,["name","address","visibility","open","phoneNumber","styleUrl","refreshVisibility","flyToView","description"]),ao(g),lo(g,A),jr(g),oo(g),so(g,c),uo(g),co(g),fa(g),v!=null&&v.lod?{lod:v.lod}:{})};(D=v==null?void 0:v.coordinateBox)!=null&&D.bbox&&(f.bbox=v.coordinateBox.bbox),((F=f.properties)==null?void 0:F.visibility)!==void 0&&(f.properties.visibility=f.properties.visibility!=="0");const m=g.getAttribute("id");return m!==null&&m!==""&&(f.id=m),f}function pa(g){return g.length===0?null:g.length===1?g[0]:{type:"GeometryCollection",geometries:g}}function ma(g,A,c,x){var D;const{coordTimes:v,geometries:p}=Uo(g),f=pa(p);if(!f&&x.skipNullGeometry)return null;const m={type:"Feature",geometry:f,properties:Object.assign(Fr(g,["name","address","visibility","open","phoneNumber","description"]),ao(g),lo(g,A),jr(g),so(g,c),uo(g),co(g),v.length?{coordinateProperties:{times:v.length===1?v[0]:v}}:{})};((D=m.properties)==null?void 0:D.visibility)!==void 0&&(m.properties.visibility=m.properties.visibility!=="0");const w=g.getAttribute("id");return w!==null&&w!==""&&(m.id=w),m}function _a(g){let A=g.getAttribute("id");const c=g.parentNode;return!A&&Ro(c)&&c.localName==="CascadingStyle"&&(A=c.getAttribute("kml:id")||c.getAttribute("id")),Nr(A||"")}function ga(g){const A={};for(const c of Sn(g,"Style"))A[_a(c)]=jr(c);for(const c of Sn(g,"StyleMap")){const x=Nr(c.getAttribute("id")||"");Vi(c,"styleUrl",v=>{v=Nr(v),A[v]&&(A[x]=A[v])})}return A}function va(g){const A={};for(const c of Sn(g,"SimpleField"))A[c.getAttribute("name")||""]=no[c.getAttribute("type")||""]||no.string;return A}function*ya(g,A={skipNullGeometry:!1}){const c=g,x=ga(c),v=va(c);for(const p of Sn(c,"Placemark")){const f=ma(p,x,v,A);f&&(yield f)}for(const p of Sn(c,"GroundOverlay")){const f=ua(p,x,v,A);f&&(yield f)}for(const p of Sn(c,"NetworkLink")){const f=da(p,x,v,A);f&&(yield f)}}function ba(g,A={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(ya(g,A))}}const wa=Xe.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});Xe.Marker.prototype.options.icon=wa;const Ko=(g,A,c)=>{if(typeof A.lat=="number"&&typeof A.lng=="number"){const x=new Date(A.created_at).toLocaleString(),v=Object.entries(A.counts).map(([f,m])=>`<b>${f}:</b> ${m}`).join("<br>"),p=`<div style="text-align:center">
        <strong>${c}</strong><br>
        <small>${x}</small>
        <hr style="margin: 5px 0;">
        ${v||"No counts"}
        </div>`;return Xe.circleMarker([A.lat,A.lng],{radius:6,fillColor:"#ff0000",color:"#fff",weight:1,opacity:1,fillOpacity:.8}).addTo(g).bindPopup(p)}return null},xa=(g,A,c)=>{A.forEach(x=>Ko(g,x,c))},To=g=>{const A=Xe.map(g).setView([-1.9441,30.0619],13);Xe.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(A);let c=null,x=null,v=null;navigator.geolocation&&(v=navigator.geolocation.watchPosition(F=>{const{latitude:P,longitude:z}=F.coords;x=Xe.latLng(P,z),c?c.setLatLng(x):(c=Xe.circleMarker(x,{radius:8,fillColor:"#3388ff",color:"white",weight:2,opacity:1,fillOpacity:.8}).addTo(A),c.bindPopup("You are here"))},F=>{console.warn("Geolocation error:",F)},{enableHighAccuracy:!0,maximumAge:5e3,timeout:1e4}));const p=new Xe.Control({position:"topleft"});return p.onAdd=function(){const F=Xe.DomUtil.create("div","leaflet-bar leaflet-control"),P=Xe.DomUtil.create("a","",F);return P.innerHTML="ð",P.href="#",P.title="Snap to my location",P.style.backgroundColor="white",P.style.width="30px",P.style.height="30px",P.style.display="flex",P.style.alignItems="center",P.style.justifyContent="center",P.style.fontSize="18px",P.style.textDecoration="none",P.style.color="black",P.style.cursor="pointer",Xe.DomEvent.on(P,"click",function(z){Xe.DomEvent.stop(z),x?(A.flyTo(x,16),c&&c.openPopup()):alert("Waiting for GPS signal...")}),F},p.addTo(A),(async()=>{try{const F=await fetch("/Tallies/maps/index.json");if(!F.ok)return;const P=await F.json(),z=Xe.latLngBounds([]);let k=!1;for(const C of P)try{const O=await(await fetch(`/Tallies/maps/${C}`)).blob();let T="";if(C.endsWith(".kmz")){const I=await Gs.loadAsync(O),j=Object.keys(I.files).find(J=>J.endsWith(".kml"));j&&(T=await I.files[j].async("string"))}else C.endsWith(".kml")&&(T=await O.text());if(T){const j=new DOMParser().parseFromString(T,"text/xml"),J=ba(j),X=Xe.geoJSON(J,{onEachFeature:(lt,rt)=>{if(lt.properties){let wt='<div style="max-height: 200px; overflow-y: auto;"><h4>Info</h4><ul>';Object.keys(lt.properties).forEach(at=>{const xt=lt.properties[at];xt!==null&&typeof xt!="object"&&(wt+=`<li><strong>${at}:</strong> ${xt}</li>`)}),wt+="</ul></div>",rt.bindPopup(wt)}},style:{color:"#ff7800",weight:2,opacity:.65}}).addTo(A);z.extend(X.getBounds()),k=!0}}catch(b){console.error(`Failed to load map ${C}:`,b)}k&&z.isValid()&&A.fitBounds(z)}catch(F){console.error("Failed to load map index:",F)}})(),setTimeout(()=>{A.invalidateSize()},100),{cleanup:()=>{v!==null&&navigator.geolocation.clearWatch(v),A.remove()},map:A,getCurrentLocation:()=>x,addMarker:(F,P)=>Ko(A,F,P)}},ka=(g,A)=>{let c=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>${A}</name>
`;return g.forEach(x=>{if(typeof x.lat=="number"&&typeof x.lng=="number"){const v=new Date(x.created_at).toLocaleString(),p=Object.entries(x.counts).map(([w,D])=>`${w}: ${D}`).join(`
`),m=`Time: ${v}
Species:
${p}`.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\n/g,"&#xA;");c+=`    <Placemark>
      <name>${A}</name>
      <description>${m}</description>
      <Point>
        <coordinates>${x.lng},${x.lat},0</coordinates>
      </Point>
    </Placemark>
`}}),c+=`  </Document>
</kml>`,c},Pa=()=>new Date().toISOString().slice(0,10),Wo=g=>new Date(g).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),Sa=g=>new Date(g).toLocaleString([],{dateStyle:"short",timeStyle:"short"}),Ta=(g,A)=>A===0?"â":`${Math.round(g*100)}%`,Lo=(g,A,c)=>{const x=vt("div",{className:"bagup-item"}),v=vt("div",{className:"bagup-header"}),p=vt("div",{text:Wo(g.created_at)}),f=vt("div",{className:"small",text:c});v.append(p,f);const m=vt("div",{className:"bagup-counts"});return A.species.forEach(w=>{const D=g.counts[w.species_code]??0;m.append(vt("span",{className:"bagup-count",text:`${w.display_name}: ${D}`}))}),x.append(v,m),x},La=(g,A,c,x)=>{const v=Object.values(c).reduce((p,f)=>p+f,0);A.forEach(p=>{const f=g.querySelector(`[data-species-code="${p.species_code}"]`);if(!f)return;const m=f.querySelector(".species-current"),w=f.querySelector(".species-total");m&&(m.textContent=`Current: ${Ta(x[p.species_code]??0,v)}`),w&&(w.textContent=`Total: ${c[p.species_code]??0}`)})},Ea=g=>{const A=vt("div",{className:"tally-item"}),c=vt("div",{text:`${g.trees} trees${g.block_name?` Â· ${g.block_name}`:""}`}),x=vt("div",{className:"tally-meta"}),v=vt("span",{text:g.sync_status}),p=vt("span",{text:Wo(g.created_at)});if(x.append(v,p),g.notes){const f=vt("div",{className:"small",text:g.notes});A.append(c,x,f)}else A.append(c,x);if(g.sync_status==="error"&&g.sync_error){const f=vt("div",{className:"small",text:`Sync error: ${g.sync_error}`});A.append(f)}return A},Ir=()=>{const g=document.createElement("img");return g.src="/Tallies/Logo.png",g.alt="Tree Tally",g.className="app-logo",g},Ca=()=>{const g=document.querySelector("#app");if(!g)return;Oe("App initialized");let A={view:"home"},c=null,x="All Sessions",v=null,p=null;const f=P=>{Oe("Navigate",P),A=P,F()},m=async()=>{v&&(v(),v=null),g.innerHTML="";const P=Ir(),z=vt("section",{className:"card"}),k=vt("section",{className:"card"}),C=vt("section",{className:"card"}),b=vt("section",{className:"card"}),O=vt("div");O.id="map-container",b.append(O);const T=vt("section",{className:"card"}),I=vt("section",{className:"card"}),j=vt("button",{text:"Start New Tally"});j.type="button",j.addEventListener("click",()=>f({view:"new-session"})),z.append(j);const J=vt("h2",{text:"Today"}),X=vt("div",{className:"tally-list"});k.append(J,X);const lt=vt("h2",{text:"Tally Sessions"}),rt=vt("div",{className:"row"});rt.style.overflowX="auto",rt.style.paddingBottom="8px",rt.style.marginBottom="8px",["All Sessions","Synced Sessions","Finalized Sessions","Archived Sessions","Error Sessions"].forEach(ht=>{const zt=vt("button",{text:ht});zt.className=ht===x?"compact":"compact secondary",zt.style.whiteSpace="nowrap",zt.addEventListener("click",async()=>{x=ht,Oe("Filter changed",{filter:ht}),await m()}),rt.append(zt)});const at=vt("div",{className:"tally-list"});C.append(lt,rt,at);const xt=vt("h2",{text:"Sync status"}),Zt=vt("div",{className:"status-row"}),N=vt("span",{className:"status-pill pending"}),ct=vt("span",{className:"status-pill synced"}),_=vt("span",{className:"status-pill error"});Zt.append(N,ct,_);const mt=vt("button",{text:"Sync now"});mt.className="secondary";const Nt=vt("button",{text:"Retry sync"}),pt=vt("div",{className:"small"});T.append(xt,Zt,mt,Nt,pt);const Pt=vt("button",{text:"Download Logs"});Pt.className="secondary",Pt.type="button",Pt.addEventListener("click",()=>{Oe("Download Logs clicked"),Ws()}),I.append(vt("h2",{text:"Debug"}),Pt),g.append(P,z,k,C,b,T,I);const{cleanup:kt}=To(O);v=kt;const gt=async()=>{const ht=Pa(),zt=await _s(ht);X.innerHTML="",zt.length===0?X.append(vt("div",{className:"small",text:"No tallies yet."})):zt.forEach(ne=>X.append(Ea(ne)))},Q=async()=>{const ht=await Ms(x);if(at.innerHTML="",ht.length===0){at.append(vt("div",{className:"small",text:"No sessions found."}));return}ht.forEach(zt=>{const ne=vt("button",{className:"session-item"});ne.type="button";const Dt=vt("div",{text:zt.block_name}),St=vt("div",{className:"tally-meta",text:`${zt.species.length} species Â· ${Sa(zt.created_at)} Â· ${zt.sync_status}`});ne.append(Dt,St),ne.addEventListener("click",()=>f({view:"session-detail",sessionId:zt.session_id})),at.append(ne)})},tt=async()=>{const[ht,zt,ne]=await Promise.all([vs(),Ps(),Os()]),Dt=zt.finalized,St=ht.synced+zt.synced+ne.synced,oe=ht.error+zt.error+ne.error;N.textContent=`Pending: ${Dt}`,ct.textContent=`Synced: ${St}`,_.textContent=`Error: ${oe}`},Ft=async()=>{await Promise.all([gt(),Q(),tt()])},Et=async()=>{Oe("Sync started"),mt.disabled=!0,Nt.disabled=!0,pt.textContent=navigator.onLine?"Syncing...":"Offline. Will retry later.",await Ks();const ht=await Us();ht.skipped?(pt.textContent="Offline. Tallies will sync when back online.",Oe("Sync skipped (offline)")):ht.failed>0?(pt.textContent=`Sync finished with ${ht.failed} failures. ${ht.errors.length>0?"Errors: "+ht.errors.join(", "):""}`,Oe("Sync finished with failures",ht)):(pt.textContent=`Synced ${ht.synced} records.`,Oe("Sync finished successfully",ht)),mt.disabled=!1,Nt.disabled=!1,await Ft()};mt.addEventListener("click",Et),Nt.addEventListener("click",Et),await Ft()},w=async()=>{g.innerHTML="";const[P,z]=await Promise.all([ds(),ms()]),k=vt("div",{className:"header-row"}),C=vt("button",{text:"Back"});C.type="button",C.className="secondary compact",C.addEventListener("click",async()=>{Oe("Back button clicked in New Session"),f({view:"home"})});const b=vt("h1",{text:"New Tally Session"});k.append(C,b);const O=vt("section",{className:"card"}),T=document.createElement("form"),I=vt("input");I.type="date";const j=new Date;I.value=`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}-${String(j.getDate()).padStart(2,"0")}`,I.required=!0;const J=vt("select"),X=vt("option",{text:"Select a project..."});X.value="",J.append(X),P.forEach(Nt=>{const pt=vt("option",{text:Nt.project_name});pt.value=Nt.project_name,J.append(pt)});const lt=vt("select");lt.required=!0;const rt=vt("option",{text:"Select a block..."});rt.value="",lt.append(rt);const wt=vt("select");wt.required=!0;const at=vt("option",{text:"Select a supervisor..."});at.value="",wt.append(at),z.forEach(Nt=>{const pt=vt("option",{text:Nt});pt.value=Nt,wt.append(pt)});const xt=vt("input");xt.type="number",xt.placeholder="Target Density",xt.min="0";const Zt=document.createElement("textarea");Zt.rows=2,Zt.placeholder="Notes (optional)";const N=vt("div",{className:"species-container"}),ct=vt("button",{text:"Start session"});ct.type="submit";const _=[],mt=Nt=>{const pt=Rs({initial:Nt});pt.codeInput.required=!0,pt.nameInput.required=!0,pt.ratioInput.required=!0,N.append(pt.row),_.push(pt)};J.addEventListener("change",()=>{const Nt=J.value,pt=P.find(gt=>gt.project_name===Nt);if(!pt)return;Oe("Project selected",{projectName:Nt}),lt.innerHTML="",lt.append(rt);const Pt=pt.blocks_data;Array.isArray(Pt)?Pt.forEach(gt=>{const Q=vt("option",{text:String(gt)});Q.value=String(gt),lt.append(Q)}):typeof Pt=="object"&&Pt!==null&&("error"in Pt?console.warn("Blocks data has error:",Pt.error):Object.values(Pt).forEach(gt=>{const Q=String(gt),tt=vt("option",{text:Q});tt.value=Q,lt.append(tt)})),_.forEach(gt=>gt.row.remove()),_.length=0;const kt=pt.species_data;"error"in kt||Object.entries(kt).forEach(([gt,Q])=>{mt({species_code:gt,display_name:Q,required_ratio:0})})}),T.append(vt("label",{text:"Date"}),I,vt("label",{text:"Project"}),J,vt("label",{text:"Block name"}),lt,vt("label",{text:"Supervisor"}),wt,vt("label",{text:"Target Density"}),xt,vt("label",{text:"Notes"}),Zt,vt("label",{text:"Species (code, name, required ratio)"}),N,ct),T.addEventListener("submit",async Nt=>{if(Nt.preventDefault(),!T.reportValidity())return;const pt=_.map(gt=>({species_code:gt.codeInput.value.trim(),display_name:gt.nameInput.value.trim(),required_ratio:Number(gt.ratioInput.value)})),Pt={block_name:lt.value,project_name:J.value,supervisor:wt.value,target_density:xt.value?Number(xt.value):void 0,notes:Zt.value,species:pt,date:I.value};Oe("Start Session",Pt),ct.disabled=!0;const kt=await ws(Pt);ct.disabled=!1,f({view:"session-detail",sessionId:kt.session_id})}),O.append(T),g.append(Ir(),k,O)},D=async P=>{g.innerHTML="";const z=await xs(P);if(!z){const Dt=vt("div",{className:"small",text:"Session not found."}),St=vt("button",{text:"Back"});St.type="button",St.addEventListener("click",()=>f({view:"home"})),g.append(St,Dt);return}const k=await Es(P),C=(c==null?void 0:c.sessionId)===P?c:null,b=C?[...k.filter(Dt=>Dt.bagup_id!==C.bagupId),{bagup_id:C.bagupId,session_id:P,created_at:C.createdAt,counts:C.counts,sync_status:"pending"}].sort((Dt,St)=>St.created_at-Dt.created_at):k,O=So(z.species,b),T=dr(z.species,O);Object.values(O).reduce((Dt,St)=>Dt+St,0);const I=b[0],j=I?Io(Date.now()-I.created_at):"â",J=vt("div",{className:"header-row"}),X=vt("button",{text:"Back"});X.type="button",X.className="secondary compact",X.addEventListener("click",()=>{Oe("Back from Session Detail"),f({view:"home"})});const lt=vt("h1",{text:z.block_name}),rt=vt("div");rt.style.display="flex",rt.style.gap="8px";const wt=z.sync_status==="draft"||z.sync_status==="pending"||z.sync_status==="error";if(wt){const Dt=vt("button",{text:"Finalize"});Dt.className="compact",Dt.addEventListener("click",async()=>{confirm("Finalize session? This will make it ready for sync and lock it for editing.")&&(Oe("Finalize Session",{sessionId:P}),await Bs(P),await D(P))}),rt.append(Dt)}const at=vt("button",{text:"Archive"});at.className="compact secondary",at.addEventListener("click",async()=>{confirm("Archive session? It will be hidden from the main list.")&&(Oe("Archive Session",{sessionId:P}),await Is(P),f({view:"home"}))}),rt.append(at);const xt=vt("button",{text:"+"});xt.type="button",xt.className="fab",xt.disabled=!wt,J.append(X,lt,rt);const Zt=vt("section",{className:"card"}),N=vt("div",{className:"meta-row"}),ct=vt("div",{className:"small",text:`Time since last bagup: ${j}`}),_=vt("div",{className:"small",text:`Started ${new Date(z.created_at).toLocaleDateString()}`});z.project_name&&N.append(vt("div",{className:"small",text:`Project: ${z.project_name}`})),z.supervisor&&N.append(vt("div",{className:"small",text:`Supervisor: ${z.supervisor}`})),z.target_density&&N.append(vt("div",{className:"small",text:`Target Density: ${z.target_density}`}));const mt=vt("div",{className:"small",text:`Status: ${z.sync_status}`});if(N.append(ct,_,mt),z.notes){const Dt=vt("div",{className:"small",text:z.notes});Zt.append(N,Dt)}else Zt.append(N);const Nt=vt("section",{className:"card"}),pt=vt("h2",{text:"Species totals"}),Pt=vt("div",{className:"species-summary-list"});z.species.forEach(Dt=>{Pt.append(Zs(Dt))}),Nt.append(pt,Pt);const kt=vt("section",{className:"card"}),gt=vt("div",{className:"bagup-title-row"}),Q=vt("h2",{text:"Bagups"});gt.append(Q,xt);const tt=vt("div",{className:"tally-list"});kt.append(gt,tt);const Ft=vt("section",{className:"card"}),Et=vt("div");Et.id="session-map-container",Et.style.height="400px",Ft.append(Et),p&&(p.cleanup(),p=null),p=To(Et);const{map:ht}=p;if(k.length>0){xa(ht,k,z.block_name);const Dt=ka(k,z.block_name);console.log("--- Generated KML Content for public/maps/bagups.kml ---"),console.log(Dt),console.log("--------------------------------------------------------")}const zt=(Dt,St)=>{La(Pt,z.species,Dt,St)};if(zt(O,T),(Dt=>{if(tt.innerHTML="",Dt.length===0){tt.append(vt("div",{className:"small",text:"No bagups yet."}));return}const St=Ds(Dt);Dt.forEach(oe=>{tt.append(Lo(oe,z,St[oe.bagup_id]))})})(k.filter(Dt=>Dt.bagup_id!==(C==null?void 0:C.bagupId))),xt.addEventListener("click",async()=>{if(c||!wt)return;Oe("Add Bagup clicked");const Dt=(p==null?void 0:p.getCurrentLocation())??void 0,St=z.species.map(q=>q.species_code),oe=await Ls(P,St,Dt?{lat:Dt.lat,lng:Dt.lng}:void 0);let ce=null;const Xt=setTimeout(()=>{p&&(ce=p.addMarker(oe,z.block_name))},50);c={sessionId:P,bagupId:oe.bagup_id,createdAt:oe.created_at,counts:{...oe.counts}},xt.style.display="none";const he=vt("section",{className:"card"}),h=vt("h2",{text:"New bagup"}),dt=document.createElement("form");z.species.forEach(q=>{const yt=vt("label",{text:q.display_name}),_t=vt("input");_t.type="number",_t.min="0",_t.value="0",_t.addEventListener("input",()=>{if(!c)return;c.counts[q.species_code]=Number(_t.value||0);const nt={...O};Object.entries(c.counts).forEach(([Ut,Ot])=>{nt[Ut]=(nt[Ut]||0)+Ot});const Lt=dr(z.species,nt);zt(nt,Lt)}),dt.append(yt,_t)});const st=vt("div",{className:"editor-actions"}),B=vt("button",{text:"Cancel"});B.type="button",B.className="secondary";const E=vt("button",{text:"Save bagup"});E.type="submit",st.append(B,E),B.addEventListener("click",async()=>{if(!c)return;Oe("Cancel Bagup"),await Po(c.bagupId),clearTimeout(Xt),ce&&ce.remove(),c=null,he.remove(),xt.style.display="";const q=dr(z.species,O);zt(O,q)}),dt.addEventListener("submit",async q=>{if(q.preventDefault(),!c)return;Oe("Save Bagup",c.counts),E.disabled=!0,await ko(c.bagupId,c.counts);const yt={bagup_id:c.bagupId,created_at:c.createdAt,counts:c.counts};Object.entries(c.counts).forEach(([Ut,Ot])=>{O[Ut]=(O[Ut]||0)+Ot}),c=null,he.remove(),xt.style.display="";const _t="Just now",nt=tt.querySelector("div.small");nt&&nt.textContent==="No bagups yet."&&nt.remove(),tt.prepend(Lo(yt,z,_t));const Lt=dr(z.species,O);zt(O,Lt)}),dt.append(st),he.append(h,dt),kt.before(he),he.scrollIntoView({behavior:"smooth"})}),C&&wt){const Dt=vt("section",{className:"card"}),St=vt("h2",{text:"New bagup"}),oe=document.createElement("form");z.species.forEach(h=>{const dt=vt("label",{text:h.display_name}),st=vt("input");st.type="number",st.min="0",st.value=String(C.counts[h.species_code]??0),st.addEventListener("input",()=>{C.counts[h.species_code]=Number(st.value||0);const B=So(z.species,[...k.filter(q=>q.bagup_id!==C.bagupId),{bagup_id:C.bagupId,session_id:P,created_at:C.createdAt,counts:C.counts,sync_status:"pending"}]),E=dr(z.species,B);zt(B,E)}),oe.append(dt,st)});const ce=vt("div",{className:"editor-actions"}),Xt=vt("button",{text:"Cancel"});Xt.type="button",Xt.className="secondary";const he=vt("button",{text:"Save bagup"});he.type="submit",ce.append(Xt,he),Xt.addEventListener("click",async()=>{Oe("Cancel Bagup"),await Po(C.bagupId),c=null,await D(P)}),oe.addEventListener("submit",async h=>{h.preventDefault(),Oe("Save Bagup",C.counts),he.disabled=!0,await ko(C.bagupId,C.counts),c=null,he.disabled=!1,await D(P)}),oe.append(ce),Dt.append(St,oe),g.append(Ir(),J,Zt,Nt,Dt,kt,Ft)}else g.append(Ir(),J,Zt,Nt,kt,Ft)},F=async()=>{switch(v&&(v(),v=null),A.view){case"home":await m();return;case"new-session":await w();return;case"session-detail":await D(A.sessionId);return;default:return}};F()},Oa="modulepreload",Aa=function(g){return"/Tallies/"+g},Eo={},za=function(A,c,x){let v=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));v=Promise.allSettled(c.map(w=>{if(w=Aa(w),w in Eo)return;Eo[w]=!0;const D=w.endsWith(".css"),F=D?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${w}"]${F}`))return;const P=document.createElement("link");if(P.rel=D?"stylesheet":Oa,D||(P.as="script"),P.crossOrigin="",P.href=w,m&&P.setAttribute("nonce",m),document.head.appendChild(P),D)return new Promise((z,k)=>{P.addEventListener("load",z),P.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${w}`)))})}))}function p(f){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=f,window.dispatchEvent(m),!m.defaultPrevented)throw f}return v.then(f=>{for(const m of f||[])m.status==="rejected"&&p(m.reason);return A().catch(p)})};function Ba(g={}){const{immediate:A=!1,onNeedRefresh:c,onOfflineReady:x,onRegistered:v,onRegisteredSW:p,onRegisterError:f}=g;let m,w;const D=async(P=!0)=>{await w};async function F(){if("serviceWorker"in navigator){if(m=await za(async()=>{const{Workbox:P}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:P}},[]).then(({Workbox:P})=>new P("/Tallies/sw.js",{scope:"/Tallies/",type:"classic"})).catch(P=>{f==null||f(P)}),!m)return;m.addEventListener("activated",P=>{(P.isUpdate||P.isExternal)&&window.location.reload()}),m.addEventListener("installed",P=>{P.isUpdate||x==null||x()}),m.register({immediate:A}).then(P=>{p?p("/Tallies/sw.js",P):v==null||v(P)}).catch(P=>{f==null||f(P)})}}return w=F(),D}Ca();Ba({immediate:!0});
