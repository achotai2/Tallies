var Xo=Object.defineProperty;var Jo=(m,z,c)=>z in m?Xo(m,z,{enumerable:!0,configurable:!0,writable:!0,value:c}):m[z]=c;var Ui=(m,z,c)=>Jo(m,typeof z!="symbol"?z+"":z,c);(function(){const z=document.createElement("link").relList;if(z&&z.supports&&z.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))k(_);new MutationObserver(_=>{for(const p of _)if(p.type==="childList")for(const y of p.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&k(y)}).observe(document,{childList:!0,subtree:!0});function c(_){const p={};return _.integrity&&(p.integrity=_.integrity),_.referrerPolicy&&(p.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?p.credentials="include":_.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function k(_){if(_.ep)return;_.ep=!0;const p=c(_);fetch(_.href,p)}})();const kt=(m,z={})=>{const c=document.createElement(m);return z.className&&(c.className=z.className),z.text!==void 0&&(c.textContent=z.text),c};var Ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function no(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var So={exports:{}};(function(m,z){(function(c,k){m.exports=k()})(Ti,function(){var c=function(n,r){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[l]=a[l])})(n,r)},k=function(){return(k=Object.assign||function(n){for(var r,s=1,a=arguments.length;s<a;s++)for(var l in r=arguments[s])Object.prototype.hasOwnProperty.call(r,l)&&(n[l]=r[l]);return n}).apply(this,arguments)};function _(n,r,s){for(var a,l=0,f=r.length;l<f;l++)!a&&l in r||((a=a||Array.prototype.slice.call(r,0,l))[l]=r[l]);return n.concat(a||Array.prototype.slice.call(r))}var p=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ti,y=Object.keys,g=Array.isArray;function w(n,r){return typeof r!="object"||y(r).forEach(function(s){n[s]=r[s]}),n}typeof Promise>"u"||p.Promise||(p.Promise=Promise);var M=Object.getPrototypeOf,R={}.hasOwnProperty;function T(n,r){return R.call(n,r)}function D(n,r){typeof r=="function"&&(r=r(M(n))),(typeof Reflect>"u"?y:Reflect.ownKeys)(r).forEach(function(s){O(n,s,r[s])})}var x=Object.defineProperty;function O(n,r,s,a){x(n,r,w(s&&T(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},a))}function b(n){return{from:function(r){return n.prototype=Object.create(r.prototype),O(n.prototype,"constructor",n),{extend:D.bind(null,n.prototype)}}}}var C=Object.getOwnPropertyDescriptor,P=[].slice;function I(n,r,s){return P.call(n,r,s)}function j(n,r){return r(n)}function X(n){if(!n)throw new Error("Assertion Failed")}function Y(n){p.setImmediate?setImmediate(n):setTimeout(n,0)}function ct(n,r){if(typeof r=="string"&&T(n,r))return n[r];if(!r)return n;if(typeof r!="string"){for(var s=[],a=0,l=r.length;a<l;++a){var f=ct(n,r[a]);s.push(f)}return s}var S=r.indexOf(".");if(S!==-1){var B=n[r.substr(0,S)];return B==null?void 0:ct(B,r.substr(S+1))}}function ot(n,r,s){if(n&&r!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof r!="string"&&"length"in r){X(typeof s!="string"&&"length"in s);for(var a=0,l=r.length;a<l;++a)ot(n,r[a],s[a])}else{var f,S,B=r.indexOf(".");B!==-1?(f=r.substr(0,B),(S=r.substr(B+1))===""?s===void 0?g(n)&&!isNaN(parseInt(f))?n.splice(f,1):delete n[f]:n[f]=s:ot(B=!(B=n[f])||!T(n,f)?n[f]={}:B,S,s)):s===void 0?g(n)&&!isNaN(parseInt(r))?n.splice(r,1):delete n[r]:n[r]=s}}function wt(n){var r,s={};for(r in n)T(n,r)&&(s[r]=n[r]);return s}var at=[].concat;function Tt(n){return at.apply([],n)}var Gt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Tt([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(r){return r+n+"Array"})}))).filter(function(n){return p[n]}),Rt=new Set(Gt.map(function(n){return p[n]})),N=null;function lt(n){return N=new WeakMap,n=function r(s){if(!s||typeof s!="object")return s;var a=N.get(s);if(a)return a;if(g(s)){a=[],N.set(s,a);for(var l=0,f=s.length;l<f;++l)a.push(r(s[l]))}else if(Rt.has(s.constructor))a=s;else{var S,B=M(s);for(S in a=B===Object.prototype?{}:Object.create(B),N.set(s,a),s)T(s,S)&&(a[S]=r(s[S]))}return a}(n),N=null,n}var d={}.toString;function ht(n){return d.call(n).slice(8,-1)}var zt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",mt=typeof zt=="symbol"?function(n){var r;return n!=null&&(r=n[zt])&&r.apply(n)}:function(){return null};function Lt(n,r){return r=n.indexOf(r),0<=r&&n.splice(r,1),0<=r}var _t={};function bt(n){var r,s,a,l;if(arguments.length===1){if(g(n))return n.slice();if(this===_t&&typeof n=="string")return[n];if(l=mt(n)){for(s=[];!(a=l.next()).done;)s.push(a.value);return s}if(n==null)return[n];if(typeof(r=n.length)!="number")return[n];for(s=new Array(r);r--;)s[r]=n[r];return s}for(r=arguments.length,s=new Array(r);r--;)s[r]=arguments[r];return s}var $=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ot=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ve=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ot),tt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Zt(n,r){this.name=n,this.message=r}function vt(n,r){return n+". Errors: "+Object.keys(r).map(function(s){return r[s].toString()}).filter(function(s,a,l){return l.indexOf(s)===a}).join(`
`)}function dt(n,r,s,a){this.failures=r,this.failedKeys=a,this.successCount=s,this.message=vt(n,r)}function jt(n,r){this.name="BulkError",this.failures=Object.keys(r).map(function(s){return r[s]}),this.failuresByPos=r,this.message=vt(n,this.failures)}b(Zt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(dt).from(Zt),b(jt).from(Zt);var le=Ve.reduce(function(n,r){return n[r]=r+"Error",n},{}),Nt=Zt,Pt=Ve.reduce(function(n,r){var s=r+"Error";function a(l,f){this.name=s,l?typeof l=="string"?(this.message="".concat(l).concat(f?`
 `+f:""),this.inner=f||null):typeof l=="object"&&(this.message="".concat(l.name," ").concat(l.message),this.inner=l):(this.message=tt[r]||s,this.inner=null)}return b(a).from(Nt),n[r]=a,n},{});Pt.Syntax=SyntaxError,Pt.Type=TypeError,Pt.Range=RangeError;var oe=Ot.reduce(function(n,r){return n[r+"Error"]=Pt[r],n},{}),Qt=Ve.reduce(function(n,r){return["Syntax","Type","Range"].indexOf(r)===-1&&(n[r+"Error"]=Pt[r]),n},{});function Vt(){}function he(n){return n}function h(n,r){return n==null||n===he?r:function(s){return r(n(s))}}function pt(n,r){return function(){n.apply(this,arguments),r.apply(this,arguments)}}function st(n,r){return n===Vt?r:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var a=this.onsuccess,l=this.onerror;this.onsuccess=null,this.onerror=null;var f=r.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?pt(a,this.onsuccess):a),l&&(this.onerror=this.onerror?pt(l,this.onerror):l),f!==void 0?f:s}}function A(n,r){return n===Vt?r:function(){n.apply(this,arguments);var s=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?pt(s,this.onsuccess):s),a&&(this.onerror=this.onerror?pt(a,this.onerror):a)}}function E(n,r){return n===Vt?r:function(s){var a=n.apply(this,arguments);w(s,a);var l=this.onsuccess,f=this.onerror;return this.onsuccess=null,this.onerror=null,s=r.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?pt(l,this.onsuccess):l),f&&(this.onerror=this.onerror?pt(f,this.onerror):f),a===void 0?s===void 0?void 0:s:w(a,s)}}function J(n,r){return n===Vt?r:function(){return r.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function xt(n,r){return n===Vt?r:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var a=this,l=arguments.length,f=new Array(l);l--;)f[l]=arguments[l];return s.then(function(){return r.apply(a,f)})}return r.apply(this,arguments)}}Qt.ModifyError=dt,Qt.DexieError=Zt,Qt.BulkError=jt;var yt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function it(n){yt=n}var Ct={},Kt=100,Gt=typeof Promise>"u"?[]:function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,M(n),n];var r=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[r,M(r),n]}(),Ot=Gt[0],Ve=Gt[1],Gt=Gt[2],Ve=Ve&&Ve.then,ce=Ot&&Ot.constructor,ie=!!Gt,Se=function(n,r){qe.push([n,r]),Oe&&(queueMicrotask(Kr),Oe=!1)},rn=!0,Oe=!0,Ke=[],me=[],on=he,Ue={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Vt,pgp:!1,env:{},finalize:Vt},Ut=Ue,qe=[],mn=0,Gn=[];function Ft(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var r=this._PSD=Ut;if(typeof n!="function"){if(n!==Ct)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ln(this,this._value))}this._state=null,this._value=null,++r.ref,function s(a,l){try{l(function(f){if(a._state===null){if(f===a)throw new TypeError("A promise cannot be resolved with itself.");var S=a._lib&&Vn();f&&typeof f.then=="function"?s(a,function(B,K){f instanceof Ft?f._then(B,K):f.then(B,K)}):(a._state=!0,a._value=f,pr(a)),S&&En()}},Ln.bind(null,a))}catch(f){Ln(a,f)}}(this,n)}var Zn={get:function(){var n=Ut,r=ci;function s(a,l){var f=this,S=!n.global&&(n!==Ut||r!==ci),B=S&&!vn(),K=new Ft(function(U,V){Yi(f,new _n(vr(a,n,S,B),vr(l,n,S,B),U,V,n))});return this._consoleTask&&(K._consoleTask=this._consoleTask),K}return s.prototype=Ct,s},set:function(n){O(this,"then",n&&n.prototype===Ct?Zn:{get:function(){return n},set:Zn.set})}};function _n(n,r,s,a,l){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof r=="function"?r:null,this.resolve=s,this.reject=a,this.psd=l}function Ln(n,r){var s,a;me.push(r),n._state===null&&(s=n._lib&&Vn(),r=on(r),n._state=!1,n._value=r,a=n,Ke.some(function(l){return l._value===a._value})||Ke.push(a),pr(n),s&&En())}function pr(n){var r=n._listeners;n._listeners=[];for(var s=0,a=r.length;s<a;++s)Yi(n,r[s]);var l=n._PSD;--l.ref||l.finalize(),mn===0&&(++mn,Se(function(){--mn==0&&Xi()},[]))}function Yi(n,r){if(n._state!==null){var s=n._state?r.onFulfilled:r.onRejected;if(s===null)return(n._state?r.resolve:r.reject)(n._value);++r.psd.ref,++mn,Se(jr,[s,n,r])}else n._listeners.push(r)}function jr(n,r,s){try{var a,l=r._value;!r._state&&me.length&&(me=[]),a=yt&&r._consoleTask?r._consoleTask.run(function(){return n(l)}):n(l),r._state||me.indexOf(l)!==-1||function(f){for(var S=Ke.length;S;)if(Ke[--S]._value===f._value)return Ke.splice(S,1)}(r),s.resolve(a)}catch(f){s.reject(f)}finally{--mn==0&&Xi(),--s.psd.ref||s.psd.finalize()}}function Kr(){Fn(Ue,function(){Vn()&&En()})}function Vn(){var n=rn;return Oe=rn=!1,n}function En(){var n,r,s;do for(;0<qe.length;)for(n=qe,qe=[],s=n.length,r=0;r<s;++r){var a=n[r];a[0].apply(null,a[1])}while(0<qe.length);Oe=rn=!0}function Xi(){var n=Ke;Ke=[],n.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});for(var r=Gn.slice(0),s=r.length;s;)r[--s]()}function Li(n){return new Ft(Ct,!1,n)}function ge(n,r){var s=Ut;return function(){var a=Vn(),l=Ut;try{return On(s,!0),n.apply(this,arguments)}catch(f){r&&r(f)}finally{On(l,!1),a&&En()}}}D(Ft.prototype,{then:Zn,_then:function(n,r){Yi(this,new _n(null,null,n,r,Ut))},catch:function(n){if(arguments.length===1)return this.then(null,n);var r=n,s=arguments[1];return typeof r=="function"?this.then(null,function(a){return(a instanceof r?s:Li)(a)}):this.then(null,function(a){return(a&&a.name===r?s:Li)(a)})},finally:function(n){return this.then(function(r){return Ft.resolve(n()).then(function(){return r})},function(r){return Ft.resolve(n()).then(function(){return Li(r)})})},timeout:function(n,r){var s=this;return n<1/0?new Ft(function(a,l){var f=setTimeout(function(){return l(new Pt.Timeout(r))},n);s.then(a,l).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&O(Ft.prototype,Symbol.toStringTag,"Dexie.Promise"),Ue.env=gr(),D(Ft,{all:function(){var n=bt.apply(null,arguments).map(yn);return new Ft(function(r,s){n.length===0&&r([]);var a=n.length;n.forEach(function(l,f){return Ft.resolve(l).then(function(S){n[f]=S,--a||r(n)},s)})})},resolve:function(n){return n instanceof Ft?n:n&&typeof n.then=="function"?new Ft(function(r,s){n.then(r,s)}):new Ft(Ct,!0,n)},reject:Li,race:function(){var n=bt.apply(null,arguments).map(yn);return new Ft(function(r,s){n.map(function(a){return Ft.resolve(a).then(r,s)})})},PSD:{get:function(){return Ut},set:function(n){return Ut=n}},totalEchoes:{get:function(){return ci}},newPSD:gn,usePSD:Fn,scheduler:{get:function(){return Se},set:function(n){Se=n}},rejectionMapper:{get:function(){return on},set:function(n){on=n}},follow:function(n,r){return new Ft(function(s,a){return gn(function(l,f){var S=Ut;S.unhandleds=[],S.onunhandled=f,S.finalize=pt(function(){var B,K=this;B=function(){K.unhandleds.length===0?l():f(K.unhandleds[0])},Gn.push(function U(){B(),Gn.splice(Gn.indexOf(U),1)}),++mn,Se(function(){--mn==0&&Xi()},[])},S.finalize),n()},r,s,a)})}}),ce&&(ce.allSettled&&O(Ft,"allSettled",function(){var n=bt.apply(null,arguments).map(yn);return new Ft(function(r){n.length===0&&r([]);var s=n.length,a=new Array(s);n.forEach(function(l,f){return Ft.resolve(l).then(function(S){return a[f]={status:"fulfilled",value:S}},function(S){return a[f]={status:"rejected",reason:S}}).then(function(){return--s||r(a)})})})}),ce.any&&typeof AggregateError<"u"&&O(Ft,"any",function(){var n=bt.apply(null,arguments).map(yn);return new Ft(function(r,s){n.length===0&&s(new AggregateError([]));var a=n.length,l=new Array(a);n.forEach(function(f,S){return Ft.resolve(f).then(function(B){return r(B)},function(B){l[S]=B,--a||s(new AggregateError(l))})})})}),ce.withResolvers&&(Ft.withResolvers=ce.withResolvers));var Te={awaits:0,echoes:0,id:0},sn=0,Yt=[],ui=0,ci=0,mr=0;function gn(n,r,s,a){var l=Ut,f=Object.create(l);return f.parent=l,f.ref=0,f.global=!1,f.id=++mr,Ue.env,f.env=ie?{Promise:Ft,PromiseProp:{value:Ft,configurable:!0,writable:!0},all:Ft.all,race:Ft.race,allSettled:Ft.allSettled,any:Ft.any,resolve:Ft.resolve,reject:Ft.reject}:{},r&&w(f,r),++l.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},a=Fn(f,n,s,a),f.ref===0&&f.finalize(),a}function Cn(){return Te.id||(Te.id=++sn),++Te.awaits,Te.echoes+=Kt,Te.id}function vn(){return!!Te.awaits&&(--Te.awaits==0&&(Te.id=0),Te.echoes=Te.awaits*Kt,!0)}function yn(n){return Te.echoes&&n&&n.constructor===ce?(Cn(),n.then(function(r){return vn(),r},function(r){return vn(),we(r)})):n}function _r(){var n=Yt[Yt.length-1];Yt.pop(),On(n,!1)}function On(n,r){var s,a=Ut;(r?!Te.echoes||ui++&&n===Ut:!ui||--ui&&n===Ut)||queueMicrotask(r?(function(l){++ci,Te.echoes&&--Te.echoes!=0||(Te.echoes=Te.awaits=Te.id=0),Yt.push(Ut),On(l,!0)}).bind(null,n):_r),n!==Ut&&(Ut=n,a===Ue&&(Ue.env=gr()),ie&&(s=Ue.env.Promise,r=n.env,(a.global||n.global)&&(Object.defineProperty(p,"Promise",r.PromiseProp),s.all=r.all,s.race=r.race,s.resolve=r.resolve,s.reject=r.reject,r.allSettled&&(s.allSettled=r.allSettled),r.any&&(s.any=r.any))))}function gr(){var n=p.Promise;return ie?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(p,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Fn(n,r,s,a,l){var f=Ut;try{return On(n,!0),r(s,a,l)}finally{On(f,!1)}}function vr(n,r,s,a){return typeof n!="function"?n:function(){var l=Ut;s&&Cn(),On(r,!0);try{return n.apply(this,arguments)}finally{On(l,!1),a&&queueMicrotask(vn)}}}function Ei(n){Promise===ce&&Te.echoes===0?ui===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+Ve).indexOf("[native code]")===-1&&(Cn=vn=Vt);var we=Ft.reject,an="ï¿¿",bn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",yr="String expected.",Yn=[],Ci="__dbnames",Ji="readonly",li="readwrite";function Qe(n,r){return n?r?function(){return n.apply(this,arguments)&&r.apply(this,arguments)}:n:r}var Qi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function hi(n){return typeof n!="string"||/\./.test(n)?function(r){return r}:function(r){return r[n]===void 0&&n in r&&delete(r=lt(r))[n],r}}function Xn(){throw Pt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ht(n,r){try{var s=ve(n),a=ve(r);if(s!==a)return s==="Array"?1:a==="Array"?-1:s==="binary"?1:a==="binary"?-1:s==="string"?1:a==="string"?-1:s==="Date"?1:a!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return r<n?1:n<r?-1:0;case"binary":return function(l,f){for(var S=l.length,B=f.length,K=S<B?S:B,U=0;U<K;++U)if(l[U]!==f[U])return l[U]<f[U]?-1:1;return S===B?0:S<B?-1:1}(fi(n),fi(r));case"Array":return function(l,f){for(var S=l.length,B=f.length,K=S<B?S:B,U=0;U<K;++U){var V=Ht(l[U],f[U]);if(V!==0)return V}return S===B?0:S<B?-1:1}(n,r)}}catch{}return NaN}function ve(n){var r=typeof n;return r!="object"?r:ArrayBuffer.isView(n)?"binary":(n=ht(n),n==="ArrayBuffer"?"binary":n)}function fi(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function wn(n,r,s){var a=n.schema.yProps;return a?(r&&0<s.numFailures&&(r=r.filter(function(l,f){return!s.failures[f]})),Promise.all(a.map(function(l){return l=l.updatesTable,r?n.db.table(l).where("k").anyOf(r).delete():n.db.table(l).clear()})).then(function(){return s})):s}var un=(Oi.prototype.execute=function(n){var r=this["@@propmod"];if(r.add!==void 0){var s=r.add;if(g(s))return _(_([],g(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(r.remove!==void 0){var a=r.remove;if(g(a))return g(n)?n.filter(function(l){return!a.includes(l)}).sort():[];if(typeof a=="number")return Number(n)-a;if(typeof a=="bigint")try{return BigInt(n)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return s=(s=r.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?r.replacePrefix[1]+n.substring(s.length):n},Oi);function Oi(n){this["@@propmod"]=n}function ne(n,r){for(var s=y(r),a=s.length,l=!1,f=0;f<a;++f){var S=s[f],B=r[S],K=ct(n,S);B instanceof un?(ot(n,S,B.execute(K)),l=!0):K!==B&&(ot(n,S,B),l=!0)}return l}var be=(de.prototype._trans=function(n,r,s){var a=this._tx||Ut.trans,l=this.name,f=yt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function S(U,V,F){if(!F.schema[l])throw new Pt.NotFound("Table "+l+" not part of transaction");return r(F.idbtrans,F)}var B=Vn();try{var K=a&&a.db._novip===this.db._novip?a===Ut.trans?a._promise(n,S,s):gn(function(){return a._promise(n,S,s)},{trans:a,transless:Ut.transless||Ut}):function U(V,F,Q,W){if(V.idbdb&&(V._state.openComplete||Ut.letThrough||V._vip)){var q=V._createTransaction(F,Q,V._dbSchema);try{q.create(),V._state.PR1398_maxLoop=3}catch(H){return H.name===le.InvalidState&&V.isOpen()&&0<--V._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),V.close({disableAutoOpen:!1}),V.open().then(function(){return U(V,F,Q,W)})):we(H)}return q._promise(F,function(H,G){return gn(function(){return Ut.trans=q,W(H,G,q)})}).then(function(H){if(F==="readwrite")try{q.idbtrans.commit()}catch{}return F==="readonly"?H:q._completion.then(function(){return H})})}if(V._state.openComplete)return we(new Pt.DatabaseClosed(V._state.dbOpenError));if(!V._state.isBeingOpened){if(!V._state.autoOpen)return we(new Pt.DatabaseClosed);V.open().catch(Vt)}return V._state.dbReadyPromise.then(function(){return U(V,F,Q,W)})}(this.db,n,[this.name],S);return f&&(K._consoleTask=f,K=K.catch(function(U){return console.trace(U),we(U)})),K}finally{B&&En()}},de.prototype.get=function(n,r){var s=this;return n&&n.constructor===Object?this.where(n).first(r):n==null?we(new Pt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return s.core.get({trans:a,key:n}).then(function(l){return s.hook.reading.fire(l)})}).then(r)},de.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(g(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var r=y(n);if(r.length===1)return this.where(r[0]).equals(n[r[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(B){if(B.compound&&r.every(function(U){return 0<=B.keyPath.indexOf(U)})){for(var K=0;K<r.length;++K)if(r.indexOf(B.keyPath[K])===-1)return!1;return!0}return!1}).sort(function(B,K){return B.keyPath.length-K.keyPath.length})[0];if(s&&this.db._maxKey!==an){var f=s.keyPath.slice(0,r.length);return this.where(f).equals(f.map(function(K){return n[K]}))}!s&&yt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var a=this.schema.idxByName;function l(B,K){return Ht(B,K)===0}var S=r.reduce(function(F,K){var U=F[0],V=F[1],F=a[K],Q=n[K];return[U||F,U||!F?Qe(V,F&&F.multi?function(W){return W=ct(W,K),g(W)&&W.some(function(q){return l(Q,q)})}:function(W){return l(Q,ct(W,K))}):V]},[null,null]),f=S[0],S=S[1];return f?this.where(f.name).equals(n[f.keyPath]).filter(S):s?this.filter(S):this.where(r).equals("")},de.prototype.filter=function(n){return this.toCollection().and(n)},de.prototype.count=function(n){return this.toCollection().count(n)},de.prototype.offset=function(n){return this.toCollection().offset(n)},de.prototype.limit=function(n){return this.toCollection().limit(n)},de.prototype.each=function(n){return this.toCollection().each(n)},de.prototype.toArray=function(n){return this.toCollection().toArray(n)},de.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},de.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,g(n)?"[".concat(n.join("+"),"]"):n))},de.prototype.reverse=function(){return this.toCollection().reverse()},de.prototype.mapToClass=function(n){var r,s=this.db,a=this.name;function l(){return r!==null&&r.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Xn&&(function(K,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");function V(){this.constructor=K}c(K,U),K.prototype=U===null?Object.create(U):(V.prototype=U.prototype,new V)}(l,r=n),Object.defineProperty(l.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),l.prototype.table=function(){return a},n=l);for(var f=new Set,S=n.prototype;S;S=M(S))Object.getOwnPropertyNames(S).forEach(function(K){return f.add(K)});function B(K){if(!K)return K;var U,V=Object.create(n.prototype);for(U in K)if(!f.has(U))try{V[U]=K[U]}catch{}return V}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=B,this.hook("reading",B),n},de.prototype.defineClass=function(){return this.mapToClass(function(n){w(this,n)})},de.prototype.add=function(n,r){var s=this,a=this.schema.primKey,l=a.auto,f=a.keyPath,S=n;return f&&l&&(S=hi(f)(n)),this._trans("readwrite",function(B){return s.core.mutate({trans:B,type:"add",keys:r!=null?[r]:null,values:[S]})}).then(function(B){return B.numFailures?Ft.reject(B.failures[0]):B.lastResult}).then(function(B){if(f)try{ot(n,f,B)}catch{}return B})},de.prototype.upsert=function(n,r){var s=this,a=this.schema.primKey.keyPath;return this._trans("readwrite",function(l){return s.core.get({trans:l,key:n}).then(function(f){var S=f??{};return ne(S,r),a&&ot(S,a,n),s.core.mutate({trans:l,type:"put",values:[S],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[r]}}).then(function(B){return B.numFailures?Ft.reject(B.failures[0]):!!f})})})},de.prototype.update=function(n,r){return typeof n!="object"||g(n)?this.where(":id").equals(n).modify(r):(n=ct(n,this.schema.primKey.keyPath),n===void 0?we(new Pt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(r))},de.prototype.put=function(n,r){var s=this,a=this.schema.primKey,l=a.auto,f=a.keyPath,S=n;return f&&l&&(S=hi(f)(n)),this._trans("readwrite",function(B){return s.core.mutate({trans:B,type:"put",values:[S],keys:r!=null?[r]:null})}).then(function(B){return B.numFailures?Ft.reject(B.failures[0]):B.lastResult}).then(function(B){if(f)try{ot(n,f,B)}catch{}return B})},de.prototype.delete=function(n){var r=this;return this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(a){return wn(r,[n],a)}).then(function(a){return a.numFailures?Ft.reject(a.failures[0]):void 0})})},de.prototype.clear=function(){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"deleteRange",range:Qi}).then(function(s){return wn(n,null,s)})}).then(function(r){return r.numFailures?Ft.reject(r.failures[0]):void 0})},de.prototype.bulkGet=function(n){var r=this;return this._trans("readonly",function(s){return r.core.getMany({keys:n,trans:s}).then(function(a){return a.map(function(l){return r.hook.reading.fire(l)})})})},de.prototype.bulkAdd=function(n,r,s){var a=this,l=Array.isArray(r)?r:void 0,f=(s=s||(l?void 0:r))?s.allKeys:void 0;return this._trans("readwrite",function(S){var U=a.schema.primKey,B=U.auto,U=U.keyPath;if(U&&l)throw new Pt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(l&&l.length!==n.length)throw new Pt.InvalidArgument("Arguments objects and keys must have the same length");var K=n.length,U=U&&B?n.map(hi(U)):n;return a.core.mutate({trans:S,type:"add",keys:l,values:U,wantResults:f}).then(function(q){var F=q.numFailures,Q=q.results,W=q.lastResult,q=q.failures;if(F===0)return f?Q:W;throw new jt("".concat(a.name,".bulkAdd(): ").concat(F," of ").concat(K," operations failed"),q)})})},de.prototype.bulkPut=function(n,r,s){var a=this,l=Array.isArray(r)?r:void 0,f=(s=s||(l?void 0:r))?s.allKeys:void 0;return this._trans("readwrite",function(S){var U=a.schema.primKey,B=U.auto,U=U.keyPath;if(U&&l)throw new Pt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(l&&l.length!==n.length)throw new Pt.InvalidArgument("Arguments objects and keys must have the same length");var K=n.length,U=U&&B?n.map(hi(U)):n;return a.core.mutate({trans:S,type:"put",keys:l,values:U,wantResults:f}).then(function(q){var F=q.numFailures,Q=q.results,W=q.lastResult,q=q.failures;if(F===0)return f?Q:W;throw new jt("".concat(a.name,".bulkPut(): ").concat(F," of ").concat(K," operations failed"),q)})})},de.prototype.bulkUpdate=function(n){var r=this,s=this.core,a=n.map(function(S){return S.key}),l=n.map(function(S){return S.changes}),f=[];return this._trans("readwrite",function(S){return s.getMany({trans:S,keys:a,cache:"clone"}).then(function(B){var K=[],U=[];n.forEach(function(F,Q){var W=F.key,q=F.changes,H=B[Q];if(H){for(var G=0,et=Object.keys(q);G<et.length;G++){var rt=et[G],ft=q[rt];if(rt===r.schema.primKey.keyPath){if(Ht(ft,W)!==0)throw new Pt.Constraint("Cannot update primary key in bulkUpdate()")}else ot(H,rt,ft)}f.push(Q),K.push(W),U.push(H)}});var V=K.length;return s.mutate({trans:S,type:"put",keys:K,values:U,updates:{keys:a,changeSpecs:l}}).then(function(F){var Q=F.numFailures,W=F.failures;if(Q===0)return V;for(var q=0,H=Object.keys(W);q<H.length;q++){var G,et=H[q],rt=f[Number(et)];rt!=null&&(G=W[et],delete W[et],W[rt]=G)}throw new jt("".concat(r.name,".bulkUpdate(): ").concat(Q," of ").concat(V," operations failed"),W)})})})},de.prototype.bulkDelete=function(n){var r=this,s=n.length;return this._trans("readwrite",function(a){return r.core.mutate({trans:a,type:"delete",keys:n}).then(function(l){return wn(r,n,l)})}).then(function(S){var l=S.numFailures,f=S.lastResult,S=S.failures;if(l===0)return f;throw new jt("".concat(r.name,".bulkDelete(): ").concat(l," of ").concat(s," operations failed"),S)})},de);function de(){}function An(n){function r(S,B){if(B){for(var K=arguments.length,U=new Array(K-1);--K;)U[K-1]=arguments[K];return s[S].subscribe.apply(null,U),n}if(typeof S=="string")return s[S]}var s={};r.addEventType=f;for(var a=1,l=arguments.length;a<l;++a)f(arguments[a]);return r;function f(S,B,K){if(typeof S!="object"){var U;B=B||J;var V={subscribers:[],fire:K=K||Vt,subscribe:function(F){V.subscribers.indexOf(F)===-1&&(V.subscribers.push(F),V.fire=B(V.fire,F))},unsubscribe:function(F){V.subscribers=V.subscribers.filter(function(Q){return Q!==F}),V.fire=V.subscribers.reduce(B,K)}};return s[S]=r[S]=V}y(U=S).forEach(function(F){var Q=U[F];if(g(Q))f(F,U[F][0],U[F][1]);else{if(Q!=="asap")throw new Pt.InvalidArgument("Invalid event config");var W=f(F,he,function(){for(var q=arguments.length,H=new Array(q);q--;)H[q]=arguments[q];W.subscribers.forEach(function(G){Y(function(){G.apply(null,H)})})})}})}}function Ae(n,r){return b(r).from({prototype:n}),r}function Jn(n,r){return!(n.filter||n.algorithm||n.or)&&(r?n.justLimit:!n.replayFilter)}function Qn(n,r){n.filter=Qe(n.filter,r)}function xn(n,r,s){var a=n.replayFilter;n.replayFilter=a?function(){return Qe(a(),r())}:r,n.justLimit=s&&!a}function ye(n,r){if(n.isPrimKey)return r.primaryKey;var s=r.getIndexByKeyPath(n.index);if(!s)throw new Pt.Schema("KeyPath "+n.index+" on object store "+r.name+" is not indexed");return s}function zn(n,r,s){var a=ye(n,r.schema);return r.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:a,range:n.range}})}function Bn(n,r,s,a){var l=n.replayFilter?Qe(n.filter,n.replayFilter()):n.filter;if(n.or){var f={},S=function(B,K,U){var V,F;l&&!l(K,U,function(Q){return K.stop(Q)},function(Q){return K.fail(Q)})||((F=""+(V=K.primaryKey))=="[object ArrayBuffer]"&&(F=""+new Uint8Array(V)),T(f,F)||(f[F]=!0,r(B,K,U)))};return Promise.all([n.or._iterate(S,s),$n(zn(n,a,s),n.algorithm,S,!n.keysOnly&&n.valueMapper)])}return $n(zn(n,a,s),Qe(n.algorithm,l),r,!n.keysOnly&&n.valueMapper)}function $n(n,r,s,a){var l=ge(a?function(f,S,B){return s(a(f),S,B)}:s);return n.then(function(f){if(f)return f.start(function(){var S=function(){return f.continue()};r&&!r(f,function(B){return S=B},function(B){f.stop(B),S=Vt},function(B){f.fail(B),S=Vt})||l(f.value,f,function(B){return S=B}),S()})})}var $i=(ae.prototype._read=function(n,r){var s=this._ctx;return s.error?s.table._trans(null,we.bind(null,s.error)):s.table._trans("readonly",n).then(r)},ae.prototype._write=function(n){var r=this._ctx;return r.error?r.table._trans(null,we.bind(null,r.error)):r.table._trans("readwrite",n,"locked")},ae.prototype._addAlgorithm=function(n){var r=this._ctx;r.algorithm=Qe(r.algorithm,n)},ae.prototype._iterate=function(n,r){return Bn(this._ctx,n,r,this._ctx.table.core)},ae.prototype.clone=function(n){var r=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&w(s,n),r._ctx=s,r},ae.prototype.raw=function(){return this._ctx.valueMapper=null,this},ae.prototype.each=function(n){var r=this._ctx;return this._read(function(s){return Bn(r,n,s,r.table.core)})},ae.prototype.count=function(n){var r=this;return this._read(function(s){var a=r._ctx,l=a.table.core;if(Jn(a,!0))return l.count({trans:s,query:{index:ye(a,l.schema),range:a.range}}).then(function(S){return Math.min(S,a.limit)});var f=0;return Bn(a,function(){return++f,!1},s,l).then(function(){return f})}).then(n)},ae.prototype.sortBy=function(n,r){var s=n.split(".").reverse(),a=s[0],l=s.length-1;function f(K,U){return U?f(K[s[U]],U-1):K[a]}var S=this._ctx.dir==="next"?1:-1;function B(K,U){return Ht(f(K,l),f(U,l))*S}return this.toArray(function(K){return K.sort(B)}).then(r)},ae.prototype.toArray=function(n){var r=this;return this._read(function(s){var a=r._ctx;if(a.dir==="next"&&Jn(a,!0)&&0<a.limit){var l=a.valueMapper,f=ye(a,a.table.core.schema);return a.table.core.query({trans:s,limit:a.limit,values:!0,query:{index:f,range:a.range}}).then(function(B){return B=B.result,l?B.map(l):B})}var S=[];return Bn(a,function(B){return S.push(B)},s,a.table.core).then(function(){return S})},n)},ae.prototype.offset=function(n){var r=this._ctx;return n<=0||(r.offset+=n,Jn(r)?xn(r,function(){var s=n;return function(a,l){return s===0||(s===1?--s:l(function(){a.advance(s),s=0}),!1)}}):xn(r,function(){var s=n;return function(){return--s<0}})),this},ae.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),xn(this._ctx,function(){var r=n;return function(s,a,l){return--r<=0&&a(l),0<=r}},!0),this},ae.prototype.until=function(n,r){return Qn(this._ctx,function(s,a,l){return!n(s.value)||(a(l),r)}),this},ae.prototype.first=function(n){return this.limit(1).toArray(function(r){return r[0]}).then(n)},ae.prototype.last=function(n){return this.reverse().first(n)},ae.prototype.filter=function(n){var r;return Qn(this._ctx,function(s){return n(s.value)}),(r=this._ctx).isMatch=Qe(r.isMatch,n),this},ae.prototype.and=function(n){return this.filter(n)},ae.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},ae.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ae.prototype.desc=function(){return this.reverse()},ae.prototype.eachKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(s,a){n(a.key,a)})},ae.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},ae.prototype.eachPrimaryKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(s,a){n(a.primaryKey,a)})},ae.prototype.keys=function(n){var r=this._ctx;r.keysOnly=!r.isMatch;var s=[];return this.each(function(a,l){s.push(l.key)}).then(function(){return s}).then(n)},ae.prototype.primaryKeys=function(n){var r=this._ctx;if(r.dir==="next"&&Jn(r,!0)&&0<r.limit)return this._read(function(a){var l=ye(r,r.table.core.schema);return r.table.core.query({trans:a,values:!1,limit:r.limit,query:{index:l,range:r.range}})}).then(function(a){return a.result}).then(n);r.keysOnly=!r.isMatch;var s=[];return this.each(function(a,l){s.push(l.primaryKey)}).then(function(){return s}).then(n)},ae.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},ae.prototype.firstKey=function(n){return this.limit(1).keys(function(r){return r[0]}).then(n)},ae.prototype.lastKey=function(n){return this.reverse().firstKey(n)},ae.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var r={};return Qn(this._ctx,function(l){var a=l.primaryKey.toString(),l=T(r,a);return r[a]=!0,!l}),this},ae.prototype.modify=function(n){var r=this,s=this._ctx;return this._write(function(a){var l=typeof n=="function"?n:function(H){return ne(H,n)},f=s.table.core,U=f.schema.primaryKey,S=U.outbound,B=U.extractKey,K=200,U=r.db._options.modifyChunkSize;U&&(K=typeof U=="object"?U[f.name]||U["*"]||200:U);function V(H,rt){var et=rt.failures,rt=rt.numFailures;Q+=H-rt;for(var ft=0,gt=y(et);ft<gt.length;ft++){var At=gt[ft];F.push(et[At])}}var F=[],Q=0,W=[],q=n===Ai;return r.clone().primaryKeys().then(function(H){function G(rt){var ft=Math.min(K,H.length-rt),gt=H.slice(rt,rt+ft);return(q?Promise.resolve([]):f.getMany({trans:a,keys:gt,cache:"immutable"})).then(function(At){var Dt=[],Et=[],Bt=S?[]:null,It=q?gt:[];if(!q)for(var Mt=0;Mt<ft;++Mt){var Wt=At[Mt],ee={value:lt(Wt),primKey:H[rt+Mt]};l.call(ee,ee.value,ee)!==!1&&(ee.value==null?It.push(H[rt+Mt]):S||Ht(B(Wt),B(ee.value))===0?(Et.push(ee.value),S&&Bt.push(H[rt+Mt])):(It.push(H[rt+Mt]),Dt.push(ee.value)))}return Promise.resolve(0<Dt.length&&f.mutate({trans:a,type:"add",values:Dt}).then(function(Jt){for(var re in Jt.failures)It.splice(parseInt(re),1);V(Dt.length,Jt)})).then(function(){return(0<Et.length||et&&typeof n=="object")&&f.mutate({trans:a,type:"put",keys:Bt,values:Et,criteria:et,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<rt}).then(function(Jt){return V(Et.length,Jt)})}).then(function(){return(0<It.length||et&&q)&&f.mutate({trans:a,type:"delete",keys:It,criteria:et,isAdditionalChunk:0<rt}).then(function(Jt){return wn(s.table,It,Jt)}).then(function(Jt){return V(It.length,Jt)})}).then(function(){return H.length>rt+ft&&G(rt+K)})})}var et=Jn(s)&&s.limit===1/0&&(typeof n!="function"||q)&&{index:s.index,range:s.range};return G(0).then(function(){if(0<F.length)throw new dt("Error modifying one or more objects",F,Q,W);return H.length})})})},ae.prototype.delete=function(){var n=this._ctx,r=n.range;return!Jn(n)||n.table.schema.yProps||!n.isPrimKey&&r.type!==3?this.modify(Ai):this._write(function(s){var a=n.table.core.schema.primaryKey,l=r;return n.table.core.count({trans:s,query:{index:a,range:l}}).then(function(f){return n.table.core.mutate({trans:s,type:"deleteRange",range:l}).then(function(K){var B=K.failures,K=K.numFailures;if(K)throw new dt("Could not delete some values",Object.keys(B).map(function(U){return B[U]}),f-K);return f-K})})})},ae);function ae(){}var Ai=function(n,r){return r.value=null};function tr(n,r){return n<r?-1:n===r?0:1}function zi(n,r){return r<n?-1:n===r?0:1}function De(n,r,s){return n=n instanceof br?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(r),n}function In(n){return new n.Collection(n,function(){return Bi("")}).limit(0)}function jn(n,r,s,a){var l,f,S,B,K,U,V,F=s.length;if(!s.every(function(q){return typeof q=="string"}))return De(n,yr);function Q(q){l=q==="next"?function(G){return G.toUpperCase()}:function(G){return G.toLowerCase()},f=q==="next"?function(G){return G.toLowerCase()}:function(G){return G.toUpperCase()},S=q==="next"?tr:zi;var H=s.map(function(G){return{lower:f(G),upper:l(G)}}).sort(function(G,et){return S(G.lower,et.lower)});B=H.map(function(G){return G.upper}),K=H.map(function(G){return G.lower}),V=(U=q)==="next"?"":a}Q("next"),n=new n.Collection(n,function(){return kn(B[0],K[F-1]+a)}),n._ondirectionchange=function(q){Q(q)};var W=0;return n._addAlgorithm(function(q,H,G){var et=q.key;if(typeof et!="string")return!1;var rt=f(et);if(r(rt,K,W))return!0;for(var ft=null,gt=W;gt<F;++gt){var At=function(Dt,Et,Bt,It,Mt,Wt){for(var ee=Math.min(Dt.length,It.length),Jt=-1,re=0;re<ee;++re){var Fe=Et[re];if(Fe!==It[re])return Mt(Dt[re],Bt[re])<0?Dt.substr(0,re)+Bt[re]+Bt.substr(re+1):Mt(Dt[re],It[re])<0?Dt.substr(0,re)+It[re]+Bt.substr(re+1):0<=Jt?Dt.substr(0,Jt)+Et[Jt]+Bt.substr(Jt+1):null;Mt(Dt[re],Fe)<0&&(Jt=re)}return ee<It.length&&Wt==="next"?Dt+Bt.substr(Dt.length):ee<Dt.length&&Wt==="prev"?Dt.substr(0,Bt.length):Jt<0?null:Dt.substr(0,Jt)+It[Jt]+Bt.substr(Jt+1)}(et,rt,B[gt],K[gt],S,U);At===null&&ft===null?W=gt+1:(ft===null||0<S(ft,At))&&(ft=At)}return H(ft!==null?function(){q.continue(ft+V)}:G),!1}),n}function kn(n,r,s,a){return{type:2,lower:n,upper:r,lowerOpen:s,upperOpen:a}}function Bi(n){return{type:1,lower:n,upper:n}}var br=(Object.defineProperty(Xt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Xt.prototype.between=function(n,r,s,a){s=s!==!1,a=a===!0;try{return 0<this._cmp(n,r)||this._cmp(n,r)===0&&(s||a)&&(!s||!a)?In(this):new this.Collection(this,function(){return kn(n,r,!s,!a)})}catch{return De(this,bn)}},Xt.prototype.equals=function(n){return n==null?De(this,bn):new this.Collection(this,function(){return Bi(n)})},Xt.prototype.above=function(n){return n==null?De(this,bn):new this.Collection(this,function(){return kn(n,void 0,!0)})},Xt.prototype.aboveOrEqual=function(n){return n==null?De(this,bn):new this.Collection(this,function(){return kn(n,void 0,!1)})},Xt.prototype.below=function(n){return n==null?De(this,bn):new this.Collection(this,function(){return kn(void 0,n,!1,!0)})},Xt.prototype.belowOrEqual=function(n){return n==null?De(this,bn):new this.Collection(this,function(){return kn(void 0,n)})},Xt.prototype.startsWith=function(n){return typeof n!="string"?De(this,yr):this.between(n,n+an,!0,!0)},Xt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):jn(this,function(r,s){return r.indexOf(s[0])===0},[n],an)},Xt.prototype.equalsIgnoreCase=function(n){return jn(this,function(r,s){return r===s[0]},[n],"")},Xt.prototype.anyOfIgnoreCase=function(){var n=bt.apply(_t,arguments);return n.length===0?In(this):jn(this,function(r,s){return s.indexOf(r)!==-1},n,"")},Xt.prototype.startsWithAnyOfIgnoreCase=function(){var n=bt.apply(_t,arguments);return n.length===0?In(this):jn(this,function(r,s){return s.some(function(a){return r.indexOf(a)===0})},n,an)},Xt.prototype.anyOf=function(){var n=this,r=bt.apply(_t,arguments),s=this._cmp;try{r.sort(s)}catch{return De(this,bn)}if(r.length===0)return In(this);var a=new this.Collection(this,function(){return kn(r[0],r[r.length-1])});a._ondirectionchange=function(f){s=f==="next"?n._ascending:n._descending,r.sort(s)};var l=0;return a._addAlgorithm(function(f,S,B){for(var K=f.key;0<s(K,r[l]);)if(++l===r.length)return S(B),!1;return s(K,r[l])===0||(S(function(){f.continue(r[l])}),!1)}),a},Xt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Xt.prototype.noneOf=function(){var n=bt.apply(_t,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return De(this,bn)}var r=n.reduce(function(s,a){return s?s.concat([[s[s.length-1][1],a]]):[[-1/0,a]]},null);return r.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},Xt.prototype.inAnyRange=function(et,r){var s=this,a=this._cmp,l=this._ascending,f=this._descending,S=this._min,B=this._max;if(et.length===0)return In(this);if(!et.every(function(rt){return rt[0]!==void 0&&rt[1]!==void 0&&l(rt[0],rt[1])<=0}))return De(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Pt.InvalidArgument);var K=!r||r.includeLowers!==!1,U=r&&r.includeUppers===!0,V,F=l;function Q(rt,ft){return F(rt[0],ft[0])}try{(V=et.reduce(function(rt,ft){for(var gt=0,At=rt.length;gt<At;++gt){var Dt=rt[gt];if(a(ft[0],Dt[1])<0&&0<a(ft[1],Dt[0])){Dt[0]=S(Dt[0],ft[0]),Dt[1]=B(Dt[1],ft[1]);break}}return gt===At&&rt.push(ft),rt},[])).sort(Q)}catch{return De(this,bn)}var W=0,q=U?function(rt){return 0<l(rt,V[W][1])}:function(rt){return 0<=l(rt,V[W][1])},H=K?function(rt){return 0<f(rt,V[W][0])}:function(rt){return 0<=f(rt,V[W][0])},G=q,et=new this.Collection(this,function(){return kn(V[0][0],V[V.length-1][1],!K,!U)});return et._ondirectionchange=function(rt){F=rt==="next"?(G=q,l):(G=H,f),V.sort(Q)},et._addAlgorithm(function(rt,ft,gt){for(var At,Dt=rt.key;G(Dt);)if(++W===V.length)return ft(gt),!1;return!q(At=Dt)&&!H(At)||(s._cmp(Dt,V[W][1])===0||s._cmp(Dt,V[W][0])===0||ft(function(){F===l?rt.continue(V[W][0]):rt.continue(V[W][1])}),!1)}),et},Xt.prototype.startsWithAnyOf=function(){var n=bt.apply(_t,arguments);return n.every(function(r){return typeof r=="string"})?n.length===0?In(this):this.inAnyRange(n.map(function(r){return[r,r+an]})):De(this,"startsWithAnyOf() only works with strings")},Xt);function Xt(){}function xe(n){return ge(function(r){return fe(r),n(r.target.error),!1})}function fe(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var ti="storagemutated",di="x-storagemutated-1",cn=An(null,ti),er=(ze.prototype._lock=function(){return X(!Ut.global),++this._reculock,this._reculock!==1||Ut.global||(Ut.lockOwnerFor=this),this},ze.prototype._unlock=function(){if(X(!Ut.global),--this._reculock==0)for(Ut.global||(Ut.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Fn(n[1],n[0])}catch{}}return this},ze.prototype._locked=function(){return this._reculock&&Ut.lockOwnerFor!==this},ze.prototype.create=function(n){var r=this;if(!this.mode)return this;var s=this.db.idbdb,a=this.db._state.dbOpenError;if(X(!this.idbtrans),!n&&!s)switch(a&&a.name){case"DatabaseClosedError":throw new Pt.DatabaseClosed(a);case"MissingAPIError":throw new Pt.MissingAPI(a.message,a);default:throw new Pt.OpenFailed(a)}if(!this.active)throw new Pt.TransactionInactive;return X(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ge(function(l){fe(l),r._reject(n.error)}),n.onabort=ge(function(l){fe(l),r.active&&r._reject(new Pt.Abort(n.error)),r.active=!1,r.on("abort").fire(l)}),n.oncomplete=ge(function(){r.active=!1,r._resolve(),"mutatedParts"in n&&cn.storagemutated.fire(n.mutatedParts)}),this},ze.prototype._promise=function(n,r,s){var a=this;if(n==="readwrite"&&this.mode!=="readwrite")return we(new Pt.ReadOnly("Transaction is readonly"));if(!this.active)return we(new Pt.TransactionInactive);if(this._locked())return new Ft(function(f,S){a._blockedFuncs.push([function(){a._promise(n,r,s).then(f,S)},Ut])});if(s)return gn(function(){var f=new Ft(function(S,B){a._lock();var K=r(S,B,a);K&&K.then&&K.then(S,B)});return f.finally(function(){return a._unlock()}),f._lib=!0,f});var l=new Ft(function(f,S){var B=r(f,S,a);B&&B.then&&B.then(f,S)});return l._lib=!0,l},ze.prototype._root=function(){return this.parent?this.parent._root():this},ze.prototype.waitFor=function(n){var r,s=this._root(),a=Ft.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return a}):(s._waitingFor=a,s._waitingQueue=[],r=s.idbtrans.objectStore(s.storeNames[0]),function f(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(r.get(-1/0).onsuccess=f)}());var l=s._waitingFor;return new Ft(function(f,S){a.then(function(B){return s._waitingQueue.push(ge(f.bind(null,B)))},function(B){return s._waitingQueue.push(ge(S.bind(null,B)))}).finally(function(){s._waitingFor===l&&(s._waitingFor=null)})})},ze.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Pt.Abort))},ze.prototype.table=function(n){var r=this._memoizedTables||(this._memoizedTables={});if(T(r,n))return r[n];var s=this.schema[n];if(!s)throw new Pt.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),r[n]=s},ze);function ze(){}function pi(n,r,s,a,l,f,S,B){return{name:n,keyPath:r,unique:s,multi:a,auto:l,compound:f,src:(s&&!S?"&":"")+(a?"*":"")+(l?"++":"")+ei(r),type:B}}function ei(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function ke(n,r,s){return{name:n,primKey:r,indexes:s,mappedClass:null,idxByName:(a=function(l){return[l.name,l]},s.reduce(function(l,f,S){return S=a(f,S),S&&(l[S[0]]=S[1]),l},{}))};var a}var $e=function(n){try{return n.only([[]]),$e=function(){return[[]]},[[]]}catch{return $e=function(){return an},an}};function Ii(n){return n==null?function(){}:typeof n=="string"?(r=n).split(".").length===1?function(s){return s[r]}:function(s){return ct(s,r)}:function(s){return ct(s,n)};var r}function nr(n){return[].slice.call(n)}var Ur=0;function ni(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function ir(n,r,K){function a(G){if(G.type===3)return null;if(G.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var W=G.lower,q=G.upper,H=G.lowerOpen,G=G.upperOpen;return W===void 0?q===void 0?null:r.upperBound(q,!!G):q===void 0?r.lowerBound(W,!!H):r.bound(W,q,!!H,!!G)}function l(Q){var W,q=Q.name;return{name:q,schema:Q,mutate:function(H){var G=H.trans,et=H.type,rt=H.keys,ft=H.values,gt=H.range;return new Promise(function(At,Dt){At=ge(At);var Et=G.objectStore(q),Bt=Et.keyPath==null,It=et==="put"||et==="add";if(!It&&et!=="delete"&&et!=="deleteRange")throw new Error("Invalid operation type: "+et);var Mt,Wt=(rt||ft||{length:1}).length;if(rt&&ft&&rt.length!==ft.length)throw new Error("Given keys array must have same length as given values array.");if(Wt===0)return At({numFailures:0,failures:{},results:[],lastResult:void 0});function ee(Me){++Fe,fe(Me)}var Jt=[],re=[],Fe=0;if(et==="deleteRange"){if(gt.type===4)return At({numFailures:Fe,failures:re,results:[],lastResult:void 0});gt.type===3?Jt.push(Mt=Et.clear()):Jt.push(Mt=Et.delete(a(gt)))}else{var Bt=It?Bt?[ft,rt]:[ft,null]:[rt,null],$t=Bt[0],Ie=Bt[1];if(It)for(var Pe=0;Pe<Wt;++Pe)Jt.push(Mt=Ie&&Ie[Pe]!==void 0?Et[et]($t[Pe],Ie[Pe]):Et[et]($t[Pe])),Mt.onerror=ee;else for(Pe=0;Pe<Wt;++Pe)Jt.push(Mt=Et[et]($t[Pe])),Mt.onerror=ee}function Dn(Me){Me=Me.target.result,Jt.forEach(function(Rn,fr){return Rn.error!=null&&(re[fr]=Rn.error)}),At({numFailures:Fe,failures:re,results:et==="delete"?rt:Jt.map(function(Rn){return Rn.result}),lastResult:Me})}Mt.onerror=function(Me){ee(Me),Dn(Me)},Mt.onsuccess=Dn})},getMany:function(H){var G=H.trans,et=H.keys;return new Promise(function(rt,ft){rt=ge(rt);for(var gt,At=G.objectStore(q),Dt=et.length,Et=new Array(Dt),Bt=0,It=0,Mt=function(Jt){Jt=Jt.target,Et[Jt._pos]=Jt.result,++It===Bt&&rt(Et)},Wt=xe(ft),ee=0;ee<Dt;++ee)et[ee]!=null&&((gt=At.get(et[ee]))._pos=ee,gt.onsuccess=Mt,gt.onerror=Wt,++Bt);Bt===0&&rt(Et)})},get:function(H){var G=H.trans,et=H.key;return new Promise(function(rt,ft){rt=ge(rt);var gt=G.objectStore(q).get(et);gt.onsuccess=function(At){return rt(At.target.result)},gt.onerror=xe(ft)})},query:(W=U,function(H){return new Promise(function(G,et){G=ge(G);var rt,ft,gt,Bt=H.trans,At=H.values,Dt=H.limit,Mt=H.query,Et=Dt===1/0?void 0:Dt,It=Mt.index,Mt=Mt.range,Bt=Bt.objectStore(q),It=It.isPrimaryKey?Bt:Bt.index(It.name),Mt=a(Mt);if(Dt===0)return G({result:[]});W?((Et=At?It.getAll(Mt,Et):It.getAllKeys(Mt,Et)).onsuccess=function(Wt){return G({result:Wt.target.result})},Et.onerror=xe(et)):(rt=0,ft=!At&&"openKeyCursor"in It?It.openKeyCursor(Mt):It.openCursor(Mt),gt=[],ft.onsuccess=function(Wt){var ee=ft.result;return ee?(gt.push(At?ee.value:ee.primaryKey),++rt===Dt?G({result:gt}):void ee.continue()):G({result:gt})},ft.onerror=xe(et))})}),openCursor:function(H){var G=H.trans,et=H.values,rt=H.query,ft=H.reverse,gt=H.unique;return new Promise(function(At,Dt){At=ge(At);var It=rt.index,Et=rt.range,Bt=G.objectStore(q),Bt=It.isPrimaryKey?Bt:Bt.index(It.name),It=ft?gt?"prevunique":"prev":gt?"nextunique":"next",Mt=!et&&"openKeyCursor"in Bt?Bt.openKeyCursor(a(Et),It):Bt.openCursor(a(Et),It);Mt.onerror=xe(Dt),Mt.onsuccess=ge(function(Wt){var ee,Jt,re,Fe,$t=Mt.result;$t?($t.___id=++Ur,$t.done=!1,ee=$t.continue.bind($t),Jt=(Jt=$t.continuePrimaryKey)&&Jt.bind($t),re=$t.advance.bind($t),Fe=function(){throw new Error("Cursor not stopped")},$t.trans=G,$t.stop=$t.continue=$t.continuePrimaryKey=$t.advance=function(){throw new Error("Cursor not started")},$t.fail=ge(Dt),$t.next=function(){var Ie=this,Pe=1;return this.start(function(){return Pe--?Ie.continue():Ie.stop()}).then(function(){return Ie})},$t.start=function(Ie){function Pe(){if(Mt.result)try{Ie()}catch(Me){$t.fail(Me)}else $t.done=!0,$t.start=function(){throw new Error("Cursor behind last entry")},$t.stop()}var Dn=new Promise(function(Me,Rn){Me=ge(Me),Mt.onerror=xe(Rn),$t.fail=Rn,$t.stop=function(fr){$t.stop=$t.continue=$t.continuePrimaryKey=$t.advance=Fe,Me(fr)}});return Mt.onsuccess=ge(function(Me){Mt.onsuccess=Pe,Pe()}),$t.continue=ee,$t.continuePrimaryKey=Jt,$t.advance=re,Pe(),Dn},At($t)):At(null)},Dt)})},count:function(H){var G=H.query,et=H.trans,rt=G.index,ft=G.range;return new Promise(function(gt,At){var Dt=et.objectStore(q),Et=rt.isPrimaryKey?Dt:Dt.index(rt.name),Dt=a(ft),Et=Dt?Et.count(Dt):Et.count();Et.onsuccess=ge(function(Bt){return gt(Bt.target.result)}),Et.onerror=xe(At)})}}}var f,S,B,V=(S=K,B=nr((f=n).objectStoreNames),{schema:{name:f.name,tables:B.map(function(Q){return S.objectStore(Q)}).map(function(Q){var W=Q.keyPath,G=Q.autoIncrement,q=g(W),H={},G={name:Q.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:W==null,compound:q,keyPath:W,autoIncrement:G,unique:!0,extractKey:Ii(W)},indexes:nr(Q.indexNames).map(function(et){return Q.index(et)}).map(function(gt){var rt=gt.name,ft=gt.unique,At=gt.multiEntry,gt=gt.keyPath,At={name:rt,compound:g(gt),keyPath:gt,unique:ft,multiEntry:At,extractKey:Ii(gt)};return H[ni(gt)]=At}),getIndexByKeyPath:function(et){return H[ni(et)]}};return H[":id"]=G.primaryKey,W!=null&&(H[ni(W)]=G.primaryKey),G})},hasGetAll:0<B.length&&"getAll"in S.objectStore(B[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),K=V.schema,U=V.hasGetAll,V=K.tables.map(l),F={};return V.forEach(function(Q){return F[Q.name]=Q}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(Q){if(!F[Q])throw new Error("Table '".concat(Q,"' not found"));return F[Q]},MIN_KEY:-1/0,MAX_KEY:$e(r),schema:K}}function Wr(n,r,s,a){var l=s.IDBKeyRange;return s.indexedDB,{dbcore:(a=ir(r,l,a),n.dbcore.reduce(function(f,S){return S=S.create,k(k({},f),S(f))},a))}}function mi(n,a){var s=a.db,a=Wr(n._middlewares,s,n._deps,a);n.core=a.dbcore,n.tables.forEach(function(l){var f=l.name;n.core.schema.tables.some(function(S){return S.name===f})&&(l.core=n.core.table(f),n[f]instanceof n.Table&&(n[f].core=l.core))})}function se(n,r,s,a){s.forEach(function(l){var f=a[l];r.forEach(function(S){var B=function K(U,V){return C(U,V)||(U=M(U))&&K(U,V)}(S,l);(!B||"value"in B&&B.value===void 0)&&(S===n.Transaction.prototype||S instanceof n.Transaction?O(S,l,{get:function(){return this.table(l)},set:function(K){x(this,l,{value:K,writable:!0,configurable:!0,enumerable:!0})}}):S[l]=new n.Table(l,f))})})}function rr(n,r){r.forEach(function(s){for(var a in s)s[a]instanceof n.Table&&delete s[a]})}function tn(n,r){return n._cfg.version-r._cfg.version}function _i(n,r,s,a){var l=n._dbSchema;s.objectStoreNames.contains("$meta")&&!l.$meta&&(l.$meta=ke("$meta",Di("")[0],[]),n._storeNames.push("$meta"));var f=n._createTransaction("readwrite",n._storeNames,l);f.create(s),f._completion.catch(a);var S=f._reject.bind(f),B=Ut.transless||Ut;gn(function(){return Ut.trans=f,Ut.transless=B,r!==0?(mi(n,s),U=r,((K=f).storeNames.includes("$meta")?K.table("$meta").get("version").then(function(V){return V??U}):Ft.resolve(U)).then(function(V){return Q=V,W=f,q=s,H=[],V=(F=n)._versions,G=F._dbSchema=Mi(0,F.idbdb,q),(V=V.filter(function(et){return et._cfg.version>=Q})).length!==0?(V.forEach(function(et){H.push(function(){var rt=G,ft=et._cfg.dbschema;Ni(F,rt,q),Ni(F,ft,q),G=F._dbSchema=ft;var gt=or(rt,ft);gt.add.forEach(function(It){gi(q,It[0],It[1].primKey,It[1].indexes)}),gt.change.forEach(function(It){if(It.recreate)throw new Pt.Upgrade("Not yet support for changing primary key");var Mt=q.objectStore(It.name);It.add.forEach(function(Wt){return vi(Mt,Wt)}),It.change.forEach(function(Wt){Mt.deleteIndex(Wt.name),vi(Mt,Wt)}),It.del.forEach(function(Wt){return Mt.deleteIndex(Wt)})});var At=et._cfg.contentUpgrade;if(At&&et._cfg.version>Q){mi(F,q),W._memoizedTables={};var Dt=wt(ft);gt.del.forEach(function(It){Dt[It]=rt[It]}),rr(F,[F.Transaction.prototype]),se(F,[F.Transaction.prototype],y(Dt),Dt),W.schema=Dt;var Et,Bt=$(At);return Bt&&Cn(),gt=Ft.follow(function(){var It;(Et=At(W))&&Bt&&(It=vn.bind(null,null),Et.then(It,It))}),Et&&typeof Et.then=="function"?Ft.resolve(Et):gt.then(function(){return Et})}}),H.push(function(rt){var ft,gt,At=et._cfg.dbschema;ft=At,gt=rt,[].slice.call(gt.db.objectStoreNames).forEach(function(Dt){return ft[Dt]==null&&gt.db.deleteObjectStore(Dt)}),rr(F,[F.Transaction.prototype]),se(F,[F.Transaction.prototype],F._storeNames,F._dbSchema),W.schema=F._dbSchema}),H.push(function(rt){F.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(F.idbdb.version/10)===et._cfg.version?(F.idbdb.deleteObjectStore("$meta"),delete F._dbSchema.$meta,F._storeNames=F._storeNames.filter(function(ft){return ft!=="$meta"})):rt.objectStore("$meta").put(et._cfg.version,"version"))})}),function et(){return H.length?Ft.resolve(H.shift()(W.idbtrans)).then(et):Ft.resolve()}().then(function(){xr(G,q)})):Ft.resolve();var F,Q,W,q,H,G}).catch(S)):(y(l).forEach(function(V){gi(s,V,l[V].primKey,l[V].indexes)}),mi(n,s),void Ft.follow(function(){return n.on.populate.fire(f)}).catch(S));var K,U})}function wr(n,r){xr(n._dbSchema,r),r.db.version%10!=0||r.objectStoreNames.contains("$meta")||r.db.createObjectStore("$meta").add(Math.ceil(r.db.version/10-1),"version");var s=Mi(0,n.idbdb,r);Ni(n,n._dbSchema,r);for(var a=0,l=or(s,n._dbSchema).change;a<l.length;a++){var f=function(S){if(S.change.length||S.recreate)return console.warn("Unable to patch indexes of table ".concat(S.name," because it has changes on the type of index or primary key.")),{value:void 0};var B=r.objectStore(S.name);S.add.forEach(function(K){yt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(S.name,".").concat(K.src)),vi(B,K)})}(l[a]);if(typeof f=="object")return f.value}}function or(n,r){var s,a={del:[],add:[],change:[]};for(s in n)r[s]||a.del.push(s);for(s in r){var l=n[s],f=r[s];if(l){var S={name:s,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(l.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||l.primKey.auto!==f.primKey.auto)S.recreate=!0,a.change.push(S);else{var B=l.idxByName,K=f.idxByName,U=void 0;for(U in B)K[U]||S.del.push(U);for(U in K){var V=B[U],F=K[U];V?V.src!==F.src&&S.change.push(F):S.add.push(F)}(0<S.del.length||0<S.add.length||0<S.change.length)&&a.change.push(S)}}else a.add.push([s,f])}return a}function gi(n,r,s,a){var l=n.db.createObjectStore(r,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return a.forEach(function(f){return vi(l,f)}),l}function xr(n,r){y(n).forEach(function(s){r.db.objectStoreNames.contains(s)||(yt&&console.debug("Dexie: Creating missing table",s),gi(r,s,n[s].primKey,n[s].indexes))})}function vi(n,r){n.createIndex(r.name,r.keyPath,{unique:r.unique,multiEntry:r.multi})}function Mi(n,r,s){var a={};return I(r.objectStoreNames,0).forEach(function(l){for(var f=s.objectStore(l),S=pi(ei(U=f.keyPath),U||"",!0,!1,!!f.autoIncrement,U&&typeof U!="string",!0),B=[],K=0;K<f.indexNames.length;++K){var V=f.index(f.indexNames[K]),U=V.keyPath,V=pi(V.name,U,!!V.unique,!!V.multiEntry,!1,U&&typeof U!="string",!1);B.push(V)}a[l]=ke(l,S,B)}),a}function Ni(n,r,s){for(var a=s.db.objectStoreNames,l=0;l<a.length;++l){var f=a[l],S=s.objectStore(f);n._hasGetAll="getAll"in S;for(var B=0;B<S.indexNames.length;++B){var K=S.indexNames[B],U=S.index(K).keyPath,V=typeof U=="string"?U:"["+I(U).join("+")+"]";!r[f]||(U=r[f].idxByName[V])&&(U.name=K,delete r[f].idxByName[V],r[f].idxByName[K]=U)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&p.WorkerGlobalScope&&p instanceof p.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Di(n){return n.split(",").map(function(r,s){var f=r.split(":"),a=(l=f[1])===null||l===void 0?void 0:l.trim(),l=(r=f[0].trim()).replace(/([&*]|\+\+)/g,""),f=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return pi(l,f||null,/\&/.test(r),/\*/.test(r),/\+\+/.test(r),g(f),s===0,a)})}var qr=(Re.prototype._createTableSchema=ke,Re.prototype._parseIndexSyntax=Di,Re.prototype._parseStoresSpec=function(n,r){var s=this;y(n).forEach(function(a){if(n[a]!==null){var l=s._parseIndexSyntax(n[a]),f=l.shift();if(!f)throw new Pt.Schema("Invalid schema for table "+a+": "+n[a]);if(f.unique=!0,f.multi)throw new Pt.Schema("Primary key cannot be multiEntry*");l.forEach(function(S){if(S.auto)throw new Pt.Schema("Only primary key can be marked as autoIncrement (++)");if(!S.keyPath)throw new Pt.Schema("Index must have a name and cannot be an empty string")}),l=s._createTableSchema(a,f,l),r[a]=l}})},Re.prototype.stores=function(s){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?w(this._cfg.storesSource,s):s;var s=r._versions,a={},l={};return s.forEach(function(f){w(a,f._cfg.storesSource),l=f._cfg.dbschema={},f._parseStoresSpec(a,l)}),r._dbSchema=l,rr(r,[r._allTables,r,r.Transaction.prototype]),se(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],y(l),l),r._storeNames=y(l),this},Re.prototype.upgrade=function(n){return this._cfg.contentUpgrade=xt(this._cfg.contentUpgrade||Vt,n),this},Re);function Re(){}function sr(n,r){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new Pn(Ci,{addons:[],indexedDB:n,IDBKeyRange:r})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Ri(n){return n&&typeof n.databases=="function"}function ln(n){return gn(function(){return Ut.letThrough=!0,n()})}function Zi(n){return!("from"in n)}var Ce=function(n,r){if(!this){var s=new Ce;return n&&"d"in n&&w(s,n),s}w(this,arguments.length?{d:1,from:n,to:1<arguments.length?r:n}:{d:0})};function Kn(n,r,s){var a=Ht(r,s);if(!isNaN(a)){if(0<a)throw RangeError();if(Zi(n))return w(n,{from:r,to:s,d:1});var l=n.l,a=n.r;if(Ht(s,n.from)<0)return l?Kn(l,r,s):n.l={from:r,to:s,d:1,l:null,r:null},kr(n);if(0<Ht(r,n.to))return a?Kn(a,r,s):n.r={from:r,to:s,d:1,l:null,r:null},kr(n);Ht(r,n.from)<0&&(n.from=r,n.l=null,n.d=a?a.d+1:1),0<Ht(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,l&&!n.l&&yi(n,l),a&&s&&yi(n,a)}}function yi(n,r){Zi(r)||function s(a,K){var f=K.from,S=K.to,B=K.l,K=K.r;Kn(a,f,S),B&&s(a,B),K&&s(a,K)}(n,r)}function ar(n,r){var s=bi(r),a=s.next();if(a.done)return!1;for(var l=a.value,f=bi(n),S=f.next(l.from),B=S.value;!a.done&&!S.done;){if(Ht(B.from,l.to)<=0&&0<=Ht(B.to,l.from))return!0;Ht(l.from,B.from)<0?l=(a=s.next(B.from)).value:B=(S=f.next(l.from)).value}return!1}function bi(n){var r=Zi(n)?null:{s:0,n};return{next:function(s){for(var a=0<arguments.length;r;)switch(r.s){case 0:if(r.s=1,a)for(;r.n.l&&Ht(s,r.n.from)<0;)r={up:r,n:r.n.l,s:1};else for(;r.n.l;)r={up:r,n:r.n.l,s:1};case 1:if(r.s=2,!a||Ht(s,r.n.to)<=0)return{value:r.n,done:!1};case 2:if(r.n.r){r.s=3,r={up:r,n:r.n.r,s:0};continue}case 3:r=r.up}return{done:!0}}}}function kr(n){var r,s,a=(((r=n.r)===null||r===void 0?void 0:r.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),l=1<a?"r":a<-1?"l":"";l&&(r=l=="r"?"l":"r",s=k({},n),a=n[l],n.from=a.from,n.to=a.to,n[l]=a[l],s[l]=a[r],(n[r]=s).d=Pr(s)),n.d=Pr(n)}function Pr(s){var r=s.r,s=s.l;return(r?s?Math.max(r.d,s.d):r.d:s?s.d:0)+1}function ii(n,r){return y(r).forEach(function(s){n[s]?yi(n[s],r[s]):n[s]=function a(l){var f,S,B={};for(f in l)T(l,f)&&(S=l[f],B[f]=!S||typeof S!="object"||Rt.has(S.constructor)?S:a(S));return B}(r[s])}),n}function ur(n,r){return n.all||r.all||Object.keys(n).some(function(s){return r[s]&&ar(r[s],n[s])})}D(Ce.prototype,((Ve={add:function(n){return yi(this,n),this},addKey:function(n){return Kn(this,n,n),this},addKeys:function(n){var r=this;return n.forEach(function(s){return Kn(r,s,s)}),this},hasKey:function(n){var r=bi(this).next(n).value;return r&&Ht(r.from,n)<=0&&0<=Ht(r.to,n)}})[zt]=function(){return bi(this)},Ve));var Mn={},Fi={},ri=!1;function hn(n){ii(Fi,n),ri||(ri=!0,setTimeout(function(){ri=!1,cr(Fi,!(Fi={}))},0))}function cr(n,r){r===void 0&&(r=!1);var s=new Set;if(n.all)for(var a=0,l=Object.values(Mn);a<l.length;a++)oi(S=l[a],n,s,r);else for(var f in n){var S,B=/^idb\:\/\/(.*)\/(.*)\//.exec(f);B&&(f=B[1],B=B[2],(S=Mn["idb://".concat(f,"/").concat(B)])&&oi(S,n,s,r))}s.forEach(function(K){return K()})}function oi(n,r,s,a){for(var l=[],f=0,S=Object.entries(n.queries.query);f<S.length;f++){for(var B=S[f],K=B[0],U=[],V=0,F=B[1];V<F.length;V++){var Q=F[V];ur(r,Q.obsSet)?Q.subscribers.forEach(function(G){return s.add(G)}):a&&U.push(Q)}a&&l.push([K,U])}if(a)for(var W=0,q=l;W<q.length;W++){var H=q[W],K=H[0],U=H[1];n.queries.query[K]=U}}function He(n){var r=n._state,s=n._deps.indexedDB;if(r.isBeingOpened||n.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?we(r.dbOpenError):n});r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var a=r.openCanceller,l=Math.round(10*n.verno),f=!1;function S(){if(r.openCanceller!==a)throw new Pt.DatabaseClosed("db.open() was cancelled")}function B(){return new Ft(function(Q,W){if(S(),!s)throw new Pt.MissingAPI;var q=n.name,H=r.autoSchema||!l?s.open(q):s.open(q,l);if(!H)throw new Pt.MissingAPI;H.onerror=xe(W),H.onblocked=ge(n._fireOnBlocked),H.onupgradeneeded=ge(function(G){var et;V=H.transaction,r.autoSchema&&!n._options.allowEmptyDB?(H.onerror=fe,V.abort(),H.result.close(),(et=s.deleteDatabase(q)).onsuccess=et.onerror=ge(function(){W(new Pt.NoSuchDatabase("Database ".concat(q," doesnt exist")))})):(V.onerror=xe(W),G=G.oldVersion>Math.pow(2,62)?0:G.oldVersion,F=G<1,n.idbdb=H.result,f&&wr(n,V),_i(n,G/10,V,W))},W),H.onsuccess=ge(function(){V=null;var G,et,rt,ft,gt,At=n.idbdb=H.result,Dt=I(At.objectStoreNames);if(0<Dt.length)try{var Et=At.transaction((ft=Dt).length===1?ft[0]:ft,"readonly");if(r.autoSchema)et=At,rt=Et,(G=n).verno=et.version/10,rt=G._dbSchema=Mi(0,et,rt),G._storeNames=I(et.objectStoreNames,0),se(G,[G._allTables],y(rt),rt);else if(Ni(n,n._dbSchema,Et),((gt=or(Mi(0,(gt=n).idbdb,Et),gt._dbSchema)).add.length||gt.change.some(function(Bt){return Bt.add.length||Bt.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),At.close(),l=At.version+1,f=!0,Q(B());mi(n,Et)}catch{}Yn.push(n),At.onversionchange=ge(function(Bt){r.vcFired=!0,n.on("versionchange").fire(Bt)}),At.onclose=ge(function(){n.close({disableAutoOpen:!1})}),F&&(gt=n._deps,Et=q,At=gt.indexedDB,gt=gt.IDBKeyRange,Ri(At)||Et===Ci||sr(At,gt).put({name:Et}).catch(Vt)),Q()},W)}).catch(function(Q){switch(Q==null?void 0:Q.name){case"UnknownError":if(0<r.PR1398_maxLoop)return r.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),B();break;case"VersionError":if(0<l)return l=0,B()}return Ft.reject(Q)})}var K,U=r.dbReadyResolve,V=null,F=!1;return Ft.race([a,(typeof navigator>"u"?Ft.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Q){function W(){return indexedDB.databases().finally(Q)}K=setInterval(W,100),W()}).finally(function(){return clearInterval(K)}):Promise.resolve()).then(B)]).then(function(){return S(),r.onReadyBeingFired=[],Ft.resolve(ln(function(){return n.on.ready.fire(n.vip)})).then(function Q(){if(0<r.onReadyBeingFired.length){var W=r.onReadyBeingFired.reduce(xt,Vt);return r.onReadyBeingFired=[],Ft.resolve(ln(function(){return W(n.vip)})).then(Q)}})}).finally(function(){r.openCanceller===a&&(r.onReadyBeingFired=null,r.isBeingOpened=!1)}).catch(function(Q){r.dbOpenError=Q;try{V&&V.abort()}catch{}return a===r.openCanceller&&n._close(),we(Q)}).finally(function(){r.openComplete=!0,U()}).then(function(){var Q;return F&&(Q={},n.tables.forEach(function(W){W.schema.indexes.forEach(function(q){q.name&&(Q["idb://".concat(n.name,"/").concat(W.name,"/").concat(q.name)]=new Ce(-1/0,[[[]]]))}),Q["idb://".concat(n.name,"/").concat(W.name,"/")]=Q["idb://".concat(n.name,"/").concat(W.name,"/:dels")]=new Ce(-1/0,[[[]]])}),cn(ti).fire(Q),cr(Q,!0)),n})}function ji(n){function r(f){return n.next(f)}var s=l(r),a=l(function(f){return n.throw(f)});function l(f){return function(K){var B=f(K),K=B.value;return B.done?K:K&&typeof K.then=="function"?K.then(s,a):g(K)?Promise.all(K).then(s,a):s(K)}}return l(r)()}function wi(n,r,s){for(var a=g(n)?n.slice():[n],l=0;l<s;++l)a.push(r);return a}var Hr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return k(k({},n),{table:function(r){var s=n.table(r),a=s.schema,l={},f=[];function S(F,Q,W){var q=ni(F),H=l[q]=l[q]||[],G=F==null?0:typeof F=="string"?1:F.length,et=0<Q,et=k(k({},W),{name:et?"".concat(q,"(virtual-from:").concat(W.name,")"):W.name,lowLevelIndex:W,isVirtual:et,keyTail:Q,keyLength:G,extractKey:Ii(F),unique:!et&&W.unique});return H.push(et),et.isPrimaryKey||f.push(et),1<G&&S(G===2?F[0]:F.slice(0,G-1),Q+1,W),H.sort(function(rt,ft){return rt.keyTail-ft.keyTail}),et}r=S(a.primaryKey.keyPath,0,a.primaryKey),l[":id"]=[r];for(var B=0,K=a.indexes;B<K.length;B++){var U=K[B];S(U.keyPath,0,U)}function V(F){var Q,W=F.query.index;return W.isVirtual?k(k({},F),{query:{index:W.lowLevelIndex,range:(Q=F.query.range,W=W.keyTail,{type:Q.type===1?2:Q.type,lower:wi(Q.lower,Q.lowerOpen?n.MAX_KEY:n.MIN_KEY,W),lowerOpen:!0,upper:wi(Q.upper,Q.upperOpen?n.MIN_KEY:n.MAX_KEY,W),upperOpen:!0})}}):F}return k(k({},s),{schema:k(k({},a),{primaryKey:r,indexes:f,getIndexByKeyPath:function(F){return(F=l[ni(F)])&&F[0]}}),count:function(F){return s.count(V(F))},query:function(F){return s.query(V(F))},openCursor:function(F){var Q=F.query.index,W=Q.keyTail,q=Q.isVirtual,H=Q.keyLength;return q?s.openCursor(V(F)).then(function(et){return et&&G(et)}):s.openCursor(F);function G(et){return Object.create(et,{continue:{value:function(rt){rt!=null?et.continue(wi(rt,F.reverse?n.MAX_KEY:n.MIN_KEY,W)):F.unique?et.continue(et.key.slice(0,H).concat(F.reverse?n.MIN_KEY:n.MAX_KEY,W)):et.continue()}},continuePrimaryKey:{value:function(rt,ft){et.continuePrimaryKey(wi(rt,n.MAX_KEY,W),ft)}},primaryKey:{get:function(){return et.primaryKey}},key:{get:function(){var rt=et.key;return H===1?rt[0]:rt.slice(0,H)}},value:{get:function(){return et.value}}})}}})}})}};function xi(n,r,s,a){return s=s||{},a=a||"",y(n).forEach(function(l){var f,S,B;T(r,l)?(f=n[l],S=r[l],typeof f=="object"&&typeof S=="object"&&f&&S?(B=ht(f))!==ht(S)?s[a+l]=r[l]:B==="Object"?xi(f,S,s,a+l+"."):f!==S&&(s[a+l]=r[l]):f!==S&&(s[a+l]=r[l])):s[a+l]=void 0}),y(r).forEach(function(l){T(n,l)||(s[a+l]=r[l])}),s}function ki(n,r){return r.type==="delete"?r.keys:r.keys||r.values.map(n.extractKey)}var Gr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return k(k({},n),{table:function(r){var s=n.table(r),a=s.schema.primaryKey;return k(k({},s),{mutate:function(l){var f=Ut.trans,S=f.table(r).hook,B=S.deleting,K=S.creating,U=S.updating;switch(l.type){case"add":if(K.fire===Vt)break;return f._promise("readwrite",function(){return V(l)},!0);case"put":if(K.fire===Vt&&U.fire===Vt)break;return f._promise("readwrite",function(){return V(l)},!0);case"delete":if(B.fire===Vt)break;return f._promise("readwrite",function(){return V(l)},!0);case"deleteRange":if(B.fire===Vt)break;return f._promise("readwrite",function(){return function F(Q,W,q){return s.query({trans:Q,values:!1,query:{index:a,range:W},limit:q}).then(function(H){var G=H.result;return V({type:"delete",keys:G,trans:Q}).then(function(et){return 0<et.numFailures?Promise.reject(et.failures[0]):G.length<q?{failures:[],numFailures:0,lastResult:void 0}:F(Q,k(k({},W),{lower:G[G.length-1],lowerOpen:!0}),q)})})}(l.trans,l.range,1e4)},!0)}return s.mutate(l);function V(F){var Q,W,q,H=Ut.trans,G=F.keys||ki(a,F);if(!G)throw new Error("Keys missing");return(F=F.type==="add"||F.type==="put"?k(k({},F),{keys:G}):k({},F)).type!=="delete"&&(F.values=_([],F.values)),F.keys&&(F.keys=_([],F.keys)),Q=s,q=G,((W=F).type==="add"?Promise.resolve([]):Q.getMany({trans:W.trans,keys:q,cache:"immutable"})).then(function(et){var rt=G.map(function(ft,gt){var At,Dt,Et,Bt=et[gt],It={onerror:null,onsuccess:null};return F.type==="delete"?B.fire.call(It,ft,Bt,H):F.type==="add"||Bt===void 0?(At=K.fire.call(It,ft,F.values[gt],H),ft==null&&At!=null&&(F.keys[gt]=ft=At,a.outbound||ot(F.values[gt],a.keyPath,ft))):(At=xi(Bt,F.values[gt]),(Dt=U.fire.call(It,At,ft,Bt,H))&&(Et=F.values[gt],Object.keys(Dt).forEach(function(Mt){T(Et,Mt)?Et[Mt]=Dt[Mt]:ot(Et,Mt,Dt[Mt])}))),It});return s.mutate(F).then(function(ft){for(var gt=ft.failures,At=ft.results,Dt=ft.numFailures,ft=ft.lastResult,Et=0;Et<G.length;++Et){var Bt=(At||G)[Et],It=rt[Et];Bt==null?It.onerror&&It.onerror(gt[Et]):It.onsuccess&&It.onsuccess(F.type==="put"&&et[Et]?F.values[Et]:Bt)}return{failures:gt,results:At,numFailures:Dt,lastResult:ft}}).catch(function(ft){return rt.forEach(function(gt){return gt.onerror&&gt.onerror(ft)}),Promise.reject(ft)})})}}})}})}};function Sr(n,r,s){try{if(!r||r.keys.length<n.length)return null;for(var a=[],l=0,f=0;l<r.keys.length&&f<n.length;++l)Ht(r.keys[l],n[f])===0&&(a.push(s?lt(r.values[l]):r.values[l]),++f);return a.length===n.length?a:null}catch{return null}}var Tr={stack:"dbcore",level:-1,create:function(n){return{table:function(r){var s=n.table(r);return k(k({},s),{getMany:function(a){if(!a.cache)return s.getMany(a);var l=Sr(a.keys,a.trans._cache,a.cache==="clone");return l?Ft.resolve(l):s.getMany(a).then(function(f){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?lt(f):f},f})},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),s.mutate(a)}})}}}};function Lr(n,r){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!r.schema.primaryKey.outbound}function Ge(n,r){switch(n){case"query":return r.values&&!r.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var si={stack:"dbcore",level:0,name:"Observability",create:function(n){var r=n.schema.name,s=new Ce(n.MIN_KEY,n.MAX_KEY);return k(k({},n),{transaction:function(a,l,f){if(Ut.subscr&&l!=="readonly")throw new Pt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ut.querier));return n.transaction(a,l,f)},table:function(a){var l=n.table(a),f=l.schema,S=f.primaryKey,F=f.indexes,B=S.extractKey,K=S.outbound,U=S.autoIncrement&&F.filter(function(W){return W.compound&&W.keyPath.includes(S.keyPath)}),V=k(k({},l),{mutate:function(W){function q(Mt){return Mt="idb://".concat(r,"/").concat(a,"/").concat(Mt),ft[Mt]||(ft[Mt]=new Ce)}var H,G,et,rt=W.trans,ft=W.mutatedParts||(W.mutatedParts={}),gt=q(""),At=q(":dels"),Dt=W.type,It=W.type==="deleteRange"?[W.range]:W.type==="delete"?[W.keys]:W.values.length<50?[ki(S,W).filter(function(Mt){return Mt}),W.values]:[],Et=It[0],Bt=It[1],It=W.trans._cache;return g(Et)?(gt.addKeys(Et),(It=Dt==="delete"||Et.length===Bt.length?Sr(Et,It):null)||At.addKeys(Et),(It||Bt)&&(H=q,G=It,et=Bt,f.indexes.forEach(function(Mt){var Wt=H(Mt.name||"");function ee(re){return re!=null?Mt.extractKey(re):null}function Jt(re){return Mt.multiEntry&&g(re)?re.forEach(function(Fe){return Wt.addKey(Fe)}):Wt.addKey(re)}(G||et).forEach(function(re,Ie){var $t=G&&ee(G[Ie]),Ie=et&&ee(et[Ie]);Ht($t,Ie)!==0&&($t!=null&&Jt($t),Ie!=null&&Jt(Ie))})}))):Et?(Bt={from:(Bt=Et.lower)!==null&&Bt!==void 0?Bt:n.MIN_KEY,to:(Bt=Et.upper)!==null&&Bt!==void 0?Bt:n.MAX_KEY},At.add(Bt),gt.add(Bt)):(gt.add(s),At.add(s),f.indexes.forEach(function(Mt){return q(Mt.name).add(s)})),l.mutate(W).then(function(Mt){return!Et||W.type!=="add"&&W.type!=="put"||(gt.addKeys(Mt.results),U&&U.forEach(function(Wt){for(var ee=W.values.map(function($t){return Wt.extractKey($t)}),Jt=Wt.keyPath.findIndex(function($t){return $t===S.keyPath}),re=0,Fe=Mt.results.length;re<Fe;++re)ee[re][Jt]=Mt.results[re];q(Wt.name).addKeys(ee)})),rt.mutatedParts=ii(rt.mutatedParts||{},ft),Mt})}}),F=function(q){var H=q.query,q=H.index,H=H.range;return[q,new Ce((q=H.lower)!==null&&q!==void 0?q:n.MIN_KEY,(H=H.upper)!==null&&H!==void 0?H:n.MAX_KEY)]},Q={get:function(W){return[S,new Ce(W.key)]},getMany:function(W){return[S,new Ce().addKeys(W.keys)]},count:F,query:F,openCursor:F};return y(Q).forEach(function(W){V[W]=function(q){var H=Ut.subscr,G=!!H,et=Lr(Ut,l)&&Ge(W,q)?q.obsSet={}:H;if(G){var rt=function(Bt){return Bt="idb://".concat(r,"/").concat(a,"/").concat(Bt),et[Bt]||(et[Bt]=new Ce)},ft=rt(""),gt=rt(":dels"),H=Q[W](q),G=H[0],H=H[1];if((W==="query"&&G.isPrimaryKey&&!q.values?gt:rt(G.name||"")).add(H),!G.isPrimaryKey){if(W!=="count"){var At=W==="query"&&K&&q.values&&l.query(k(k({},q),{values:!1}));return l[W].apply(this,arguments).then(function(Bt){if(W==="query"){if(K&&q.values)return At.then(function(ee){return ee=ee.result,ft.addKeys(ee),Bt});var It=q.values?Bt.result.map(B):Bt.result;(q.values?ft:gt).addKeys(It)}else if(W==="openCursor"){var Mt=Bt,Wt=q.values;return Mt&&Object.create(Mt,{key:{get:function(){return gt.addKey(Mt.primaryKey),Mt.key}},primaryKey:{get:function(){var ee=Mt.primaryKey;return gt.addKey(ee),ee}},value:{get:function(){return Wt&&ft.addKey(Mt.primaryKey),Mt.value}}})}return Bt})}gt.add(s)}}return l[W].apply(this,arguments)}}),V}})}};function Er(n,r,s){if(s.numFailures===0)return r;if(r.type==="deleteRange")return null;var a=r.keys?r.keys.length:"values"in r&&r.values?r.values.length:1;return s.numFailures===a?null:(r=k({},r),g(r.keys)&&(r.keys=r.keys.filter(function(l,f){return!(f in s.failures)})),"values"in r&&g(r.values)&&(r.values=r.values.filter(function(l,f){return!(f in s.failures)})),r)}function en(n,r){return s=n,((a=r).lower===void 0||(a.lowerOpen?0<Ht(s,a.lower):0<=Ht(s,a.lower)))&&(n=n,(r=r).upper===void 0||(r.upperOpen?Ht(n,r.upper)<0:Ht(n,r.upper)<=0));var s,a}function Cr(n,r,Q,a,l,f){if(!Q||Q.length===0)return n;var S=r.query.index,B=S.multiEntry,K=r.query.range,U=a.schema.primaryKey.extractKey,V=S.extractKey,F=(S.lowLevelIndex||S).extractKey,Q=Q.reduce(function(W,q){var H=W,G=[];if(q.type==="add"||q.type==="put")for(var et=new Ce,rt=q.values.length-1;0<=rt;--rt){var ft,gt=q.values[rt],At=U(gt);et.hasKey(At)||(ft=V(gt),(B&&g(ft)?ft.some(function(Mt){return en(Mt,K)}):en(ft,K))&&(et.addKey(At),G.push(gt)))}switch(q.type){case"add":var Dt=new Ce().addKeys(r.values?W.map(function(Wt){return U(Wt)}):W),H=W.concat(r.values?G.filter(function(Wt){return Wt=U(Wt),!Dt.hasKey(Wt)&&(Dt.addKey(Wt),!0)}):G.map(function(Wt){return U(Wt)}).filter(function(Wt){return!Dt.hasKey(Wt)&&(Dt.addKey(Wt),!0)}));break;case"put":var Et=new Ce().addKeys(q.values.map(function(Wt){return U(Wt)}));H=W.filter(function(Wt){return!Et.hasKey(r.values?U(Wt):Wt)}).concat(r.values?G:G.map(function(Wt){return U(Wt)}));break;case"delete":var Bt=new Ce().addKeys(q.keys);H=W.filter(function(Wt){return!Bt.hasKey(r.values?U(Wt):Wt)});break;case"deleteRange":var It=q.range;H=W.filter(function(Wt){return!en(U(Wt),It)})}return H},n);return Q===n?n:(Q.sort(function(W,q){return Ht(F(W),F(q))||Ht(U(W),U(q))}),r.limit&&r.limit<1/0&&(Q.length>r.limit?Q.length=r.limit:n.length===r.limit&&Q.length<r.limit&&(l.dirty=!0)),f?Object.freeze(Q):Q)}function Un(n,r){return Ht(n.lower,r.lower)===0&&Ht(n.upper,r.upper)===0&&!!n.lowerOpen==!!r.lowerOpen&&!!n.upperOpen==!!r.upperOpen}function Vr(n,r){return function(s,a,l,f){if(s===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((a=Ht(s,a))===0){if(l&&f)return 0;if(l)return 1;if(f)return-1}return a}(n.lower,r.lower,n.lowerOpen,r.lowerOpen)<=0&&0<=function(s,a,l,f){if(s===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((a=Ht(s,a))===0){if(l&&f)return 0;if(l)return-1;if(f)return 1}return a}(n.upper,r.upper,n.upperOpen,r.upperOpen)}function Pi(n,r,s,a){n.subscribers.add(s),a.addEventListener("abort",function(){var l,f;n.subscribers.delete(s),n.subscribers.size===0&&(l=n,f=r,setTimeout(function(){l.subscribers.size===0&&Lt(f,l)},3e3))})}var Or={stack:"dbcore",level:0,name:"Cache",create:function(n){var r=n.schema.name;return k(k({},n),{transaction:function(s,a,l){var f,S,B=n.transaction(s,a,l);return a==="readwrite"&&(S=(f=new AbortController).signal,l=function(K){return function(){if(f.abort(),a==="readwrite"){for(var U=new Set,V=0,F=s;V<F.length;V++){var Q=F[V],W=Mn["idb://".concat(r,"/").concat(Q)];if(W){var q=n.table(Q),H=W.optimisticOps.filter(function(Wt){return Wt.trans===B});if(B._explicit&&K&&B.mutatedParts)for(var G=0,et=Object.values(W.queries.query);G<et.length;G++)for(var rt=0,ft=(Dt=et[G]).slice();rt<ft.length;rt++)ur((Et=ft[rt]).obsSet,B.mutatedParts)&&(Lt(Dt,Et),Et.subscribers.forEach(function(Wt){return U.add(Wt)}));else if(0<H.length){W.optimisticOps=W.optimisticOps.filter(function(Wt){return Wt.trans!==B});for(var gt=0,At=Object.values(W.queries.query);gt<At.length;gt++)for(var Dt,Et,Bt,It=0,Mt=(Dt=At[gt]).slice();It<Mt.length;It++)(Et=Mt[It]).res!=null&&B.mutatedParts&&(K&&!Et.dirty?(Bt=Object.isFrozen(Et.res),Bt=Cr(Et.res,Et.req,H,q,Et,Bt),Et.dirty?(Lt(Dt,Et),Et.subscribers.forEach(function(Wt){return U.add(Wt)})):Bt!==Et.res&&(Et.res=Bt,Et.promise=Ft.resolve({result:Bt}))):(Et.dirty&&Lt(Dt,Et),Et.subscribers.forEach(function(Wt){return U.add(Wt)})))}}}U.forEach(function(Wt){return Wt()})}}},B.addEventListener("abort",l(!1),{signal:S}),B.addEventListener("error",l(!1),{signal:S}),B.addEventListener("complete",l(!0),{signal:S})),B},table:function(s){var a=n.table(s),l=a.schema.primaryKey;return k(k({},a),{mutate:function(f){var S=Ut.trans;if(l.outbound||S.db._options.cache==="disabled"||S.explicit||S.idbtrans.mode!=="readwrite")return a.mutate(f);var B=Mn["idb://".concat(r,"/").concat(s)];return B?(S=a.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||ki(l,f).some(function(K){return K==null}))?(B.optimisticOps.push(f),f.mutatedParts&&hn(f.mutatedParts),S.then(function(K){0<K.numFailures&&(Lt(B.optimisticOps,f),(K=Er(0,f,K))&&B.optimisticOps.push(K),f.mutatedParts&&hn(f.mutatedParts))}),S.catch(function(){Lt(B.optimisticOps,f),f.mutatedParts&&hn(f.mutatedParts)})):S.then(function(K){var U=Er(0,k(k({},f),{values:f.values.map(function(V,F){var Q;return K.failures[F]?V:(V=(Q=l.keyPath)!==null&&Q!==void 0&&Q.includes(".")?lt(V):k({},V),ot(V,l.keyPath,K.results[F]),V)})}),K);B.optimisticOps.push(U),queueMicrotask(function(){return f.mutatedParts&&hn(f.mutatedParts)})}),S):a.mutate(f)},query:function(f){if(!Lr(Ut,a)||!Ge("query",f))return a.query(f);var S=((U=Ut.trans)===null||U===void 0?void 0:U.db._options.cache)==="immutable",F=Ut,B=F.requery,K=F.signal,U=function(q,H,G,et){var rt=Mn["idb://".concat(q,"/").concat(H)];if(!rt)return[];if(!(H=rt.queries[G]))return[null,!1,rt,null];var ft=H[(et.query?et.query.index.name:null)||""];if(!ft)return[null,!1,rt,null];switch(G){case"query":var gt=ft.find(function(At){return At.req.limit===et.limit&&At.req.values===et.values&&Un(At.req.query.range,et.query.range)});return gt?[gt,!0,rt,ft]:[ft.find(function(At){return("limit"in At.req?At.req.limit:1/0)>=et.limit&&(!et.values||At.req.values)&&Vr(At.req.query.range,et.query.range)}),!1,rt,ft];case"count":return gt=ft.find(function(At){return Un(At.req.query.range,et.query.range)}),[gt,!!gt,rt,ft]}}(r,s,"query",f),V=U[0],F=U[1],Q=U[2],W=U[3];return V&&F?V.obsSet=f.obsSet:(F=a.query(f).then(function(q){var H=q.result;if(V&&(V.res=H),S){for(var G=0,et=H.length;G<et;++G)Object.freeze(H[G]);Object.freeze(H)}else q.result=lt(H);return q}).catch(function(q){return W&&V&&Lt(W,V),Promise.reject(q)}),V={obsSet:f.obsSet,promise:F,subscribers:new Set,type:"query",req:f,dirty:!1},W?W.push(V):(W=[V],(Q=Q||(Mn["idb://".concat(r,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=W)),Pi(V,W,B,K),V.promise.then(function(q){return{result:Cr(q.result,f,Q==null?void 0:Q.optimisticOps,a,V,S)}})}})}})}};function Wn(n,r){return new Proxy(n,{get:function(s,a,l){return a==="db"?r:Reflect.get(s,a,l)}})}var Pn=(pe.prototype.version=function(n){if(isNaN(n)||n<.1)throw new Pt.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new Pt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var r=this._versions,s=r.filter(function(a){return a._cfg.version===n})[0];return s||(s=new this.Version(n),r.push(s),r.sort(tn),s.stores({}),this._state.autoSchema=!1,s)},pe.prototype._whenReady=function(n){var r=this;return this.idbdb&&(this._state.openComplete||Ut.letThrough||this._vip)?n():new Ft(function(s,a){if(r._state.openComplete)return a(new Pt.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen)return void a(new Pt.DatabaseClosed);r.open().catch(Vt)}r._state.dbReadyPromise.then(s,a)}).then(n)},pe.prototype.use=function(n){var r=n.stack,s=n.create,a=n.level,l=n.name;return l&&this.unuse({stack:r,name:l}),n=this._middlewares[r]||(this._middlewares[r]=[]),n.push({stack:r,create:s,level:a??10,name:l}),n.sort(function(f,S){return f.level-S.level}),this},pe.prototype.unuse=function(n){var r=n.stack,s=n.name,a=n.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(l){return a?l.create!==a:!!s&&l.name!==s})),this},pe.prototype.open=function(){var n=this;return Fn(Ue,function(){return He(n)})},pe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,r=Yn.indexOf(this);if(0<=r&&Yn.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ft(function(s){n.dbReadyResolve=s}),n.openCanceller=new Ft(function(s,a){n.cancelOpen=a}))},pe.prototype.close=function(s){var r=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;r?(s.isBeingOpened&&s.cancelOpen(new Pt.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new Pt.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},pe.prototype.delete=function(n){var r=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",a=this._state;return new Ft(function(l,f){function S(){r.close(n);var B=r._deps.indexedDB.deleteDatabase(r.name);B.onsuccess=ge(function(){var K,U,V;K=r._deps,U=r.name,V=K.indexedDB,K=K.IDBKeyRange,Ri(V)||U===Ci||sr(V,K).delete(U).catch(Vt),l()}),B.onerror=xe(f),B.onblocked=r._fireOnBlocked}if(s)throw new Pt.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(S):S()})},pe.prototype.backendDB=function(){return this.idbdb},pe.prototype.isOpen=function(){return this.idbdb!==null},pe.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},pe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},pe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(pe.prototype,"tables",{get:function(){var n=this;return y(this._allTables).map(function(r){return n._allTables[r]})},enumerable:!1,configurable:!0}),pe.prototype.transaction=function(){var n=(function(r,s,a){var l=arguments.length;if(l<2)throw new Pt.InvalidArgument("Too few arguments");for(var f=new Array(l-1);--l;)f[l-1]=arguments[l];return a=f.pop(),[r,Tt(f),a]}).apply(this,arguments);return this._transaction.apply(this,n)},pe.prototype._transaction=function(n,r,s){var a=this,l=Ut.trans;l&&l.db===this&&n.indexOf("!")===-1||(l=null);var f,S,B=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(S=r.map(function(U){if(U=U instanceof a.Table?U.name:U,typeof U!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return U}),n=="r"||n===Ji)f=Ji;else{if(n!="rw"&&n!=li)throw new Pt.InvalidArgument("Invalid transaction mode: "+n);f=li}if(l){if(l.mode===Ji&&f===li){if(!B)throw new Pt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");l=null}l&&S.forEach(function(U){if(l&&l.storeNames.indexOf(U)===-1){if(!B)throw new Pt.SubTransaction("Table "+U+" not included in parent transaction.");l=null}}),B&&l&&!l.active&&(l=null)}}catch(U){return l?l._promise(null,function(V,F){F(U)}):we(U)}var K=(function U(V,F,Q,W,q){return Ft.resolve().then(function(){var H=Ut.transless||Ut,G=V._createTransaction(F,Q,V._dbSchema,W);if(G.explicit=!0,H={trans:G,transless:H},W)G.idbtrans=W.idbtrans;else try{G.create(),G.idbtrans._explicit=!0,V._state.PR1398_maxLoop=3}catch(ft){return ft.name===le.InvalidState&&V.isOpen()&&0<--V._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),V.close({disableAutoOpen:!1}),V.open().then(function(){return U(V,F,Q,null,q)})):we(ft)}var et,rt=$(q);return rt&&Cn(),H=Ft.follow(function(){var ft;(et=q.call(G,G))&&(rt?(ft=vn.bind(null,null),et.then(ft,ft)):typeof et.next=="function"&&typeof et.throw=="function"&&(et=ji(et)))},H),(et&&typeof et.then=="function"?Ft.resolve(et).then(function(ft){return G.active?ft:we(new Pt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):H.then(function(){return et})).then(function(ft){return W&&G._resolve(),G._completion.then(function(){return ft})}).catch(function(ft){return G._reject(ft),we(ft)})})}).bind(null,this,f,S,l,s);return l?l._promise(f,K,"lock"):Ut.trans?Fn(Ut.transless,function(){return a._whenReady(K)}):this._whenReady(K)},pe.prototype.table=function(n){if(!T(this._allTables,n))throw new Pt.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},pe);function pe(n,r){var s=this;this._middlewares={},this.verno=0;var a=pe.dependencies;this._options=r=k({addons:pe.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange},a=r.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var l,f,S,B,K,U={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Vt,dbReadyPromise:null,cancelOpen:Vt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};U.dbReadyPromise=new Ft(function(F){U.dbReadyResolve=F}),U.openCanceller=new Ft(function(F,Q){U.cancelOpen=Q}),this._state=U,this.name=n,this.on=An(this,"populate","blocked","versionchange","close",{ready:[xt,Vt]}),this.once=function(F,Q){var W=function(){for(var q=[],H=0;H<arguments.length;H++)q[H]=arguments[H];s.on(F).unsubscribe(W),Q.apply(s,q)};return s.on(F,W)},this.on.ready.subscribe=j(this.on.ready.subscribe,function(F){return function(Q,W){pe.vip(function(){var q,H=s._state;H.openComplete?(H.dbOpenError||Ft.resolve().then(Q),W&&F(Q)):H.onReadyBeingFired?(H.onReadyBeingFired.push(Q),W&&F(Q)):(F(Q),q=s,W||F(function G(){q.on.ready.unsubscribe(Q),q.on.ready.unsubscribe(G)}))})}}),this.Collection=(l=this,Ae($i.prototype,function(et,G){this.db=l;var W=Qi,q=null;if(G)try{W=G()}catch(rt){q=rt}var H=et._ctx,G=H.table,et=G.hook.reading.fire;this._ctx={table:G,index:H.index,isPrimKey:!H.index||G.schema.primKey.keyPath&&H.index===G.schema.primKey.name,range:W,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:q,or:H.or,valueMapper:et!==he?et:null}})),this.Table=(f=this,Ae(be.prototype,function(F,Q,W){this.db=f,this._tx=W,this.name=F,this.schema=Q,this.hook=f._allTables[F]?f._allTables[F].hook:An(null,{creating:[st,Vt],reading:[h,he],updating:[E,Vt],deleting:[A,Vt]})})),this.Transaction=(S=this,Ae(er.prototype,function(F,Q,W,q,H){var G=this;F!=="readonly"&&Q.forEach(function(et){et=(et=W[et])===null||et===void 0?void 0:et.yProps,et&&(Q=Q.concat(et.map(function(rt){return rt.updatesTable})))}),this.db=S,this.mode=F,this.storeNames=Q,this.schema=W,this.chromeTransactionDurability=q,this.idbtrans=null,this.on=An(this,"complete","error","abort"),this.parent=H||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ft(function(et,rt){G._resolve=et,G._reject=rt}),this._completion.then(function(){G.active=!1,G.on.complete.fire()},function(et){var rt=G.active;return G.active=!1,G.on.error.fire(et),G.parent?G.parent._reject(et):rt&&G.idbtrans&&G.idbtrans.abort(),we(et)})})),this.Version=(B=this,Ae(qr.prototype,function(F){this.db=B,this._cfg={version:F,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(K=this,Ae(br.prototype,function(F,Q,W){if(this.db=K,this._ctx={table:F,index:Q===":id"?null:Q,or:W},this._cmp=this._ascending=Ht,this._descending=function(q,H){return Ht(H,q)},this._max=function(q,H){return 0<Ht(q,H)?q:H},this._min=function(q,H){return Ht(q,H)<0?q:H},this._IDBKeyRange=K._deps.IDBKeyRange,!this._IDBKeyRange)throw new Pt.MissingAPI})),this.on("versionchange",function(F){0<F.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(F){!F.newVersion||F.newVersion<F.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(F.oldVersion/10))}),this._maxKey=$e(r.IDBKeyRange),this._createTransaction=function(F,Q,W,q){return new s.Transaction(F,Q,W,s._options.chromeTransactionDurability,q)},this._fireOnBlocked=function(F){s.on("blocked").fire(F),Yn.filter(function(Q){return Q.name===s.name&&Q!==s&&!Q._state.vcFired}).map(function(Q){return Q.on("versionchange").fire(F)})},this.use(Tr),this.use(Or),this.use(si),this.use(Hr),this.use(Gr);var V=new Proxy(this,{get:function(F,Q,W){if(Q==="_vip")return!0;if(Q==="table")return function(H){return Wn(s.table(H),V)};var q=Reflect.get(F,Q,W);return q instanceof be?Wn(q,V):Q==="tables"?q.map(function(H){return Wn(H,V)}):Q==="_createTransaction"?function(){return Wn(q.apply(this,arguments),V)}:q}});this.vip=V,a.forEach(function(F){return F(s)})}var qn,Ve=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",lr=(hr.prototype.subscribe=function(n,r,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:r,complete:s})},hr.prototype[Ve]=function(){return this},hr);function hr(n){this._subscribe=n}try{qn={indexedDB:p.indexedDB||p.mozIndexedDB||p.webkitIndexedDB||p.msIndexedDB,IDBKeyRange:p.IDBKeyRange||p.webkitIDBKeyRange}}catch{qn={indexedDB:null,IDBKeyRange:null}}function fn(n){var r,s=!1,a=new lr(function(l){var f=$(n),S,B=!1,K={},U={},V={get closed(){return B},unsubscribe:function(){B||(B=!0,S&&S.abort(),F&&cn.storagemutated.unsubscribe(W))}};l.start&&l.start(V);var F=!1,Q=function(){return Ei(q)},W=function(H){ii(K,H),ur(U,K)&&Q()},q=function(){var H,G,et;!B&&qn.indexedDB&&(K={},H={},S&&S.abort(),S=new AbortController,et=function(rt){var ft=Vn();try{f&&Cn();var gt=gn(n,rt);return gt=f?gt.finally(vn):gt}finally{ft&&En()}}(G={subscr:H,signal:S.signal,requery:Q,querier:n,trans:null}),Promise.resolve(et).then(function(rt){s=!0,r=rt,B||G.signal.aborted||(K={},function(ft){for(var gt in ft)if(T(ft,gt))return;return 1}(U=H)||F||(cn(ti,W),F=!0),Ei(function(){return!B&&l.next&&l.next(rt)}))},function(rt){s=!1,["DatabaseClosedError","AbortError"].includes(rt==null?void 0:rt.name)||B||Ei(function(){B||l.error&&l.error(rt)})}))};return setTimeout(Q,0),V});return a.hasValue=function(){return s},a.getValue=function(){return r},a}var Hn=Pn;function Nn(n){var r=Be;try{Be=!0,cn.storagemutated.fire(n),cr(n,!0)}finally{Be=r}}D(Hn,k(k({},Qt),{delete:function(n){return new Hn(n,{addons:[]}).delete()},exists:function(n){return new Hn(n,{addons:[]}).open().then(function(r){return r.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return r=Hn.dependencies,s=r.indexedDB,r=r.IDBKeyRange,(Ri(s)?Promise.resolve(s.databases()).then(function(a){return a.map(function(l){return l.name}).filter(function(l){return l!==Ci})}):sr(s,r).toCollection().primaryKeys()).then(n)}catch{return we(new Pt.MissingAPI)}var r,s},defineClass:function(){return function(n){w(this,n)}},ignoreTransaction:function(n){return Ut.trans?Fn(Ut.transless,n):n()},vip:ln,async:function(n){return function(){try{var r=ji(n.apply(this,arguments));return r&&typeof r.then=="function"?r:Ft.resolve(r)}catch(s){return we(s)}}},spawn:function(n,r,s){try{var a=ji(n.apply(s,r||[]));return a&&typeof a.then=="function"?a:Ft.resolve(a)}catch(l){return we(l)}},currentTransaction:{get:function(){return Ut.trans||null}},waitFor:function(n,r){return r=Ft.resolve(typeof n=="function"?Hn.ignoreTransaction(n):n).timeout(r||6e4),Ut.trans?Ut.trans.waitFor(r):r},Promise:Ft,debug:{get:function(){return yt},set:function(n){it(n)}},derive:b,extend:w,props:D,override:j,Events:An,on:cn,liveQuery:fn,extendObservabilitySet:ii,getByKeyPath:ct,setByKeyPath:ot,delByKeyPath:function(n,r){typeof r=="string"?ot(n,r,void 0):"length"in r&&[].map.call(r,function(s){ot(n,s,void 0)})},shallowClone:wt,deepClone:lt,getObjectDiff:xi,cmp:Ht,asap:Y,minKey:-1/0,addons:[],connections:Yn,errnames:le,dependencies:qn,cache:Mn,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,r,s){return n+r/Math.pow(10,2*s)})})),Hn.maxKey=$e(Hn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(cn(ti,function(n){Be||(n=new CustomEvent(di,{detail:n}),Be=!0,dispatchEvent(n),Be=!1)}),addEventListener(di,function(n){n=n.detail,Be||Nn(n)}));var ai,Be=!1,Si=function(){};return typeof BroadcastChannel<"u"&&((Si=function(){(ai=new BroadcastChannel(di)).onmessage=function(n){return n.data&&Nn(n.data)}})(),typeof ai.unref=="function"&&ai.unref(),cn(ti,function(n){Be||ai.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Pn.disableBfCache&&n.persisted){yt&&console.debug("Dexie: handling persisted pagehide"),ai!=null&&ai.close();for(var r=0,s=Yn;r<s.length;r++)s[r].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Pn.disableBfCache&&n.persisted&&(yt&&console.debug("Dexie: handling persisted pageshow"),Si(),Nn({all:new Ce(-1/0,[[]])}))})),Ft.rejectionMapper=function(n,r){return!n||n instanceof Zt||n instanceof TypeError||n instanceof SyntaxError||!n.name||!oe[n.name]?n:(r=new oe[n.name](r||n.message,n),"stack"in n&&O(r,"stack",{get:function(){return this.inner.stack}}),r)},it(yt),k(Pn,Object.freeze({__proto__:null,Dexie:Pn,liveQuery:fn,Entity:Xn,cmp:Ht,PropModification:un,replacePrefix:function(n,r){return new un({replacePrefix:[n,r]})},add:function(n){return new un({add:n})},remove:function(n){return new un({remove:n})},default:Pn,RangeSet:Ce,mergeRanges:yi,rangesOverlap:ar}),{default:Pn}),Pn})})(So);var Qo=So.exports;const Qr=no(Qo),wo=Symbol.for("Dexie"),Gi=globalThis[wo]||(globalThis[wo]=Qr);if(Qr.semVer!==Gi.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Qr.semVer} and ${Gi.semVer}`);const{liveQuery:La,mergeRanges:Ea,rangesOverlap:Ca,RangeSet:Oa,cmp:Aa,Entity:za,PropModification:Ba,replacePrefix:Ia,add:Ma,remove:Na,DexieYProvider:Da}=Gi;class $o extends Gi{constructor(){super("tallies-db");Ui(this,"tallies");Ui(this,"tally_sessions");Ui(this,"bagups");Ui(this,"projects");Ui(this,"supervisors");this.version(1).stores({tallies:"client_id, date, created_at, sync_status"}),this.version(2).stores({tallies:"client_id, date, created_at, sync_status",tally_sessions:"session_id, created_at, sync_status",bagups:"bagup_id, session_id, created_at, sync_status, [session_id+created_at]"}),this.version(3).stores({tallies:"client_id, date, created_at, sync_status",tally_sessions:"session_id, created_at, sync_status",bagups:"bagup_id, session_id, created_at, sync_status, [session_id+created_at]",projects:"project_name"}),this.version(4).stores({tallies:"client_id, date, created_at, sync_status",tally_sessions:"session_id, created_at, sync_status",bagups:"bagup_id, session_id, created_at, sync_status, [session_id+created_at]",projects:"project_name",supervisors:"name"})}}const _e=new $o,Ee=async()=>{_e.isOpen()||await _e.open()},ts=async m=>(await Ee(),_e.tallies.where("date").equals(m).reverse().sortBy("created_at")),es=async m=>(await Ee(),_e.tallies.where("sync_status").anyOf(m).reverse().sortBy("created_at")),Xr=async m=>(await Ee(),_e.tallies.where("sync_status").equals(m).count()),To=async(m,z)=>{await Ee(),await _e.tallies.update(m,z)},ns=async m=>{await Ee(),await _e.tally_sessions.add(m)},Dr=async(m,z)=>{await Ee(),await _e.tally_sessions.update(m,z)},Lo=async m=>(await Ee(),_e.tally_sessions.get(m)),dr=async m=>(await Ee(),_e.tally_sessions.where("sync_status").anyOf(m).reverse().sortBy("created_at")),is=async()=>(await Ee(),_e.tally_sessions.orderBy("created_at").reverse().toArray()),Wi=async m=>(await Ee(),_e.tally_sessions.where("sync_status").equals(m).count()),rs=async m=>{await Ee(),await _e.bagups.add(m)},Rr=async(m,z)=>{await Ee(),await _e.bagups.update(m,z)},os=async m=>{await Ee(),await _e.bagups.delete(m)},Eo=async m=>(await Ee(),_e.bagups.where("[session_id+created_at]").between([m,Gi.minKey],[m,Gi.maxKey]).reverse().toArray()),ss=async m=>(await Ee(),_e.bagups.where("sync_status").anyOf(m).reverse().sortBy("created_at")),Jr=async m=>(await Ee(),_e.bagups.where("sync_status").equals(m).count()),as=async m=>{await Ee(),await _e.transaction("rw",_e.projects,async()=>{await _e.projects.clear(),await _e.projects.bulkPut(m)})},us=async()=>(await Ee(),_e.projects.toArray()),cs=async m=>{await Ee(),await _e.transaction("rw",_e.supervisors,async()=>{await _e.supervisors.clear(),await _e.supervisors.bulkPut(m.map(z=>({name:z})))})},ls=async()=>(await Ee(),(await _e.supervisors.toArray()).map(z=>z.name)),hs=async m=>ts(m),fs=async(m=20)=>(await es(["pending","error"])).slice(0,m),ds=async()=>{const[m,z,c]=await Promise.all([Xr("pending"),Xr("synced"),Xr("error")]);return{pending:m,synced:z,error:c}},ps=async m=>{await Promise.all(m.map(z=>To(z.client_id,{sync_status:"synced",sync_error:void 0})))},ms=async(m,z)=>{await Promise.all(m.map(c=>To(c.client_id,{sync_status:"error",sync_error:z})))},Co=()=>"randomUUID"in crypto?crypto.randomUUID():`id-${Date.now()}-${Math.random().toString(16).slice(2)}`,_s=async m=>{var k,_,p;let z=Date.now();if(m.date){const[y,g,w]=m.date.split("-").map(Number),M=new Date(y,g-1,w),R=new Date;M.setHours(R.getHours(),R.getMinutes(),R.getSeconds(),R.getMilliseconds()),z=M.getTime()}const c={session_id:Co(),created_at:z,block_name:m.block_name.trim(),project_name:(k=m.project_name)==null?void 0:k.trim(),supervisor:(_=m.supervisor)==null?void 0:_.trim(),target_density:m.target_density,notes:((p=m.notes)==null?void 0:p.trim())||void 0,species:m.species,sync_status:"draft"};return await ns(c),c},gs=async m=>Lo(m),vs=async(m=20)=>(await dr(["finalized","error"])).slice(0,m),ys=async()=>{const[m,z,c,k,_,p]=await Promise.all([Wi("pending"),Wi("draft"),Wi("synced"),Wi("error"),Wi("finalized"),Wi("archived")]);return{pending:m,draft:z,synced:c,error:k,finalized:_,archived:p}},bs=async m=>{await Promise.all(m.map(z=>Dr(z.session_id,{sync_status:"synced",sync_error:void 0})))},ws=async(m,z)=>{await Promise.all(m.map(c=>Dr(c.session_id,{sync_status:"error",sync_error:z})))},xs=async(m,z,c)=>{const k={};z.forEach(p=>{k[p]=0});const _={bagup_id:Co(),session_id:m,created_at:Date.now(),counts:k,sync_status:"pending"};return c&&(_.lat=c.lat,_.lng=c.lng),await rs(_),_},ks=async(m,z)=>{await Rr(m,{counts:z})},Ps=async m=>{await os(m)},Ss=async m=>Eo(m),Ts=async(m=20)=>(await ss(["finalized","error"])).slice(0,m),Ls=async()=>{const[m,z,c]=await Promise.all([Jr("pending"),Jr("synced"),Jr("error")]);return{pending:m,synced:z,error:c}},Es=async m=>{await Promise.all(m.map(z=>Rr(z.bagup_id,{sync_status:"synced",sync_error:void 0})))},Cs=async(m,z)=>{await Promise.all(m.map(c=>Rr(c.bagup_id,{sync_status:"error",sync_error:z})))},Os=async m=>{if(!await Lo(m))return;await Dr(m,{sync_status:"finalized",sync_error:void 0});const c=await Eo(m);await Promise.all(c.filter(k=>k.sync_status==="pending"||k.sync_status==="error").map(k=>Rr(k.bagup_id,{sync_status:"finalized",sync_error:void 0})))},As=async m=>{await Dr(m,{sync_status:"archived"})},zs=async m=>{switch(m){case"Synced Sessions":return dr(["synced"]);case"Finalized Sessions":return dr(["finalized"]);case"Archived Sessions":return dr(["archived"]);case"Error Sessions":return dr(["error"]);case"All Sessions":default:return is()}},xo=(m,z)=>{const c={};return m.forEach(k=>{c[k.species_code]=0}),z.forEach(k=>{Object.entries(k.counts).forEach(([_,p])=>{c[_]=(c[_]??0)+p})}),c},ko=(m,z)=>{const c=m.reduce((_,p)=>_+(z[p.species_code]??0),0),k={};return m.forEach(_=>{k[_.species_code]=c===0?0:(z[_.species_code]??0)/c}),k},Bs=(m,z)=>{if(!z)return"First bagup";const c=Math.max(m-z,0);return Oo(c)},Oo=m=>{const z=Math.floor(m/1e3),c=Math.floor(z/60),k=z%60;return c===0?`${k}s`:`${c}m ${k}s`},Is=m=>{const z=[...m].sort((k,_)=>k.created_at-_.created_at),c={};return z.forEach((k,_)=>{var y;const p=_===0||(y=z[_-1])==null?void 0:y.created_at;c[k.bagup_id]=Bs(k.created_at,p)}),c},Ms=m=>{var p,y,g,w;const z=kt("div",{className:"species-row"}),c=kt("input");c.placeholder="Code",c.readOnly=!0,c.value=((p=m.initial)==null?void 0:p.species_code)??"";const k=kt("input");k.placeholder="Display name",k.readOnly=!0,k.value=((y=m.initial)==null?void 0:y.display_name)??"";const _=kt("input");return _.type="number",_.step="0.01",_.min="0",_.placeholder="Required ratio",_.value=((w=(g=m.initial)==null?void 0:g.required_ratio)==null?void 0:w.toString())??"",z.append(c,k,_),{row:z,codeInput:c,nameInput:k,ratioInput:_}},Ns=m=>{const z=kt("div",{className:"species-summary"});z.dataset.speciesCode=m.species_code;const c=kt("div",{className:"species-title",text:m.display_name}),k=kt("div",{className:"species-meta",text:`Target: ${(m.required_ratio*100).toFixed(0)}%`}),_=kt("div",{className:"species-current",text:"Current: 0%"}),p=kt("div",{className:"species-total",text:"Total: 0"});return z.append(c,k,_,p),z},Ao="https://script.google.com/macros/s/AKfycbxDcDdxog0J713kdiMBHWbnelmDa0lGf8JwYMKEGKP1H5ok3t_wsdOyu9-KcLWgXZvZ/exec",Ds=async m=>{const z=await fetch(Ao,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(m)});if(!z.ok){const c=await z.text();throw new Error(c||`Request failed with status ${z.status}`)}},Rs=async()=>{const m=await fetch(Ao,{method:"GET"});if(!m.ok){const c=await m.text();throw new Error(c||`Request failed with status ${m.status}`)}return await m.json()},qi=20,Zs=async()=>{if(!navigator.onLine)return{synced:0,failed:0,skipped:!0,errors:[]};let m=0,z=0;const c=new Set;for(;;){const[k,_,p]=await Promise.all([fs(qi),vs(qi),Ts(qi)]);if(k.length===0&&_.length===0&&p.length===0)break;try{await Ds({tallies:k,sessions:_,bagups:p}),await Promise.all([ps(k),bs(_),Es(p)]),m+=k.length+_.length+p.length}catch(y){const g=y instanceof Error?y.message:"Sync failed";c.add(g),await Promise.all([ms(k,g),ws(_,g),Cs(p,g)]),z+=k.length+_.length+p.length}if(k.length<qi&&_.length<qi&&p.length<qi)break}return{synced:m,failed:z,skipped:!1,errors:Array.from(c)}},Fs=async()=>{if(navigator.onLine)try{const m=await Rs();await as(m.projects),await cs(m.supervisors)}catch(m){console.error("Failed to sync projects",m)}},zo=[],Ze=(m,z)=>{const c={timestamp:new Date().toISOString(),action:m,details:z};zo.push(c),console.log("[UserAction]",c)},js=()=>{const m=zo.map(_=>`[${_.timestamp}] ${_.action}${_.details?" "+JSON.stringify(_.details):""}`).join(`
`),z=new Blob([m],{type:"text/plain"}),c=URL.createObjectURL(z),k=document.createElement("a");k.href=c,k.download=`user_logs_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(c)};var $r={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(m,z){(function(c,k){k(z)})(Ti,function(c){var k="1.9.4";function _(t){var e,i,o,u;for(i=1,o=arguments.length;i<o;i++){u=arguments[i];for(e in u)t[e]=u[e]}return t}var p=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function y(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var o=i.call(arguments,2);return function(){return t.apply(e,o.length?o.concat(i.call(arguments)):arguments)}}var g=0;function w(t){return"_leaflet_id"in t||(t._leaflet_id=++g),t._leaflet_id}function M(t,e,i){var o,u,v,Z;return Z=function(){o=!1,u&&(v.apply(i,u),u=!1)},v=function(){o?u=arguments:(t.apply(i,arguments),setTimeout(Z,e),o=!0)},v}function R(t,e,i){var o=e[1],u=e[0],v=o-u;return t===o&&i?t:((t-u)%v+v)%v+u}function T(){return!1}function D(t,e){if(e===!1)return t;var i=Math.pow(10,e===void 0?6:e);return Math.round(t*i)/i}function x(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function O(t){return x(t).split(/\s+/)}function b(t,e){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?p(t.options):{});for(var i in e)t.options[i]=e[i];return t.options}function C(t,e,i){var o=[];for(var u in t)o.push(encodeURIComponent(i?u.toUpperCase():u)+"="+encodeURIComponent(t[u]));return(!e||e.indexOf("?")===-1?"?":"&")+o.join("&")}var P=/\{ *([\w_ -]+) *\}/g;function I(t,e){return t.replace(P,function(i,o){var u=e[o];if(u===void 0)throw new Error("No value provided for variable "+i);return typeof u=="function"&&(u=u(e)),u})}var j=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function X(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var Y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function ct(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var ot=0;function wt(t){var e=+new Date,i=Math.max(0,16-(e-ot));return ot=e+i,window.setTimeout(t,i)}var at=window.requestAnimationFrame||ct("RequestAnimationFrame")||wt,Tt=window.cancelAnimationFrame||ct("CancelAnimationFrame")||ct("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function Rt(t,e,i){if(i&&at===wt)t.call(e);else return at.call(window,y(t,e))}function N(t){t&&Tt.call(window,t)}var lt={__proto__:null,extend:_,create:p,bind:y,get lastId(){return g},stamp:w,throttle:M,wrapNum:R,falseFn:T,formatNum:D,trim:x,splitWords:O,setOptions:b,getParamString:C,template:I,isArray:j,indexOf:X,emptyImageUrl:Y,requestFn:at,cancelFn:Tt,requestAnimFrame:Rt,cancelAnimFrame:N};function d(){}d.extend=function(t){var e=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,o=p(i);o.constructor=e,e.prototype=o;for(var u in this)Object.prototype.hasOwnProperty.call(this,u)&&u!=="prototype"&&u!=="__super__"&&(e[u]=this[u]);return t.statics&&_(e,t.statics),t.includes&&(ht(t.includes),_.apply(null,[o].concat(t.includes))),_(o,t),delete o.statics,delete o.includes,o.options&&(o.options=i.options?p(i.options):{},_(o.options,t.options)),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var v=0,Z=o._initHooks.length;v<Z;v++)o._initHooks[v].call(this)}},e},d.include=function(t){var e=this.prototype.options;return _(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},d.mergeOptions=function(t){return _(this.prototype.options,t),this},d.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i=typeof t=="function"?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};function ht(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=j(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var zt={on:function(t,e,i){if(typeof t=="object")for(var o in t)this._on(o,t[o],e);else{t=O(t);for(var u=0,v=t.length;u<v;u++)this._on(t[u],e,i)}return this},off:function(t,e,i){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var o in t)this._off(o,t[o],e);else{t=O(t);for(var u=arguments.length===1,v=0,Z=t.length;v<Z;v++)u?this._off(t[v]):this._off(t[v],e,i)}return this},_on:function(t,e,i,o){if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}if(this._listens(t,e,i)===!1){i===this&&(i=void 0);var u={fn:e,ctx:i};o&&(u.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(u)}},_off:function(t,e,i){var o,u,v;if(this._events&&(o=this._events[t],!!o)){if(arguments.length===1){if(this._firingCount)for(u=0,v=o.length;u<v;u++)o[u].fn=T;delete this._events[t];return}if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}var Z=this._listens(t,e,i);if(Z!==!1){var nt=o[Z];this._firingCount&&(nt.fn=T,this._events[t]=o=o.slice()),o.splice(Z,1)}}},fire:function(t,e,i){if(!this.listens(t,i))return this;var o=_({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var u=this._events[t];if(u){this._firingCount=this._firingCount+1||1;for(var v=0,Z=u.length;v<Z;v++){var nt=u[v],ut=nt.fn;nt.once&&this.off(t,ut,nt.ctx),ut.call(nt.ctx||this,o)}this._firingCount--}}return i&&this._propagateEvent(o),this},listens:function(t,e,i,o){typeof t!="string"&&console.warn('"string" type argument expected');var u=e;typeof e!="function"&&(o=!!e,u=void 0,i=void 0);var v=this._events&&this._events[t];if(v&&v.length&&this._listens(t,u,i)!==!1)return!0;if(o){for(var Z in this._eventParents)if(this._eventParents[Z].listens(t,e,i,o))return!0}return!1},_listens:function(t,e,i){if(!this._events)return!1;var o=this._events[t]||[];if(!e)return!!o.length;i===this&&(i=void 0);for(var u=0,v=o.length;u<v;u++)if(o[u].fn===e&&o[u].ctx===i)return u;return!1},once:function(t,e,i){if(typeof t=="object")for(var o in t)this._on(o,t[o],e,!0);else{t=O(t);for(var u=0,v=t.length;u<v;u++)this._on(t[u],e,i,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[w(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[w(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,_({layer:t.target,propagatedFrom:t.target},t),!0)}};zt.addEventListener=zt.on,zt.removeEventListener=zt.clearAllEventListeners=zt.off,zt.addOneTimeEventListener=zt.once,zt.fireEvent=zt.fire,zt.hasEventListeners=zt.listens;var mt=d.extend(zt);function Lt(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var _t=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};Lt.prototype={clone:function(){return new Lt(this.x,this.y)},add:function(t){return this.clone()._add(bt(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(bt(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new Lt(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new Lt(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=_t(this.x),this.y=_t(this.y),this},distanceTo:function(t){t=bt(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=bt(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=bt(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+D(this.x)+", "+D(this.y)+")"}};function bt(t,e,i){return t instanceof Lt?t:j(t)?new Lt(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new Lt(t.x,t.y):new Lt(t,e,i)}function $(t,e){if(t)for(var i=e?[t,e]:t,o=0,u=i.length;o<u;o++)this.extend(i[o])}$.prototype={extend:function(t){var e,i;if(!t)return this;if(t instanceof Lt||typeof t[0]=="number"||"x"in t)e=i=bt(t);else if(t=tt(t),e=t.min,i=t.max,!e||!i)return this;return!this.min&&!this.max?(this.min=e.clone(),this.max=i.clone()):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(i.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(i.y,this.max.y)),this},getCenter:function(t){return bt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return bt(this.min.x,this.max.y)},getTopRight:function(){return bt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return typeof t[0]=="number"||t instanceof Lt?t=bt(t):t=tt(t),t instanceof $?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=tt(t);var e=this.min,i=this.max,o=t.min,u=t.max,v=u.x>=e.x&&o.x<=i.x,Z=u.y>=e.y&&o.y<=i.y;return v&&Z},overlaps:function(t){t=tt(t);var e=this.min,i=this.max,o=t.min,u=t.max,v=u.x>e.x&&o.x<i.x,Z=u.y>e.y&&o.y<i.y;return v&&Z},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var e=this.min,i=this.max,o=Math.abs(e.x-i.x)*t,u=Math.abs(e.y-i.y)*t;return tt(bt(e.x-o,e.y-u),bt(i.x+o,i.y+u))},equals:function(t){return t?(t=tt(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function tt(t,e){return!t||t instanceof $?t:new $(t,e)}function Zt(t,e){if(t)for(var i=e?[t,e]:t,o=0,u=i.length;o<u;o++)this.extend(i[o])}Zt.prototype={extend:function(t){var e=this._southWest,i=this._northEast,o,u;if(t instanceof dt)o=t,u=t;else if(t instanceof Zt){if(o=t._southWest,u=t._northEast,!o||!u)return this}else return t?this.extend(jt(t)||vt(t)):this;return!e&&!i?(this._southWest=new dt(o.lat,o.lng),this._northEast=new dt(u.lat,u.lng)):(e.lat=Math.min(o.lat,e.lat),e.lng=Math.min(o.lng,e.lng),i.lat=Math.max(u.lat,i.lat),i.lng=Math.max(u.lng,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,o=Math.abs(e.lat-i.lat)*t,u=Math.abs(e.lng-i.lng)*t;return new Zt(new dt(e.lat-o,e.lng-u),new dt(i.lat+o,i.lng+u))},getCenter:function(){return new dt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new dt(this.getNorth(),this.getWest())},getSouthEast:function(){return new dt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof dt||"lat"in t?t=jt(t):t=vt(t);var e=this._southWest,i=this._northEast,o,u;return t instanceof Zt?(o=t.getSouthWest(),u=t.getNorthEast()):o=u=t,o.lat>=e.lat&&u.lat<=i.lat&&o.lng>=e.lng&&u.lng<=i.lng},intersects:function(t){t=vt(t);var e=this._southWest,i=this._northEast,o=t.getSouthWest(),u=t.getNorthEast(),v=u.lat>=e.lat&&o.lat<=i.lat,Z=u.lng>=e.lng&&o.lng<=i.lng;return v&&Z},overlaps:function(t){t=vt(t);var e=this._southWest,i=this._northEast,o=t.getSouthWest(),u=t.getNorthEast(),v=u.lat>e.lat&&o.lat<i.lat,Z=u.lng>e.lng&&o.lng<i.lng;return v&&Z},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return t?(t=vt(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function vt(t,e){return t instanceof Zt?t:new Zt(t,e)}function dt(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,i!==void 0&&(this.alt=+i)}dt.prototype={equals:function(t,e){if(!t)return!1;t=jt(t);var i=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return i<=(e===void 0?1e-9:e)},toString:function(t){return"LatLng("+D(this.lat,t)+", "+D(this.lng,t)+")"},distanceTo:function(t){return Nt.distance(this,jt(t))},wrap:function(){return Nt.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return vt([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new dt(this.lat,this.lng,this.alt)}};function jt(t,e,i){return t instanceof dt?t:j(t)&&typeof t[0]!="object"?t.length===3?new dt(t[0],t[1],t[2]):t.length===2?new dt(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new dt(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===void 0?null:new dt(t,e,i)}var le={latLngToPoint:function(t,e){var i=this.projection.project(t),o=this.scale(e);return this.transformation._transform(i,o)},pointToLatLng:function(t,e){var i=this.scale(e),o=this.transformation.untransform(t,i);return this.projection.unproject(o)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),o=this.transformation.transform(e.min,i),u=this.transformation.transform(e.max,i);return new $(o,u)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?R(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?R(t.lat,this.wrapLat,!0):t.lat,o=t.alt;return new dt(i,e,o)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),o=e.lat-i.lat,u=e.lng-i.lng;if(o===0&&u===0)return t;var v=t.getSouthWest(),Z=t.getNorthEast(),nt=new dt(v.lat-o,v.lng-u),ut=new dt(Z.lat-o,Z.lng-u);return new Zt(nt,ut)}},Nt=_({},le,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,o=t.lat*i,u=e.lat*i,v=Math.sin((e.lat-t.lat)*i/2),Z=Math.sin((e.lng-t.lng)*i/2),nt=v*v+Math.cos(o)*Math.cos(u)*Z*Z,ut=2*Math.atan2(Math.sqrt(nt),Math.sqrt(1-nt));return this.R*ut}}),Pt=6378137,oe={R:Pt,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,o=Math.max(Math.min(i,t.lat),-i),u=Math.sin(o*e);return new Lt(this.R*t.lng*e,this.R*Math.log((1+u)/(1-u))/2)},unproject:function(t){var e=180/Math.PI;return new dt((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=Pt*Math.PI;return new $([-t,-t],[t,t])}()};function Qt(t,e,i,o){if(j(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=e,this._c=i,this._d=o}Qt.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new Lt((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};function Vt(t,e,i,o){return new Qt(t,e,i,o)}var he=_({},Nt,{code:"EPSG:3857",projection:oe,transformation:function(){var t=.5/(Math.PI*oe.R);return Vt(t,.5,-t,.5)}()}),h=_({},he,{code:"EPSG:900913"});function pt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function st(t,e){var i="",o,u,v,Z,nt,ut;for(o=0,v=t.length;o<v;o++){for(nt=t[o],u=0,Z=nt.length;u<Z;u++)ut=nt[u],i+=(u?"L":"M")+ut.x+" "+ut.y;i+=e?Yt.svg?"z":"x":""}return i||"M0 0"}var A=document.documentElement.style,E="ActiveXObject"in window,J=E&&!document.addEventListener,xt="msLaunchUri"in navigator&&!("documentMode"in document),yt=sn("webkit"),it=sn("android"),Ct=sn("android 2")||sn("android 3"),Kt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ot=it&&sn("Google")&&Kt<537&&!("AudioNode"in window),Gt=!!window.opera,ce=!xt&&sn("chrome"),ie=sn("gecko")&&!yt&&!Gt&&!E,Se=!ce&&sn("safari"),rn=sn("phantom"),Oe="OTransition"in A,Ke=navigator.platform.indexOf("Win")===0,me=E&&"transition"in A,on="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ct,Ue="MozPerspective"in A,Ut=!window.L_DISABLE_3D&&(me||on||Ue)&&!Oe&&!rn,qe=typeof orientation<"u"||sn("mobile"),mn=qe&&yt,Gn=qe&&on,Ft=!window.PointerEvent&&window.MSPointerEvent,Zn=!!(window.PointerEvent||Ft),_n="ontouchstart"in window||!!window.TouchEvent,Ln=!window.L_NO_TOUCH&&(_n||Zn),pr=qe&&Gt,Yi=qe&&ie,jr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Kr=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",T,e),window.removeEventListener("testPassiveEventSupport",T,e)}catch{}return t}(),Vn=function(){return!!document.createElement("canvas").getContext}(),En=!!(document.createElementNS&&pt("svg").createSVGRect),Xi=!!En&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Li=!En&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&typeof e.adj=="object"}catch{return!1}}(),ge=navigator.platform.indexOf("Mac")===0,Te=navigator.platform.indexOf("Linux")===0;function sn(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Yt={ie:E,ielt9:J,edge:xt,webkit:yt,android:it,android23:Ct,androidStock:Ot,opera:Gt,chrome:ce,gecko:ie,safari:Se,phantom:rn,opera12:Oe,win:Ke,ie3d:me,webkit3d:on,gecko3d:Ue,any3d:Ut,mobile:qe,mobileWebkit:mn,mobileWebkit3d:Gn,msPointer:Ft,pointer:Zn,touch:Ln,touchNative:_n,mobileOpera:pr,mobileGecko:Yi,retina:jr,passiveEvents:Kr,canvas:Vn,svg:En,vml:Li,inlineSvg:Xi,mac:ge,linux:Te},ui=Yt.msPointer?"MSPointerDown":"pointerdown",ci=Yt.msPointer?"MSPointerMove":"pointermove",mr=Yt.msPointer?"MSPointerUp":"pointerup",gn=Yt.msPointer?"MSPointerCancel":"pointercancel",Cn={touchstart:ui,touchmove:ci,touchend:mr,touchcancel:gn},vn={touchstart:bn,touchmove:an,touchend:an,touchcancel:an},yn={},_r=!1;function On(t,e,i){return e==="touchstart"&&we(),vn[e]?(i=vn[e].bind(this,i),t.addEventListener(Cn[e],i,!1),i):(console.warn("wrong event specified:",e),T)}function gr(t,e,i){if(!Cn[e]){console.warn("wrong event specified:",e);return}t.removeEventListener(Cn[e],i,!1)}function Fn(t){yn[t.pointerId]=t}function vr(t){yn[t.pointerId]&&(yn[t.pointerId]=t)}function Ei(t){delete yn[t.pointerId]}function we(){_r||(document.addEventListener(ui,Fn,!0),document.addEventListener(ci,vr,!0),document.addEventListener(mr,Ei,!0),document.addEventListener(gn,Ei,!0),_r=!0)}function an(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){e.touches=[];for(var i in yn)e.touches.push(yn[i]);e.changedTouches=[e],t(e)}}function bn(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&ke(e),an(t,e)}function yr(t){var e={},i,o;for(o in t)i=t[o],e[o]=i&&i.bind?i.bind(t):i;return t=e,e.type="dblclick",e.detail=2,e.isTrusted=!1,e._simulated=!0,e}var Yn=200;function Ci(t,e){t.addEventListener("dblclick",e);var i=0,o;function u(v){if(v.detail!==1){o=v.detail;return}if(!(v.pointerType==="mouse"||v.sourceCapabilities&&!v.sourceCapabilities.firesTouchEvents)){var Z=Ii(v);if(!(Z.some(function(ut){return ut instanceof HTMLLabelElement&&ut.attributes.for})&&!Z.some(function(ut){return ut instanceof HTMLInputElement||ut instanceof HTMLSelectElement}))){var nt=Date.now();nt-i<=Yn?(o++,o===2&&e(yr(v))):o=1,i=nt}}}return t.addEventListener("click",u),{dblclick:e,simDblclick:u}}function Ji(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}var li=Qn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qe=Qn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Qi=Qe==="webkitTransition"||Qe==="OTransition"?Qe+"End":"transitionend";function hi(t){return typeof t=="string"?document.getElementById(t):t}function Xn(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||i==="auto")&&document.defaultView){var o=document.defaultView.getComputedStyle(t,null);i=o?o[e]:null}return i==="auto"?null:i}function Ht(t,e,i){var o=document.createElement(t);return o.className=e||"",i&&i.appendChild(o),o}function ve(t){var e=t.parentNode;e&&e.removeChild(t)}function fi(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function wn(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function un(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function Oi(t,e){if(t.classList!==void 0)return t.classList.contains(e);var i=An(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function ne(t,e){if(t.classList!==void 0)for(var i=O(e),o=0,u=i.length;o<u;o++)t.classList.add(i[o]);else if(!Oi(t,e)){var v=An(t);de(t,(v?v+" ":"")+e)}}function be(t,e){t.classList!==void 0?t.classList.remove(e):de(t,x((" "+An(t)+" ").replace(" "+e+" "," ")))}function de(t,e){t.className.baseVal===void 0?t.className=e:t.className.baseVal=e}function An(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function Ae(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&Jn(t,e)}function Jn(t,e){var i=!1,o="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(o)}catch{if(e===1)return}e=Math.round(e*100),i?(i.Enabled=e!==100,i.Opacity=e):t.style.filter+=" progid:"+o+"(opacity="+e+")"}function Qn(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function xn(t,e,i){var o=e||new Lt(0,0);t.style[li]=(Yt.ie3d?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(i?" scale("+i+")":"")}function ye(t,e){t._leaflet_pos=e,Yt.any3d?xn(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function zn(t){return t._leaflet_pos||new Lt(0,0)}var Bn,$n,$i;if("onselectstart"in document)Bn=function(){Xt(window,"selectstart",ke)},$n=function(){fe(window,"selectstart",ke)};else{var ae=Qn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Bn=function(){if(ae){var t=document.documentElement.style;$i=t[ae],t[ae]="none"}},$n=function(){ae&&(document.documentElement.style[ae]=$i,$i=void 0)}}function Ai(){Xt(window,"dragstart",ke)}function tr(){fe(window,"dragstart",ke)}var zi,De;function In(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(jn(),zi=t,De=t.style.outlineStyle,t.style.outlineStyle="none",Xt(window,"keydown",jn))}function jn(){zi&&(zi.style.outlineStyle=De,zi=void 0,De=void 0,fe(window,"keydown",jn))}function kn(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function Bi(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var br={__proto__:null,TRANSFORM:li,TRANSITION:Qe,TRANSITION_END:Qi,get:hi,getStyle:Xn,create:Ht,remove:ve,empty:fi,toFront:wn,toBack:un,hasClass:Oi,addClass:ne,removeClass:be,setClass:de,getClass:An,setOpacity:Ae,testProp:Qn,setTransform:xn,setPosition:ye,getPosition:zn,get disableTextSelection(){return Bn},get enableTextSelection(){return $n},disableImageDrag:Ai,enableImageDrag:tr,preventOutline:In,restoreOutline:jn,getSizedParentNode:kn,getScale:Bi};function Xt(t,e,i,o){if(e&&typeof e=="object")for(var u in e)cn(t,u,e[u],i);else{e=O(e);for(var v=0,Z=e.length;v<Z;v++)cn(t,e[v],i,o)}return this}var xe="_leaflet_events";function fe(t,e,i,o){if(arguments.length===1)ti(t),delete t[xe];else if(e&&typeof e=="object")for(var u in e)er(t,u,e[u],i);else if(e=O(e),arguments.length===2)ti(t,function(nt){return X(e,nt)!==-1});else for(var v=0,Z=e.length;v<Z;v++)er(t,e[v],i,o);return this}function ti(t,e){for(var i in t[xe]){var o=i.split(/\d/)[0];(!e||e(o))&&er(t,o,null,null,i)}}var di={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function cn(t,e,i,o){var u=e+w(i)+(o?"_"+w(o):"");if(t[xe]&&t[xe][u])return this;var v=function(nt){return i.call(o||t,nt||window.event)},Z=v;!Yt.touchNative&&Yt.pointer&&e.indexOf("touch")===0?v=On(t,e,v):Yt.touch&&e==="dblclick"?v=Ci(t,v):"addEventListener"in t?e==="touchstart"||e==="touchmove"||e==="wheel"||e==="mousewheel"?t.addEventListener(di[e]||e,v,Yt.passiveEvents?{passive:!1}:!1):e==="mouseenter"||e==="mouseleave"?(v=function(nt){nt=nt||window.event,ir(t,nt)&&Z(nt)},t.addEventListener(di[e],v,!1)):t.addEventListener(e,Z,!1):t.attachEvent("on"+e,v),t[xe]=t[xe]||{},t[xe][u]=v}function er(t,e,i,o,u){u=u||e+w(i)+(o?"_"+w(o):"");var v=t[xe]&&t[xe][u];if(!v)return this;!Yt.touchNative&&Yt.pointer&&e.indexOf("touch")===0?gr(t,e,v):Yt.touch&&e==="dblclick"?Ji(t,v):"removeEventListener"in t?t.removeEventListener(di[e]||e,v,!1):t.detachEvent("on"+e,v),t[xe][u]=null}function ze(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function pi(t){return cn(t,"wheel",ze),this}function ei(t){return Xt(t,"mousedown touchstart dblclick contextmenu",ze),t._leaflet_disable_click=!0,this}function ke(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function $e(t){return ke(t),ze(t),this}function Ii(t){if(t.composedPath)return t.composedPath();for(var e=[],i=t.target;i;)e.push(i),i=i.parentNode;return e}function nr(t,e){if(!e)return new Lt(t.clientX,t.clientY);var i=Bi(e),o=i.boundingClientRect;return new Lt((t.clientX-o.left)/i.x-e.clientLeft,(t.clientY-o.top)/i.y-e.clientTop)}var Ur=Yt.linux&&Yt.chrome?window.devicePixelRatio:Yt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ni(t){return Yt.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/Ur:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function ir(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch{return!1}return i!==t}var Wr={__proto__:null,on:Xt,off:fe,stopPropagation:ze,disableScrollPropagation:pi,disableClickPropagation:ei,preventDefault:ke,stop:$e,getPropagationPath:Ii,getMousePosition:nr,getWheelDelta:ni,isExternalTarget:ir,addListener:Xt,removeListener:fe},mi=mt.extend({run:function(t,e,i,o){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(o||.5,.2),this._startPos=zn(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Rt(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=this._duration*1e3;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),ye(this._el,i),this.fire("step")},_complete:function(){N(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),se=mt.extend({options:{crs:he,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=b(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=y(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==void 0&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==void 0&&this.setView(jt(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qe&&Yt.any3d&&!Yt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Xt(this._proxy,Qi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){if(e=e===void 0?this._zoom:this._limitZoom(e),t=this._limitCenter(jt(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==void 0&&(i.zoom=_({animate:i.animate},i.zoom),i.pan=_({animate:i.animate,duration:i.duration},i.pan));var o=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(o)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e,i.pan&&i.pan.noMoveStart),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Yt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Yt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var o=this.getZoomScale(e),u=this.getSize().divideBy(2),v=t instanceof Lt?t:this.latLngToContainerPoint(t),Z=v.subtract(u).multiplyBy(1-1/o),nt=this.containerPointToLatLng(u.add(Z));return this.setView(nt,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():vt(t);var i=bt(e.paddingTopLeft||e.padding||[0,0]),o=bt(e.paddingBottomRight||e.padding||[0,0]),u=this.getBoundsZoom(t,!1,i.add(o));if(u=typeof e.maxZoom=="number"?Math.min(e.maxZoom,u):u,u===1/0)return{center:t.getCenter(),zoom:u};var v=o.subtract(i).divideBy(2),Z=this.project(t.getSouthWest(),u),nt=this.project(t.getNorthEast(),u),ut=this.unproject(Z.add(nt).divideBy(2).add(v),u);return{center:ut,zoom:u}},fitBounds:function(t,e){if(t=vt(t),!t.isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=bt(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new mi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){ne(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(i=i||{},i.animate===!1||!Yt.any3d)return this.setView(t,e,i);this._stop();var o=this.project(this.getCenter()),u=this.project(t),v=this.getSize(),Z=this._zoom;t=jt(t),e=e===void 0?Z:e;var nt=Math.max(v.x,v.y),ut=nt*this.getZoomScale(Z,e),St=u.distanceTo(o)||1,qt=1.42,te=qt*qt;function ue(Le){var Ar=Le?-1:1,Ho=Le?ut:nt,Go=ut*ut-nt*nt+Ar*te*te*St*St,Vo=2*Ho*te*St,Yr=Go/Vo,bo=Math.sqrt(Yr*Yr+1)-Yr,Yo=bo<1e-9?-18:Math.log(bo);return Yo}function We(Le){return(Math.exp(Le)-Math.exp(-Le))/2}function Ne(Le){return(Math.exp(Le)+Math.exp(-Le))/2}function dn(Le){return We(Le)/Ne(Le)}var Ye=ue(0);function Ki(Le){return nt*(Ne(Ye)/Ne(Ye+qt*Le))}function Ko(Le){return nt*(Ne(Ye)*dn(Ye+qt*Le)-We(Ye))/te}function Uo(Le){return 1-Math.pow(1-Le,1.5)}var Wo=Date.now(),vo=(ue(1)-Ye)/qt,qo=i.duration?1e3*i.duration:1e3*vo*.8;function yo(){var Le=(Date.now()-Wo)/qo,Ar=Uo(Le)*vo;Le<=1?(this._flyToFrame=Rt(yo,this),this._move(this.unproject(o.add(u.subtract(o).multiplyBy(Ko(Ar)/St)),Z),this.getScaleZoom(nt/Ki(Ar),Z),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,i.noMoveStart),yo.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return t=vt(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),o=this._limitCenter(i,this._zoom,vt(t));return i.equals(o)||this.panTo(o,e),this._enforcingBounds=!1,this},panInside:function(t,e){e=e||{};var i=bt(e.paddingTopLeft||e.padding||[0,0]),o=bt(e.paddingBottomRight||e.padding||[0,0]),u=this.project(this.getCenter()),v=this.project(t),Z=this.getPixelBounds(),nt=tt([Z.min.add(i),Z.max.subtract(o)]),ut=nt.getSize();if(!nt.contains(v)){this._enforcingBounds=!0;var St=v.subtract(nt.getCenter()),qt=nt.extend(v).getSize().subtract(ut);u.x+=St.x<0?-qt.x:qt.x,u.y+=St.y<0?-qt.y:qt.y,this.panTo(this.unproject(u),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=_({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),o=e.divideBy(2).round(),u=i.divideBy(2).round(),v=o.subtract(u);return!v.x&&!v.y?this:(t.animate&&t.pan?this.panBy(v):(t.pan&&this._rawPanBy(v),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(y(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=_({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=y(this._handleGeolocationResponse,this),i=y(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,i=t.message||(e===1?"permission denied":e===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=t.coords.latitude,i=t.coords.longitude,o=new dt(e,i),u=o.toBounds(t.coords.accuracy*2),v=this._locateOptions;if(v.setView){var Z=this.getBoundsZoom(u);this.setView(o,v.maxZoom?Math.min(Z,v.maxZoom):Z)}var nt={latlng:o,bounds:u,timestamp:t.timestamp};for(var ut in t.coords)typeof t.coords[ut]=="number"&&(nt[ut]=t.coords[ut]);this.fire("locationfound",nt)}},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ve(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(N(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ve(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),o=Ht("div",i,e||this._mapPane);return t&&(this._panes[t]=o),o},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new Zt(e,i)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=vt(t),i=bt(i||[0,0]);var o=this.getZoom()||0,u=this.getMinZoom(),v=this.getMaxZoom(),Z=t.getNorthWest(),nt=t.getSouthEast(),ut=this.getSize().subtract(i),St=tt(this.project(nt,o),this.project(Z,o)).getSize(),qt=Yt.any3d?this.options.zoomSnap:1,te=ut.x/St.x,ue=ut.y/St.y,We=e?Math.max(te,ue):Math.min(te,ue);return o=this.getScaleZoom(We,o),qt&&(o=Math.round(o/(qt/100))*(qt/100),o=e?Math.ceil(o/qt)*qt:Math.floor(o/qt)*qt),Math.max(u,Math.min(v,o))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Lt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new $(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=e===void 0?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=e===void 0?this._zoom:e;var o=i.zoom(t*i.scale(e));return isNaN(o)?1/0:o},project:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.latLngToPoint(jt(t),e)},unproject:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.pointToLatLng(bt(t),e)},layerPointToLatLng:function(t){var e=bt(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(jt(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(jt(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(vt(t))},distance:function(t,e){return this.options.crs.distance(jt(t),jt(e))},containerPointToLayerPoint:function(t){return bt(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return bt(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(bt(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(jt(t)))},mouseEventToContainerPoint:function(t){return nr(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=hi(t);if(e){if(e._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Xt(e,"scroll",this._onScroll,this),this._containerId=w(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Yt.any3d,ne(t,"leaflet-container"+(Yt.touch?" leaflet-touch":"")+(Yt.retina?" leaflet-retina":"")+(Yt.ielt9?" leaflet-oldie":"")+(Yt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=Xn(t,"position");e!=="absolute"&&e!=="relative"&&e!=="fixed"&&e!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ye(this._mapPane,new Lt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ne(t.markerPane,"leaflet-zoom-hide"),ne(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,i){ye(this._mapPane,new Lt(0,0));var o=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var u=this._zoom!==e;this._moveStart(u,i)._move(t,e)._moveEnd(u),this.fire("viewreset"),o&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i,o){e===void 0&&(e=this._zoom);var u=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),o?i&&i.pinch&&this.fire("zoom",i):((u||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return N(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ye(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[w(this._container)]=this;var e=t?fe:Xt;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Yt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){N(this._resizeRequest),this._resizeRequest=Rt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i=[],o,u=e==="mouseout"||e==="mouseover",v=t.target||t.srcElement,Z=!1;v;){if(o=this._targets[w(v)],o&&(e==="click"||e==="preclick")&&this._draggableMoved(o)){Z=!0;break}if(o&&o.listens(e,!0)&&(u&&!ir(v,t)||(i.push(o),u))||v===this._container)break;v=v.parentNode}return!i.length&&!Z&&!u&&this.listens(e,!0)&&(i=[this]),i},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(e))){var i=t.type;i==="mousedown"&&In(e),this._fireDOMEvent(t,i)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,i){if(t.type==="click"){var o=_({},t);o.type="preclick",this._fireDOMEvent(o,o.type,i)}var u=this._findEventTargets(t,e);if(i){for(var v=[],Z=0;Z<i.length;Z++)i[Z].listens(e,!0)&&v.push(i[Z]);u=v.concat(u)}if(u.length){e==="contextmenu"&&ke(t);var nt=u[0],ut={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var St=nt.getLatLng&&(!nt._radius||nt._radius<=10);ut.containerPoint=St?this.latLngToContainerPoint(nt.getLatLng()):this.mouseEventToContainerPoint(t),ut.layerPoint=this.containerPointToLayerPoint(ut.containerPoint),ut.latlng=St?nt.getLatLng():this.layerPointToLatLng(ut.layerPoint)}for(Z=0;Z<u.length;Z++)if(u[Z].fire(e,ut,!0),ut.originalEvent._stopped||u[Z].options.bubblingMouseEvents===!1&&X(this._mouseEvents,e)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return zn(this._mapPane)||new Lt(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var i=t&&e!==void 0?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return i.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var o=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(o)},_latLngBoundsToNewLayerBounds:function(t,e,i){var o=this._getNewPixelOrigin(i,e);return tt([this.project(t.getSouthWest(),e)._subtract(o),this.project(t.getNorthWest(),e)._subtract(o),this.project(t.getSouthEast(),e)._subtract(o),this.project(t.getNorthEast(),e)._subtract(o)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var o=this.project(t,e),u=this.getSize().divideBy(2),v=new $(o.subtract(u),o.add(u)),Z=this._getBoundsOffset(v,i,e);return Math.abs(Z.x)<=1&&Math.abs(Z.y)<=1?t:this.unproject(o.add(Z),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),o=new $(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(o,e))},_getBoundsOffset:function(t,e,i){var o=tt(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),u=o.min.subtract(t.min),v=o.max.subtract(t.max),Z=this._rebound(u.x,-v.x),nt=this._rebound(u.y,-v.y);return new Lt(Z,nt)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),o=Yt.any3d?this.options.zoomSnap:1;return o&&(t=Math.round(t/o)*o),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){be(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return(e&&e.animate)!==!0&&!this.getSize().contains(i)?!1:(this.panBy(i,e),!0)},_createAnimProxy:function(){var t=this._proxy=Ht("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var i=li,o=this._proxy.style[i];xn(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),o===this._proxy.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ve(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();xn(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var o=this.getZoomScale(e),u=this._getCenterOffset(t)._divideBy(1-1/o);return i.animate!==!0&&!this.getSize().contains(u)?!1:(Rt(function(){this._moveStart(!0,i.noMoveStart||!1)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,i,o){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,ne(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:o}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(y(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&be(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function rr(t,e){return new se(t,e)}var tn=d.extend({options:{position:"topright"},initialize:function(t){b(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),o=t._controlCorners[i];return ne(e,"leaflet-control"),i.indexOf("bottom")!==-1?o.insertBefore(e,o.firstChild):o.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ve(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),_i=function(t){return new tn(t)};se.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=Ht("div",e+"control-container",this._container);function o(u,v){var Z=e+u+" "+e+v;t[u+v]=Ht("div",Z,i)}o("top","left"),o("top","right"),o("bottom","left"),o("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ve(this._controlCorners[t]);ve(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var wr=tn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,o){return i<o?-1:o<i?1:0}},initialize:function(t,e,i){b(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var o in t)this._addLayer(t[o],o);for(o in e)this._addLayer(e[o],o,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return tn.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(w(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){ne(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ne(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):be(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return be(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=Ht("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),ei(e),pi(e);var o=this._section=Ht("section",t+"-list");i&&(this._map.on("click",this.collapse,this),Xt(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var u=this._layersLink=Ht("a",t+"-toggle",e);u.href="#",u.title="Layers",u.setAttribute("role","button"),Xt(u,{keydown:function(v){v.keyCode===13&&this._expandSafely()},click:function(v){ke(v),this._expandSafely()}},this),i||this.expand(),this._baseLayersList=Ht("div",t+"-base",o),this._separator=Ht("div",t+"-separator",o),this._overlaysList=Ht("div",t+"-overlays",o),e.appendChild(o)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&w(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(y(function(o,u){return this.options.sortFunction(o.layer,u.layer,o.name,u.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;fi(this._baseLayersList),fi(this._overlaysList),this._layerControlInputs=[];var t,e,i,o,u=0;for(i=0;i<this._layers.length;i++)o=this._layers[i],this._addItem(o),e=e||o.overlay,t=t||!o.overlay,u+=o.overlay?0:1;return this.options.hideSingleBase&&(t=t&&u>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(w(t.target)),i=e.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",o=document.createElement("div");return o.innerHTML=i,o.firstChild},_addItem:function(t){var e=document.createElement("label"),i=this._map.hasLayer(t.layer),o;t.overlay?(o=document.createElement("input"),o.type="checkbox",o.className="leaflet-control-layers-selector",o.defaultChecked=i):o=this._createRadioElement("leaflet-base-layers_"+w(this),i),this._layerControlInputs.push(o),o.layerId=w(t.layer),Xt(o,"click",this._onInputClick,this);var u=document.createElement("span");u.innerHTML=" "+t.name;var v=document.createElement("span");e.appendChild(v),v.appendChild(o),v.appendChild(u);var Z=t.overlay?this._overlaysList:this._baseLayersList;return Z.appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,e,i,o=[],u=[];this._handlingClick=!0;for(var v=t.length-1;v>=0;v--)e=t[v],i=this._getLayer(e.layerId).layer,e.checked?o.push(i):e.checked||u.push(i);for(v=0;v<u.length;v++)this._map.hasLayer(u[v])&&this._map.removeLayer(u[v]);for(v=0;v<o.length;v++)this._map.hasLayer(o[v])||this._map.addLayer(o[v]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,e,i,o=this._map.getZoom(),u=t.length-1;u>=0;u--)e=t[u],i=this._getLayer(e.layerId).layer,e.disabled=i.options.minZoom!==void 0&&o<i.options.minZoom||i.options.maxZoom!==void 0&&o>i.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Xt(t,"click",ke),this.expand();var e=this;setTimeout(function(){fe(t,"click",ke),e._preventClick=!1})}}),or=function(t,e,i){return new wr(t,e,i)},gi=tn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=Ht("div",e+" leaflet-bar"),o=this.options;return this._zoomInButton=this._createButton(o.zoomInText,o.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(o.zoomOutText,o.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,o,u){var v=Ht("a",i,o);return v.innerHTML=t,v.href="#",v.title=e,v.setAttribute("role","button"),v.setAttribute("aria-label",e),ei(v),Xt(v,"click",$e),Xt(v,"click",u,this),Xt(v,"click",this._refocusOnMap,this),v},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";be(this._zoomInButton,e),be(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(ne(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(ne(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});se.mergeOptions({zoomControl:!0}),se.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new gi,this.addControl(this.zoomControl))});var xr=function(t){return new gi(t)},vi=tn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=Ht("div",e),o=this.options;return this._addScales(o,e+"-line",i),t.on(o.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=Ht("div",e,i)),t.imperial&&(this._iScale=Ht("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e=t*3.2808399,i,o,u;e>5280?(i=e/5280,o=this._getRoundNum(i),this._updateScale(this._iScale,o+" mi",o/i)):(u=this._getRoundNum(e),this._updateScale(this._iScale,u+" ft",u/e))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),Mi=function(t){return new vi(t)},Ni='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Di=tn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Yt.inlineSvg?Ni+" ":"")+"Leaflet</a>"},initialize:function(t){b(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=Ht("div","leaflet-control-attribution"),ei(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(' <span aria-hidden="true">|</span> ')}}});se.mergeOptions({attributionControl:!0}),se.addInitHook(function(){this.options.attributionControl&&new Di().addTo(this)});var qr=function(t){return new Di(t)};tn.Layers=wr,tn.Zoom=gi,tn.Scale=vi,tn.Attribution=Di,_i.layers=or,_i.zoom=xr,_i.scale=Mi,_i.attribution=qr;var Re=d.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Re.addTo=function(t,e){return t.addHandler(e,this),this};var sr={Events:zt},Ri=Yt.touch?"touchstart mousedown":"mousedown",ln=mt.extend({options:{clickTolerance:3},initialize:function(t,e,i,o){b(this,o),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(Xt(this._dragStartTarget,Ri,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ln._dragging===this&&this.finishDrag(!0),fe(this._dragStartTarget,Ri,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!Oi(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){ln._dragging===this&&this.finishDrag();return}if(!(ln._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(ln._dragging=this,this._preventOutline&&In(this._element),Ai(),Bn(),!this._moving)){this.fire("down");var e=t.touches?t.touches[0]:t,i=kn(this._element);this._startPoint=new Lt(e.clientX,e.clientY),this._startPos=zn(this._element),this._parentScale=Bi(i);var o=t.type==="mousedown";Xt(document,o?"mousemove":"touchmove",this._onMove,this),Xt(document,o?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var e=t.touches&&t.touches.length===1?t.touches[0]:t,i=new Lt(e.clientX,e.clientY)._subtract(this._startPoint);!i.x&&!i.y||Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,ke(t),this._moved||(this.fire("dragstart"),this._moved=!0,ne(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ne(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ye(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){be(document.body,"leaflet-dragging"),this._lastTarget&&(be(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),fe(document,"mousemove touchmove",this._onMove,this),fe(document,"mouseup touchend touchcancel",this._onUp,this),tr(),$n();var e=this._moved&&this._moving;this._moving=!1,ln._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Zi(t,e,i){var o,u=[1,4,2,8],v,Z,nt,ut,St,qt,te,ue;for(v=0,qt=t.length;v<qt;v++)t[v]._code=hn(t[v],e);for(nt=0;nt<4;nt++){for(te=u[nt],o=[],v=0,qt=t.length,Z=qt-1;v<qt;Z=v++)ut=t[v],St=t[Z],ut._code&te?St._code&te||(ue=ri(St,ut,te,e,i),ue._code=hn(ue,e),o.push(ue)):(St._code&te&&(ue=ri(St,ut,te,e,i),ue._code=hn(ue,e),o.push(ue)),o.push(ut));t=o}return t}function Ce(t,e){var i,o,u,v,Z,nt,ut,St,qt;if(!t||t.length===0)throw new Error("latlngs not passed");He(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var te=jt([0,0]),ue=vt(t),We=ue.getNorthWest().distanceTo(ue.getSouthWest())*ue.getNorthEast().distanceTo(ue.getNorthWest());We<1700&&(te=Kn(t));var Ne=t.length,dn=[];for(i=0;i<Ne;i++){var Ye=jt(t[i]);dn.push(e.project(jt([Ye.lat-te.lat,Ye.lng-te.lng])))}for(nt=ut=St=0,i=0,o=Ne-1;i<Ne;o=i++)u=dn[i],v=dn[o],Z=u.y*v.x-v.y*u.x,ut+=(u.x+v.x)*Z,St+=(u.y+v.y)*Z,nt+=Z*3;nt===0?qt=dn[0]:qt=[ut/nt,St/nt];var Ki=e.unproject(bt(qt));return jt([Ki.lat+te.lat,Ki.lng+te.lng])}function Kn(t){for(var e=0,i=0,o=0,u=0;u<t.length;u++){var v=jt(t[u]);e+=v.lat,i+=v.lng,o++}return jt([e/o,i/o])}var yi={__proto__:null,clipPolygon:Zi,polygonCenter:Ce,centroid:Kn};function ar(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=ur(t,i),t=Pr(t,i),t}function bi(t,e,i){return Math.sqrt(oi(t,e,i,!0))}function kr(t,e,i){return oi(t,e,i)}function Pr(t,e){var i=t.length,o=typeof Uint8Array<"u"?Uint8Array:Array,u=new o(i);u[0]=u[i-1]=1,ii(t,u,e,0,i-1);var v,Z=[];for(v=0;v<i;v++)u[v]&&Z.push(t[v]);return Z}function ii(t,e,i,o,u){var v=0,Z,nt,ut;for(nt=o+1;nt<=u-1;nt++)ut=oi(t[nt],t[o],t[u],!0),ut>v&&(Z=nt,v=ut);v>i&&(e[Z]=1,ii(t,e,i,o,Z),ii(t,e,i,Z,u))}function ur(t,e){for(var i=[t[0]],o=1,u=0,v=t.length;o<v;o++)cr(t[o],t[u])>e&&(i.push(t[o]),u=o);return u<v-1&&i.push(t[v-1]),i}var Mn;function Fi(t,e,i,o,u){var v=o?Mn:hn(t,i),Z=hn(e,i),nt,ut,St;for(Mn=Z;;){if(!(v|Z))return[t,e];if(v&Z)return!1;nt=v||Z,ut=ri(t,e,nt,i,u),St=hn(ut,i),nt===v?(t=ut,v=St):(e=ut,Z=St)}}function ri(t,e,i,o,u){var v=e.x-t.x,Z=e.y-t.y,nt=o.min,ut=o.max,St,qt;return i&8?(St=t.x+v*(ut.y-t.y)/Z,qt=ut.y):i&4?(St=t.x+v*(nt.y-t.y)/Z,qt=nt.y):i&2?(St=ut.x,qt=t.y+Z*(ut.x-t.x)/v):i&1&&(St=nt.x,qt=t.y+Z*(nt.x-t.x)/v),new Lt(St,qt,u)}function hn(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function cr(t,e){var i=e.x-t.x,o=e.y-t.y;return i*i+o*o}function oi(t,e,i,o){var u=e.x,v=e.y,Z=i.x-u,nt=i.y-v,ut=Z*Z+nt*nt,St;return ut>0&&(St=((t.x-u)*Z+(t.y-v)*nt)/ut,St>1?(u=i.x,v=i.y):St>0&&(u+=Z*St,v+=nt*St)),Z=t.x-u,nt=t.y-v,o?Z*Z+nt*nt:new Lt(u,v)}function He(t){return!j(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function ji(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),He(t)}function wi(t,e){var i,o,u,v,Z,nt,ut,St;if(!t||t.length===0)throw new Error("latlngs not passed");He(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var qt=jt([0,0]),te=vt(t),ue=te.getNorthWest().distanceTo(te.getSouthWest())*te.getNorthEast().distanceTo(te.getNorthWest());ue<1700&&(qt=Kn(t));var We=t.length,Ne=[];for(i=0;i<We;i++){var dn=jt(t[i]);Ne.push(e.project(jt([dn.lat-qt.lat,dn.lng-qt.lng])))}for(i=0,o=0;i<We-1;i++)o+=Ne[i].distanceTo(Ne[i+1])/2;if(o===0)St=Ne[0];else for(i=0,v=0;i<We-1;i++)if(Z=Ne[i],nt=Ne[i+1],u=Z.distanceTo(nt),v+=u,v>o){ut=(v-o)/u,St=[nt.x-ut*(nt.x-Z.x),nt.y-ut*(nt.y-Z.y)];break}var Ye=e.unproject(bt(St));return jt([Ye.lat+qt.lat,Ye.lng+qt.lng])}var Hr={__proto__:null,simplify:ar,pointToSegmentDistance:bi,closestPointOnSegment:kr,clipSegment:Fi,_getEdgeIntersection:ri,_getBitCode:hn,_sqClosestPointOnSegment:oi,isFlat:He,_flat:ji,polylineCenter:wi},xi={project:function(t){return new Lt(t.lng,t.lat)},unproject:function(t){return new dt(t.y,t.x)},bounds:new $([-180,-90],[180,90])},ki={R:6378137,R_MINOR:6356752314245179e-9,bounds:new $([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var e=Math.PI/180,i=this.R,o=t.lat*e,u=this.R_MINOR/i,v=Math.sqrt(1-u*u),Z=v*Math.sin(o),nt=Math.tan(Math.PI/4-o/2)/Math.pow((1-Z)/(1+Z),v/2);return o=-i*Math.log(Math.max(nt,1e-10)),new Lt(t.lng*e*i,o)},unproject:function(t){for(var e=180/Math.PI,i=this.R,o=this.R_MINOR/i,u=Math.sqrt(1-o*o),v=Math.exp(-t.y/i),Z=Math.PI/2-2*Math.atan(v),nt=0,ut=.1,St;nt<15&&Math.abs(ut)>1e-7;nt++)St=u*Math.sin(Z),St=Math.pow((1-St)/(1+St),u/2),ut=Math.PI/2-2*Math.atan(v*St)-Z,Z+=ut;return new dt(Z*e,t.x*e/i)}},Gr={__proto__:null,LonLat:xi,Mercator:ki,SphericalMercator:oe},Sr=_({},Nt,{code:"EPSG:3395",projection:ki,transformation:function(){var t=.5/(Math.PI*ki.R);return Vt(t,.5,-t,.5)}()}),Tr=_({},Nt,{code:"EPSG:4326",projection:xi,transformation:Vt(1/180,1,-1/180,.5)}),Lr=_({},le,{projection:xi,transformation:Vt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,o=e.lat-t.lat;return Math.sqrt(i*i+o*o)},infinite:!0});le.Earth=Nt,le.EPSG3395=Sr,le.EPSG3857=he,le.EPSG900913=h,le.EPSG4326=Tr,le.Simple=Lr;var Ge=mt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[w(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[w(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});se.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=w(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=w(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return w(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){t=t?j(t)?t:[t]:[];for(var e=0,i=t.length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[w(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=w(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var o in this._zoomBoundLayers){var u=this._zoomBoundLayers[o].options;t=u.minZoom===void 0?t:Math.min(t,u.minZoom),e=u.maxZoom===void 0?e:Math.max(e,u.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var si=Ge.extend({initialize:function(t,e){b(this,e),this._layers={};var i,o;if(t)for(i=0,o=t.length;i<o;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){var e=typeof t=="number"?t:this.getLayerId(t);return e in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e=Array.prototype.slice.call(arguments,1),i,o;for(i in this._layers)o=this._layers[i],o[t]&&o[t].apply(o,e);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return w(t)}}),Er=function(t,e){return new si(t,e)},en=si.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),si.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),si.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new Zt;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),Cr=function(t,e){return new en(t,e)},Un=d.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){b(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var o=this._createImg(i,e&&e.tagName==="IMG"?e:null);return this._setIconStyles(o,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),o},_setIconStyles:function(t,e){var i=this.options,o=i[e+"Size"];typeof o=="number"&&(o=[o,o]);var u=bt(o),v=bt(e==="shadow"&&i.shadowAnchor||i.iconAnchor||u&&u.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),v&&(t.style.marginLeft=-v.x+"px",t.style.marginTop=-v.y+"px"),u&&(t.style.width=u.x+"px",t.style.height=u.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return Yt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Vr(t){return new Un(t)}var Pi=Un.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof Pi.imagePath!="string"&&(Pi.imagePath=this._detectIconPath()),(this.options.imagePath||Pi.imagePath)+Un.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(i,o,u){var v=o.exec(i);return v&&v[u]};return t=e(t,/^url\((['"])?(.+)\1\)$/,2),t&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=Ht("div","leaflet-default-icon-path",document.body),e=Xn(t,"background-image")||Xn(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e),e)return e;var i=document.querySelector('link[href$="leaflet.css"]');return i?i.href.substring(0,i.href.length-11-1):""}}),Or=Re.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new ln(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ne(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&be(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,o=this._marker.options.autoPanSpeed,u=this._marker.options.autoPanPadding,v=zn(e._icon),Z=i.getPixelBounds(),nt=i.getPixelOrigin(),ut=tt(Z.min._subtract(nt).add(u),Z.max._subtract(nt).subtract(u));if(!ut.contains(v)){var St=bt((Math.max(ut.max.x,v.x)-ut.max.x)/(Z.max.x-ut.max.x)-(Math.min(ut.min.x,v.x)-ut.min.x)/(Z.min.x-ut.min.x),(Math.max(ut.max.y,v.y)-ut.max.y)/(Z.max.y-ut.max.y)-(Math.min(ut.min.y,v.y)-ut.min.y)/(Z.min.y-ut.min.y)).multiplyBy(o);i.panBy(St,{animate:!1}),this._draggable._newPos._add(St),this._draggable._startPos._add(St),ye(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=Rt(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(N(this._panRequest),this._panRequest=Rt(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,o=zn(e._icon),u=e._map.layerPointToLatLng(o);i&&ye(i,o),e._latlng=u,t.latlng=u,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){N(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Wn=Ge.extend({options:{icon:new Pi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){b(this,e),this._latlng=jt(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=jt(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),o=!1;i!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(i.title=t.title),i.tagName==="IMG"&&(i.alt=t.alt||"")),ne(i,e),t.keyboard&&(i.tabIndex="0",i.setAttribute("role","button")),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Xt(i,"focus",this._panOnFocus,this);var u=t.icon.createShadow(this._shadow),v=!1;u!==this._shadow&&(this._removeShadow(),v=!0),u&&(ne(u,e),u.alt=""),this._shadow=u,t.opacity<1&&this._updateOpacity(),o&&this.getPane().appendChild(this._icon),this._initInteraction(),u&&v&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&fe(this._icon,"focus",this._panOnFocus,this),ve(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ve(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ye(this._icon,t),this._shadow&&ye(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(ne(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Or)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Or(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&Ae(this._icon,t),this._shadow&&Ae(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,i=e.iconSize?bt(e.iconSize):bt(0,0),o=e.iconAnchor?bt(e.iconAnchor):bt(0,0);t.panInside(this._latlng,{paddingTopLeft:o,paddingBottomRight:i.subtract(o)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Pn(t,e){return new Wn(t,e)}var pe=Ge.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return b(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),qn=pe.extend({options:{fill:!0,radius:10},initialize:function(t,e){b(this,e),this._latlng=jt(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=jt(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return pe.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),o=[t+i,e+i];this._pxBounds=new $(this._point.subtract(o),this._point.add(o))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ve(t,e){return new qn(t,e)}var lr=qn.extend({initialize:function(t,e,i){if(typeof e=="number"&&(e=_({},i,{radius:e})),b(this,e),this._latlng=jt(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new Zt(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:pe.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,o=i.options.crs;if(o.distance===Nt.distance){var u=Math.PI/180,v=this._mRadius/Nt.R/u,Z=i.project([e+v,t]),nt=i.project([e-v,t]),ut=Z.add(nt).divideBy(2),St=i.unproject(ut).lat,qt=Math.acos((Math.cos(v*u)-Math.sin(e*u)*Math.sin(St*u))/(Math.cos(e*u)*Math.cos(St*u)))/u;(isNaN(qt)||qt===0)&&(qt=v/Math.cos(Math.PI/180*e)),this._point=ut.subtract(i.getPixelOrigin()),this._radius=isNaN(qt)?0:ut.x-i.project([St,t-qt]).x,this._radiusY=ut.y-Z.y}else{var te=o.unproject(o.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(te).x}this._updateBounds()}});function hr(t,e,i){return new lr(t,e,i)}var fn=pe.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){b(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e=1/0,i=null,o=oi,u,v,Z=0,nt=this._parts.length;Z<nt;Z++)for(var ut=this._parts[Z],St=1,qt=ut.length;St<qt;St++){u=ut[St-1],v=ut[St];var te=o(t,u,v,!0);te<e&&(e=te,i=o(t,u,v))}return i&&(i.distance=Math.sqrt(e)),i},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return wi(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=jt(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new Zt,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return He(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=He(t),o=0,u=t.length;o<u;o++)i?(e[o]=jt(t[o]),this._bounds.extend(e[o])):e[o]=this._convertLatLngs(t[o]);return e},_project:function(){var t=new $;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new Lt(t,t);this._rawPxBounds&&(this._pxBounds=new $([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,i){var o=t[0]instanceof dt,u=t.length,v,Z;if(o){for(Z=[],v=0;v<u;v++)Z[v]=this._map.latLngToLayerPoint(t[v]),i.extend(Z[v]);e.push(Z)}else for(v=0;v<u;v++)this._projectLatlngs(t[v],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var e=this._parts,i,o,u,v,Z,nt,ut;for(i=0,u=0,v=this._rings.length;i<v;i++)for(ut=this._rings[i],o=0,Z=ut.length;o<Z-1;o++)nt=Fi(ut[o],ut[o+1],t,o,!0),nt&&(e[u]=e[u]||[],e[u].push(nt[0]),(nt[1]!==ut[o+1]||o===Z-2)&&(e[u].push(nt[1]),u++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,o=t.length;i<o;i++)t[i]=ar(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,o,u,v,Z,nt,ut=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,v=this._parts.length;i<v;i++)for(nt=this._parts[i],o=0,Z=nt.length,u=Z-1;o<Z;u=o++)if(!(!e&&o===0)&&bi(t,nt[u],nt[o])<=ut)return!0;return!1}});function Hn(t,e){return new fn(t,e)}fn._flat=ji;var Nn=fn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ce(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=fn.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof dt&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){fn.prototype._setLatLngs.call(this,t),He(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return He(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new Lt(e,e);if(t=new $(t.min.subtract(i),t.max.add(i)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var o=0,u=this._rings.length,v;o<u;o++)v=Zi(this._rings[o],t,!0),v.length&&this._parts.push(v)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e=!1,i,o,u,v,Z,nt,ut,St;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(v=0,ut=this._parts.length;v<ut;v++)for(i=this._parts[v],Z=0,St=i.length,nt=St-1;Z<St;nt=Z++)o=i[Z],u=i[nt],o.y>t.y!=u.y>t.y&&t.x<(u.x-o.x)*(t.y-o.y)/(u.y-o.y)+o.x&&(e=!e);return e||fn.prototype._containsPoint.call(this,t,!0)}});function ai(t,e){return new Nn(t,e)}var Be=en.extend({initialize:function(t,e){b(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e=j(t)?t:t.features,i,o,u;if(e){for(i=0,o=e.length;i<o;i++)u=e[i],(u.geometries||u.geometry||u.features||u.coordinates)&&this.addData(u);return this}var v=this.options;if(v.filter&&!v.filter(t))return this;var Z=Si(t,v);return Z?(Z.feature=S(t),Z.defaultOptions=Z.options,this.resetStyle(Z),v.onEachFeature&&v.onEachFeature(t,Z),this.addLayer(Z)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=_({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){t.setStyle&&(typeof e=="function"&&(e=e(t.feature)),t.setStyle(e))}});function Si(t,e){var i=t.type==="Feature"?t.geometry:t,o=i?i.coordinates:null,u=[],v=e&&e.pointToLayer,Z=e&&e.coordsToLatLng||r,nt,ut,St,qt;if(!o&&!i)return null;switch(i.type){case"Point":return nt=Z(o),n(v,t,nt,e);case"MultiPoint":for(St=0,qt=o.length;St<qt;St++)nt=Z(o[St]),u.push(n(v,t,nt,e));return new en(u);case"LineString":case"MultiLineString":return ut=s(o,i.type==="LineString"?0:1,Z),new fn(ut,e);case"Polygon":case"MultiPolygon":return ut=s(o,i.type==="Polygon"?1:2,Z),new Nn(ut,e);case"GeometryCollection":for(St=0,qt=i.geometries.length;St<qt;St++){var te=Si({geometry:i.geometries[St],type:"Feature",properties:t.properties},e);te&&u.push(te)}return new en(u);case"FeatureCollection":for(St=0,qt=i.features.length;St<qt;St++){var ue=Si(i.features[St],e);ue&&u.push(ue)}return new en(u);default:throw new Error("Invalid GeoJSON object.")}}function n(t,e,i,o){return t?t(e,i):new Wn(i,o&&o.markersInheritOptions&&o)}function r(t){return new dt(t[1],t[0],t[2])}function s(t,e,i){for(var o=[],u=0,v=t.length,Z;u<v;u++)Z=e?s(t[u],e-1,i):(i||r)(t[u]),o.push(Z);return o}function a(t,e){return t=jt(t),t.alt!==void 0?[D(t.lng,e),D(t.lat,e),D(t.alt,e)]:[D(t.lng,e),D(t.lat,e)]}function l(t,e,i,o){for(var u=[],v=0,Z=t.length;v<Z;v++)u.push(e?l(t[v],He(t[v])?0:e-1,i,o):a(t[v],o));return!e&&i&&u.length>0&&u.push(u[0].slice()),u}function f(t,e){return t.feature?_({},t.feature,{geometry:e}):S(e)}function S(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var B={toGeoJSON:function(t){return f(this,{type:"Point",coordinates:a(this.getLatLng(),t)})}};Wn.include(B),lr.include(B),qn.include(B),fn.include({toGeoJSON:function(t){var e=!He(this._latlngs),i=l(this._latlngs,e?1:0,!1,t);return f(this,{type:(e?"Multi":"")+"LineString",coordinates:i})}}),Nn.include({toGeoJSON:function(t){var e=!He(this._latlngs),i=e&&!He(this._latlngs[0]),o=l(this._latlngs,i?2:e?1:0,!0,t);return e||(o=[o]),f(this,{type:(i?"Multi":"")+"Polygon",coordinates:o})}}),si.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(i){e.push(i.toGeoJSON(t).geometry.coordinates)}),f(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(e==="MultiPoint")return this.toMultiPoint(t);var i=e==="GeometryCollection",o=[];return this.eachLayer(function(u){if(u.toGeoJSON){var v=u.toGeoJSON(t);if(i)o.push(v.geometry);else{var Z=S(v);Z.type==="FeatureCollection"?o.push.apply(o,Z.features):o.push(Z)}}}),i?f(this,{geometries:o,type:"GeometryCollection"}):{type:"FeatureCollection",features:o}}});function K(t,e){return new Be(t,e)}var U=K,V=Ge.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=vt(e),b(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ne(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ve(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&wn(this._image),this},bringToBack:function(){return this._map&&un(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=vt(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",e=this._image=t?this._url:Ht("img");if(ne(e,"leaflet-image-layer"),this._zoomAnimated&&ne(e,"leaflet-zoom-animated"),this.options.className&&ne(e,this.options.className),e.onselectstart=T,e.onmousemove=T,e.onload=y(this.fire,this,"load"),e.onerror=y(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(e.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=e.src;return}e.src=this._url,e.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;xn(this._image,i,e)},_reset:function(){var t=this._image,e=new $(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();ye(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){Ae(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),F=function(t,e,i){return new V(t,e,i)},Q=V.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",e=this._image=t?this._url:Ht("video");if(ne(e,"leaflet-image-layer"),this._zoomAnimated&&ne(e,"leaflet-zoom-animated"),this.options.className&&ne(e,this.options.className),e.onselectstart=T,e.onmousemove=T,e.onloadeddata=y(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),o=[],u=0;u<i.length;u++)o.push(i[u].src);this._url=i.length>0?o:[e.src];return}j(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var v=0;v<this._url.length;v++){var Z=Ht("source");Z.src=this._url[v],e.appendChild(Z)}}});function W(t,e,i){return new Q(t,e,i)}var q=V.extend({_initImage:function(){var t=this._image=this._url;ne(t,"leaflet-image-layer"),this._zoomAnimated&&ne(t,"leaflet-zoom-animated"),this.options.className&&ne(t,this.options.className),t.onselectstart=T,t.onmousemove=T}});function H(t,e,i){return new q(t,e,i)}var G=Ge.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof dt||j(t))?(this._latlng=jt(t),b(this,e)):(b(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Ae(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Ae(this._container,1),this.bringToFront(),this.options.interactive&&(ne(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(Ae(this._container,0),this._removeTimeout=setTimeout(y(ve,void 0,this._container),200)):ve(this._container),this.options.interactive&&(be(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=jt(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&wn(this._container),this},bringToBack:function(){return this._map&&un(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof en){e=null;var i=this._source._layers;for(var o in i)if(i[o]._map){e=i[o];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else if(e.getBounds)t=e.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof e=="string")t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=bt(this.options.offset),i=this._getAnchor();this._zoomAnimated?ye(this._container,t.add(i)):e=e.add(t).add(i);var o=this._containerBottom=-e.y,u=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=o+"px",this._container.style.left=u+"px"}},_getAnchor:function(){return[0,0]}});se.include({_initOverlay:function(t,e,i,o){var u=e;return u instanceof t||(u=new t(o).setContent(e)),i&&u.setLatLng(i),u}}),Ge.include({_initOverlay:function(t,e,i,o){var u=i;return u instanceof t?(b(u,o),u._source=this):(u=e&&!o?e:new t(o,this),u.setContent(i)),u}});var et=G.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,G.prototype.openOn.call(this,t)},onAdd:function(t){G.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof pe||this._source.on("preclick",ze))},onRemove:function(t){G.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof pe||this._source.off("preclick",ze))},getEvents:function(){var t=G.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=Ht("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=Ht("div",t+"-content-wrapper",e);if(this._contentNode=Ht("div",t+"-content",i),ei(e),pi(this._contentNode),Xt(e,"contextmenu",ze),this._tipContainer=Ht("div",t+"-tip-container",e),this._tip=Ht("div",t+"-tip",this._tipContainer),this.options.closeButton){var o=this._closeButton=Ht("a",t+"-close-button",e);o.setAttribute("role","button"),o.setAttribute("aria-label","Close popup"),o.href="#close",o.innerHTML='<span aria-hidden="true">&#215;</span>',Xt(o,"click",function(u){ke(u),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var o=t.offsetHeight,u=this.options.maxHeight,v="leaflet-popup-scrolled";u&&o>u?(e.height=u+"px",ne(t,v)):be(t,v),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();ye(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,e=parseInt(Xn(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,o=this._containerWidth,u=new Lt(this._containerLeft,-i-this._containerBottom);u._add(zn(this._container));var v=t.layerPointToContainerPoint(u),Z=bt(this.options.autoPanPadding),nt=bt(this.options.autoPanPaddingTopLeft||Z),ut=bt(this.options.autoPanPaddingBottomRight||Z),St=t.getSize(),qt=0,te=0;v.x+o+ut.x>St.x&&(qt=v.x+o-St.x+ut.x),v.x-qt-nt.x<0&&(qt=v.x-nt.x),v.y+i+ut.y>St.y&&(te=v.y+i-St.y+ut.y),v.y-te-nt.y<0&&(te=v.y-nt.y),(qt||te)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([qt,te]))}},_getAnchor:function(){return bt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),rt=function(t,e){return new et(t,e)};se.mergeOptions({closePopupOnClick:!0}),se.include({openPopup:function(t,e,i){return this._initOverlay(et,t,e,i).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),Ge.include({bindPopup:function(t,e){return this._popup=this._initOverlay(et,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof en||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){$e(t);var e=t.layer||t.target;if(this._popup._source===e&&!(e instanceof pe)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=e,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var ft=G.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){G.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){G.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=G.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ht("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+w(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,i,o=this._map,u=this._container,v=o.latLngToContainerPoint(o.getCenter()),Z=o.layerPointToContainerPoint(t),nt=this.options.direction,ut=u.offsetWidth,St=u.offsetHeight,qt=bt(this.options.offset),te=this._getAnchor();nt==="top"?(e=ut/2,i=St):nt==="bottom"?(e=ut/2,i=0):nt==="center"?(e=ut/2,i=St/2):nt==="right"?(e=0,i=St/2):nt==="left"?(e=ut,i=St/2):Z.x<v.x?(nt="right",e=0,i=St/2):(nt="left",e=ut+(qt.x+te.x)*2,i=St/2),t=t.subtract(bt(e,i,!0)).add(qt).add(te),be(u,"leaflet-tooltip-right"),be(u,"leaflet-tooltip-left"),be(u,"leaflet-tooltip-top"),be(u,"leaflet-tooltip-bottom"),ne(u,"leaflet-tooltip-"+nt),ye(u,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Ae(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return bt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),gt=function(t,e){return new ft(t,e)};se.include({openTooltip:function(t,e,i){return this._initOverlay(ft,t,e,i).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Ge.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ft,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,i.click=this._openTooltip,this._map?this._addFocusListeners():i.add=this._addFocusListeners),this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof en||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&(Xt(e,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),Xt(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",function(){e._openOnceFlag=!1,e._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var e=t.latlng,i,o;this._tooltip.options.sticky&&t.originalEvent&&(i=this._map.mouseEventToContainerPoint(t.originalEvent),o=this._map.containerPointToLayerPoint(i),e=this._map.layerPointToLatLng(o)),this._tooltip.setLatLng(e)}});var At=Un.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&t.tagName==="DIV"?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(fi(e),e.appendChild(i.html)):e.innerHTML=i.html!==!1?i.html:"",i.bgPos){var o=bt(i.bgPos);e.style.backgroundPosition=-o.x+"px "+-o.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function Dt(t){return new At(t)}Un.Default=Pi;var Et=Ge.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Yt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){b(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ve(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(wn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(un(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=M(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof Lt?t:new Lt(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e=this.getPane().children,i=-t(-1/0,1/0),o=0,u=e.length,v;o<u;o++)v=e[o].style.zIndex,e[o]!==this._container&&v&&(i=t(i,+v));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Yt.ielt9){Ae(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var o in this._tiles){var u=this._tiles[o];if(!(!u.current||!u.loaded)){var v=Math.min(1,(t-u.loaded)/200);Ae(u.el,v),v<1?e=!0:(u.active?i=!0:this._onOpaqueTile(u),u.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(N(this._fadeFrame),this._fadeFrame=Rt(this._updateOpacity,this))}},_onOpaqueTile:T,_initContainer:function(){this._container||(this._container=Ht("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t!==void 0){for(var i in this._levels)i=Number(i),this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(ve(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var o=this._levels[t],u=this._map;return o||(o=this._levels[t]={},o.el=Ht("div","leaflet-tile-container leaflet-zoom-animated",this._container),o.el.style.zIndex=e,o.origin=u.project(u.unproject(u.getPixelOrigin()),t).round(),o.zoom=t,this._setZoomTransform(o,u.getCenter(),u.getZoom()),T(o.el.offsetWidth),this._onCreateLevel(o)),this._level=o,o}},_onUpdateLevel:T,_onRemoveLevel:T,_onCreateLevel:T,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var o=e.coords;this._retainParent(o.x,o.y,o.z,o.z-5)||this._retainChildren(o.x,o.y,o.z,o.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ve(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,o){var u=Math.floor(t/2),v=Math.floor(e/2),Z=i-1,nt=new Lt(+u,+v);nt.z=+Z;var ut=this._tileCoordsToKey(nt),St=this._tiles[ut];return St&&St.active?(St.retain=!0,!0):(St&&St.loaded&&(St.retain=!0),Z>o?this._retainParent(u,v,Z,o):!1)},_retainChildren:function(t,e,i,o){for(var u=2*t;u<2*t+2;u++)for(var v=2*e;v<2*e+2;v++){var Z=new Lt(u,v);Z.z=i+1;var nt=this._tileCoordsToKey(Z),ut=this._tiles[nt];if(ut&&ut.active){ut.retain=!0;continue}else ut&&ut.loaded&&(ut.retain=!0);i+1<o&&this._retainChildren(u,v,i+1,o)}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return e.minNativeZoom!==void 0&&t<e.minNativeZoom?e.minNativeZoom:e.maxNativeZoom!==void 0&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,o){var u=Math.round(e);this.options.maxZoom!==void 0&&u>this.options.maxZoom||this.options.minZoom!==void 0&&u<this.options.minZoom?u=void 0:u=this._clampZoom(u);var v=this.options.updateWhenZooming&&u!==this._tileZoom;(!o||v)&&(this._tileZoom=u,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),u!==void 0&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var o=this._map.getZoomScale(i,t.zoom),u=t.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(e,i)).round();Yt.any3d?xn(t.el,u,o):ye(t.el,u)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),o=this._tileZoom,u=this._map.getPixelWorldBounds(this._tileZoom);u&&(this._globalTileRange=this._pxBoundsToTileRange(u)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],o).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],o).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],o).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],o).y/i.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),o=e.getZoomScale(i,this._tileZoom),u=e.project(t,this._tileZoom).floor(),v=e.getSize().divideBy(o*2);return new $(u.subtract(v),u.add(v))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(t===void 0&&(t=e.getCenter()),this._tileZoom!==void 0){var o=this._getTiledPixelBounds(t),u=this._pxBoundsToTileRange(o),v=u.getCenter(),Z=[],nt=this.options.keepBuffer,ut=new $(u.getBottomLeft().subtract([nt,-nt]),u.getTopRight().add([nt,-nt]));if(!(isFinite(u.min.x)&&isFinite(u.min.y)&&isFinite(u.max.x)&&isFinite(u.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var St in this._tiles){var qt=this._tiles[St].coords;(qt.z!==this._tileZoom||!ut.contains(new Lt(qt.x,qt.y)))&&(this._tiles[St].current=!1)}if(Math.abs(i-this._tileZoom)>1){this._setView(t,i);return}for(var te=u.min.y;te<=u.max.y;te++)for(var ue=u.min.x;ue<=u.max.x;ue++){var We=new Lt(ue,te);if(We.z=this._tileZoom,!!this._isValidTile(We)){var Ne=this._tiles[this._tileCoordsToKey(We)];Ne?Ne.current=!0:Z.push(We)}}if(Z.sort(function(Ye,Ki){return Ye.distanceTo(v)-Ki.distanceTo(v)}),Z.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var dn=document.createDocumentFragment();for(ue=0;ue<Z.length;ue++)this._addTile(Z[ue],dn);this._level.el.appendChild(dn)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var o=this._tileCoordsToBounds(t);return vt(this.options.bounds).overlaps(o)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),o=t.scaleBy(i),u=o.add(i),v=e.unproject(o,t.z),Z=e.unproject(u,t.z);return[v,Z]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new Zt(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new Lt(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(ve(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ne(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=T,t.onmousemove=T,Yt.ielt9&&this.options.opacity<1&&Ae(t,this.options.opacity)},_addTile:function(t,e){var i=this._getTilePos(t),o=this._tileCoordsToKey(t),u=this.createTile(this._wrapCoords(t),y(this._tileReady,this,t));this._initTile(u),this.createTile.length<2&&Rt(y(this._tileReady,this,t,null,u)),ye(u,i),this._tiles[o]={el:u,coords:t,current:!0},e.appendChild(u),this.fire("tileloadstart",{tile:u,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var o=this._tileCoordsToKey(t);i=this._tiles[o],i&&(i.loaded=+new Date,this._map._fadeAnimated?(Ae(i.el,0),N(this._fadeFrame),this._fadeFrame=Rt(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(ne(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Yt.ielt9||!this._map._fadeAnimated?Rt(this._pruneTiles,this):setTimeout(y(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new Lt(this._wrapX?R(t.x,this._wrapX):t.x,this._wrapY?R(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new $(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Bt(t){return new Et(t)}var It=Et.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,e=b(this,e),e.detectRetina&&Yt.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),typeof e.subdomains=="string"&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&e===void 0&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return Xt(i,"load",y(this._tileOnLoad,this,e,i)),Xt(i,"error",y(this._tileOnError,this,e,i)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(i.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(i.referrerPolicy=this.options.referrerPolicy),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){var e={r:Yt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return I(this._url,_(e,this.options))},_tileOnLoad:function(t,e){Yt.ielt9?setTimeout(y(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var o=this.options.errorTileUrl;o&&e.getAttribute("src")!==o&&(e.src=o),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,i=this.options.zoomReverse,o=this.options.zoomOffset;return i&&(t=e-t),t+o},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=T,e.onerror=T,!e.complete)){e.src=Y;var i=this._tiles[t].coords;ve(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:i})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",Y),Et.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(!(!this._map||i&&i.getAttribute("src")===Y))return Et.prototype._tileReady.call(this,t,e,i)}});function Mt(t,e){return new It(t,e)}var Wt=It.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=_({},this.defaultWmsParams);for(var o in e)o in this.options||(i[o]=e[o]);e=b(this,e);var u=e.detectRetina&&Yt.retina?2:1,v=this.getTileSize();i.width=v.x*u,i.height=v.y*u,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,It.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,o=tt(i.project(e[0]),i.project(e[1])),u=o.min,v=o.max,Z=(this._wmsVersion>=1.3&&this._crs===Tr?[u.y,u.x,v.y,v.x]:[u.x,u.y,v.x,v.y]).join(","),nt=It.prototype.getTileUrl.call(this,t);return nt+C(this.wmsParams,nt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Z},setParams:function(t,e){return _(this.wmsParams,t),e||this.redraw(),this}});function ee(t,e){return new Wt(t,e)}It.WMS=Wt,Mt.wms=ee;var Jt=Ge.extend({options:{padding:.1},initialize:function(t){b(this,t),w(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ne(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),o=this._map.getSize().multiplyBy(.5+this.options.padding),u=this._map.project(this._center,e),v=o.multiplyBy(-i).add(u).subtract(this._map._getNewPixelOrigin(t,e));Yt.any3d?xn(this._container,v,i):ye(this._container,v)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new $(i,i.add(e.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),re=Jt.extend({options:{tolerance:0},getEvents:function(){var t=Jt.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Jt.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Xt(t,"mousemove",this._onMouseMove,this),Xt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Xt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){N(this._redrawRequest),delete this._ctx,ve(this._container),fe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var e in this._layers)t=this._layers[e],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Jt.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),o=Yt.retina?2:1;ye(e,t.min),e.width=o*i.x,e.height=o*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Yt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Jt.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[w(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,o=e.prev;i?i.prev=o:this._drawLast=o,o?o.next=i:this._drawFirst=i,delete t._order,delete this._layers[w(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var e=t.options.dashArray.split(/[, ]+/),i=[],o,u;for(u=0;u<e.length;u++){if(o=Number(e[u]),isNaN(o))return;i.push(o)}t.options._dashArray=i}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||Rt(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new $,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var o=this._drawFirst;o;o=o.next)t=o.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,o,u,v,Z=t._parts,nt=Z.length,ut=this._ctx;if(nt){for(ut.beginPath(),i=0;i<nt;i++){for(o=0,u=Z[i].length;o<u;o++)v=Z[i][o],ut[o?"lineTo":"moveTo"](v.x,v.y);e&&ut.closePath()}this._fillStroke(ut,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var e=t._point,i=this._ctx,o=Math.max(Math.round(t._radius),1),u=(Math.max(Math.round(t._radiusY),1)||o)/o;u!==1&&(i.save(),i.scale(1,u)),i.beginPath(),i.arc(e.x,e.y/u,o,0,Math.PI*2,!1),u!==1&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&i.weight!==0&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e=this._map.mouseEventToLayerPoint(t),i,o,u=this._drawFirst;u;u=u.next)i=u.layer,i.options.interactive&&i._containsPoint(e)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(i))&&(o=i);this._fireEvent(o?[o]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(be(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var i,o,u=this._drawFirst;u;u=u.next)i=u.layer,i.options.interactive&&i._containsPoint(e)&&(o=i);o!==this._hoveredLayer&&(this._handleMouseOut(t),o&&(ne(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseover"),this._hoveredLayer=o)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(y(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,o=e.prev;if(i)i.prev=o;else return;o?o.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t)}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,o=e.prev;if(o)o.next=i;else return;i?i.prev=o:o&&(this._drawLast=o),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t)}}});function Fe(t){return Yt.canvas?new re(t):null}var $t=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ie={_initContainer:function(){this._container=Ht("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Jt.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=$t("shape");ne(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=$t("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[w(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ve(e),t.removeInteractiveTarget(e),delete this._layers[w(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,o=t.options,u=t._container;u.stroked=!!o.stroke,u.filled=!!o.fill,o.stroke?(e||(e=t._stroke=$t("stroke")),u.appendChild(e),e.weight=o.weight+"px",e.color=o.color,e.opacity=o.opacity,o.dashArray?e.dashStyle=j(o.dashArray)?o.dashArray.join(" "):o.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=o.lineCap.replace("butt","flat"),e.joinstyle=o.lineJoin):e&&(u.removeChild(e),t._stroke=null),o.fill?(i||(i=t._fill=$t("fill")),u.appendChild(i),i.color=o.fillColor||o.color,i.opacity=o.fillOpacity):i&&(u.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),o=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+o+" 0,"+65535*360)},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){wn(t._container)},_bringToBack:function(t){un(t._container)}},Pe=Yt.vml?$t:pt,Dn=Jt.extend({_initContainer:function(){this._container=Pe("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Pe("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ve(this._container),fe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Jt.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;(!this._svgSize||!this._svgSize.equals(e))&&(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),ye(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=Pe("path");t.options.className&&ne(e,t.options.className),t.options.interactive&&ne(e,"leaflet-interactive"),this._updateStyle(t),this._layers[w(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ve(t._path),t.removeInteractiveTarget(t._path),delete this._layers[w(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,st(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),o=Math.max(Math.round(t._radiusY),1)||i,u="a"+i+","+o+" 0 1,0 ",v=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+u+i*2+",0 "+u+-i*2+",0 ";this._setPath(t,v)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){wn(t._path)},_bringToBack:function(t){un(t._path)}});Yt.vml&&Dn.include(Ie);function Me(t){return Yt.svg||Yt.vml?new Dn(t):null}se.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var e=this._paneRenderers[t];return e===void 0&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&Fe(t)||Me(t)}});var Rn=Nn.extend({initialize:function(t,e){Nn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=vt(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function fr(t,e){return new Rn(t,e)}Dn.create=Pe,Dn.pointsToPath=st,Be.geometryToLayer=Si,Be.coordsToLatLng=r,Be.coordsToLatLngs=s,Be.latLngToCoords=a,Be.latLngsToCoords=l,Be.getFeature=f,Be.asFeature=S,se.mergeOptions({boxZoom:!0});var lo=Re.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Xt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){fe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ve(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Bn(),Ai(),this._startPoint=this._map.mouseEventToContainerPoint(t),Xt(document,{contextmenu:$e,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Ht("div","leaflet-zoom-box",this._container),ne(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new $(this._point,this._startPoint),i=e.getSize();ye(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(ve(this._box),be(this._container,"leaflet-crosshair")),$n(),tr(),fe(document,{contextmenu:$e,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(y(this._resetState,this),0);var e=new Zt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});se.addInitHook("addHandler","boxZoom",lo),se.mergeOptions({doubleClickZoom:!0});var ho=Re.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),o=e.options.zoomDelta,u=t.originalEvent.shiftKey?i-o:i+o;e.options.doubleClickZoom==="center"?e.setZoom(u):e.setZoomAround(t.containerPoint,u)}});se.addInitHook("addHandler","doubleClickZoom",ho),se.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var fo=Re.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new ln(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ne(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){be(this._map._container,"leaflet-grab"),be(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=vt(this._map.options.maxBounds);this._offsetLimit=tt(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,o=this._draggable._newPos.x,u=(o-e+i)%t+e-i,v=(o+e+i)%t-e-i,Z=Math.abs(u+i)<Math.abs(v+i)?u:v;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Z},_onDragEnd:function(t){var e=this._map,i=e.options,o=!i.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),o)e.fire("moveend");else{this._prunePositions(+new Date);var u=this._lastPos.subtract(this._positions[0]),v=(this._lastTime-this._times[0])/1e3,Z=i.easeLinearity,nt=u.multiplyBy(Z/v),ut=nt.distanceTo([0,0]),St=Math.min(i.inertiaMaxSpeed,ut),qt=nt.multiplyBy(St/ut),te=St/(i.inertiaDeceleration*Z),ue=qt.multiplyBy(-te/2).round();!ue.x&&!ue.y?e.fire("moveend"):(ue=e._limitOffset(ue,e.options.maxBounds),Rt(function(){e.panBy(ue,{duration:te,easeLinearity:Z,noMoveStart:!0,animate:!0})}))}}});se.addInitHook("addHandler","dragging",fo),se.mergeOptions({keyboard:!0,keyboardPanDelta:80});var po=Re.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Xt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),fe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,o=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(o,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e=this._panKeys={},i=this.keyCodes,o,u;for(o=0,u=i.left.length;o<u;o++)e[i.left[o]]=[-1*t,0];for(o=0,u=i.right.length;o<u;o++)e[i.right[o]]=[t,0];for(o=0,u=i.down.length;o<u;o++)e[i.down[o]]=[0,t];for(o=0,u=i.up.length;o<u;o++)e[i.up[o]]=[0,-1*t]},_setZoomDelta:function(t){var e=this._zoomKeys={},i=this.keyCodes,o,u;for(o=0,u=i.zoomIn.length;o<u;o++)e[i.zoomIn[o]]=t;for(o=0,u=i.zoomOut.length;o<u;o++)e[i.zoomOut[o]]=-t},_addHooks:function(){Xt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){fe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=t.keyCode,i=this._map,o;if(e in this._panKeys){if(!i._panAnim||!i._panAnim._inProgress)if(o=this._panKeys[e],t.shiftKey&&(o=bt(o).multiplyBy(3)),i.options.maxBounds&&(o=i._limitOffset(bt(o),i.options.maxBounds)),i.options.worldCopyJump){var u=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(o)));i.panTo(u)}else i.panBy(o)}else if(e in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else if(e===27&&i._popup&&i._popup.options.closeOnEscapeKey)i.closePopup();else return;$e(t)}}});se.addInitHook("addHandler","keyboard",po),se.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var mo=Re.extend({addHooks:function(){Xt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){fe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=ni(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var o=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(y(this._performZoom,this),o),$e(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var o=this._delta/(this._map.options.wheelPxPerZoomLevel*4),u=4*Math.log(2/(1+Math.exp(-Math.abs(o))))/Math.LN2,v=i?Math.ceil(u/i)*i:u,Z=t._limitZoom(e+(this._delta>0?v:-v))-e;this._delta=0,this._startTime=null,Z&&(t.options.scrollWheelZoom==="center"?t.setZoom(e+Z):t.setZoomAround(this._lastMousePos,e+Z))}});se.addInitHook("addHandler","scrollWheelZoom",mo);var Fo=600;se.mergeOptions({tapHold:Yt.touchNative&&Yt.safari&&Yt.mobile,tapTolerance:15});var _o=Re.extend({addHooks:function(){Xt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){fe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var e=t.touches[0];this._startPos=this._newPos=new Lt(e.clientX,e.clientY),this._holdTimeout=setTimeout(y(function(){this._cancel(),this._isTapValid()&&(Xt(document,"touchend",ke),Xt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))},this),Fo),Xt(document,"touchend touchcancel contextmenu",this._cancel,this),Xt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){fe(document,"touchend",ke),fe(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),fe(document,"touchend touchcancel contextmenu",this._cancel,this),fe(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new Lt(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var i=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});i._simulated=!0,e.target.dispatchEvent(i)}});se.addInitHook("addHandler","tapHold",_o),se.mergeOptions({touchZoom:Yt.touch,bounceAtZoomLimits:!0});var go=Re.extend({addHooks:function(){ne(this._map._container,"leaflet-touch-zoom"),Xt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){be(this._map._container,"leaflet-touch-zoom"),fe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(!(!t.touches||t.touches.length!==2||e._animatingZoom||this._zooming)){var i=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),e.options.touchZoom!=="center"&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(o)._divideBy(2))),this._startDist=i.distanceTo(o),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Xt(document,"touchmove",this._onTouchMove,this),Xt(document,"touchend touchcancel",this._onTouchEnd,this),ke(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]),u=i.distanceTo(o)/this._startDist;if(this._zoom=e.getScaleZoom(u,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&u<1||this._zoom>e.getMaxZoom()&&u>1)&&(this._zoom=e._limitZoom(this._zoom)),e.options.touchZoom==="center"){if(this._center=this._startLatLng,u===1)return}else{var v=i._add(o)._divideBy(2)._subtract(this._centerPoint);if(u===1&&v.x===0&&v.y===0)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(v),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),N(this._animRequest);var Z=y(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Rt(Z,this,!0),ke(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,N(this._animRequest),fe(document,"touchmove",this._onTouchMove,this),fe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});se.addInitHook("addHandler","touchZoom",go),se.BoxZoom=lo,se.DoubleClickZoom=ho,se.Drag=fo,se.Keyboard=po,se.ScrollWheelZoom=mo,se.TapHold=_o,se.TouchZoom=go,c.Bounds=$,c.Browser=Yt,c.CRS=le,c.Canvas=re,c.Circle=lr,c.CircleMarker=qn,c.Class=d,c.Control=tn,c.DivIcon=At,c.DivOverlay=G,c.DomEvent=Wr,c.DomUtil=br,c.Draggable=ln,c.Evented=mt,c.FeatureGroup=en,c.GeoJSON=Be,c.GridLayer=Et,c.Handler=Re,c.Icon=Un,c.ImageOverlay=V,c.LatLng=dt,c.LatLngBounds=Zt,c.Layer=Ge,c.LayerGroup=si,c.LineUtil=Hr,c.Map=se,c.Marker=Wn,c.Mixin=sr,c.Path=pe,c.Point=Lt,c.PolyUtil=yi,c.Polygon=Nn,c.Polyline=fn,c.Popup=et,c.PosAnimation=mi,c.Projection=Gr,c.Rectangle=Rn,c.Renderer=Jt,c.SVG=Dn,c.SVGOverlay=q,c.TileLayer=It,c.Tooltip=ft,c.Transformation=Qt,c.Util=lt,c.VideoOverlay=Q,c.bind=y,c.bounds=tt,c.canvas=Fe,c.circle=hr,c.circleMarker=Ve,c.control=_i,c.divIcon=Dt,c.extend=_,c.featureGroup=Cr,c.geoJSON=K,c.geoJson=U,c.gridLayer=Bt,c.icon=Vr,c.imageOverlay=F,c.latLng=jt,c.latLngBounds=vt,c.layerGroup=Er,c.map=rr,c.marker=Pn,c.point=bt,c.polygon=ai,c.polyline=Hn,c.popup=rt,c.rectangle=fr,c.setOptions=b,c.stamp=w,c.svg=Me,c.svgOverlay=H,c.tileLayer=Mt,c.tooltip=gt,c.transformation=Vt,c.version=k,c.videoOverlay=W;var jo=window.L;c.noConflict=function(){return window.L=jo,this},window.L=c})})($r,$r.exports);var Ks=$r.exports;const Xe=no(Ks);function zr(m){throw new Error('Could not dynamically require "'+m+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bo={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(m,z){(function(c){m.exports=c()})(function(){return function c(k,_,p){function y(M,R){if(!_[M]){if(!k[M]){var T=typeof zr=="function"&&zr;if(!R&&T)return T(M,!0);if(g)return g(M,!0);var D=new Error("Cannot find module '"+M+"'");throw D.code="MODULE_NOT_FOUND",D}var x=_[M]={exports:{}};k[M][0].call(x.exports,function(O){var b=k[M][1][O];return y(b||O)},x,x.exports,c,k,_,p)}return _[M].exports}for(var g=typeof zr=="function"&&zr,w=0;w<p.length;w++)y(p[w]);return y}({1:[function(c,k,_){var p=c("./utils"),y=c("./support"),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";_.encode=function(w){for(var M,R,T,D,x,O,b,C=[],P=0,I=w.length,j=I,X=p.getTypeOf(w)!=="string";P<w.length;)j=I-P,T=X?(M=w[P++],R=P<I?w[P++]:0,P<I?w[P++]:0):(M=w.charCodeAt(P++),R=P<I?w.charCodeAt(P++):0,P<I?w.charCodeAt(P++):0),D=M>>2,x=(3&M)<<4|R>>4,O=1<j?(15&R)<<2|T>>6:64,b=2<j?63&T:64,C.push(g.charAt(D)+g.charAt(x)+g.charAt(O)+g.charAt(b));return C.join("")},_.decode=function(w){var M,R,T,D,x,O,b=0,C=0,P="data:";if(w.substr(0,P.length)===P)throw new Error("Invalid base64 input, it looks like a data url.");var I,j=3*(w=w.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(w.charAt(w.length-1)===g.charAt(64)&&j--,w.charAt(w.length-2)===g.charAt(64)&&j--,j%1!=0)throw new Error("Invalid base64 input, bad content length.");for(I=y.uint8array?new Uint8Array(0|j):new Array(0|j);b<w.length;)M=g.indexOf(w.charAt(b++))<<2|(D=g.indexOf(w.charAt(b++)))>>4,R=(15&D)<<4|(x=g.indexOf(w.charAt(b++)))>>2,T=(3&x)<<6|(O=g.indexOf(w.charAt(b++))),I[C++]=M,x!==64&&(I[C++]=R),O!==64&&(I[C++]=T);return I}},{"./support":30,"./utils":32}],2:[function(c,k,_){var p=c("./external"),y=c("./stream/DataWorker"),g=c("./stream/Crc32Probe"),w=c("./stream/DataLengthProbe");function M(R,T,D,x,O){this.compressedSize=R,this.uncompressedSize=T,this.crc32=D,this.compression=x,this.compressedContent=O}M.prototype={getContentWorker:function(){var R=new y(p.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new w("data_length")),T=this;return R.on("end",function(){if(this.streamInfo.data_length!==T.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),R},getCompressedWorker:function(){return new y(p.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},M.createWorkerFrom=function(R,T,D){return R.pipe(new g).pipe(new w("uncompressedSize")).pipe(T.compressWorker(D)).pipe(new w("compressedSize")).withStreamInfo("compression",T)},k.exports=M},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(c,k,_){var p=c("./stream/GenericWorker");_.STORE={magic:"\0\0",compressWorker:function(){return new p("STORE compression")},uncompressWorker:function(){return new p("STORE decompression")}},_.DEFLATE=c("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(c,k,_){var p=c("./utils"),y=function(){for(var g,w=[],M=0;M<256;M++){g=M;for(var R=0;R<8;R++)g=1&g?3988292384^g>>>1:g>>>1;w[M]=g}return w}();k.exports=function(g,w){return g!==void 0&&g.length?p.getTypeOf(g)!=="string"?function(M,R,T,D){var x=y,O=D+T;M^=-1;for(var b=D;b<O;b++)M=M>>>8^x[255&(M^R[b])];return-1^M}(0|w,g,g.length,0):function(M,R,T,D){var x=y,O=D+T;M^=-1;for(var b=D;b<O;b++)M=M>>>8^x[255&(M^R.charCodeAt(b))];return-1^M}(0|w,g,g.length,0):0}},{"./utils":32}],5:[function(c,k,_){_.base64=!1,_.binary=!1,_.dir=!1,_.createFolders=!0,_.date=null,_.compression=null,_.compressionOptions=null,_.comment=null,_.unixPermissions=null,_.dosPermissions=null},{}],6:[function(c,k,_){var p=null;p=typeof Promise<"u"?Promise:c("lie"),k.exports={Promise:p}},{lie:37}],7:[function(c,k,_){var p=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",y=c("pako"),g=c("./utils"),w=c("./stream/GenericWorker"),M=p?"uint8array":"array";function R(T,D){w.call(this,"FlateWorker/"+T),this._pako=null,this._pakoAction=T,this._pakoOptions=D,this.meta={}}_.magic="\b\0",g.inherits(R,w),R.prototype.processChunk=function(T){this.meta=T.meta,this._pako===null&&this._createPako(),this._pako.push(g.transformTo(M,T.data),!1)},R.prototype.flush=function(){w.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},R.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this._pako=null},R.prototype._createPako=function(){this._pako=new y[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var T=this;this._pako.onData=function(D){T.push({data:D,meta:T.meta})}},_.compressWorker=function(T){return new R("Deflate",T)},_.uncompressWorker=function(){return new R("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(c,k,_){function p(x,O){var b,C="";for(b=0;b<O;b++)C+=String.fromCharCode(255&x),x>>>=8;return C}function y(x,O,b,C,P,I){var j,X,Y=x.file,ct=x.compression,ot=I!==M.utf8encode,wt=g.transformTo("string",I(Y.name)),at=g.transformTo("string",M.utf8encode(Y.name)),Tt=Y.comment,Rt=g.transformTo("string",I(Tt)),N=g.transformTo("string",M.utf8encode(Tt)),lt=at.length!==Y.name.length,d=N.length!==Tt.length,ht="",zt="",mt="",Lt=Y.dir,_t=Y.date,bt={crc32:0,compressedSize:0,uncompressedSize:0};O&&!b||(bt.crc32=x.crc32,bt.compressedSize=x.compressedSize,bt.uncompressedSize=x.uncompressedSize);var $=0;O&&($|=8),ot||!lt&&!d||($|=2048);var tt=0,Zt=0;Lt&&(tt|=16),P==="UNIX"?(Zt=798,tt|=function(dt,jt){var le=dt;return dt||(le=jt?16893:33204),(65535&le)<<16}(Y.unixPermissions,Lt)):(Zt=20,tt|=function(dt){return 63&(dt||0)}(Y.dosPermissions)),j=_t.getUTCHours(),j<<=6,j|=_t.getUTCMinutes(),j<<=5,j|=_t.getUTCSeconds()/2,X=_t.getUTCFullYear()-1980,X<<=4,X|=_t.getUTCMonth()+1,X<<=5,X|=_t.getUTCDate(),lt&&(zt=p(1,1)+p(R(wt),4)+at,ht+="up"+p(zt.length,2)+zt),d&&(mt=p(1,1)+p(R(Rt),4)+N,ht+="uc"+p(mt.length,2)+mt);var vt="";return vt+=`
\0`,vt+=p($,2),vt+=ct.magic,vt+=p(j,2),vt+=p(X,2),vt+=p(bt.crc32,4),vt+=p(bt.compressedSize,4),vt+=p(bt.uncompressedSize,4),vt+=p(wt.length,2),vt+=p(ht.length,2),{fileRecord:T.LOCAL_FILE_HEADER+vt+wt+ht,dirRecord:T.CENTRAL_FILE_HEADER+p(Zt,2)+vt+p(Rt.length,2)+"\0\0\0\0"+p(tt,4)+p(C,4)+wt+ht+Rt}}var g=c("../utils"),w=c("../stream/GenericWorker"),M=c("../utf8"),R=c("../crc32"),T=c("../signature");function D(x,O,b,C){w.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=O,this.zipPlatform=b,this.encodeFileName=C,this.streamFiles=x,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}g.inherits(D,w),D.prototype.push=function(x){var O=x.meta.percent||0,b=this.entriesCount,C=this._sources.length;this.accumulate?this.contentBuffer.push(x):(this.bytesWritten+=x.data.length,w.prototype.push.call(this,{data:x.data,meta:{currentFile:this.currentFile,percent:b?(O+100*(b-C-1))/b:100}}))},D.prototype.openedSource=function(x){this.currentSourceOffset=this.bytesWritten,this.currentFile=x.file.name;var O=this.streamFiles&&!x.file.dir;if(O){var b=y(x,O,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},D.prototype.closedSource=function(x){this.accumulate=!1;var O=this.streamFiles&&!x.file.dir,b=y(x,O,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),O)this.push({data:function(C){return T.DATA_DESCRIPTOR+p(C.crc32,4)+p(C.compressedSize,4)+p(C.uncompressedSize,4)}(x),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},D.prototype.flush=function(){for(var x=this.bytesWritten,O=0;O<this.dirRecords.length;O++)this.push({data:this.dirRecords[O],meta:{percent:100}});var b=this.bytesWritten-x,C=function(P,I,j,X,Y){var ct=g.transformTo("string",Y(X));return T.CENTRAL_DIRECTORY_END+"\0\0\0\0"+p(P,2)+p(P,2)+p(I,4)+p(j,4)+p(ct.length,2)+ct}(this.dirRecords.length,b,x,this.zipComment,this.encodeFileName);this.push({data:C,meta:{percent:100}})},D.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},D.prototype.registerPrevious=function(x){this._sources.push(x);var O=this;return x.on("data",function(b){O.processChunk(b)}),x.on("end",function(){O.closedSource(O.previous.streamInfo),O._sources.length?O.prepareNextSource():O.end()}),x.on("error",function(b){O.error(b)}),this},D.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},D.prototype.error=function(x){var O=this._sources;if(!w.prototype.error.call(this,x))return!1;for(var b=0;b<O.length;b++)try{O[b].error(x)}catch{}return!0},D.prototype.lock=function(){w.prototype.lock.call(this);for(var x=this._sources,O=0;O<x.length;O++)x[O].lock()},k.exports=D},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(c,k,_){var p=c("../compressions"),y=c("./ZipFileWorker");_.generateWorker=function(g,w,M){var R=new y(w.streamFiles,M,w.platform,w.encodeFileName),T=0;try{g.forEach(function(D,x){T++;var O=function(I,j){var X=I||j,Y=p[X];if(!Y)throw new Error(X+" is not a valid compression method !");return Y}(x.options.compression,w.compression),b=x.options.compressionOptions||w.compressionOptions||{},C=x.dir,P=x.date;x._compressWorker(O,b).withStreamInfo("file",{name:D,dir:C,date:P,comment:x.comment||"",unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions}).pipe(R)}),R.entriesCount=T}catch(D){R.error(D)}return R}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(c,k,_){function p(){if(!(this instanceof p))return new p;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var y=new p;for(var g in this)typeof this[g]!="function"&&(y[g]=this[g]);return y}}(p.prototype=c("./object")).loadAsync=c("./load"),p.support=c("./support"),p.defaults=c("./defaults"),p.version="3.10.1",p.loadAsync=function(y,g){return new p().loadAsync(y,g)},p.external=c("./external"),k.exports=p},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(c,k,_){var p=c("./utils"),y=c("./external"),g=c("./utf8"),w=c("./zipEntries"),M=c("./stream/Crc32Probe"),R=c("./nodejsUtils");function T(D){return new y.Promise(function(x,O){var b=D.decompressed.getContentWorker().pipe(new M);b.on("error",function(C){O(C)}).on("end",function(){b.streamInfo.crc32!==D.decompressed.crc32?O(new Error("Corrupted zip : CRC32 mismatch")):x()}).resume()})}k.exports=function(D,x){var O=this;return x=p.extend(x||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:g.utf8decode}),R.isNode&&R.isStream(D)?y.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):p.prepareContent("the loaded zip file",D,!0,x.optimizedBinaryString,x.base64).then(function(b){var C=new w(x);return C.load(b),C}).then(function(b){var C=[y.Promise.resolve(b)],P=b.files;if(x.checkCRC32)for(var I=0;I<P.length;I++)C.push(T(P[I]));return y.Promise.all(C)}).then(function(b){for(var C=b.shift(),P=C.files,I=0;I<P.length;I++){var j=P[I],X=j.fileNameStr,Y=p.resolve(j.fileNameStr);O.file(Y,j.decompressed,{binary:!0,optimizedBinaryString:!0,date:j.date,dir:j.dir,comment:j.fileCommentStr.length?j.fileCommentStr:null,unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions,createFolders:x.createFolders}),j.dir||(O.file(Y).unsafeOriginalName=X)}return C.zipComment.length&&(O.comment=C.zipComment),O})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(c,k,_){var p=c("../utils"),y=c("../stream/GenericWorker");function g(w,M){y.call(this,"Nodejs stream input adapter for "+w),this._upstreamEnded=!1,this._bindStream(M)}p.inherits(g,y),g.prototype._bindStream=function(w){var M=this;(this._stream=w).pause(),w.on("data",function(R){M.push({data:R,meta:{percent:0}})}).on("error",function(R){M.isPaused?this.generatedError=R:M.error(R)}).on("end",function(){M.isPaused?M._upstreamEnded=!0:M.end()})},g.prototype.pause=function(){return!!y.prototype.pause.call(this)&&(this._stream.pause(),!0)},g.prototype.resume=function(){return!!y.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},k.exports=g},{"../stream/GenericWorker":28,"../utils":32}],13:[function(c,k,_){var p=c("readable-stream").Readable;function y(g,w,M){p.call(this,w),this._helper=g;var R=this;g.on("data",function(T,D){R.push(T)||R._helper.pause(),M&&M(D)}).on("error",function(T){R.emit("error",T)}).on("end",function(){R.push(null)})}c("../utils").inherits(y,p),y.prototype._read=function(){this._helper.resume()},k.exports=y},{"../utils":32,"readable-stream":16}],14:[function(c,k,_){k.exports={isNode:typeof Buffer<"u",newBufferFrom:function(p,y){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(p,y);if(typeof p=="number")throw new Error('The "data" argument must not be a number');return new Buffer(p,y)},allocBuffer:function(p){if(Buffer.alloc)return Buffer.alloc(p);var y=new Buffer(p);return y.fill(0),y},isBuffer:function(p){return Buffer.isBuffer(p)},isStream:function(p){return p&&typeof p.on=="function"&&typeof p.pause=="function"&&typeof p.resume=="function"}}},{}],15:[function(c,k,_){function p(Y,ct,ot){var wt,at=g.getTypeOf(ct),Tt=g.extend(ot||{},R);Tt.date=Tt.date||new Date,Tt.compression!==null&&(Tt.compression=Tt.compression.toUpperCase()),typeof Tt.unixPermissions=="string"&&(Tt.unixPermissions=parseInt(Tt.unixPermissions,8)),Tt.unixPermissions&&16384&Tt.unixPermissions&&(Tt.dir=!0),Tt.dosPermissions&&16&Tt.dosPermissions&&(Tt.dir=!0),Tt.dir&&(Y=P(Y)),Tt.createFolders&&(wt=C(Y))&&I.call(this,wt,!0);var Rt=at==="string"&&Tt.binary===!1&&Tt.base64===!1;ot&&ot.binary!==void 0||(Tt.binary=!Rt),(ct instanceof T&&ct.uncompressedSize===0||Tt.dir||!ct||ct.length===0)&&(Tt.base64=!1,Tt.binary=!0,ct="",Tt.compression="STORE",at="string");var N=null;N=ct instanceof T||ct instanceof w?ct:O.isNode&&O.isStream(ct)?new b(Y,ct):g.prepareContent(Y,ct,Tt.binary,Tt.optimizedBinaryString,Tt.base64);var lt=new D(Y,N,Tt);this.files[Y]=lt}var y=c("./utf8"),g=c("./utils"),w=c("./stream/GenericWorker"),M=c("./stream/StreamHelper"),R=c("./defaults"),T=c("./compressedObject"),D=c("./zipObject"),x=c("./generate"),O=c("./nodejsUtils"),b=c("./nodejs/NodejsStreamInputAdapter"),C=function(Y){Y.slice(-1)==="/"&&(Y=Y.substring(0,Y.length-1));var ct=Y.lastIndexOf("/");return 0<ct?Y.substring(0,ct):""},P=function(Y){return Y.slice(-1)!=="/"&&(Y+="/"),Y},I=function(Y,ct){return ct=ct!==void 0?ct:R.createFolders,Y=P(Y),this.files[Y]||p.call(this,Y,null,{dir:!0,createFolders:ct}),this.files[Y]};function j(Y){return Object.prototype.toString.call(Y)==="[object RegExp]"}var X={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Y){var ct,ot,wt;for(ct in this.files)wt=this.files[ct],(ot=ct.slice(this.root.length,ct.length))&&ct.slice(0,this.root.length)===this.root&&Y(ot,wt)},filter:function(Y){var ct=[];return this.forEach(function(ot,wt){Y(ot,wt)&&ct.push(wt)}),ct},file:function(Y,ct,ot){if(arguments.length!==1)return Y=this.root+Y,p.call(this,Y,ct,ot),this;if(j(Y)){var wt=Y;return this.filter(function(Tt,Rt){return!Rt.dir&&wt.test(Tt)})}var at=this.files[this.root+Y];return at&&!at.dir?at:null},folder:function(Y){if(!Y)return this;if(j(Y))return this.filter(function(at,Tt){return Tt.dir&&Y.test(at)});var ct=this.root+Y,ot=I.call(this,ct),wt=this.clone();return wt.root=ot.name,wt},remove:function(Y){Y=this.root+Y;var ct=this.files[Y];if(ct||(Y.slice(-1)!=="/"&&(Y+="/"),ct=this.files[Y]),ct&&!ct.dir)delete this.files[Y];else for(var ot=this.filter(function(at,Tt){return Tt.name.slice(0,Y.length)===Y}),wt=0;wt<ot.length;wt++)delete this.files[ot[wt].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Y){var ct,ot={};try{if((ot=g.extend(Y||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:y.utf8encode})).type=ot.type.toLowerCase(),ot.compression=ot.compression.toUpperCase(),ot.type==="binarystring"&&(ot.type="string"),!ot.type)throw new Error("No output type specified.");g.checkSupport(ot.type),ot.platform!=="darwin"&&ot.platform!=="freebsd"&&ot.platform!=="linux"&&ot.platform!=="sunos"||(ot.platform="UNIX"),ot.platform==="win32"&&(ot.platform="DOS");var wt=ot.comment||this.comment||"";ct=x.generateWorker(this,ot,wt)}catch(at){(ct=new w("error")).error(at)}return new M(ct,ot.type||"string",ot.mimeType)},generateAsync:function(Y,ct){return this.generateInternalStream(Y).accumulate(ct)},generateNodeStream:function(Y,ct){return(Y=Y||{}).type||(Y.type="nodebuffer"),this.generateInternalStream(Y).toNodejsStream(ct)}};k.exports=X},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(c,k,_){k.exports=c("stream")},{stream:void 0}],17:[function(c,k,_){var p=c("./DataReader");function y(g){p.call(this,g);for(var w=0;w<this.data.length;w++)g[w]=255&g[w]}c("../utils").inherits(y,p),y.prototype.byteAt=function(g){return this.data[this.zero+g]},y.prototype.lastIndexOfSignature=function(g){for(var w=g.charCodeAt(0),M=g.charCodeAt(1),R=g.charCodeAt(2),T=g.charCodeAt(3),D=this.length-4;0<=D;--D)if(this.data[D]===w&&this.data[D+1]===M&&this.data[D+2]===R&&this.data[D+3]===T)return D-this.zero;return-1},y.prototype.readAndCheckSignature=function(g){var w=g.charCodeAt(0),M=g.charCodeAt(1),R=g.charCodeAt(2),T=g.charCodeAt(3),D=this.readData(4);return w===D[0]&&M===D[1]&&R===D[2]&&T===D[3]},y.prototype.readData=function(g){if(this.checkOffset(g),g===0)return[];var w=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,w},k.exports=y},{"../utils":32,"./DataReader":18}],18:[function(c,k,_){var p=c("../utils");function y(g){this.data=g,this.length=g.length,this.index=0,this.zero=0}y.prototype={checkOffset:function(g){this.checkIndex(this.index+g)},checkIndex:function(g){if(this.length<this.zero+g||g<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+g+"). Corrupted zip ?")},setIndex:function(g){this.checkIndex(g),this.index=g},skip:function(g){this.setIndex(this.index+g)},byteAt:function(){},readInt:function(g){var w,M=0;for(this.checkOffset(g),w=this.index+g-1;w>=this.index;w--)M=(M<<8)+this.byteAt(w);return this.index+=g,M},readString:function(g){return p.transformTo("string",this.readData(g))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var g=this.readInt(4);return new Date(Date.UTC(1980+(g>>25&127),(g>>21&15)-1,g>>16&31,g>>11&31,g>>5&63,(31&g)<<1))}},k.exports=y},{"../utils":32}],19:[function(c,k,_){var p=c("./Uint8ArrayReader");function y(g){p.call(this,g)}c("../utils").inherits(y,p),y.prototype.readData=function(g){this.checkOffset(g);var w=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,w},k.exports=y},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(c,k,_){var p=c("./DataReader");function y(g){p.call(this,g)}c("../utils").inherits(y,p),y.prototype.byteAt=function(g){return this.data.charCodeAt(this.zero+g)},y.prototype.lastIndexOfSignature=function(g){return this.data.lastIndexOf(g)-this.zero},y.prototype.readAndCheckSignature=function(g){return g===this.readData(4)},y.prototype.readData=function(g){this.checkOffset(g);var w=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,w},k.exports=y},{"../utils":32,"./DataReader":18}],21:[function(c,k,_){var p=c("./ArrayReader");function y(g){p.call(this,g)}c("../utils").inherits(y,p),y.prototype.readData=function(g){if(this.checkOffset(g),g===0)return new Uint8Array(0);var w=this.data.subarray(this.zero+this.index,this.zero+this.index+g);return this.index+=g,w},k.exports=y},{"../utils":32,"./ArrayReader":17}],22:[function(c,k,_){var p=c("../utils"),y=c("../support"),g=c("./ArrayReader"),w=c("./StringReader"),M=c("./NodeBufferReader"),R=c("./Uint8ArrayReader");k.exports=function(T){var D=p.getTypeOf(T);return p.checkSupport(D),D!=="string"||y.uint8array?D==="nodebuffer"?new M(T):y.uint8array?new R(p.transformTo("uint8array",T)):new g(p.transformTo("array",T)):new w(T)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(c,k,_){_.LOCAL_FILE_HEADER="PK",_.CENTRAL_FILE_HEADER="PK",_.CENTRAL_DIRECTORY_END="PK",_.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",_.ZIP64_CENTRAL_DIRECTORY_END="PK",_.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(c,k,_){var p=c("./GenericWorker"),y=c("../utils");function g(w){p.call(this,"ConvertWorker to "+w),this.destType=w}y.inherits(g,p),g.prototype.processChunk=function(w){this.push({data:y.transformTo(this.destType,w.data),meta:w.meta})},k.exports=g},{"../utils":32,"./GenericWorker":28}],25:[function(c,k,_){var p=c("./GenericWorker"),y=c("../crc32");function g(){p.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}c("../utils").inherits(g,p),g.prototype.processChunk=function(w){this.streamInfo.crc32=y(w.data,this.streamInfo.crc32||0),this.push(w)},k.exports=g},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(c,k,_){var p=c("../utils"),y=c("./GenericWorker");function g(w){y.call(this,"DataLengthProbe for "+w),this.propName=w,this.withStreamInfo(w,0)}p.inherits(g,y),g.prototype.processChunk=function(w){if(w){var M=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=M+w.data.length}y.prototype.processChunk.call(this,w)},k.exports=g},{"../utils":32,"./GenericWorker":28}],27:[function(c,k,_){var p=c("../utils"),y=c("./GenericWorker");function g(w){y.call(this,"DataWorker");var M=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,w.then(function(R){M.dataIsReady=!0,M.data=R,M.max=R&&R.length||0,M.type=p.getTypeOf(R),M.isPaused||M._tickAndRepeat()},function(R){M.error(R)})}p.inherits(g,y),g.prototype.cleanUp=function(){y.prototype.cleanUp.call(this),this.data=null},g.prototype.resume=function(){return!!y.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,p.delay(this._tickAndRepeat,[],this)),!0)},g.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(p.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},g.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var w=null,M=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":w=this.data.substring(this.index,M);break;case"uint8array":w=this.data.subarray(this.index,M);break;case"array":case"nodebuffer":w=this.data.slice(this.index,M)}return this.index=M,this.push({data:w,meta:{percent:this.max?this.index/this.max*100:0}})},k.exports=g},{"../utils":32,"./GenericWorker":28}],28:[function(c,k,_){function p(y){this.name=y||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}p.prototype={push:function(y){this.emit("data",y)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(y){this.emit("error",y)}return!0},error:function(y){return!this.isFinished&&(this.isPaused?this.generatedError=y:(this.isFinished=!0,this.emit("error",y),this.previous&&this.previous.error(y),this.cleanUp()),!0)},on:function(y,g){return this._listeners[y].push(g),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(y,g){if(this._listeners[y])for(var w=0;w<this._listeners[y].length;w++)this._listeners[y][w].call(this,g)},pipe:function(y){return y.registerPrevious(this)},registerPrevious:function(y){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=y.streamInfo,this.mergeStreamInfo(),this.previous=y;var g=this;return y.on("data",function(w){g.processChunk(w)}),y.on("end",function(){g.end()}),y.on("error",function(w){g.error(w)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var y=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),y=!0),this.previous&&this.previous.resume(),!y},flush:function(){},processChunk:function(y){this.push(y)},withStreamInfo:function(y,g){return this.extraStreamInfo[y]=g,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var y in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,y)&&(this.streamInfo[y]=this.extraStreamInfo[y])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var y="Worker "+this.name;return this.previous?this.previous+" -> "+y:y}},k.exports=p},{}],29:[function(c,k,_){var p=c("../utils"),y=c("./ConvertWorker"),g=c("./GenericWorker"),w=c("../base64"),M=c("../support"),R=c("../external"),T=null;if(M.nodestream)try{T=c("../nodejs/NodejsStreamOutputAdapter")}catch{}function D(O,b){return new R.Promise(function(C,P){var I=[],j=O._internalType,X=O._outputType,Y=O._mimeType;O.on("data",function(ct,ot){I.push(ct),b&&b(ot)}).on("error",function(ct){I=[],P(ct)}).on("end",function(){try{var ct=function(ot,wt,at){switch(ot){case"blob":return p.newBlob(p.transformTo("arraybuffer",wt),at);case"base64":return w.encode(wt);default:return p.transformTo(ot,wt)}}(X,function(ot,wt){var at,Tt=0,Rt=null,N=0;for(at=0;at<wt.length;at++)N+=wt[at].length;switch(ot){case"string":return wt.join("");case"array":return Array.prototype.concat.apply([],wt);case"uint8array":for(Rt=new Uint8Array(N),at=0;at<wt.length;at++)Rt.set(wt[at],Tt),Tt+=wt[at].length;return Rt;case"nodebuffer":return Buffer.concat(wt);default:throw new Error("concat : unsupported type '"+ot+"'")}}(j,I),Y);C(ct)}catch(ot){P(ot)}I=[]}).resume()})}function x(O,b,C){var P=b;switch(b){case"blob":case"arraybuffer":P="uint8array";break;case"base64":P="string"}try{this._internalType=P,this._outputType=b,this._mimeType=C,p.checkSupport(P),this._worker=O.pipe(new y(P)),O.lock()}catch(I){this._worker=new g("error"),this._worker.error(I)}}x.prototype={accumulate:function(O){return D(this,O)},on:function(O,b){var C=this;return O==="data"?this._worker.on(O,function(P){b.call(C,P.data,P.meta)}):this._worker.on(O,function(){p.delay(b,arguments,C)}),this},resume:function(){return p.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(O){if(p.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new T(this,{objectMode:this._outputType!=="nodebuffer"},O)}},k.exports=x},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(c,k,_){if(_.base64=!0,_.array=!0,_.string=!0,_.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",_.nodebuffer=typeof Buffer<"u",_.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")_.blob=!1;else{var p=new ArrayBuffer(0);try{_.blob=new Blob([p],{type:"application/zip"}).size===0}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);y.append(p),_.blob=y.getBlob("application/zip").size===0}catch{_.blob=!1}}}try{_.nodestream=!!c("readable-stream").Readable}catch{_.nodestream=!1}},{"readable-stream":16}],31:[function(c,k,_){for(var p=c("./utils"),y=c("./support"),g=c("./nodejsUtils"),w=c("./stream/GenericWorker"),M=new Array(256),R=0;R<256;R++)M[R]=252<=R?6:248<=R?5:240<=R?4:224<=R?3:192<=R?2:1;M[254]=M[254]=1;function T(){w.call(this,"utf-8 decode"),this.leftOver=null}function D(){w.call(this,"utf-8 encode")}_.utf8encode=function(x){return y.nodebuffer?g.newBufferFrom(x,"utf-8"):function(O){var b,C,P,I,j,X=O.length,Y=0;for(I=0;I<X;I++)(64512&(C=O.charCodeAt(I)))==55296&&I+1<X&&(64512&(P=O.charCodeAt(I+1)))==56320&&(C=65536+(C-55296<<10)+(P-56320),I++),Y+=C<128?1:C<2048?2:C<65536?3:4;for(b=y.uint8array?new Uint8Array(Y):new Array(Y),I=j=0;j<Y;I++)(64512&(C=O.charCodeAt(I)))==55296&&I+1<X&&(64512&(P=O.charCodeAt(I+1)))==56320&&(C=65536+(C-55296<<10)+(P-56320),I++),C<128?b[j++]=C:(C<2048?b[j++]=192|C>>>6:(C<65536?b[j++]=224|C>>>12:(b[j++]=240|C>>>18,b[j++]=128|C>>>12&63),b[j++]=128|C>>>6&63),b[j++]=128|63&C);return b}(x)},_.utf8decode=function(x){return y.nodebuffer?p.transformTo("nodebuffer",x).toString("utf-8"):function(O){var b,C,P,I,j=O.length,X=new Array(2*j);for(b=C=0;b<j;)if((P=O[b++])<128)X[C++]=P;else if(4<(I=M[P]))X[C++]=65533,b+=I-1;else{for(P&=I===2?31:I===3?15:7;1<I&&b<j;)P=P<<6|63&O[b++],I--;1<I?X[C++]=65533:P<65536?X[C++]=P:(P-=65536,X[C++]=55296|P>>10&1023,X[C++]=56320|1023&P)}return X.length!==C&&(X.subarray?X=X.subarray(0,C):X.length=C),p.applyFromCharCode(X)}(x=p.transformTo(y.uint8array?"uint8array":"array",x))},p.inherits(T,w),T.prototype.processChunk=function(x){var O=p.transformTo(y.uint8array?"uint8array":"array",x.data);if(this.leftOver&&this.leftOver.length){if(y.uint8array){var b=O;(O=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),O.set(b,this.leftOver.length)}else O=this.leftOver.concat(O);this.leftOver=null}var C=function(I,j){var X;for((j=j||I.length)>I.length&&(j=I.length),X=j-1;0<=X&&(192&I[X])==128;)X--;return X<0||X===0?j:X+M[I[X]]>j?X:j}(O),P=O;C!==O.length&&(y.uint8array?(P=O.subarray(0,C),this.leftOver=O.subarray(C,O.length)):(P=O.slice(0,C),this.leftOver=O.slice(C,O.length))),this.push({data:_.utf8decode(P),meta:x.meta})},T.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:_.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},_.Utf8DecodeWorker=T,p.inherits(D,w),D.prototype.processChunk=function(x){this.push({data:_.utf8encode(x.data),meta:x.meta})},_.Utf8EncodeWorker=D},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(c,k,_){var p=c("./support"),y=c("./base64"),g=c("./nodejsUtils"),w=c("./external");function M(b){return b}function R(b,C){for(var P=0;P<b.length;++P)C[P]=255&b.charCodeAt(P);return C}c("setimmediate"),_.newBlob=function(b,C){_.checkSupport("blob");try{return new Blob([b],{type:C})}catch{try{var P=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return P.append(b),P.getBlob(C)}catch{throw new Error("Bug : can't construct the Blob.")}}};var T={stringifyByChunk:function(b,C,P){var I=[],j=0,X=b.length;if(X<=P)return String.fromCharCode.apply(null,b);for(;j<X;)C==="array"||C==="nodebuffer"?I.push(String.fromCharCode.apply(null,b.slice(j,Math.min(j+P,X)))):I.push(String.fromCharCode.apply(null,b.subarray(j,Math.min(j+P,X)))),j+=P;return I.join("")},stringifyByChar:function(b){for(var C="",P=0;P<b.length;P++)C+=String.fromCharCode(b[P]);return C},applyCanBeUsed:{uint8array:function(){try{return p.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return p.nodebuffer&&String.fromCharCode.apply(null,g.allocBuffer(1)).length===1}catch{return!1}}()}};function D(b){var C=65536,P=_.getTypeOf(b),I=!0;if(P==="uint8array"?I=T.applyCanBeUsed.uint8array:P==="nodebuffer"&&(I=T.applyCanBeUsed.nodebuffer),I)for(;1<C;)try{return T.stringifyByChunk(b,P,C)}catch{C=Math.floor(C/2)}return T.stringifyByChar(b)}function x(b,C){for(var P=0;P<b.length;P++)C[P]=b[P];return C}_.applyFromCharCode=D;var O={};O.string={string:M,array:function(b){return R(b,new Array(b.length))},arraybuffer:function(b){return O.string.uint8array(b).buffer},uint8array:function(b){return R(b,new Uint8Array(b.length))},nodebuffer:function(b){return R(b,g.allocBuffer(b.length))}},O.array={string:D,array:M,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return g.newBufferFrom(b)}},O.arraybuffer={string:function(b){return D(new Uint8Array(b))},array:function(b){return x(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:M,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return g.newBufferFrom(new Uint8Array(b))}},O.uint8array={string:D,array:function(b){return x(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:M,nodebuffer:function(b){return g.newBufferFrom(b)}},O.nodebuffer={string:D,array:function(b){return x(b,new Array(b.length))},arraybuffer:function(b){return O.nodebuffer.uint8array(b).buffer},uint8array:function(b){return x(b,new Uint8Array(b.length))},nodebuffer:M},_.transformTo=function(b,C){if(C=C||"",!b)return C;_.checkSupport(b);var P=_.getTypeOf(C);return O[P][b](C)},_.resolve=function(b){for(var C=b.split("/"),P=[],I=0;I<C.length;I++){var j=C[I];j==="."||j===""&&I!==0&&I!==C.length-1||(j===".."?P.pop():P.push(j))}return P.join("/")},_.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":p.nodebuffer&&g.isBuffer(b)?"nodebuffer":p.uint8array&&b instanceof Uint8Array?"uint8array":p.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},_.checkSupport=function(b){if(!p[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},_.MAX_VALUE_16BITS=65535,_.MAX_VALUE_32BITS=-1,_.pretty=function(b){var C,P,I="";for(P=0;P<(b||"").length;P++)I+="\\x"+((C=b.charCodeAt(P))<16?"0":"")+C.toString(16).toUpperCase();return I},_.delay=function(b,C,P){setImmediate(function(){b.apply(P||null,C||[])})},_.inherits=function(b,C){function P(){}P.prototype=C.prototype,b.prototype=new P},_.extend=function(){var b,C,P={};for(b=0;b<arguments.length;b++)for(C in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],C)&&P[C]===void 0&&(P[C]=arguments[b][C]);return P},_.prepareContent=function(b,C,P,I,j){return w.Promise.resolve(C).then(function(X){return p.blob&&(X instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(X))!==-1)&&typeof FileReader<"u"?new w.Promise(function(Y,ct){var ot=new FileReader;ot.onload=function(wt){Y(wt.target.result)},ot.onerror=function(wt){ct(wt.target.error)},ot.readAsArrayBuffer(X)}):X}).then(function(X){var Y=_.getTypeOf(X);return Y?(Y==="arraybuffer"?X=_.transformTo("uint8array",X):Y==="string"&&(j?X=y.decode(X):P&&I!==!0&&(X=function(ct){return R(ct,p.uint8array?new Uint8Array(ct.length):new Array(ct.length))}(X))),X):w.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(c,k,_){var p=c("./reader/readerFor"),y=c("./utils"),g=c("./signature"),w=c("./zipEntry"),M=c("./support");function R(T){this.files=[],this.loadOptions=T}R.prototype={checkSignature:function(T){if(!this.reader.readAndCheckSignature(T)){this.reader.index-=4;var D=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+y.pretty(D)+", expected "+y.pretty(T)+")")}},isSignature:function(T,D){var x=this.reader.index;this.reader.setIndex(T);var O=this.reader.readString(4)===D;return this.reader.setIndex(x),O},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var T=this.reader.readData(this.zipCommentLength),D=M.uint8array?"uint8array":"array",x=y.transformTo(D,T);this.zipComment=this.loadOptions.decodeFileName(x)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var T,D,x,O=this.zip64EndOfCentralSize-44;0<O;)T=this.reader.readInt(2),D=this.reader.readInt(4),x=this.reader.readData(D),this.zip64ExtensibleData[T]={id:T,length:D,value:x}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var T,D;for(T=0;T<this.files.length;T++)D=this.files[T],this.reader.setIndex(D.localHeaderOffset),this.checkSignature(g.LOCAL_FILE_HEADER),D.readLocalPart(this.reader),D.handleUTF8(),D.processAttributes()},readCentralDir:function(){var T;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(g.CENTRAL_FILE_HEADER);)(T=new w({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(T);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var T=this.reader.lastIndexOfSignature(g.CENTRAL_DIRECTORY_END);if(T<0)throw this.isSignature(0,g.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(T);var D=T;if(this.checkSignature(g.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===y.MAX_VALUE_16BITS||this.diskWithCentralDirStart===y.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===y.MAX_VALUE_16BITS||this.centralDirRecords===y.MAX_VALUE_16BITS||this.centralDirSize===y.MAX_VALUE_32BITS||this.centralDirOffset===y.MAX_VALUE_32BITS){if(this.zip64=!0,(T=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(T),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,g.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var x=this.centralDirOffset+this.centralDirSize;this.zip64&&(x+=20,x+=12+this.zip64EndOfCentralSize);var O=D-x;if(0<O)this.isSignature(D,g.CENTRAL_FILE_HEADER)||(this.reader.zero=O);else if(O<0)throw new Error("Corrupted zip: missing "+Math.abs(O)+" bytes.")},prepareReader:function(T){this.reader=p(T)},load:function(T){this.prepareReader(T),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},k.exports=R},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(c,k,_){var p=c("./reader/readerFor"),y=c("./utils"),g=c("./compressedObject"),w=c("./crc32"),M=c("./utf8"),R=c("./compressions"),T=c("./support");function D(x,O){this.options=x,this.loadOptions=O}D.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(x){var O,b;if(x.skip(22),this.fileNameLength=x.readInt(2),b=x.readInt(2),this.fileName=x.readData(this.fileNameLength),x.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((O=function(C){for(var P in R)if(Object.prototype.hasOwnProperty.call(R,P)&&R[P].magic===C)return R[P];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+y.pretty(this.compressionMethod)+" unknown (inner file : "+y.transformTo("string",this.fileName)+")");this.decompressed=new g(this.compressedSize,this.uncompressedSize,this.crc32,O,x.readData(this.compressedSize))},readCentralPart:function(x){this.versionMadeBy=x.readInt(2),x.skip(2),this.bitFlag=x.readInt(2),this.compressionMethod=x.readString(2),this.date=x.readDate(),this.crc32=x.readInt(4),this.compressedSize=x.readInt(4),this.uncompressedSize=x.readInt(4);var O=x.readInt(2);if(this.extraFieldsLength=x.readInt(2),this.fileCommentLength=x.readInt(2),this.diskNumberStart=x.readInt(2),this.internalFileAttributes=x.readInt(2),this.externalFileAttributes=x.readInt(4),this.localHeaderOffset=x.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");x.skip(O),this.readExtraFields(x),this.parseZIP64ExtraField(x),this.fileComment=x.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var x=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),x==0&&(this.dosPermissions=63&this.externalFileAttributes),x==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var x=p(this.extraFields[1].value);this.uncompressedSize===y.MAX_VALUE_32BITS&&(this.uncompressedSize=x.readInt(8)),this.compressedSize===y.MAX_VALUE_32BITS&&(this.compressedSize=x.readInt(8)),this.localHeaderOffset===y.MAX_VALUE_32BITS&&(this.localHeaderOffset=x.readInt(8)),this.diskNumberStart===y.MAX_VALUE_32BITS&&(this.diskNumberStart=x.readInt(4))}},readExtraFields:function(x){var O,b,C,P=x.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});x.index+4<P;)O=x.readInt(2),b=x.readInt(2),C=x.readData(b),this.extraFields[O]={id:O,length:b,value:C};x.setIndex(P)},handleUTF8:function(){var x=T.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=M.utf8decode(this.fileName),this.fileCommentStr=M.utf8decode(this.fileComment);else{var O=this.findExtraFieldUnicodePath();if(O!==null)this.fileNameStr=O;else{var b=y.transformTo(x,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var C=this.findExtraFieldUnicodeComment();if(C!==null)this.fileCommentStr=C;else{var P=y.transformTo(x,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(P)}}},findExtraFieldUnicodePath:function(){var x=this.extraFields[28789];if(x){var O=p(x.value);return O.readInt(1)!==1||w(this.fileName)!==O.readInt(4)?null:M.utf8decode(O.readData(x.length-5))}return null},findExtraFieldUnicodeComment:function(){var x=this.extraFields[25461];if(x){var O=p(x.value);return O.readInt(1)!==1||w(this.fileComment)!==O.readInt(4)?null:M.utf8decode(O.readData(x.length-5))}return null}},k.exports=D},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(c,k,_){function p(O,b,C){this.name=O,this.dir=C.dir,this.date=C.date,this.comment=C.comment,this.unixPermissions=C.unixPermissions,this.dosPermissions=C.dosPermissions,this._data=b,this._dataBinary=C.binary,this.options={compression:C.compression,compressionOptions:C.compressionOptions}}var y=c("./stream/StreamHelper"),g=c("./stream/DataWorker"),w=c("./utf8"),M=c("./compressedObject"),R=c("./stream/GenericWorker");p.prototype={internalStream:function(O){var b=null,C="string";try{if(!O)throw new Error("No output type specified.");var P=(C=O.toLowerCase())==="string"||C==="text";C!=="binarystring"&&C!=="text"||(C="string"),b=this._decompressWorker();var I=!this._dataBinary;I&&!P&&(b=b.pipe(new w.Utf8EncodeWorker)),!I&&P&&(b=b.pipe(new w.Utf8DecodeWorker))}catch(j){(b=new R("error")).error(j)}return new y(b,C,"")},async:function(O,b){return this.internalStream(O).accumulate(b)},nodeStream:function(O,b){return this.internalStream(O||"nodebuffer").toNodejsStream(b)},_compressWorker:function(O,b){if(this._data instanceof M&&this._data.compression.magic===O.magic)return this._data.getCompressedWorker();var C=this._decompressWorker();return this._dataBinary||(C=C.pipe(new w.Utf8EncodeWorker)),M.createWorkerFrom(C,O,b)},_decompressWorker:function(){return this._data instanceof M?this._data.getContentWorker():this._data instanceof R?this._data:new g(this._data)}};for(var T=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],D=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},x=0;x<T.length;x++)p.prototype[T[x]]=D;k.exports=p},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(c,k,_){(function(p){var y,g,w=p.MutationObserver||p.WebKitMutationObserver;if(w){var M=0,R=new w(O),T=p.document.createTextNode("");R.observe(T,{characterData:!0}),y=function(){T.data=M=++M%2}}else if(p.setImmediate||p.MessageChannel===void 0)y="document"in p&&"onreadystatechange"in p.document.createElement("script")?function(){var b=p.document.createElement("script");b.onreadystatechange=function(){O(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},p.document.documentElement.appendChild(b)}:function(){setTimeout(O,0)};else{var D=new p.MessageChannel;D.port1.onmessage=O,y=function(){D.port2.postMessage(0)}}var x=[];function O(){var b,C;g=!0;for(var P=x.length;P;){for(C=x,x=[],b=-1;++b<P;)C[b]();P=x.length}g=!1}k.exports=function(b){x.push(b)!==1||g||y()}}).call(this,typeof Ti<"u"?Ti:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(c,k,_){var p=c("immediate");function y(){}var g={},w=["REJECTED"],M=["FULFILLED"],R=["PENDING"];function T(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=R,this.queue=[],this.outcome=void 0,P!==y&&b(this,P)}function D(P,I,j){this.promise=P,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof j=="function"&&(this.onRejected=j,this.callRejected=this.otherCallRejected)}function x(P,I,j){p(function(){var X;try{X=I(j)}catch(Y){return g.reject(P,Y)}X===P?g.reject(P,new TypeError("Cannot resolve promise with itself")):g.resolve(P,X)})}function O(P){var I=P&&P.then;if(P&&(typeof P=="object"||typeof P=="function")&&typeof I=="function")return function(){I.apply(P,arguments)}}function b(P,I){var j=!1;function X(ot){j||(j=!0,g.reject(P,ot))}function Y(ot){j||(j=!0,g.resolve(P,ot))}var ct=C(function(){I(Y,X)});ct.status==="error"&&X(ct.value)}function C(P,I){var j={};try{j.value=P(I),j.status="success"}catch(X){j.status="error",j.value=X}return j}(k.exports=T).prototype.finally=function(P){if(typeof P!="function")return this;var I=this.constructor;return this.then(function(j){return I.resolve(P()).then(function(){return j})},function(j){return I.resolve(P()).then(function(){throw j})})},T.prototype.catch=function(P){return this.then(null,P)},T.prototype.then=function(P,I){if(typeof P!="function"&&this.state===M||typeof I!="function"&&this.state===w)return this;var j=new this.constructor(y);return this.state!==R?x(j,this.state===M?P:I,this.outcome):this.queue.push(new D(j,P,I)),j},D.prototype.callFulfilled=function(P){g.resolve(this.promise,P)},D.prototype.otherCallFulfilled=function(P){x(this.promise,this.onFulfilled,P)},D.prototype.callRejected=function(P){g.reject(this.promise,P)},D.prototype.otherCallRejected=function(P){x(this.promise,this.onRejected,P)},g.resolve=function(P,I){var j=C(O,I);if(j.status==="error")return g.reject(P,j.value);var X=j.value;if(X)b(P,X);else{P.state=M,P.outcome=I;for(var Y=-1,ct=P.queue.length;++Y<ct;)P.queue[Y].callFulfilled(I)}return P},g.reject=function(P,I){P.state=w,P.outcome=I;for(var j=-1,X=P.queue.length;++j<X;)P.queue[j].callRejected(I);return P},T.resolve=function(P){return P instanceof this?P:g.resolve(new this(y),P)},T.reject=function(P){var I=new this(y);return g.reject(I,P)},T.all=function(P){var I=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=P.length,X=!1;if(!j)return this.resolve([]);for(var Y=new Array(j),ct=0,ot=-1,wt=new this(y);++ot<j;)at(P[ot],ot);return wt;function at(Tt,Rt){I.resolve(Tt).then(function(N){Y[Rt]=N,++ct!==j||X||(X=!0,g.resolve(wt,Y))},function(N){X||(X=!0,g.reject(wt,N))})}},T.race=function(P){var I=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=P.length,X=!1;if(!j)return this.resolve([]);for(var Y=-1,ct=new this(y);++Y<j;)ot=P[Y],I.resolve(ot).then(function(wt){X||(X=!0,g.resolve(ct,wt))},function(wt){X||(X=!0,g.reject(ct,wt))});var ot;return ct}},{immediate:36}],38:[function(c,k,_){var p={};(0,c("./lib/utils/common").assign)(p,c("./lib/deflate"),c("./lib/inflate"),c("./lib/zlib/constants")),k.exports=p},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(c,k,_){var p=c("./zlib/deflate"),y=c("./utils/common"),g=c("./utils/strings"),w=c("./zlib/messages"),M=c("./zlib/zstream"),R=Object.prototype.toString,T=0,D=-1,x=0,O=8;function b(P){if(!(this instanceof b))return new b(P);this.options=y.assign({level:D,method:O,chunkSize:16384,windowBits:15,memLevel:8,strategy:x,to:""},P||{});var I=this.options;I.raw&&0<I.windowBits?I.windowBits=-I.windowBits:I.gzip&&0<I.windowBits&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var j=p.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(j!==T)throw new Error(w[j]);if(I.header&&p.deflateSetHeader(this.strm,I.header),I.dictionary){var X;if(X=typeof I.dictionary=="string"?g.string2buf(I.dictionary):R.call(I.dictionary)==="[object ArrayBuffer]"?new Uint8Array(I.dictionary):I.dictionary,(j=p.deflateSetDictionary(this.strm,X))!==T)throw new Error(w[j]);this._dict_set=!0}}function C(P,I){var j=new b(I);if(j.push(P,!0),j.err)throw j.msg||w[j.err];return j.result}b.prototype.push=function(P,I){var j,X,Y=this.strm,ct=this.options.chunkSize;if(this.ended)return!1;X=I===~~I?I:I===!0?4:0,typeof P=="string"?Y.input=g.string2buf(P):R.call(P)==="[object ArrayBuffer]"?Y.input=new Uint8Array(P):Y.input=P,Y.next_in=0,Y.avail_in=Y.input.length;do{if(Y.avail_out===0&&(Y.output=new y.Buf8(ct),Y.next_out=0,Y.avail_out=ct),(j=p.deflate(Y,X))!==1&&j!==T)return this.onEnd(j),!(this.ended=!0);Y.avail_out!==0&&(Y.avail_in!==0||X!==4&&X!==2)||(this.options.to==="string"?this.onData(g.buf2binstring(y.shrinkBuf(Y.output,Y.next_out))):this.onData(y.shrinkBuf(Y.output,Y.next_out)))}while((0<Y.avail_in||Y.avail_out===0)&&j!==1);return X===4?(j=p.deflateEnd(this.strm),this.onEnd(j),this.ended=!0,j===T):X!==2||(this.onEnd(T),!(Y.avail_out=0))},b.prototype.onData=function(P){this.chunks.push(P)},b.prototype.onEnd=function(P){P===T&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg},_.Deflate=b,_.deflate=C,_.deflateRaw=function(P,I){return(I=I||{}).raw=!0,C(P,I)},_.gzip=function(P,I){return(I=I||{}).gzip=!0,C(P,I)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(c,k,_){var p=c("./zlib/inflate"),y=c("./utils/common"),g=c("./utils/strings"),w=c("./zlib/constants"),M=c("./zlib/messages"),R=c("./zlib/zstream"),T=c("./zlib/gzheader"),D=Object.prototype.toString;function x(b){if(!(this instanceof x))return new x(b);this.options=y.assign({chunkSize:16384,windowBits:0,to:""},b||{});var C=this.options;C.raw&&0<=C.windowBits&&C.windowBits<16&&(C.windowBits=-C.windowBits,C.windowBits===0&&(C.windowBits=-15)),!(0<=C.windowBits&&C.windowBits<16)||b&&b.windowBits||(C.windowBits+=32),15<C.windowBits&&C.windowBits<48&&!(15&C.windowBits)&&(C.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new R,this.strm.avail_out=0;var P=p.inflateInit2(this.strm,C.windowBits);if(P!==w.Z_OK)throw new Error(M[P]);this.header=new T,p.inflateGetHeader(this.strm,this.header)}function O(b,C){var P=new x(C);if(P.push(b,!0),P.err)throw P.msg||M[P.err];return P.result}x.prototype.push=function(b,C){var P,I,j,X,Y,ct,ot=this.strm,wt=this.options.chunkSize,at=this.options.dictionary,Tt=!1;if(this.ended)return!1;I=C===~~C?C:C===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof b=="string"?ot.input=g.binstring2buf(b):D.call(b)==="[object ArrayBuffer]"?ot.input=new Uint8Array(b):ot.input=b,ot.next_in=0,ot.avail_in=ot.input.length;do{if(ot.avail_out===0&&(ot.output=new y.Buf8(wt),ot.next_out=0,ot.avail_out=wt),(P=p.inflate(ot,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&at&&(ct=typeof at=="string"?g.string2buf(at):D.call(at)==="[object ArrayBuffer]"?new Uint8Array(at):at,P=p.inflateSetDictionary(this.strm,ct)),P===w.Z_BUF_ERROR&&Tt===!0&&(P=w.Z_OK,Tt=!1),P!==w.Z_STREAM_END&&P!==w.Z_OK)return this.onEnd(P),!(this.ended=!0);ot.next_out&&(ot.avail_out!==0&&P!==w.Z_STREAM_END&&(ot.avail_in!==0||I!==w.Z_FINISH&&I!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(j=g.utf8border(ot.output,ot.next_out),X=ot.next_out-j,Y=g.buf2string(ot.output,j),ot.next_out=X,ot.avail_out=wt-X,X&&y.arraySet(ot.output,ot.output,j,X,0),this.onData(Y)):this.onData(y.shrinkBuf(ot.output,ot.next_out)))),ot.avail_in===0&&ot.avail_out===0&&(Tt=!0)}while((0<ot.avail_in||ot.avail_out===0)&&P!==w.Z_STREAM_END);return P===w.Z_STREAM_END&&(I=w.Z_FINISH),I===w.Z_FINISH?(P=p.inflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===w.Z_OK):I!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),!(ot.avail_out=0))},x.prototype.onData=function(b){this.chunks.push(b)},x.prototype.onEnd=function(b){b===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},_.Inflate=x,_.inflate=O,_.inflateRaw=function(b,C){return(C=C||{}).raw=!0,O(b,C)},_.ungzip=O},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(c,k,_){var p=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";_.assign=function(w){for(var M=Array.prototype.slice.call(arguments,1);M.length;){var R=M.shift();if(R){if(typeof R!="object")throw new TypeError(R+"must be non-object");for(var T in R)R.hasOwnProperty(T)&&(w[T]=R[T])}}return w},_.shrinkBuf=function(w,M){return w.length===M?w:w.subarray?w.subarray(0,M):(w.length=M,w)};var y={arraySet:function(w,M,R,T,D){if(M.subarray&&w.subarray)w.set(M.subarray(R,R+T),D);else for(var x=0;x<T;x++)w[D+x]=M[R+x]},flattenChunks:function(w){var M,R,T,D,x,O;for(M=T=0,R=w.length;M<R;M++)T+=w[M].length;for(O=new Uint8Array(T),M=D=0,R=w.length;M<R;M++)x=w[M],O.set(x,D),D+=x.length;return O}},g={arraySet:function(w,M,R,T,D){for(var x=0;x<T;x++)w[D+x]=M[R+x]},flattenChunks:function(w){return[].concat.apply([],w)}};_.setTyped=function(w){w?(_.Buf8=Uint8Array,_.Buf16=Uint16Array,_.Buf32=Int32Array,_.assign(_,y)):(_.Buf8=Array,_.Buf16=Array,_.Buf32=Array,_.assign(_,g))},_.setTyped(p)},{}],42:[function(c,k,_){var p=c("./common"),y=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch{y=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{g=!1}for(var w=new p.Buf8(256),M=0;M<256;M++)w[M]=252<=M?6:248<=M?5:240<=M?4:224<=M?3:192<=M?2:1;function R(T,D){if(D<65537&&(T.subarray&&g||!T.subarray&&y))return String.fromCharCode.apply(null,p.shrinkBuf(T,D));for(var x="",O=0;O<D;O++)x+=String.fromCharCode(T[O]);return x}w[254]=w[254]=1,_.string2buf=function(T){var D,x,O,b,C,P=T.length,I=0;for(b=0;b<P;b++)(64512&(x=T.charCodeAt(b)))==55296&&b+1<P&&(64512&(O=T.charCodeAt(b+1)))==56320&&(x=65536+(x-55296<<10)+(O-56320),b++),I+=x<128?1:x<2048?2:x<65536?3:4;for(D=new p.Buf8(I),b=C=0;C<I;b++)(64512&(x=T.charCodeAt(b)))==55296&&b+1<P&&(64512&(O=T.charCodeAt(b+1)))==56320&&(x=65536+(x-55296<<10)+(O-56320),b++),x<128?D[C++]=x:(x<2048?D[C++]=192|x>>>6:(x<65536?D[C++]=224|x>>>12:(D[C++]=240|x>>>18,D[C++]=128|x>>>12&63),D[C++]=128|x>>>6&63),D[C++]=128|63&x);return D},_.buf2binstring=function(T){return R(T,T.length)},_.binstring2buf=function(T){for(var D=new p.Buf8(T.length),x=0,O=D.length;x<O;x++)D[x]=T.charCodeAt(x);return D},_.buf2string=function(T,D){var x,O,b,C,P=D||T.length,I=new Array(2*P);for(x=O=0;x<P;)if((b=T[x++])<128)I[O++]=b;else if(4<(C=w[b]))I[O++]=65533,x+=C-1;else{for(b&=C===2?31:C===3?15:7;1<C&&x<P;)b=b<<6|63&T[x++],C--;1<C?I[O++]=65533:b<65536?I[O++]=b:(b-=65536,I[O++]=55296|b>>10&1023,I[O++]=56320|1023&b)}return R(I,O)},_.utf8border=function(T,D){var x;for((D=D||T.length)>T.length&&(D=T.length),x=D-1;0<=x&&(192&T[x])==128;)x--;return x<0||x===0?D:x+w[T[x]]>D?x:D}},{"./common":41}],43:[function(c,k,_){k.exports=function(p,y,g,w){for(var M=65535&p|0,R=p>>>16&65535|0,T=0;g!==0;){for(g-=T=2e3<g?2e3:g;R=R+(M=M+y[w++]|0)|0,--T;);M%=65521,R%=65521}return M|R<<16|0}},{}],44:[function(c,k,_){k.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(c,k,_){var p=function(){for(var y,g=[],w=0;w<256;w++){y=w;for(var M=0;M<8;M++)y=1&y?3988292384^y>>>1:y>>>1;g[w]=y}return g}();k.exports=function(y,g,w,M){var R=p,T=M+w;y^=-1;for(var D=M;D<T;D++)y=y>>>8^R[255&(y^g[D])];return-1^y}},{}],46:[function(c,k,_){var p,y=c("../utils/common"),g=c("./trees"),w=c("./adler32"),M=c("./crc32"),R=c("./messages"),T=0,D=4,x=0,O=-2,b=-1,C=4,P=2,I=8,j=9,X=286,Y=30,ct=19,ot=2*X+1,wt=15,at=3,Tt=258,Rt=Tt+at+1,N=42,lt=113,d=1,ht=2,zt=3,mt=4;function Lt(h,pt){return h.msg=R[pt],pt}function _t(h){return(h<<1)-(4<h?9:0)}function bt(h){for(var pt=h.length;0<=--pt;)h[pt]=0}function $(h){var pt=h.state,st=pt.pending;st>h.avail_out&&(st=h.avail_out),st!==0&&(y.arraySet(h.output,pt.pending_buf,pt.pending_out,st,h.next_out),h.next_out+=st,pt.pending_out+=st,h.total_out+=st,h.avail_out-=st,pt.pending-=st,pt.pending===0&&(pt.pending_out=0))}function tt(h,pt){g._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,pt),h.block_start=h.strstart,$(h.strm)}function Zt(h,pt){h.pending_buf[h.pending++]=pt}function vt(h,pt){h.pending_buf[h.pending++]=pt>>>8&255,h.pending_buf[h.pending++]=255&pt}function dt(h,pt){var st,A,E=h.max_chain_length,J=h.strstart,xt=h.prev_length,yt=h.nice_match,it=h.strstart>h.w_size-Rt?h.strstart-(h.w_size-Rt):0,Ct=h.window,Kt=h.w_mask,Ot=h.prev,Gt=h.strstart+Tt,ce=Ct[J+xt-1],ie=Ct[J+xt];h.prev_length>=h.good_match&&(E>>=2),yt>h.lookahead&&(yt=h.lookahead);do if(Ct[(st=pt)+xt]===ie&&Ct[st+xt-1]===ce&&Ct[st]===Ct[J]&&Ct[++st]===Ct[J+1]){J+=2,st++;do;while(Ct[++J]===Ct[++st]&&Ct[++J]===Ct[++st]&&Ct[++J]===Ct[++st]&&Ct[++J]===Ct[++st]&&Ct[++J]===Ct[++st]&&Ct[++J]===Ct[++st]&&Ct[++J]===Ct[++st]&&Ct[++J]===Ct[++st]&&J<Gt);if(A=Tt-(Gt-J),J=Gt-Tt,xt<A){if(h.match_start=pt,yt<=(xt=A))break;ce=Ct[J+xt-1],ie=Ct[J+xt]}}while((pt=Ot[pt&Kt])>it&&--E!=0);return xt<=h.lookahead?xt:h.lookahead}function jt(h){var pt,st,A,E,J,xt,yt,it,Ct,Kt,Ot=h.w_size;do{if(E=h.window_size-h.lookahead-h.strstart,h.strstart>=Ot+(Ot-Rt)){for(y.arraySet(h.window,h.window,Ot,Ot,0),h.match_start-=Ot,h.strstart-=Ot,h.block_start-=Ot,pt=st=h.hash_size;A=h.head[--pt],h.head[pt]=Ot<=A?A-Ot:0,--st;);for(pt=st=Ot;A=h.prev[--pt],h.prev[pt]=Ot<=A?A-Ot:0,--st;);E+=Ot}if(h.strm.avail_in===0)break;if(xt=h.strm,yt=h.window,it=h.strstart+h.lookahead,Ct=E,Kt=void 0,Kt=xt.avail_in,Ct<Kt&&(Kt=Ct),st=Kt===0?0:(xt.avail_in-=Kt,y.arraySet(yt,xt.input,xt.next_in,Kt,it),xt.state.wrap===1?xt.adler=w(xt.adler,yt,Kt,it):xt.state.wrap===2&&(xt.adler=M(xt.adler,yt,Kt,it)),xt.next_in+=Kt,xt.total_in+=Kt,Kt),h.lookahead+=st,h.lookahead+h.insert>=at)for(J=h.strstart-h.insert,h.ins_h=h.window[J],h.ins_h=(h.ins_h<<h.hash_shift^h.window[J+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[J+at-1])&h.hash_mask,h.prev[J&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=J,J++,h.insert--,!(h.lookahead+h.insert<at)););}while(h.lookahead<Rt&&h.strm.avail_in!==0)}function le(h,pt){for(var st,A;;){if(h.lookahead<Rt){if(jt(h),h.lookahead<Rt&&pt===T)return d;if(h.lookahead===0)break}if(st=0,h.lookahead>=at&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+at-1])&h.hash_mask,st=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),st!==0&&h.strstart-st<=h.w_size-Rt&&(h.match_length=dt(h,st)),h.match_length>=at)if(A=g._tr_tally(h,h.strstart-h.match_start,h.match_length-at),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=at){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+at-1])&h.hash_mask,st=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else A=g._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(A&&(tt(h,!1),h.strm.avail_out===0))return d}return h.insert=h.strstart<at-1?h.strstart:at-1,pt===D?(tt(h,!0),h.strm.avail_out===0?zt:mt):h.last_lit&&(tt(h,!1),h.strm.avail_out===0)?d:ht}function Nt(h,pt){for(var st,A,E;;){if(h.lookahead<Rt){if(jt(h),h.lookahead<Rt&&pt===T)return d;if(h.lookahead===0)break}if(st=0,h.lookahead>=at&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+at-1])&h.hash_mask,st=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=at-1,st!==0&&h.prev_length<h.max_lazy_match&&h.strstart-st<=h.w_size-Rt&&(h.match_length=dt(h,st),h.match_length<=5&&(h.strategy===1||h.match_length===at&&4096<h.strstart-h.match_start)&&(h.match_length=at-1)),h.prev_length>=at&&h.match_length<=h.prev_length){for(E=h.strstart+h.lookahead-at,A=g._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-at),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=E&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+at-1])&h.hash_mask,st=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=at-1,h.strstart++,A&&(tt(h,!1),h.strm.avail_out===0))return d}else if(h.match_available){if((A=g._tr_tally(h,0,h.window[h.strstart-1]))&&tt(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return d}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(A=g._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<at-1?h.strstart:at-1,pt===D?(tt(h,!0),h.strm.avail_out===0?zt:mt):h.last_lit&&(tt(h,!1),h.strm.avail_out===0)?d:ht}function Pt(h,pt,st,A,E){this.good_length=h,this.max_lazy=pt,this.nice_length=st,this.max_chain=A,this.func=E}function oe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new y.Buf16(2*ot),this.dyn_dtree=new y.Buf16(2*(2*Y+1)),this.bl_tree=new y.Buf16(2*(2*ct+1)),bt(this.dyn_ltree),bt(this.dyn_dtree),bt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new y.Buf16(wt+1),this.heap=new y.Buf16(2*X+1),bt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new y.Buf16(2*X+1),bt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qt(h){var pt;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=P,(pt=h.state).pending=0,pt.pending_out=0,pt.wrap<0&&(pt.wrap=-pt.wrap),pt.status=pt.wrap?N:lt,h.adler=pt.wrap===2?0:1,pt.last_flush=T,g._tr_init(pt),x):Lt(h,O)}function Vt(h){var pt=Qt(h);return pt===x&&function(st){st.window_size=2*st.w_size,bt(st.head),st.max_lazy_match=p[st.level].max_lazy,st.good_match=p[st.level].good_length,st.nice_match=p[st.level].nice_length,st.max_chain_length=p[st.level].max_chain,st.strstart=0,st.block_start=0,st.lookahead=0,st.insert=0,st.match_length=st.prev_length=at-1,st.match_available=0,st.ins_h=0}(h.state),pt}function he(h,pt,st,A,E,J){if(!h)return O;var xt=1;if(pt===b&&(pt=6),A<0?(xt=0,A=-A):15<A&&(xt=2,A-=16),E<1||j<E||st!==I||A<8||15<A||pt<0||9<pt||J<0||C<J)return Lt(h,O);A===8&&(A=9);var yt=new oe;return(h.state=yt).strm=h,yt.wrap=xt,yt.gzhead=null,yt.w_bits=A,yt.w_size=1<<yt.w_bits,yt.w_mask=yt.w_size-1,yt.hash_bits=E+7,yt.hash_size=1<<yt.hash_bits,yt.hash_mask=yt.hash_size-1,yt.hash_shift=~~((yt.hash_bits+at-1)/at),yt.window=new y.Buf8(2*yt.w_size),yt.head=new y.Buf16(yt.hash_size),yt.prev=new y.Buf16(yt.w_size),yt.lit_bufsize=1<<E+6,yt.pending_buf_size=4*yt.lit_bufsize,yt.pending_buf=new y.Buf8(yt.pending_buf_size),yt.d_buf=1*yt.lit_bufsize,yt.l_buf=3*yt.lit_bufsize,yt.level=pt,yt.strategy=J,yt.method=st,Vt(h)}p=[new Pt(0,0,0,0,function(h,pt){var st=65535;for(st>h.pending_buf_size-5&&(st=h.pending_buf_size-5);;){if(h.lookahead<=1){if(jt(h),h.lookahead===0&&pt===T)return d;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var A=h.block_start+st;if((h.strstart===0||h.strstart>=A)&&(h.lookahead=h.strstart-A,h.strstart=A,tt(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-Rt&&(tt(h,!1),h.strm.avail_out===0))return d}return h.insert=0,pt===D?(tt(h,!0),h.strm.avail_out===0?zt:mt):(h.strstart>h.block_start&&(tt(h,!1),h.strm.avail_out),d)}),new Pt(4,4,8,4,le),new Pt(4,5,16,8,le),new Pt(4,6,32,32,le),new Pt(4,4,16,16,Nt),new Pt(8,16,32,32,Nt),new Pt(8,16,128,128,Nt),new Pt(8,32,128,256,Nt),new Pt(32,128,258,1024,Nt),new Pt(32,258,258,4096,Nt)],_.deflateInit=function(h,pt){return he(h,pt,I,15,8,0)},_.deflateInit2=he,_.deflateReset=Vt,_.deflateResetKeep=Qt,_.deflateSetHeader=function(h,pt){return h&&h.state?h.state.wrap!==2?O:(h.state.gzhead=pt,x):O},_.deflate=function(h,pt){var st,A,E,J;if(!h||!h.state||5<pt||pt<0)return h?Lt(h,O):O;if(A=h.state,!h.output||!h.input&&h.avail_in!==0||A.status===666&&pt!==D)return Lt(h,h.avail_out===0?-5:O);if(A.strm=h,st=A.last_flush,A.last_flush=pt,A.status===N)if(A.wrap===2)h.adler=0,Zt(A,31),Zt(A,139),Zt(A,8),A.gzhead?(Zt(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),Zt(A,255&A.gzhead.time),Zt(A,A.gzhead.time>>8&255),Zt(A,A.gzhead.time>>16&255),Zt(A,A.gzhead.time>>24&255),Zt(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),Zt(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(Zt(A,255&A.gzhead.extra.length),Zt(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(h.adler=M(h.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=69):(Zt(A,0),Zt(A,0),Zt(A,0),Zt(A,0),Zt(A,0),Zt(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),Zt(A,3),A.status=lt);else{var xt=I+(A.w_bits-8<<4)<<8;xt|=(2<=A.strategy||A.level<2?0:A.level<6?1:A.level===6?2:3)<<6,A.strstart!==0&&(xt|=32),xt+=31-xt%31,A.status=lt,vt(A,xt),A.strstart!==0&&(vt(A,h.adler>>>16),vt(A,65535&h.adler)),h.adler=1}if(A.status===69)if(A.gzhead.extra){for(E=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>E&&(h.adler=M(h.adler,A.pending_buf,A.pending-E,E)),$(h),E=A.pending,A.pending!==A.pending_buf_size));)Zt(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>E&&(h.adler=M(h.adler,A.pending_buf,A.pending-E,E)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=73)}else A.status=73;if(A.status===73)if(A.gzhead.name){E=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>E&&(h.adler=M(h.adler,A.pending_buf,A.pending-E,E)),$(h),E=A.pending,A.pending===A.pending_buf_size)){J=1;break}J=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,Zt(A,J)}while(J!==0);A.gzhead.hcrc&&A.pending>E&&(h.adler=M(h.adler,A.pending_buf,A.pending-E,E)),J===0&&(A.gzindex=0,A.status=91)}else A.status=91;if(A.status===91)if(A.gzhead.comment){E=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>E&&(h.adler=M(h.adler,A.pending_buf,A.pending-E,E)),$(h),E=A.pending,A.pending===A.pending_buf_size)){J=1;break}J=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,Zt(A,J)}while(J!==0);A.gzhead.hcrc&&A.pending>E&&(h.adler=M(h.adler,A.pending_buf,A.pending-E,E)),J===0&&(A.status=103)}else A.status=103;if(A.status===103&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&$(h),A.pending+2<=A.pending_buf_size&&(Zt(A,255&h.adler),Zt(A,h.adler>>8&255),h.adler=0,A.status=lt)):A.status=lt),A.pending!==0){if($(h),h.avail_out===0)return A.last_flush=-1,x}else if(h.avail_in===0&&_t(pt)<=_t(st)&&pt!==D)return Lt(h,-5);if(A.status===666&&h.avail_in!==0)return Lt(h,-5);if(h.avail_in!==0||A.lookahead!==0||pt!==T&&A.status!==666){var yt=A.strategy===2?function(it,Ct){for(var Kt;;){if(it.lookahead===0&&(jt(it),it.lookahead===0)){if(Ct===T)return d;break}if(it.match_length=0,Kt=g._tr_tally(it,0,it.window[it.strstart]),it.lookahead--,it.strstart++,Kt&&(tt(it,!1),it.strm.avail_out===0))return d}return it.insert=0,Ct===D?(tt(it,!0),it.strm.avail_out===0?zt:mt):it.last_lit&&(tt(it,!1),it.strm.avail_out===0)?d:ht}(A,pt):A.strategy===3?function(it,Ct){for(var Kt,Ot,Gt,ce,ie=it.window;;){if(it.lookahead<=Tt){if(jt(it),it.lookahead<=Tt&&Ct===T)return d;if(it.lookahead===0)break}if(it.match_length=0,it.lookahead>=at&&0<it.strstart&&(Ot=ie[Gt=it.strstart-1])===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]){ce=it.strstart+Tt;do;while(Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Ot===ie[++Gt]&&Gt<ce);it.match_length=Tt-(ce-Gt),it.match_length>it.lookahead&&(it.match_length=it.lookahead)}if(it.match_length>=at?(Kt=g._tr_tally(it,1,it.match_length-at),it.lookahead-=it.match_length,it.strstart+=it.match_length,it.match_length=0):(Kt=g._tr_tally(it,0,it.window[it.strstart]),it.lookahead--,it.strstart++),Kt&&(tt(it,!1),it.strm.avail_out===0))return d}return it.insert=0,Ct===D?(tt(it,!0),it.strm.avail_out===0?zt:mt):it.last_lit&&(tt(it,!1),it.strm.avail_out===0)?d:ht}(A,pt):p[A.level].func(A,pt);if(yt!==zt&&yt!==mt||(A.status=666),yt===d||yt===zt)return h.avail_out===0&&(A.last_flush=-1),x;if(yt===ht&&(pt===1?g._tr_align(A):pt!==5&&(g._tr_stored_block(A,0,0,!1),pt===3&&(bt(A.head),A.lookahead===0&&(A.strstart=0,A.block_start=0,A.insert=0))),$(h),h.avail_out===0))return A.last_flush=-1,x}return pt!==D?x:A.wrap<=0?1:(A.wrap===2?(Zt(A,255&h.adler),Zt(A,h.adler>>8&255),Zt(A,h.adler>>16&255),Zt(A,h.adler>>24&255),Zt(A,255&h.total_in),Zt(A,h.total_in>>8&255),Zt(A,h.total_in>>16&255),Zt(A,h.total_in>>24&255)):(vt(A,h.adler>>>16),vt(A,65535&h.adler)),$(h),0<A.wrap&&(A.wrap=-A.wrap),A.pending!==0?x:1)},_.deflateEnd=function(h){var pt;return h&&h.state?(pt=h.state.status)!==N&&pt!==69&&pt!==73&&pt!==91&&pt!==103&&pt!==lt&&pt!==666?Lt(h,O):(h.state=null,pt===lt?Lt(h,-3):x):O},_.deflateSetDictionary=function(h,pt){var st,A,E,J,xt,yt,it,Ct,Kt=pt.length;if(!h||!h.state||(J=(st=h.state).wrap)===2||J===1&&st.status!==N||st.lookahead)return O;for(J===1&&(h.adler=w(h.adler,pt,Kt,0)),st.wrap=0,Kt>=st.w_size&&(J===0&&(bt(st.head),st.strstart=0,st.block_start=0,st.insert=0),Ct=new y.Buf8(st.w_size),y.arraySet(Ct,pt,Kt-st.w_size,st.w_size,0),pt=Ct,Kt=st.w_size),xt=h.avail_in,yt=h.next_in,it=h.input,h.avail_in=Kt,h.next_in=0,h.input=pt,jt(st);st.lookahead>=at;){for(A=st.strstart,E=st.lookahead-(at-1);st.ins_h=(st.ins_h<<st.hash_shift^st.window[A+at-1])&st.hash_mask,st.prev[A&st.w_mask]=st.head[st.ins_h],st.head[st.ins_h]=A,A++,--E;);st.strstart=A,st.lookahead=at-1,jt(st)}return st.strstart+=st.lookahead,st.block_start=st.strstart,st.insert=st.lookahead,st.lookahead=0,st.match_length=st.prev_length=at-1,st.match_available=0,h.next_in=yt,h.input=it,h.avail_in=xt,st.wrap=J,x},_.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(c,k,_){k.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(c,k,_){k.exports=function(p,y){var g,w,M,R,T,D,x,O,b,C,P,I,j,X,Y,ct,ot,wt,at,Tt,Rt,N,lt,d,ht;g=p.state,w=p.next_in,d=p.input,M=w+(p.avail_in-5),R=p.next_out,ht=p.output,T=R-(y-p.avail_out),D=R+(p.avail_out-257),x=g.dmax,O=g.wsize,b=g.whave,C=g.wnext,P=g.window,I=g.hold,j=g.bits,X=g.lencode,Y=g.distcode,ct=(1<<g.lenbits)-1,ot=(1<<g.distbits)-1;t:do{j<15&&(I+=d[w++]<<j,j+=8,I+=d[w++]<<j,j+=8),wt=X[I&ct];e:for(;;){if(I>>>=at=wt>>>24,j-=at,(at=wt>>>16&255)===0)ht[R++]=65535&wt;else{if(!(16&at)){if(!(64&at)){wt=X[(65535&wt)+(I&(1<<at)-1)];continue e}if(32&at){g.mode=12;break t}p.msg="invalid literal/length code",g.mode=30;break t}Tt=65535&wt,(at&=15)&&(j<at&&(I+=d[w++]<<j,j+=8),Tt+=I&(1<<at)-1,I>>>=at,j-=at),j<15&&(I+=d[w++]<<j,j+=8,I+=d[w++]<<j,j+=8),wt=Y[I&ot];n:for(;;){if(I>>>=at=wt>>>24,j-=at,!(16&(at=wt>>>16&255))){if(!(64&at)){wt=Y[(65535&wt)+(I&(1<<at)-1)];continue n}p.msg="invalid distance code",g.mode=30;break t}if(Rt=65535&wt,j<(at&=15)&&(I+=d[w++]<<j,(j+=8)<at&&(I+=d[w++]<<j,j+=8)),x<(Rt+=I&(1<<at)-1)){p.msg="invalid distance too far back",g.mode=30;break t}if(I>>>=at,j-=at,(at=R-T)<Rt){if(b<(at=Rt-at)&&g.sane){p.msg="invalid distance too far back",g.mode=30;break t}if(lt=P,(N=0)===C){if(N+=O-at,at<Tt){for(Tt-=at;ht[R++]=P[N++],--at;);N=R-Rt,lt=ht}}else if(C<at){if(N+=O+C-at,(at-=C)<Tt){for(Tt-=at;ht[R++]=P[N++],--at;);if(N=0,C<Tt){for(Tt-=at=C;ht[R++]=P[N++],--at;);N=R-Rt,lt=ht}}}else if(N+=C-at,at<Tt){for(Tt-=at;ht[R++]=P[N++],--at;);N=R-Rt,lt=ht}for(;2<Tt;)ht[R++]=lt[N++],ht[R++]=lt[N++],ht[R++]=lt[N++],Tt-=3;Tt&&(ht[R++]=lt[N++],1<Tt&&(ht[R++]=lt[N++]))}else{for(N=R-Rt;ht[R++]=ht[N++],ht[R++]=ht[N++],ht[R++]=ht[N++],2<(Tt-=3););Tt&&(ht[R++]=ht[N++],1<Tt&&(ht[R++]=ht[N++]))}break}}break}}while(w<M&&R<D);w-=Tt=j>>3,I&=(1<<(j-=Tt<<3))-1,p.next_in=w,p.next_out=R,p.avail_in=w<M?M-w+5:5-(w-M),p.avail_out=R<D?D-R+257:257-(R-D),g.hold=I,g.bits=j}},{}],49:[function(c,k,_){var p=c("../utils/common"),y=c("./adler32"),g=c("./crc32"),w=c("./inffast"),M=c("./inftrees"),R=1,T=2,D=0,x=-2,O=1,b=852,C=592;function P(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function I(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new p.Buf16(320),this.work=new p.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(N){var lt;return N&&N.state?(lt=N.state,N.total_in=N.total_out=lt.total=0,N.msg="",lt.wrap&&(N.adler=1&lt.wrap),lt.mode=O,lt.last=0,lt.havedict=0,lt.dmax=32768,lt.head=null,lt.hold=0,lt.bits=0,lt.lencode=lt.lendyn=new p.Buf32(b),lt.distcode=lt.distdyn=new p.Buf32(C),lt.sane=1,lt.back=-1,D):x}function X(N){var lt;return N&&N.state?((lt=N.state).wsize=0,lt.whave=0,lt.wnext=0,j(N)):x}function Y(N,lt){var d,ht;return N&&N.state?(ht=N.state,lt<0?(d=0,lt=-lt):(d=1+(lt>>4),lt<48&&(lt&=15)),lt&&(lt<8||15<lt)?x:(ht.window!==null&&ht.wbits!==lt&&(ht.window=null),ht.wrap=d,ht.wbits=lt,X(N))):x}function ct(N,lt){var d,ht;return N?(ht=new I,(N.state=ht).window=null,(d=Y(N,lt))!==D&&(N.state=null),d):x}var ot,wt,at=!0;function Tt(N){if(at){var lt;for(ot=new p.Buf32(512),wt=new p.Buf32(32),lt=0;lt<144;)N.lens[lt++]=8;for(;lt<256;)N.lens[lt++]=9;for(;lt<280;)N.lens[lt++]=7;for(;lt<288;)N.lens[lt++]=8;for(M(R,N.lens,0,288,ot,0,N.work,{bits:9}),lt=0;lt<32;)N.lens[lt++]=5;M(T,N.lens,0,32,wt,0,N.work,{bits:5}),at=!1}N.lencode=ot,N.lenbits=9,N.distcode=wt,N.distbits=5}function Rt(N,lt,d,ht){var zt,mt=N.state;return mt.window===null&&(mt.wsize=1<<mt.wbits,mt.wnext=0,mt.whave=0,mt.window=new p.Buf8(mt.wsize)),ht>=mt.wsize?(p.arraySet(mt.window,lt,d-mt.wsize,mt.wsize,0),mt.wnext=0,mt.whave=mt.wsize):(ht<(zt=mt.wsize-mt.wnext)&&(zt=ht),p.arraySet(mt.window,lt,d-ht,zt,mt.wnext),(ht-=zt)?(p.arraySet(mt.window,lt,d-ht,ht,0),mt.wnext=ht,mt.whave=mt.wsize):(mt.wnext+=zt,mt.wnext===mt.wsize&&(mt.wnext=0),mt.whave<mt.wsize&&(mt.whave+=zt))),0}_.inflateReset=X,_.inflateReset2=Y,_.inflateResetKeep=j,_.inflateInit=function(N){return ct(N,15)},_.inflateInit2=ct,_.inflate=function(N,lt){var d,ht,zt,mt,Lt,_t,bt,$,tt,Zt,vt,dt,jt,le,Nt,Pt,oe,Qt,Vt,he,h,pt,st,A,E=0,J=new p.Buf8(4),xt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return x;(d=N.state).mode===12&&(d.mode=13),Lt=N.next_out,zt=N.output,bt=N.avail_out,mt=N.next_in,ht=N.input,_t=N.avail_in,$=d.hold,tt=d.bits,Zt=_t,vt=bt,pt=D;t:for(;;)switch(d.mode){case O:if(d.wrap===0){d.mode=13;break}for(;tt<16;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if(2&d.wrap&&$===35615){J[d.check=0]=255&$,J[1]=$>>>8&255,d.check=g(d.check,J,2,0),tt=$=0,d.mode=2;break}if(d.flags=0,d.head&&(d.head.done=!1),!(1&d.wrap)||(((255&$)<<8)+($>>8))%31){N.msg="incorrect header check",d.mode=30;break}if((15&$)!=8){N.msg="unknown compression method",d.mode=30;break}if(tt-=4,h=8+(15&($>>>=4)),d.wbits===0)d.wbits=h;else if(h>d.wbits){N.msg="invalid window size",d.mode=30;break}d.dmax=1<<h,N.adler=d.check=1,d.mode=512&$?10:12,tt=$=0;break;case 2:for(;tt<16;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if(d.flags=$,(255&d.flags)!=8){N.msg="unknown compression method",d.mode=30;break}if(57344&d.flags){N.msg="unknown header flags set",d.mode=30;break}d.head&&(d.head.text=$>>8&1),512&d.flags&&(J[0]=255&$,J[1]=$>>>8&255,d.check=g(d.check,J,2,0)),tt=$=0,d.mode=3;case 3:for(;tt<32;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}d.head&&(d.head.time=$),512&d.flags&&(J[0]=255&$,J[1]=$>>>8&255,J[2]=$>>>16&255,J[3]=$>>>24&255,d.check=g(d.check,J,4,0)),tt=$=0,d.mode=4;case 4:for(;tt<16;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}d.head&&(d.head.xflags=255&$,d.head.os=$>>8),512&d.flags&&(J[0]=255&$,J[1]=$>>>8&255,d.check=g(d.check,J,2,0)),tt=$=0,d.mode=5;case 5:if(1024&d.flags){for(;tt<16;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}d.length=$,d.head&&(d.head.extra_len=$),512&d.flags&&(J[0]=255&$,J[1]=$>>>8&255,d.check=g(d.check,J,2,0)),tt=$=0}else d.head&&(d.head.extra=null);d.mode=6;case 6:if(1024&d.flags&&(_t<(dt=d.length)&&(dt=_t),dt&&(d.head&&(h=d.head.extra_len-d.length,d.head.extra||(d.head.extra=new Array(d.head.extra_len)),p.arraySet(d.head.extra,ht,mt,dt,h)),512&d.flags&&(d.check=g(d.check,ht,dt,mt)),_t-=dt,mt+=dt,d.length-=dt),d.length))break t;d.length=0,d.mode=7;case 7:if(2048&d.flags){if(_t===0)break t;for(dt=0;h=ht[mt+dt++],d.head&&h&&d.length<65536&&(d.head.name+=String.fromCharCode(h)),h&&dt<_t;);if(512&d.flags&&(d.check=g(d.check,ht,dt,mt)),_t-=dt,mt+=dt,h)break t}else d.head&&(d.head.name=null);d.length=0,d.mode=8;case 8:if(4096&d.flags){if(_t===0)break t;for(dt=0;h=ht[mt+dt++],d.head&&h&&d.length<65536&&(d.head.comment+=String.fromCharCode(h)),h&&dt<_t;);if(512&d.flags&&(d.check=g(d.check,ht,dt,mt)),_t-=dt,mt+=dt,h)break t}else d.head&&(d.head.comment=null);d.mode=9;case 9:if(512&d.flags){for(;tt<16;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if($!==(65535&d.check)){N.msg="header crc mismatch",d.mode=30;break}tt=$=0}d.head&&(d.head.hcrc=d.flags>>9&1,d.head.done=!0),N.adler=d.check=0,d.mode=12;break;case 10:for(;tt<32;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}N.adler=d.check=P($),tt=$=0,d.mode=11;case 11:if(d.havedict===0)return N.next_out=Lt,N.avail_out=bt,N.next_in=mt,N.avail_in=_t,d.hold=$,d.bits=tt,2;N.adler=d.check=1,d.mode=12;case 12:if(lt===5||lt===6)break t;case 13:if(d.last){$>>>=7&tt,tt-=7&tt,d.mode=27;break}for(;tt<3;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}switch(d.last=1&$,tt-=1,3&($>>>=1)){case 0:d.mode=14;break;case 1:if(Tt(d),d.mode=20,lt!==6)break;$>>>=2,tt-=2;break t;case 2:d.mode=17;break;case 3:N.msg="invalid block type",d.mode=30}$>>>=2,tt-=2;break;case 14:for($>>>=7&tt,tt-=7&tt;tt<32;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if((65535&$)!=($>>>16^65535)){N.msg="invalid stored block lengths",d.mode=30;break}if(d.length=65535&$,tt=$=0,d.mode=15,lt===6)break t;case 15:d.mode=16;case 16:if(dt=d.length){if(_t<dt&&(dt=_t),bt<dt&&(dt=bt),dt===0)break t;p.arraySet(zt,ht,mt,dt,Lt),_t-=dt,mt+=dt,bt-=dt,Lt+=dt,d.length-=dt;break}d.mode=12;break;case 17:for(;tt<14;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if(d.nlen=257+(31&$),$>>>=5,tt-=5,d.ndist=1+(31&$),$>>>=5,tt-=5,d.ncode=4+(15&$),$>>>=4,tt-=4,286<d.nlen||30<d.ndist){N.msg="too many length or distance symbols",d.mode=30;break}d.have=0,d.mode=18;case 18:for(;d.have<d.ncode;){for(;tt<3;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}d.lens[xt[d.have++]]=7&$,$>>>=3,tt-=3}for(;d.have<19;)d.lens[xt[d.have++]]=0;if(d.lencode=d.lendyn,d.lenbits=7,st={bits:d.lenbits},pt=M(0,d.lens,0,19,d.lencode,0,d.work,st),d.lenbits=st.bits,pt){N.msg="invalid code lengths set",d.mode=30;break}d.have=0,d.mode=19;case 19:for(;d.have<d.nlen+d.ndist;){for(;Pt=(E=d.lencode[$&(1<<d.lenbits)-1])>>>16&255,oe=65535&E,!((Nt=E>>>24)<=tt);){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if(oe<16)$>>>=Nt,tt-=Nt,d.lens[d.have++]=oe;else{if(oe===16){for(A=Nt+2;tt<A;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if($>>>=Nt,tt-=Nt,d.have===0){N.msg="invalid bit length repeat",d.mode=30;break}h=d.lens[d.have-1],dt=3+(3&$),$>>>=2,tt-=2}else if(oe===17){for(A=Nt+3;tt<A;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}tt-=Nt,h=0,dt=3+(7&($>>>=Nt)),$>>>=3,tt-=3}else{for(A=Nt+7;tt<A;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}tt-=Nt,h=0,dt=11+(127&($>>>=Nt)),$>>>=7,tt-=7}if(d.have+dt>d.nlen+d.ndist){N.msg="invalid bit length repeat",d.mode=30;break}for(;dt--;)d.lens[d.have++]=h}}if(d.mode===30)break;if(d.lens[256]===0){N.msg="invalid code -- missing end-of-block",d.mode=30;break}if(d.lenbits=9,st={bits:d.lenbits},pt=M(R,d.lens,0,d.nlen,d.lencode,0,d.work,st),d.lenbits=st.bits,pt){N.msg="invalid literal/lengths set",d.mode=30;break}if(d.distbits=6,d.distcode=d.distdyn,st={bits:d.distbits},pt=M(T,d.lens,d.nlen,d.ndist,d.distcode,0,d.work,st),d.distbits=st.bits,pt){N.msg="invalid distances set",d.mode=30;break}if(d.mode=20,lt===6)break t;case 20:d.mode=21;case 21:if(6<=_t&&258<=bt){N.next_out=Lt,N.avail_out=bt,N.next_in=mt,N.avail_in=_t,d.hold=$,d.bits=tt,w(N,vt),Lt=N.next_out,zt=N.output,bt=N.avail_out,mt=N.next_in,ht=N.input,_t=N.avail_in,$=d.hold,tt=d.bits,d.mode===12&&(d.back=-1);break}for(d.back=0;Pt=(E=d.lencode[$&(1<<d.lenbits)-1])>>>16&255,oe=65535&E,!((Nt=E>>>24)<=tt);){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if(Pt&&!(240&Pt)){for(Qt=Nt,Vt=Pt,he=oe;Pt=(E=d.lencode[he+(($&(1<<Qt+Vt)-1)>>Qt)])>>>16&255,oe=65535&E,!(Qt+(Nt=E>>>24)<=tt);){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}$>>>=Qt,tt-=Qt,d.back+=Qt}if($>>>=Nt,tt-=Nt,d.back+=Nt,d.length=oe,Pt===0){d.mode=26;break}if(32&Pt){d.back=-1,d.mode=12;break}if(64&Pt){N.msg="invalid literal/length code",d.mode=30;break}d.extra=15&Pt,d.mode=22;case 22:if(d.extra){for(A=d.extra;tt<A;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}d.length+=$&(1<<d.extra)-1,$>>>=d.extra,tt-=d.extra,d.back+=d.extra}d.was=d.length,d.mode=23;case 23:for(;Pt=(E=d.distcode[$&(1<<d.distbits)-1])>>>16&255,oe=65535&E,!((Nt=E>>>24)<=tt);){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if(!(240&Pt)){for(Qt=Nt,Vt=Pt,he=oe;Pt=(E=d.distcode[he+(($&(1<<Qt+Vt)-1)>>Qt)])>>>16&255,oe=65535&E,!(Qt+(Nt=E>>>24)<=tt);){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}$>>>=Qt,tt-=Qt,d.back+=Qt}if($>>>=Nt,tt-=Nt,d.back+=Nt,64&Pt){N.msg="invalid distance code",d.mode=30;break}d.offset=oe,d.extra=15&Pt,d.mode=24;case 24:if(d.extra){for(A=d.extra;tt<A;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}d.offset+=$&(1<<d.extra)-1,$>>>=d.extra,tt-=d.extra,d.back+=d.extra}if(d.offset>d.dmax){N.msg="invalid distance too far back",d.mode=30;break}d.mode=25;case 25:if(bt===0)break t;if(dt=vt-bt,d.offset>dt){if((dt=d.offset-dt)>d.whave&&d.sane){N.msg="invalid distance too far back",d.mode=30;break}jt=dt>d.wnext?(dt-=d.wnext,d.wsize-dt):d.wnext-dt,dt>d.length&&(dt=d.length),le=d.window}else le=zt,jt=Lt-d.offset,dt=d.length;for(bt<dt&&(dt=bt),bt-=dt,d.length-=dt;zt[Lt++]=le[jt++],--dt;);d.length===0&&(d.mode=21);break;case 26:if(bt===0)break t;zt[Lt++]=d.length,bt--,d.mode=21;break;case 27:if(d.wrap){for(;tt<32;){if(_t===0)break t;_t--,$|=ht[mt++]<<tt,tt+=8}if(vt-=bt,N.total_out+=vt,d.total+=vt,vt&&(N.adler=d.check=d.flags?g(d.check,zt,vt,Lt-vt):y(d.check,zt,vt,Lt-vt)),vt=bt,(d.flags?$:P($))!==d.check){N.msg="incorrect data check",d.mode=30;break}tt=$=0}d.mode=28;case 28:if(d.wrap&&d.flags){for(;tt<32;){if(_t===0)break t;_t--,$+=ht[mt++]<<tt,tt+=8}if($!==(4294967295&d.total)){N.msg="incorrect length check",d.mode=30;break}tt=$=0}d.mode=29;case 29:pt=1;break t;case 30:pt=-3;break t;case 31:return-4;case 32:default:return x}return N.next_out=Lt,N.avail_out=bt,N.next_in=mt,N.avail_in=_t,d.hold=$,d.bits=tt,(d.wsize||vt!==N.avail_out&&d.mode<30&&(d.mode<27||lt!==4))&&Rt(N,N.output,N.next_out,vt-N.avail_out)?(d.mode=31,-4):(Zt-=N.avail_in,vt-=N.avail_out,N.total_in+=Zt,N.total_out+=vt,d.total+=vt,d.wrap&&vt&&(N.adler=d.check=d.flags?g(d.check,zt,vt,N.next_out-vt):y(d.check,zt,vt,N.next_out-vt)),N.data_type=d.bits+(d.last?64:0)+(d.mode===12?128:0)+(d.mode===20||d.mode===15?256:0),(Zt==0&&vt===0||lt===4)&&pt===D&&(pt=-5),pt)},_.inflateEnd=function(N){if(!N||!N.state)return x;var lt=N.state;return lt.window&&(lt.window=null),N.state=null,D},_.inflateGetHeader=function(N,lt){var d;return N&&N.state&&2&(d=N.state).wrap?((d.head=lt).done=!1,D):x},_.inflateSetDictionary=function(N,lt){var d,ht=lt.length;return N&&N.state?(d=N.state).wrap!==0&&d.mode!==11?x:d.mode===11&&y(1,lt,ht,0)!==d.check?-3:Rt(N,lt,ht,ht)?(d.mode=31,-4):(d.havedict=1,D):x},_.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(c,k,_){var p=c("../utils/common"),y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],M=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];k.exports=function(R,T,D,x,O,b,C,P){var I,j,X,Y,ct,ot,wt,at,Tt,Rt=P.bits,N=0,lt=0,d=0,ht=0,zt=0,mt=0,Lt=0,_t=0,bt=0,$=0,tt=null,Zt=0,vt=new p.Buf16(16),dt=new p.Buf16(16),jt=null,le=0;for(N=0;N<=15;N++)vt[N]=0;for(lt=0;lt<x;lt++)vt[T[D+lt]]++;for(zt=Rt,ht=15;1<=ht&&vt[ht]===0;ht--);if(ht<zt&&(zt=ht),ht===0)return O[b++]=20971520,O[b++]=20971520,P.bits=1,0;for(d=1;d<ht&&vt[d]===0;d++);for(zt<d&&(zt=d),N=_t=1;N<=15;N++)if(_t<<=1,(_t-=vt[N])<0)return-1;if(0<_t&&(R===0||ht!==1))return-1;for(dt[1]=0,N=1;N<15;N++)dt[N+1]=dt[N]+vt[N];for(lt=0;lt<x;lt++)T[D+lt]!==0&&(C[dt[T[D+lt]]++]=lt);if(ot=R===0?(tt=jt=C,19):R===1?(tt=y,Zt-=257,jt=g,le-=257,256):(tt=w,jt=M,-1),N=d,ct=b,Lt=lt=$=0,X=-1,Y=(bt=1<<(mt=zt))-1,R===1&&852<bt||R===2&&592<bt)return 1;for(;;){for(wt=N-Lt,Tt=C[lt]<ot?(at=0,C[lt]):C[lt]>ot?(at=jt[le+C[lt]],tt[Zt+C[lt]]):(at=96,0),I=1<<N-Lt,d=j=1<<mt;O[ct+($>>Lt)+(j-=I)]=wt<<24|at<<16|Tt|0,j!==0;);for(I=1<<N-1;$&I;)I>>=1;if(I!==0?($&=I-1,$+=I):$=0,lt++,--vt[N]==0){if(N===ht)break;N=T[D+C[lt]]}if(zt<N&&($&Y)!==X){for(Lt===0&&(Lt=zt),ct+=d,_t=1<<(mt=N-Lt);mt+Lt<ht&&!((_t-=vt[mt+Lt])<=0);)mt++,_t<<=1;if(bt+=1<<mt,R===1&&852<bt||R===2&&592<bt)return 1;O[X=$&Y]=zt<<24|mt<<16|ct-b|0}}return $!==0&&(O[ct+$]=N-Lt<<24|64<<16|0),P.bits=zt,0}},{"../utils/common":41}],51:[function(c,k,_){k.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(c,k,_){var p=c("../utils/common"),y=0,g=1;function w(E){for(var J=E.length;0<=--J;)E[J]=0}var M=0,R=29,T=256,D=T+1+R,x=30,O=19,b=2*D+1,C=15,P=16,I=7,j=256,X=16,Y=17,ct=18,ot=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],wt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Rt=new Array(2*(D+2));w(Rt);var N=new Array(2*x);w(N);var lt=new Array(512);w(lt);var d=new Array(256);w(d);var ht=new Array(R);w(ht);var zt,mt,Lt,_t=new Array(x);function bt(E,J,xt,yt,it){this.static_tree=E,this.extra_bits=J,this.extra_base=xt,this.elems=yt,this.max_length=it,this.has_stree=E&&E.length}function $(E,J){this.dyn_tree=E,this.max_code=0,this.stat_desc=J}function tt(E){return E<256?lt[E]:lt[256+(E>>>7)]}function Zt(E,J){E.pending_buf[E.pending++]=255&J,E.pending_buf[E.pending++]=J>>>8&255}function vt(E,J,xt){E.bi_valid>P-xt?(E.bi_buf|=J<<E.bi_valid&65535,Zt(E,E.bi_buf),E.bi_buf=J>>P-E.bi_valid,E.bi_valid+=xt-P):(E.bi_buf|=J<<E.bi_valid&65535,E.bi_valid+=xt)}function dt(E,J,xt){vt(E,xt[2*J],xt[2*J+1])}function jt(E,J){for(var xt=0;xt|=1&E,E>>>=1,xt<<=1,0<--J;);return xt>>>1}function le(E,J,xt){var yt,it,Ct=new Array(C+1),Kt=0;for(yt=1;yt<=C;yt++)Ct[yt]=Kt=Kt+xt[yt-1]<<1;for(it=0;it<=J;it++){var Ot=E[2*it+1];Ot!==0&&(E[2*it]=jt(Ct[Ot]++,Ot))}}function Nt(E){var J;for(J=0;J<D;J++)E.dyn_ltree[2*J]=0;for(J=0;J<x;J++)E.dyn_dtree[2*J]=0;for(J=0;J<O;J++)E.bl_tree[2*J]=0;E.dyn_ltree[2*j]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function Pt(E){8<E.bi_valid?Zt(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function oe(E,J,xt,yt){var it=2*J,Ct=2*xt;return E[it]<E[Ct]||E[it]===E[Ct]&&yt[J]<=yt[xt]}function Qt(E,J,xt){for(var yt=E.heap[xt],it=xt<<1;it<=E.heap_len&&(it<E.heap_len&&oe(J,E.heap[it+1],E.heap[it],E.depth)&&it++,!oe(J,yt,E.heap[it],E.depth));)E.heap[xt]=E.heap[it],xt=it,it<<=1;E.heap[xt]=yt}function Vt(E,J,xt){var yt,it,Ct,Kt,Ot=0;if(E.last_lit!==0)for(;yt=E.pending_buf[E.d_buf+2*Ot]<<8|E.pending_buf[E.d_buf+2*Ot+1],it=E.pending_buf[E.l_buf+Ot],Ot++,yt===0?dt(E,it,J):(dt(E,(Ct=d[it])+T+1,J),(Kt=ot[Ct])!==0&&vt(E,it-=ht[Ct],Kt),dt(E,Ct=tt(--yt),xt),(Kt=wt[Ct])!==0&&vt(E,yt-=_t[Ct],Kt)),Ot<E.last_lit;);dt(E,j,J)}function he(E,J){var xt,yt,it,Ct=J.dyn_tree,Kt=J.stat_desc.static_tree,Ot=J.stat_desc.has_stree,Gt=J.stat_desc.elems,ce=-1;for(E.heap_len=0,E.heap_max=b,xt=0;xt<Gt;xt++)Ct[2*xt]!==0?(E.heap[++E.heap_len]=ce=xt,E.depth[xt]=0):Ct[2*xt+1]=0;for(;E.heap_len<2;)Ct[2*(it=E.heap[++E.heap_len]=ce<2?++ce:0)]=1,E.depth[it]=0,E.opt_len--,Ot&&(E.static_len-=Kt[2*it+1]);for(J.max_code=ce,xt=E.heap_len>>1;1<=xt;xt--)Qt(E,Ct,xt);for(it=Gt;xt=E.heap[1],E.heap[1]=E.heap[E.heap_len--],Qt(E,Ct,1),yt=E.heap[1],E.heap[--E.heap_max]=xt,E.heap[--E.heap_max]=yt,Ct[2*it]=Ct[2*xt]+Ct[2*yt],E.depth[it]=(E.depth[xt]>=E.depth[yt]?E.depth[xt]:E.depth[yt])+1,Ct[2*xt+1]=Ct[2*yt+1]=it,E.heap[1]=it++,Qt(E,Ct,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(ie,Se){var rn,Oe,Ke,me,on,Ue,Ut=Se.dyn_tree,qe=Se.max_code,mn=Se.stat_desc.static_tree,Gn=Se.stat_desc.has_stree,Ft=Se.stat_desc.extra_bits,Zn=Se.stat_desc.extra_base,_n=Se.stat_desc.max_length,Ln=0;for(me=0;me<=C;me++)ie.bl_count[me]=0;for(Ut[2*ie.heap[ie.heap_max]+1]=0,rn=ie.heap_max+1;rn<b;rn++)_n<(me=Ut[2*Ut[2*(Oe=ie.heap[rn])+1]+1]+1)&&(me=_n,Ln++),Ut[2*Oe+1]=me,qe<Oe||(ie.bl_count[me]++,on=0,Zn<=Oe&&(on=Ft[Oe-Zn]),Ue=Ut[2*Oe],ie.opt_len+=Ue*(me+on),Gn&&(ie.static_len+=Ue*(mn[2*Oe+1]+on)));if(Ln!==0){do{for(me=_n-1;ie.bl_count[me]===0;)me--;ie.bl_count[me]--,ie.bl_count[me+1]+=2,ie.bl_count[_n]--,Ln-=2}while(0<Ln);for(me=_n;me!==0;me--)for(Oe=ie.bl_count[me];Oe!==0;)qe<(Ke=ie.heap[--rn])||(Ut[2*Ke+1]!==me&&(ie.opt_len+=(me-Ut[2*Ke+1])*Ut[2*Ke],Ut[2*Ke+1]=me),Oe--)}}(E,J),le(Ct,ce,E.bl_count)}function h(E,J,xt){var yt,it,Ct=-1,Kt=J[1],Ot=0,Gt=7,ce=4;for(Kt===0&&(Gt=138,ce=3),J[2*(xt+1)+1]=65535,yt=0;yt<=xt;yt++)it=Kt,Kt=J[2*(yt+1)+1],++Ot<Gt&&it===Kt||(Ot<ce?E.bl_tree[2*it]+=Ot:it!==0?(it!==Ct&&E.bl_tree[2*it]++,E.bl_tree[2*X]++):Ot<=10?E.bl_tree[2*Y]++:E.bl_tree[2*ct]++,Ct=it,ce=(Ot=0)===Kt?(Gt=138,3):it===Kt?(Gt=6,3):(Gt=7,4))}function pt(E,J,xt){var yt,it,Ct=-1,Kt=J[1],Ot=0,Gt=7,ce=4;for(Kt===0&&(Gt=138,ce=3),yt=0;yt<=xt;yt++)if(it=Kt,Kt=J[2*(yt+1)+1],!(++Ot<Gt&&it===Kt)){if(Ot<ce)for(;dt(E,it,E.bl_tree),--Ot!=0;);else it!==0?(it!==Ct&&(dt(E,it,E.bl_tree),Ot--),dt(E,X,E.bl_tree),vt(E,Ot-3,2)):Ot<=10?(dt(E,Y,E.bl_tree),vt(E,Ot-3,3)):(dt(E,ct,E.bl_tree),vt(E,Ot-11,7));Ct=it,ce=(Ot=0)===Kt?(Gt=138,3):it===Kt?(Gt=6,3):(Gt=7,4)}}w(_t);var st=!1;function A(E,J,xt,yt){vt(E,(M<<1)+(yt?1:0),3),function(it,Ct,Kt,Ot){Pt(it),Zt(it,Kt),Zt(it,~Kt),p.arraySet(it.pending_buf,it.window,Ct,Kt,it.pending),it.pending+=Kt}(E,J,xt)}_._tr_init=function(E){st||(function(){var J,xt,yt,it,Ct,Kt=new Array(C+1);for(it=yt=0;it<R-1;it++)for(ht[it]=yt,J=0;J<1<<ot[it];J++)d[yt++]=it;for(d[yt-1]=it,it=Ct=0;it<16;it++)for(_t[it]=Ct,J=0;J<1<<wt[it];J++)lt[Ct++]=it;for(Ct>>=7;it<x;it++)for(_t[it]=Ct<<7,J=0;J<1<<wt[it]-7;J++)lt[256+Ct++]=it;for(xt=0;xt<=C;xt++)Kt[xt]=0;for(J=0;J<=143;)Rt[2*J+1]=8,J++,Kt[8]++;for(;J<=255;)Rt[2*J+1]=9,J++,Kt[9]++;for(;J<=279;)Rt[2*J+1]=7,J++,Kt[7]++;for(;J<=287;)Rt[2*J+1]=8,J++,Kt[8]++;for(le(Rt,D+1,Kt),J=0;J<x;J++)N[2*J+1]=5,N[2*J]=jt(J,5);zt=new bt(Rt,ot,T+1,D,C),mt=new bt(N,wt,0,x,C),Lt=new bt(new Array(0),at,0,O,I)}(),st=!0),E.l_desc=new $(E.dyn_ltree,zt),E.d_desc=new $(E.dyn_dtree,mt),E.bl_desc=new $(E.bl_tree,Lt),E.bi_buf=0,E.bi_valid=0,Nt(E)},_._tr_stored_block=A,_._tr_flush_block=function(E,J,xt,yt){var it,Ct,Kt=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(Ot){var Gt,ce=4093624447;for(Gt=0;Gt<=31;Gt++,ce>>>=1)if(1&ce&&Ot.dyn_ltree[2*Gt]!==0)return y;if(Ot.dyn_ltree[18]!==0||Ot.dyn_ltree[20]!==0||Ot.dyn_ltree[26]!==0)return g;for(Gt=32;Gt<T;Gt++)if(Ot.dyn_ltree[2*Gt]!==0)return g;return y}(E)),he(E,E.l_desc),he(E,E.d_desc),Kt=function(Ot){var Gt;for(h(Ot,Ot.dyn_ltree,Ot.l_desc.max_code),h(Ot,Ot.dyn_dtree,Ot.d_desc.max_code),he(Ot,Ot.bl_desc),Gt=O-1;3<=Gt&&Ot.bl_tree[2*Tt[Gt]+1]===0;Gt--);return Ot.opt_len+=3*(Gt+1)+5+5+4,Gt}(E),it=E.opt_len+3+7>>>3,(Ct=E.static_len+3+7>>>3)<=it&&(it=Ct)):it=Ct=xt+5,xt+4<=it&&J!==-1?A(E,J,xt,yt):E.strategy===4||Ct===it?(vt(E,2+(yt?1:0),3),Vt(E,Rt,N)):(vt(E,4+(yt?1:0),3),function(Ot,Gt,ce,ie){var Se;for(vt(Ot,Gt-257,5),vt(Ot,ce-1,5),vt(Ot,ie-4,4),Se=0;Se<ie;Se++)vt(Ot,Ot.bl_tree[2*Tt[Se]+1],3);pt(Ot,Ot.dyn_ltree,Gt-1),pt(Ot,Ot.dyn_dtree,ce-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,Kt+1),Vt(E,E.dyn_ltree,E.dyn_dtree)),Nt(E),yt&&Pt(E)},_._tr_tally=function(E,J,xt){return E.pending_buf[E.d_buf+2*E.last_lit]=J>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&J,E.pending_buf[E.l_buf+E.last_lit]=255&xt,E.last_lit++,J===0?E.dyn_ltree[2*xt]++:(E.matches++,J--,E.dyn_ltree[2*(d[xt]+T+1)]++,E.dyn_dtree[2*tt(J)]++),E.last_lit===E.lit_bufsize-1},_._tr_align=function(E){vt(E,2,3),dt(E,j,Rt),function(J){J.bi_valid===16?(Zt(J,J.bi_buf),J.bi_buf=0,J.bi_valid=0):8<=J.bi_valid&&(J.pending_buf[J.pending++]=255&J.bi_buf,J.bi_buf>>=8,J.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(c,k,_){k.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(c,k,_){(function(p){(function(y,g){if(!y.setImmediate){var w,M,R,T,D=1,x={},O=!1,b=y.document,C=Object.getPrototypeOf&&Object.getPrototypeOf(y);C=C&&C.setTimeout?C:y,w={}.toString.call(y.process)==="[object process]"?function(X){process.nextTick(function(){I(X)})}:function(){if(y.postMessage&&!y.importScripts){var X=!0,Y=y.onmessage;return y.onmessage=function(){X=!1},y.postMessage("","*"),y.onmessage=Y,X}}()?(T="setImmediate$"+Math.random()+"$",y.addEventListener?y.addEventListener("message",j,!1):y.attachEvent("onmessage",j),function(X){y.postMessage(T+X,"*")}):y.MessageChannel?((R=new MessageChannel).port1.onmessage=function(X){I(X.data)},function(X){R.port2.postMessage(X)}):b&&"onreadystatechange"in b.createElement("script")?(M=b.documentElement,function(X){var Y=b.createElement("script");Y.onreadystatechange=function(){I(X),Y.onreadystatechange=null,M.removeChild(Y),Y=null},M.appendChild(Y)}):function(X){setTimeout(I,0,X)},C.setImmediate=function(X){typeof X!="function"&&(X=new Function(""+X));for(var Y=new Array(arguments.length-1),ct=0;ct<Y.length;ct++)Y[ct]=arguments[ct+1];var ot={callback:X,args:Y};return x[D]=ot,w(D),D++},C.clearImmediate=P}function P(X){delete x[X]}function I(X){if(O)setTimeout(I,0,X);else{var Y=x[X];if(Y){O=!0;try{(function(ct){var ot=ct.callback,wt=ct.args;switch(wt.length){case 0:ot();break;case 1:ot(wt[0]);break;case 2:ot(wt[0],wt[1]);break;case 3:ot(wt[0],wt[1],wt[2]);break;default:ot.apply(g,wt)}})(Y)}finally{P(X),O=!1}}}}function j(X){X.source===y&&typeof X.data=="string"&&X.data.indexOf(T)===0&&I(+X.data.slice(T.length))}})(typeof self>"u"?p===void 0?this:p:self)}).call(this,typeof Ti<"u"?Ti:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Bo);var Us=Bo.exports;const Ws=no(Us);function Sn(m,z){return Array.from(m.getElementsByTagName(z))}function Mr(m){return m[0]==="#"?m:`#${m}`}function qs(m,z,c){return Array.from(m.getElementsByTagNameNS(c,z))}function nn(m){return m==null||m.normalize(),(m==null?void 0:m.textContent)||""}function je(m,z,c){const k=m.getElementsByTagName(z);return k.length?k[0]:null}function Tn(m,z,c){const k={};if(!m)return k;const _=m.getElementsByTagName(z),p=_.length?_[0]:null;return p&&c?c(p,k):k}function Vi(m,z,c){const k=nn(je(m,z));return k&&c?c(k)||{}:{}}function Je(m,z,c){const k=Number.parseFloat(nn(je(m,z)));if(!Number.isNaN(k))return c&&c(k),k}function Zr(m,z){const c={};for(const k of z)Vi(m,k,_=>{c[k]=_});return c}function Io(m){return(m==null?void 0:m.nodeType)===1}function Mo(m,z){const c={},k=z==="stroke"||z==="fill"?z:`${z}-color`;return m[0]==="#"&&(m=m.substring(1)),m.length===6||m.length===3?c[k]=`#${m}`:m.length===8&&(c[`${z}-opacity`]=Number.parseInt(m.substring(0,2),16)/255,c[k]=`#${m.substring(6,8)}${m.substring(4,6)}${m.substring(2,4)}`),c}function Nr(m,z,c){const k={};return Je(m,z,_=>{k[c]=_}),k}function io(m,z){return Tn(m,"color",c=>Mo(nn(c),z))}function ro(m){return Tn(m,"Icon",(z,c)=>(Vi(z,"href",k=>{c.icon=k}),c))}function Hs(m){return Tn(m,"IconStyle",z=>Object.assign(io(z,"icon"),Nr(z,"scale","icon-scale"),Nr(z,"heading","icon-heading"),Tn(z,"hotSpot",c=>{const k=Number.parseFloat(c.getAttribute("x")||""),_=Number.parseFloat(c.getAttribute("y")||""),p=c.getAttribute("xunits")||"",y=c.getAttribute("yunits")||"";return!Number.isNaN(k)&&!Number.isNaN(_)?{"icon-offset":[k,_],"icon-offset-units":[p,y]}:{}}),ro(z)))}function Gs(m){return Tn(m,"LabelStyle",z=>Object.assign(io(z,"label"),Nr(z,"scale","label-scale")))}function Vs(m){return Tn(m,"LineStyle",z=>Object.assign(io(z,"stroke"),Nr(z,"width","stroke-width")))}function Ys(m){return Tn(m,"PolyStyle",(z,c)=>Object.assign(c,Tn(z,"color",k=>Mo(nn(k),"fill")),Vi(z,"fill",k=>{if(k==="0")return{"fill-opacity":0}}),Vi(z,"outline",k=>{if(k==="0")return{"stroke-opacity":0}})))}function Fr(m){return Object.assign({},Ys(m),Vs(m),Gs(m),Hs(m))}const Xs=/\s*/g,Js=/^\s*|\s*$/g,Qs=/\s+/;function No(m){return m.replace(Xs,"").split(",").map(Number.parseFloat).filter(z=>!Number.isNaN(z)).slice(0,3)}function to(m){return m.replace(Js,"").split(Qs).map(No).filter(z=>z.length>=2)}function $s(m){let z=Sn(m,"coord");z.length===0&&(z=qs(m,"coord","*"));const c=z.map(k=>nn(k).split(" ").map(Number.parseFloat));return c.length===0?null:{geometry:c.length>2?{type:"LineString",coordinates:c}:{type:"Point",coordinates:c[0]},times:Sn(m,"when").map(k=>nn(k))}}function Do(m){if(m.length===0)return m;const z=m[0],c=m[m.length-1];let k=!0;for(let _=0;_<Math.max(z.length,c.length);_++)if(z[_]!==c[_]){k=!1;break}return k?m:m.concat([m[0]])}function Ir(m){return nn(je(m,"coordinates"))}function Ro(m){let z=[],c=[];for(let k=0;k<m.childNodes.length;k++){const _=m.childNodes.item(k);if(Io(_))switch(_.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const p=Ro(_);z=z.concat(p.geometries),c=c.concat(p.coordTimes);break}case"Point":{const p=No(Ir(_));p.length>=2&&z.push({type:"Point",coordinates:p});break}case"LinearRing":case"LineString":{const p=to(Ir(_));p.length>=2&&z.push({type:"LineString",coordinates:p});break}case"Polygon":{const p=[];for(const y of Sn(_,"LinearRing")){const g=Do(to(Ir(y)));g.length>=4&&p.push(g)}p.length&&z.push({type:"Polygon",coordinates:p});break}case"Track":case"gx:Track":{const p=$s(_);if(!p)break;const{times:y,geometry:g}=p;z.push(g),y.length&&c.push(y);break}}}return{geometries:z,coordTimes:c}}const Hi=m=>Number(m),eo={string:m=>m,int:Hi,uint:Hi,short:Hi,ushort:Hi,float:Hi,double:Hi,bool:m=>!!m};function oo(m,z){return Tn(m,"ExtendedData",(c,k)=>{for(const _ of Sn(c,"Data"))k[_.getAttribute("name")||""]=nn(je(_,"value"));for(const _ of Sn(c,"SimpleData")){const p=_.getAttribute("name")||"",y=z[p]||eo.string;k[p]=y(nn(_))}return k})}function so(m){const z=je(m,"description");for(const c of Array.from((z==null?void 0:z.childNodes)||[]))if(c.nodeType===4)return{description:{"@type":"html",value:nn(c)}};return{}}function ao(m){return Tn(m,"TimeSpan",z=>({timespan:{begin:nn(je(z,"begin")),end:nn(je(z,"end"))}}))}function uo(m){return Tn(m,"TimeStamp",z=>({timestamp:nn(je(z,"when"))}))}function co(m,z){return Vi(m,"styleUrl",c=>(c=Mr(c),z[c]?Object.assign({styleUrl:c},z[c]):{styleUrl:c}))}var pn;(function(m){m.ABSOLUTE="absolute",m.RELATIVE_TO_GROUND="relativeToGround",m.CLAMP_TO_GROUND="clampToGround",m.CLAMP_TO_SEAFLOOR="clampToSeaFloor",m.RELATIVE_TO_SEAFLOOR="relativeToSeaFloor"})(pn||(pn={}));function ta(m){switch(m==null?void 0:m.textContent){case pn.ABSOLUTE:return pn.ABSOLUTE;case pn.CLAMP_TO_GROUND:return pn.CLAMP_TO_GROUND;case pn.CLAMP_TO_SEAFLOOR:return pn.CLAMP_TO_SEAFLOOR;case pn.RELATIVE_TO_GROUND:return pn.RELATIVE_TO_GROUND;case pn.RELATIVE_TO_SEAFLOOR:return pn.RELATIVE_TO_SEAFLOOR}return null}function ea(m){return je(m,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[Do(to(Ir(m)))]}}:ra(m)}const na=Math.PI/180;function ia(m,z,c){const k=[(m[0]+m[2])/2,(m[1]+m[3])/2];return[z[0].map(_=>{const p=_[1]-k[1],y=_[0]-k[0],g=Math.sqrt(p**2+y**2),w=Math.atan2(p,y)+c*na;return[k[0]+Math.cos(w)*g,k[1]+Math.sin(w)*g]})]}function ra(m){const z=je(m,"LatLonBox");if(z){const c=Je(z,"north"),k=Je(z,"west"),_=Je(z,"east"),p=Je(z,"south"),y=Je(z,"rotation");if(typeof c=="number"&&typeof p=="number"&&typeof k=="number"&&typeof _=="number"){const g=[k,p,_,c];let w=[[[k,c],[_,c],[_,p],[k,p],[k,c]]];return typeof y=="number"&&(w=ia(g,w,y)),{bbox:g,geometry:{type:"Polygon",coordinates:w}}}}return null}function oa(m,z,c,k){var w;const _=ea(m),p=(_==null?void 0:_.geometry)||null;if(!p&&k.skipNullGeometry)return null;const y={type:"Feature",geometry:p,properties:Object.assign({"@geometry-type":"groundoverlay"},Zr(m,["name","address","visibility","open","phoneNumber","description"]),so(m),co(m,z),Fr(m),ro(m),oo(m,c),ao(m),uo(m))};_!=null&&_.bbox&&(y.bbox=_.bbox),((w=y.properties)==null?void 0:w.visibility)!==void 0&&(y.properties.visibility=y.properties.visibility!=="0");const g=m.getAttribute("id");return g!==null&&g!==""&&(y.id=g),y}function sa(m){const z=je(m,"Region");return z?{coordinateBox:ua(z),lod:aa(m)}:null}function aa(m){const z=je(m,"Lod");return z?[Je(z,"minLodPixels")??-1,Je(z,"maxLodPixels")??-1,Je(z,"minFadeExtent")??null,Je(z,"maxFadeExtent")??null]:null}function ua(m){const z=je(m,"LatLonAltBox");if(z){const c=Je(z,"north"),k=Je(z,"west"),_=Je(z,"east"),p=Je(z,"south");if(ta(je(z,"altitudeMode")||je(z,"gx:altitudeMode"))&&console.debug("Encountered an unsupported feature of KML for togeojson: please contact developers for support of altitude mode."),typeof c=="number"&&typeof p=="number"&&typeof k=="number"&&typeof _=="number")return{bbox:[k,p,_,c],geometry:{type:"Polygon",coordinates:[[[k,c],[_,c],[_,p],[k,p],[k,c]]]}}}return null}function ca(m){const z=je(m,"Link");return z?Zr(z,["href","refreshMode","refreshInterval","viewRefreshMode","viewRefreshTime","viewBoundScale","viewFormat","httpQuery"]):{}}function la(m,z,c,k){var w,M,R;const _=sa(m),p=((w=_==null?void 0:_.coordinateBox)==null?void 0:w.geometry)||null;if(!p&&k.skipNullGeometry)return null;const y={type:"Feature",geometry:p,properties:Object.assign({"@geometry-type":"networklink"},Zr(m,["name","address","visibility","open","phoneNumber","styleUrl","refreshVisibility","flyToView","description"]),so(m),co(m,z),Fr(m),ro(m),oo(m,c),ao(m),uo(m),ca(m),_!=null&&_.lod?{lod:_.lod}:{})};(M=_==null?void 0:_.coordinateBox)!=null&&M.bbox&&(y.bbox=_.coordinateBox.bbox),((R=y.properties)==null?void 0:R.visibility)!==void 0&&(y.properties.visibility=y.properties.visibility!=="0");const g=m.getAttribute("id");return g!==null&&g!==""&&(y.id=g),y}function ha(m){return m.length===0?null:m.length===1?m[0]:{type:"GeometryCollection",geometries:m}}function fa(m,z,c,k){var M;const{coordTimes:_,geometries:p}=Ro(m),y=ha(p);if(!y&&k.skipNullGeometry)return null;const g={type:"Feature",geometry:y,properties:Object.assign(Zr(m,["name","address","visibility","open","phoneNumber","description"]),so(m),co(m,z),Fr(m),oo(m,c),ao(m),uo(m),_.length?{coordinateProperties:{times:_.length===1?_[0]:_}}:{})};((M=g.properties)==null?void 0:M.visibility)!==void 0&&(g.properties.visibility=g.properties.visibility!=="0");const w=m.getAttribute("id");return w!==null&&w!==""&&(g.id=w),g}function da(m){let z=m.getAttribute("id");const c=m.parentNode;return!z&&Io(c)&&c.localName==="CascadingStyle"&&(z=c.getAttribute("kml:id")||c.getAttribute("id")),Mr(z||"")}function pa(m){const z={};for(const c of Sn(m,"Style"))z[da(c)]=Fr(c);for(const c of Sn(m,"StyleMap")){const k=Mr(c.getAttribute("id")||"");Vi(c,"styleUrl",_=>{_=Mr(_),z[_]&&(z[k]=z[_])})}return z}function ma(m){const z={};for(const c of Sn(m,"SimpleField"))z[c.getAttribute("name")||""]=eo[c.getAttribute("type")||""]||eo.string;return z}function*_a(m,z={skipNullGeometry:!1}){const c=m,k=pa(c),_=ma(c);for(const p of Sn(c,"Placemark")){const y=fa(p,k,_,z);y&&(yield y)}for(const p of Sn(c,"GroundOverlay")){const y=oa(p,k,_,z);y&&(yield y)}for(const p of Sn(c,"NetworkLink")){const y=la(p,k,_,z);y&&(yield y)}}function ga(m,z={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(_a(m,z))}}const va=Xe.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});Xe.Marker.prototype.options.icon=va;const Po=m=>{const z=Xe.map(m).setView([-1.9441,30.0619],13);Xe.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(z);let c=null,k=null,_=null;navigator.geolocation&&(_=navigator.geolocation.watchPosition(w=>{const{latitude:M,longitude:R}=w.coords;k=Xe.latLng(M,R),c?c.setLatLng(k):(c=Xe.circleMarker(k,{radius:8,fillColor:"#3388ff",color:"white",weight:2,opacity:1,fillOpacity:.8}).addTo(z),c.bindPopup("You are here"))},w=>{console.warn("Geolocation error:",w)},{enableHighAccuracy:!0,maximumAge:5e3,timeout:1e4}));const p=new Xe.Control({position:"topleft"});return p.onAdd=function(){const w=Xe.DomUtil.create("div","leaflet-bar leaflet-control"),M=Xe.DomUtil.create("a","",w);return M.innerHTML="ð",M.href="#",M.title="Snap to my location",M.style.backgroundColor="white",M.style.width="30px",M.style.height="30px",M.style.display="flex",M.style.alignItems="center",M.style.justifyContent="center",M.style.fontSize="18px",M.style.textDecoration="none",M.style.color="black",M.style.cursor="pointer",Xe.DomEvent.on(M,"click",function(R){Xe.DomEvent.stop(R),k?(z.flyTo(k,16),c&&c.openPopup()):alert("Waiting for GPS signal...")}),w},p.addTo(z),(async()=>{try{const w=await fetch("/maps/index.json");if(!w.ok)return;const M=await w.json(),R=Xe.latLngBounds([]);let T=!1;for(const D of M)try{const O=await(await fetch(`/maps/${D}`)).blob();let b="";if(D.endsWith(".kmz")){const C=await Ws.loadAsync(O),P=Object.keys(C.files).find(I=>I.endsWith(".kml"));P&&(b=await C.files[P].async("string"))}else D.endsWith(".kml")&&(b=await O.text());if(b){const P=new DOMParser().parseFromString(b,"text/xml"),I=ga(P),j=Xe.geoJSON(I,{onEachFeature:(X,Y)=>{if(X.properties){let ct='<div style="max-height: 200px; overflow-y: auto;"><h4>Info</h4><ul>';Object.keys(X.properties).forEach(ot=>{const wt=X.properties[ot];wt!==null&&typeof wt!="object"&&(ct+=`<li><strong>${ot}:</strong> ${wt}</li>`)}),ct+="</ul></div>",Y.bindPopup(ct)}},style:{color:"#ff7800",weight:2,opacity:.65}}).addTo(z);R.extend(j.getBounds()),T=!0}}catch(x){console.error(`Failed to load map ${D}:`,x)}T&&R.isValid()&&z.fitBounds(R)}catch(w){console.error("Failed to load map index:",w)}})(),setTimeout(()=>{z.invalidateSize()},100),{cleanup:()=>{_!==null&&navigator.geolocation.clearWatch(_),z.remove()},map:z}},ya=(m,z,c)=>{z.forEach(k=>{if(typeof k.lat=="number"&&typeof k.lng=="number"){const _=new Date(k.created_at).toLocaleString(),p=Object.entries(k.counts).map(([g,w])=>`<b>${g}:</b> ${w}`).join("<br>"),y=`<div style="text-align:center">
        <strong>${c}</strong><br>
        <small>${_}</small>
        <hr style="margin: 5px 0;">
        ${p||"No counts"}
        </div>`;Xe.circleMarker([k.lat,k.lng],{radius:6,fillColor:"#ff0000",color:"#fff",weight:1,opacity:1,fillOpacity:.8}).addTo(m).bindPopup(y)}})},ba=(m,z)=>{let c=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>${z}</name>
`;return m.forEach(k=>{if(typeof k.lat=="number"&&typeof k.lng=="number"){const _=new Date(k.created_at).toLocaleString(),p=Object.entries(k.counts).map(([w,M])=>`${w}: ${M}`).join(`
`),g=`Time: ${_}
Species:
${p}`.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\n/g,"&#xA;");c+=`    <Placemark>
      <name>${z}</name>
      <description>${g}</description>
      <Point>
        <coordinates>${k.lng},${k.lat},0</coordinates>
      </Point>
    </Placemark>
`}}),c+=`  </Document>
</kml>`,c},wa=()=>new Date().toISOString().slice(0,10),Zo=m=>new Date(m).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),xa=m=>new Date(m).toLocaleString([],{dateStyle:"short",timeStyle:"short"}),ka=(m,z)=>z===0?"â":`${Math.round(m*100)}%`,Pa=m=>{const z=kt("div",{className:"tally-item"}),c=kt("div",{text:`${m.trees} trees${m.block_name?` Â· ${m.block_name}`:""}`}),k=kt("div",{className:"tally-meta"}),_=kt("span",{text:m.sync_status}),p=kt("span",{text:Zo(m.created_at)});if(k.append(_,p),m.notes){const y=kt("div",{className:"small",text:m.notes});z.append(c,k,y)}else z.append(c,k);if(m.sync_status==="error"&&m.sync_error){const y=kt("div",{className:"small",text:`Sync error: ${m.sync_error}`});z.append(y)}return z},Br=()=>{const m=document.createElement("img");return m.src="/Tallies/Logo.png",m.alt="Tree Tally",m.className="app-logo",m},Sa=()=>{const m=document.querySelector("#app");if(!m)return;Ze("App initialized");let z={view:"home"},c=null,k="All Sessions",_=null;const p=R=>{Ze("Navigate",R),z=R,M()},y=async()=>{_&&(_(),_=null),m.innerHTML="";const R=Br(),T=kt("section",{className:"card"}),D=kt("section",{className:"card"}),x=kt("section",{className:"card"}),O=kt("section",{className:"card"}),b=kt("div");b.id="map-container",O.append(b);const C=kt("section",{className:"card"}),P=kt("section",{className:"card"}),I=kt("button",{text:"Start New Tally"});I.type="button",I.addEventListener("click",()=>p({view:"new-session"})),T.append(I);const j=kt("h2",{text:"Today"}),X=kt("div",{className:"tally-list"});D.append(j,X);const Y=kt("h2",{text:"Tally Sessions"}),ct=kt("div",{className:"row"});ct.style.overflowX="auto",ct.style.paddingBottom="8px",ct.style.marginBottom="8px",["All Sessions","Synced Sessions","Finalized Sessions","Archived Sessions","Error Sessions"].forEach(vt=>{const dt=kt("button",{text:vt});dt.className=vt===k?"compact":"compact secondary",dt.style.whiteSpace="nowrap",dt.addEventListener("click",async()=>{k=vt,Ze("Filter changed",{filter:vt}),await y()}),ct.append(dt)});const wt=kt("div",{className:"tally-list"});x.append(Y,ct,wt);const at=kt("h2",{text:"Sync status"}),Tt=kt("div",{className:"status-row"}),Rt=kt("span",{className:"status-pill pending"}),N=kt("span",{className:"status-pill synced"}),lt=kt("span",{className:"status-pill error"});Tt.append(Rt,N,lt);const d=kt("button",{text:"Sync now"});d.className="secondary";const ht=kt("button",{text:"Retry sync"}),zt=kt("div",{className:"small"});C.append(at,Tt,d,ht,zt);const mt=kt("button",{text:"Download Logs"});mt.className="secondary",mt.type="button",mt.addEventListener("click",()=>{Ze("Download Logs clicked"),js()}),P.append(kt("h2",{text:"Debug"}),mt),m.append(R,T,D,x,O,C,P);const{cleanup:Lt}=Po(b);_=Lt;const _t=async()=>{const vt=wa(),dt=await hs(vt);X.innerHTML="",dt.length===0?X.append(kt("div",{className:"small",text:"No tallies yet."})):dt.forEach(jt=>X.append(Pa(jt)))},bt=async()=>{const vt=await zs(k);if(wt.innerHTML="",vt.length===0){wt.append(kt("div",{className:"small",text:"No sessions found."}));return}vt.forEach(dt=>{const jt=kt("button",{className:"session-item"});jt.type="button";const le=kt("div",{text:dt.block_name}),Nt=kt("div",{className:"tally-meta",text:`${dt.species.length} species Â· ${xa(dt.created_at)} Â· ${dt.sync_status}`});jt.append(le,Nt),jt.addEventListener("click",()=>p({view:"session-detail",sessionId:dt.session_id})),wt.append(jt)})},$=async()=>{const[vt,dt,jt]=await Promise.all([ds(),ys(),Ls()]),le=dt.finalized,Nt=vt.synced+dt.synced+jt.synced,Pt=vt.error+dt.error+jt.error;Rt.textContent=`Pending: ${le}`,N.textContent=`Synced: ${Nt}`,lt.textContent=`Error: ${Pt}`},tt=async()=>{await Promise.all([_t(),bt(),$()])},Zt=async()=>{Ze("Sync started"),d.disabled=!0,ht.disabled=!0,zt.textContent=navigator.onLine?"Syncing...":"Offline. Will retry later.",await Fs();const vt=await Zs();vt.skipped?(zt.textContent="Offline. Tallies will sync when back online.",Ze("Sync skipped (offline)")):vt.failed>0?(zt.textContent=`Sync finished with ${vt.failed} failures. ${vt.errors.length>0?"Errors: "+vt.errors.join(", "):""}`,Ze("Sync finished with failures",vt)):(zt.textContent=`Synced ${vt.synced} records.`,Ze("Sync finished successfully",vt)),d.disabled=!1,ht.disabled=!1,await tt()};d.addEventListener("click",Zt),ht.addEventListener("click",Zt),await tt()},g=async()=>{m.innerHTML="";const[R,T]=await Promise.all([us(),ls()]),D=kt("div",{className:"header-row"}),x=kt("button",{text:"Back"});x.type="button",x.className="secondary compact",x.addEventListener("click",async()=>{Ze("Back button clicked in New Session"),p({view:"home"})});const O=kt("h1",{text:"New Tally Session"});D.append(x,O);const b=kt("section",{className:"card"}),C=document.createElement("form"),P=kt("input");P.type="date";const I=new Date;P.value=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}-${String(I.getDate()).padStart(2,"0")}`,P.required=!0;const j=kt("select"),X=kt("option",{text:"Select a project..."});X.value="",j.append(X),R.forEach(ht=>{const zt=kt("option",{text:ht.project_name});zt.value=ht.project_name,j.append(zt)});const Y=kt("select");Y.required=!0;const ct=kt("option",{text:"Select a block..."});ct.value="",Y.append(ct);const ot=kt("select");ot.required=!0;const wt=kt("option",{text:"Select a supervisor..."});wt.value="",ot.append(wt),T.forEach(ht=>{const zt=kt("option",{text:ht});zt.value=ht,ot.append(zt)});const at=kt("input");at.type="number",at.placeholder="Target Density",at.min="0";const Tt=document.createElement("textarea");Tt.rows=2,Tt.placeholder="Notes (optional)";const Rt=kt("div",{className:"species-container"}),N=kt("button",{text:"Start session"});N.type="submit";const lt=[],d=ht=>{const zt=Ms({initial:ht});zt.codeInput.required=!0,zt.nameInput.required=!0,zt.ratioInput.required=!0,Rt.append(zt.row),lt.push(zt)};j.addEventListener("change",()=>{const ht=j.value,zt=R.find(_t=>_t.project_name===ht);if(!zt)return;Ze("Project selected",{projectName:ht}),Y.innerHTML="",Y.append(ct);const mt=zt.blocks_data;Array.isArray(mt)?mt.forEach(_t=>{const bt=kt("option",{text:String(_t)});bt.value=String(_t),Y.append(bt)}):typeof mt=="object"&&mt!==null&&("error"in mt?console.warn("Blocks data has error:",mt.error):Object.values(mt).forEach(_t=>{const bt=String(_t),$=kt("option",{text:bt});$.value=bt,Y.append($)})),lt.forEach(_t=>_t.row.remove()),lt.length=0;const Lt=zt.species_data;"error"in Lt||Object.entries(Lt).forEach(([_t,bt])=>{d({species_code:_t,display_name:bt,required_ratio:0})})}),C.append(kt("label",{text:"Date"}),P,kt("label",{text:"Project"}),j,kt("label",{text:"Block name"}),Y,kt("label",{text:"Supervisor"}),ot,kt("label",{text:"Target Density"}),at,kt("label",{text:"Notes"}),Tt,kt("label",{text:"Species (code, name, required ratio)"}),Rt,N),C.addEventListener("submit",async ht=>{if(ht.preventDefault(),!C.reportValidity())return;const zt=lt.map(_t=>({species_code:_t.codeInput.value.trim(),display_name:_t.nameInput.value.trim(),required_ratio:Number(_t.ratioInput.value)})),mt={block_name:Y.value,project_name:j.value,supervisor:ot.value,target_density:at.value?Number(at.value):void 0,notes:Tt.value,species:zt,date:P.value};Ze("Start Session",mt),N.disabled=!0;const Lt=await _s(mt);N.disabled=!1,p({view:"session-detail",sessionId:Lt.session_id})}),b.append(C),m.append(Br(),D,b)},w=async R=>{m.innerHTML="";const T=await gs(R);if(!T){const Nt=kt("div",{className:"small",text:"Session not found."}),Pt=kt("button",{text:"Back"});Pt.type="button",Pt.addEventListener("click",()=>p({view:"home"})),m.append(Pt,Nt);return}const D=await Ss(R),x=(c==null?void 0:c.sessionId)===R?c:null,O=x?[...D.filter(Nt=>Nt.bagup_id!==x.bagupId),{bagup_id:x.bagupId,session_id:R,created_at:x.createdAt,counts:x.counts,sync_status:"pending"}].sort((Nt,Pt)=>Pt.created_at-Nt.created_at):D,b=xo(T.species,O),C=ko(T.species,b);Object.values(b).reduce((Nt,Pt)=>Nt+Pt,0);const P=O[0],I=P?Oo(Date.now()-P.created_at):"â",j=kt("div",{className:"header-row"}),X=kt("button",{text:"Back"});X.type="button",X.className="secondary compact",X.addEventListener("click",()=>{Ze("Back from Session Detail"),p({view:"home"})});const Y=kt("h1",{text:T.block_name}),ct=kt("div");ct.style.display="flex",ct.style.gap="8px";const ot=T.sync_status==="draft"||T.sync_status==="pending"||T.sync_status==="error";if(ot){const Nt=kt("button",{text:"Finalize"});Nt.className="compact",Nt.addEventListener("click",async()=>{confirm("Finalize session? This will make it ready for sync and lock it for editing.")&&(Ze("Finalize Session",{sessionId:R}),await Os(R),await w(R))}),ct.append(Nt)}const wt=kt("button",{text:"Archive"});wt.className="compact secondary",wt.addEventListener("click",async()=>{confirm("Archive session? It will be hidden from the main list.")&&(Ze("Archive Session",{sessionId:R}),await As(R),p({view:"home"}))}),ct.append(wt);const at=kt("button",{text:"+"});at.type="button",at.className="fab",at.disabled=!ot,j.append(X,Y,ct);const Tt=kt("section",{className:"card"}),Rt=kt("div",{className:"meta-row"}),N=kt("div",{className:"small",text:`Time since last bagup: ${I}`}),lt=kt("div",{className:"small",text:`Started ${new Date(T.created_at).toLocaleDateString()}`});T.project_name&&Rt.append(kt("div",{className:"small",text:`Project: ${T.project_name}`})),T.supervisor&&Rt.append(kt("div",{className:"small",text:`Supervisor: ${T.supervisor}`})),T.target_density&&Rt.append(kt("div",{className:"small",text:`Target Density: ${T.target_density}`}));const d=kt("div",{className:"small",text:`Status: ${T.sync_status}`});if(Rt.append(N,lt,d),T.notes){const Nt=kt("div",{className:"small",text:T.notes});Tt.append(Rt,Nt)}else Tt.append(Rt);const ht=kt("section",{className:"card"}),zt=kt("h2",{text:"Species totals"}),mt=kt("div",{className:"species-summary-list"});T.species.forEach(Nt=>{mt.append(Ns(Nt))}),ht.append(zt,mt);const Lt=kt("section",{className:"card"}),_t=kt("div",{className:"bagup-title-row"}),bt=kt("h2",{text:"Bagups"});_t.append(bt,at);const $=kt("div",{className:"tally-list"});Lt.append(_t,$);const tt=kt("section",{className:"card"}),Zt=kt("div");Zt.id="session-map-container",Zt.style.height="400px",tt.append(Zt),_&&(_(),_=null);const{cleanup:vt,map:dt}=Po(Zt);if(_=vt,D.length>0){ya(dt,D,T.block_name);const Nt=ba(D,T.block_name);console.log("--- Generated KML Content for public/maps/bagups.kml ---"),console.log(Nt),console.log("--------------------------------------------------------")}const jt=(Nt,Pt)=>{const oe=Object.values(Nt).reduce((Qt,Vt)=>Qt+Vt,0);T.species.forEach(Qt=>{const Vt=mt.querySelector(`[data-species-code="${Qt.species_code}"]`);if(!Vt)return;const he=Vt.querySelector(".species-current"),h=Vt.querySelector(".species-total");he&&(he.textContent=`Current: ${ka(Pt[Qt.species_code]??0,oe)}`),h&&(h.textContent=`Total: ${Nt[Qt.species_code]??0}`)})};if(jt(b,C),(Nt=>{if($.innerHTML="",Nt.length===0){$.append(kt("div",{className:"small",text:"No bagups yet."}));return}const Pt=Is(Nt);Nt.forEach(oe=>{const Qt=kt("div",{className:"bagup-item"}),Vt=kt("div",{className:"bagup-header"}),he=kt("div",{text:Zo(oe.created_at)}),h=kt("div",{className:"small",text:Pt[oe.bagup_id]});Vt.append(he,h);const pt=kt("div",{className:"bagup-counts"});T.species.forEach(st=>{const A=oe.counts[st.species_code]??0;pt.append(kt("span",{className:"bagup-count",text:`${st.display_name}: ${A}`}))}),Qt.append(Vt,pt),$.append(Qt)})})(D.filter(Nt=>Nt.bagup_id!==(x==null?void 0:x.bagupId))),at.addEventListener("click",async()=>{if(c||!ot)return;Ze("Add Bagup clicked");let Nt;try{if(navigator.geolocation){const Qt=await new Promise((Vt,he)=>{navigator.geolocation.getCurrentPosition(Vt,he,{enableHighAccuracy:!0,timeout:5e3})});Nt={lat:Qt.coords.latitude,lng:Qt.coords.longitude}}}catch(Qt){console.warn("Failed to get location for bagup:",Qt)}const Pt=T.species.map(Qt=>Qt.species_code),oe=await xs(R,Pt,Nt);c={sessionId:R,bagupId:oe.bagup_id,createdAt:oe.created_at,counts:{...oe.counts}},await w(R)}),x&&ot){const Nt=kt("section",{className:"card"}),Pt=kt("h2",{text:"New bagup"}),oe=document.createElement("form");T.species.forEach(h=>{const pt=kt("label",{text:h.display_name}),st=kt("input");st.type="number",st.min="0",st.value=String(x.counts[h.species_code]??0),st.addEventListener("input",()=>{x.counts[h.species_code]=Number(st.value||0);const A=xo(T.species,[...D.filter(J=>J.bagup_id!==x.bagupId),{bagup_id:x.bagupId,session_id:R,created_at:x.createdAt,counts:x.counts,sync_status:"pending"}]),E=ko(T.species,A);jt(A,E)}),oe.append(pt,st)});const Qt=kt("div",{className:"editor-actions"}),Vt=kt("button",{text:"Cancel"});Vt.type="button",Vt.className="secondary";const he=kt("button",{text:"Save bagup"});he.type="submit",Qt.append(Vt,he),Vt.addEventListener("click",async()=>{Ze("Cancel Bagup"),await Ps(x.bagupId),c=null,await w(R)}),oe.addEventListener("submit",async h=>{h.preventDefault(),Ze("Save Bagup",x.counts),he.disabled=!0,await ks(x.bagupId,x.counts),c=null,he.disabled=!1,await w(R)}),oe.append(Qt),Nt.append(Pt,oe),m.append(Br(),j,Tt,ht,Nt,Lt,tt)}else m.append(Br(),j,Tt,ht,Lt,tt)},M=async()=>{switch(_&&(_(),_=null),z.view){case"home":await y();return;case"new-session":await g();return;case"session-detail":await w(z.sessionId);return;default:return}};M()};Sa();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(m=>{console.warn("Service worker registration failed",m)})});
